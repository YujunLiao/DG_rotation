******************Start training**************************************
--------------------------------------------------------
Dataset size: training 449, validation 49, testing 2817
--------------------------------------------------------
Namespace(TTA=False, batch_size=32, bias_whole_image=0.4, classify_only_ordered_images_or_not=True, domains_list=['amazon', 'dslr', 'webcam'], entropy_loss_weight=0.1, epochs=30, folder_name='test', image_size=222, jitter=0.4, learning_rate=0.0005, limit_source=None, limit_target=None, max_scale=1.0, min_scale=0.8, n_classes=65, nesterov=False, network='resnet50', number_of_unsupervised_classes=4, ooo_weight=0, parameters_lists=[[0.8, 0.4, 0.7, 0.1]], random_horiz_flip=0.5, repeat_times=1, source=['dslr'], suffix='', target='amazon', target_domain_list=['amazon', 'dslr', 'webcam'], target_domain_unsupervised_task_loss_weight=0.7, tf_logger=True, tile_random_grayscale=0.1, train_all=True, unsupervised_task_weight=0.8, val_size=0.1)
--------------------------------------------------------
/home/giorgio/Files/pycharm_project/pytorch_interpreter/lib/python3.7/site-packages/torch/optim/lr_scheduler.py:100: UserWarning: Detected call of `lr_scheduler.step()` before `optimizer.step()`. In PyTorch 1.1.0 and later, you should call them in the opposite order: `optimizer.step()` before `lr_scheduler.step()`.  Failure to do this will result in PyTorch skipping the first value of the learning rate schedule.See more details at https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate
  "https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate", UserWarning)
--------------------------------------------------------
current epoch:%d 0
New epoch - lr: 0.0005
0/14 of epoch 1/30 jigsaw : 1.414, class : 4.262, t_rotation : 1.400, entropy : 4.111 - acc jigsaw : 15.62, class : 0.00 [bs:32]
Accuracies on val: jigsaw : 100.00, class : 14.29
--------------------------------------------------------
Accuracies on test: jigsaw : 100.00, class : 8.77
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 1
New epoch - lr: 0.0005
0/14 of epoch 2/30 jigsaw : 1.264, class : 3.763, t_rotation : 0.921, entropy : 4.092 - acc jigsaw : 50.00, class : 9.38 [bs:32]
Accuracies on val: jigsaw : 100.00, class : 24.49
--------------------------------------------------------
Accuracies on test: jigsaw : 100.00, class : 11.00
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 2
New epoch - lr: 0.0005
0/14 of epoch 3/30 jigsaw : 1.115, class : 3.187, t_rotation : 1.134, entropy : 3.889 - acc jigsaw : 53.12, class : 18.75 [bs:32]
Accuracies on val: jigsaw : 100.00, class : 32.65
--------------------------------------------------------
Accuracies on test: jigsaw : 99.96, class : 16.44
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 3
New epoch - lr: 0.0005
0/14 of epoch 4/30 jigsaw : 1.067, class : 2.898, t_rotation : 1.451, entropy : 3.643 - acc jigsaw : 46.88, class : 31.25 [bs:32]
Accuracies on val: jigsaw : 100.00, class : 48.98
--------------------------------------------------------
Accuracies on test: jigsaw : 99.96, class : 23.86
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 4
New epoch - lr: 0.0005
0/14 of epoch 5/30 jigsaw : 1.160, class : 2.254, t_rotation : 1.270, entropy : 3.444 - acc jigsaw : 43.75, class : 53.12 [bs:32]
Accuracies on val: jigsaw : 100.00, class : 65.31
--------------------------------------------------------
Accuracies on test: jigsaw : 100.00, class : 32.69
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 5
New epoch - lr: 0.0005
0/14 of epoch 6/30 jigsaw : 0.912, class : 1.945, t_rotation : 0.889, entropy : 3.490 - acc jigsaw : 56.25, class : 65.62 [bs:32]
Accuracies on val: jigsaw : 100.00, class : 67.35
--------------------------------------------------------
Accuracies on test: jigsaw : 99.54, class : 37.84
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 6
New epoch - lr: 0.0005
0/14 of epoch 7/30 jigsaw : 0.770, class : 1.494, t_rotation : 1.091, entropy : 3.378 - acc jigsaw : 71.88, class : 78.12 [bs:32]
Accuracies on val: jigsaw : 100.00, class : 71.43
--------------------------------------------------------
Accuracies on test: jigsaw : 99.40, class : 38.80
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 7
New epoch - lr: 0.0005
0/14 of epoch 8/30 jigsaw : 0.816, class : 1.328, t_rotation : 1.048, entropy : 3.068 - acc jigsaw : 62.50, class : 68.75 [bs:32]
Accuracies on val: jigsaw : 100.00, class : 77.55
--------------------------------------------------------
Accuracies on test: jigsaw : 98.79, class : 44.02
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 8
New epoch - lr: 0.0005
0/14 of epoch 9/30 jigsaw : 0.788, class : 1.000, t_rotation : 0.980, entropy : 3.077 - acc jigsaw : 62.50, class : 75.00 [bs:32]
Accuracies on val: jigsaw : 100.00, class : 87.76
--------------------------------------------------------
Accuracies on test: jigsaw : 98.65, class : 48.17
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 9
New epoch - lr: 0.0005
0/14 of epoch 10/30 jigsaw : 0.660, class : 1.242, t_rotation : 0.840, entropy : 2.907 - acc jigsaw : 65.62, class : 68.75 [bs:32]
Accuracies on val: jigsaw : 100.00, class : 91.84
--------------------------------------------------------
Accuracies on test: jigsaw : 95.78, class : 52.01
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 10
New epoch - lr: 0.0005
0/14 of epoch 11/30 jigsaw : 0.511, class : 0.579, t_rotation : 1.138, entropy : 2.646 - acc jigsaw : 87.50, class : 81.25 [bs:32]
Accuracies on val: jigsaw : 100.00, class : 89.80
--------------------------------------------------------
Accuracies on test: jigsaw : 97.16, class : 57.44
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 11
New epoch - lr: 0.0005
0/14 of epoch 12/30 jigsaw : 0.851, class : 0.739, t_rotation : 0.725, entropy : 2.773 - acc jigsaw : 68.75, class : 78.12 [bs:32]
Accuracies on val: jigsaw : 100.00, class : 91.84
--------------------------------------------------------
Accuracies on test: jigsaw : 97.48, class : 60.03
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 12
New epoch - lr: 0.0005
0/14 of epoch 13/30 jigsaw : 0.889, class : 0.712, t_rotation : 0.908, entropy : 2.375 - acc jigsaw : 65.62, class : 78.12 [bs:32]
Accuracies on val: jigsaw : 100.00, class : 91.84
--------------------------------------------------------
Accuracies on test: jigsaw : 98.23, class : 61.09
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 13
New epoch - lr: 0.0005
0/14 of epoch 14/30 jigsaw : 0.576, class : 0.620, t_rotation : 1.150, entropy : 2.387 - acc jigsaw : 75.00, class : 62.50 [bs:32]
Accuracies on val: jigsaw : 100.00, class : 93.88
--------------------------------------------------------
Accuracies on test: jigsaw : 96.02, class : 62.23
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 14
New epoch - lr: 0.0005
0/14 of epoch 15/30 jigsaw : 0.754, class : 0.257, t_rotation : 0.828, entropy : 2.508 - acc jigsaw : 65.62, class : 78.12 [bs:32]
Accuracies on val: jigsaw : 100.00, class : 93.88
--------------------------------------------------------
Accuracies on test: jigsaw : 97.16, class : 61.48
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 15
New epoch - lr: 0.0005
0/14 of epoch 16/30 jigsaw : 0.564, class : 0.238, t_rotation : 0.857, entropy : 2.645 - acc jigsaw : 84.38, class : 84.38 [bs:32]
Accuracies on val: jigsaw : 100.00, class : 93.88
--------------------------------------------------------
Accuracies on test: jigsaw : 96.88, class : 62.41
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 16
New epoch - lr: 0.0005
0/14 of epoch 17/30 jigsaw : 0.597, class : 0.232, t_rotation : 0.676, entropy : 2.122 - acc jigsaw : 75.00, class : 81.25 [bs:32]
Accuracies on val: jigsaw : 100.00, class : 93.88
--------------------------------------------------------
Accuracies on test: jigsaw : 96.49, class : 61.87
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 17
New epoch - lr: 0.0005
0/14 of epoch 18/30 jigsaw : 0.786, class : 0.134, t_rotation : 0.795, entropy : 2.535 - acc jigsaw : 65.62, class : 78.12 [bs:32]
Accuracies on val: jigsaw : 100.00, class : 95.92
--------------------------------------------------------
Accuracies on test: jigsaw : 95.88, class : 62.97
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 18
New epoch - lr: 0.0005
0/14 of epoch 19/30 jigsaw : 0.499, class : 0.213, t_rotation : 0.613, entropy : 2.314 - acc jigsaw : 75.00, class : 75.00 [bs:32]
Accuracies on val: jigsaw : 100.00, class : 97.96
--------------------------------------------------------
Accuracies on test: jigsaw : 98.47, class : 63.90
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 19
New epoch - lr: 0.0005
0/14 of epoch 20/30 jigsaw : 0.679, class : 0.276, t_rotation : 0.609, entropy : 2.183 - acc jigsaw : 59.38, class : 78.12 [bs:32]
Accuracies on val: jigsaw : 100.00, class : 97.96
--------------------------------------------------------
Accuracies on test: jigsaw : 94.36, class : 63.58
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 20
New epoch - lr: 0.0005
0/14 of epoch 21/30 jigsaw : 0.606, class : 0.073, t_rotation : 1.000, entropy : 2.007 - acc jigsaw : 68.75, class : 78.12 [bs:32]
Accuracies on val: jigsaw : 100.00, class : 95.92
--------------------------------------------------------
Accuracies on test: jigsaw : 91.94, class : 64.32
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 21
New epoch - lr: 0.0005
0/14 of epoch 22/30 jigsaw : 0.539, class : 0.342, t_rotation : 0.732, entropy : 1.856 - acc jigsaw : 81.25, class : 87.50 [bs:32]
Accuracies on val: jigsaw : 100.00, class : 97.96
--------------------------------------------------------
Accuracies on test: jigsaw : 95.53, class : 65.10
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 22
New epoch - lr: 0.0005
0/14 of epoch 23/30 jigsaw : 0.569, class : 0.149, t_rotation : 0.794, entropy : 1.944 - acc jigsaw : 65.62, class : 78.12 [bs:32]
Accuracies on val: jigsaw : 100.00, class : 97.96
--------------------------------------------------------
Accuracies on test: jigsaw : 94.99, class : 65.10
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 23
New epoch - lr: 5e-05
0/14 of epoch 24/30 jigsaw : 0.372, class : 0.115, t_rotation : 0.741, entropy : 2.126 - acc jigsaw : 87.50, class : 90.62 [bs:32]
Accuracies on val: jigsaw : 100.00, class : 97.96
--------------------------------------------------------
Accuracies on test: jigsaw : 95.35, class : 64.86
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 24
New epoch - lr: 5e-05
0/14 of epoch 25/30 jigsaw : 0.412, class : 0.144, t_rotation : 0.569, entropy : 2.157 - acc jigsaw : 75.00, class : 78.12 [bs:32]
Accuracies on val: jigsaw : 100.00, class : 97.96
--------------------------------------------------------
Accuracies on test: jigsaw : 94.21, class : 64.61
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 25
New epoch - lr: 5e-05
0/14 of epoch 26/30 jigsaw : 0.476, class : 0.113, t_rotation : 0.649, entropy : 1.804 - acc jigsaw : 84.38, class : 100.00 [bs:32]
Accuracies on val: jigsaw : 100.00, class : 97.96
--------------------------------------------------------
Accuracies on test: jigsaw : 94.64, class : 64.71
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 26
New epoch - lr: 5e-05
0/14 of epoch 27/30 jigsaw : 0.472, class : 0.116, t_rotation : 0.766, entropy : 1.973 - acc jigsaw : 81.25, class : 75.00 [bs:32]
Accuracies on val: jigsaw : 100.00, class : 97.96
--------------------------------------------------------
Accuracies on test: jigsaw : 94.92, class : 64.96
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 27
New epoch - lr: 5e-05
0/14 of epoch 28/30 jigsaw : 0.389, class : 0.061, t_rotation : 0.711, entropy : 1.587 - acc jigsaw : 87.50, class : 78.12 [bs:32]
Accuracies on val: jigsaw : 100.00, class : 97.96
--------------------------------------------------------
Accuracies on test: jigsaw : 96.41, class : 65.46
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 28
New epoch - lr: 5e-05
0/14 of epoch 29/30 jigsaw : 0.453, class : 0.166, t_rotation : 0.800, entropy : 1.830 - acc jigsaw : 81.25, class : 84.38 [bs:32]
Accuracies on val: jigsaw : 100.00, class : 97.96
--------------------------------------------------------
Accuracies on test: jigsaw : 94.78, class : 64.96
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 29
New epoch - lr: 5e-05
0/14 of epoch 30/30 jigsaw : 0.413, class : 0.135, t_rotation : 0.906, entropy : 1.957 - acc jigsaw : 84.38, class : 90.62 [bs:32]
Accuracies on val: jigsaw : 100.00, class : 97.96
--------------------------------------------------------
Accuracies on test: jigsaw : 95.10, class : 65.00
--------------------------------------------------------
2020-01-03 18:25:15
amazon
['dslr']
unsupervised_task_weight: 0.8
bias_hole_image: 0.4
target_rotation_weight: 0.7
entropy_weight 0.1
only_classify the ordered image: True
Highest accuracy on validation set appears on epoch  tensor(29)
Highest accuracy on test set appears on epoch  tensor(27)
Accuracy on test set when the accuracy on validation set is highest:0.650
Highest accuracy on test set:0.655
It took 484.106
--------------------------------------------------------
******************Start training**************************************
--------------------------------------------------------
Dataset size: training 716, validation 79, testing 2817
--------------------------------------------------------
Namespace(TTA=False, batch_size=32, bias_whole_image=0.4, classify_only_ordered_images_or_not=True, domains_list=['amazon', 'dslr', 'webcam'], entropy_loss_weight=0.1, epochs=30, folder_name='test', image_size=222, jitter=0.4, learning_rate=0.0005, limit_source=None, limit_target=None, max_scale=1.0, min_scale=0.8, n_classes=65, nesterov=False, network='resnet50', number_of_unsupervised_classes=4, ooo_weight=0, parameters_lists=[[0.8, 0.4, 0.7, 0.1]], random_horiz_flip=0.5, repeat_times=1, source=['webcam'], suffix='', target='amazon', target_domain_list=['amazon', 'dslr', 'webcam'], target_domain_unsupervised_task_loss_weight=0.7, tf_logger=True, tile_random_grayscale=0.1, train_all=True, unsupervised_task_weight=0.8, val_size=0.1)
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 0
New epoch - lr: 0.0005
0/22 of epoch 1/30 jigsaw : 1.246, class : 4.179, t_rotation : 1.305, entropy : 4.127 - acc jigsaw : 34.38, class : 0.00 [bs:32]
Accuracies on val: jigsaw : 100.00, class : 11.39
--------------------------------------------------------
Accuracies on test: jigsaw : 98.90, class : 4.44
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 1
New epoch - lr: 0.0005
0/22 of epoch 2/30 jigsaw : 1.301, class : 3.671, t_rotation : 1.203, entropy : 3.998 - acc jigsaw : 46.88, class : 3.12 [bs:32]
Accuracies on val: jigsaw : 100.00, class : 39.24
--------------------------------------------------------
Accuracies on test: jigsaw : 99.61, class : 15.97
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 2
New epoch - lr: 0.0005
0/22 of epoch 3/30 jigsaw : 1.195, class : 2.942, t_rotation : 1.267, entropy : 3.737 - acc jigsaw : 46.88, class : 31.25 [bs:32]
Accuracies on val: jigsaw : 100.00, class : 63.29
--------------------------------------------------------
Accuracies on test: jigsaw : 99.11, class : 37.45
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 3
New epoch - lr: 0.0005
0/22 of epoch 4/30 jigsaw : 1.127, class : 2.578, t_rotation : 1.149, entropy : 3.642 - acc jigsaw : 50.00, class : 37.50 [bs:32]
Accuracies on val: jigsaw : 100.00, class : 73.42
--------------------------------------------------------
Accuracies on test: jigsaw : 98.62, class : 36.39
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 4
New epoch - lr: 0.0005
0/22 of epoch 5/30 jigsaw : 0.873, class : 1.653, t_rotation : 1.003, entropy : 3.515 - acc jigsaw : 65.62, class : 62.50 [bs:32]
Accuracies on val: jigsaw : 98.73, class : 84.81
--------------------------------------------------------
Accuracies on test: jigsaw : 96.20, class : 48.49
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 5
New epoch - lr: 0.0005
0/22 of epoch 6/30 jigsaw : 1.116, class : 1.376, t_rotation : 0.900, entropy : 3.161 - acc jigsaw : 43.75, class : 56.25 [bs:32]
Accuracies on val: jigsaw : 100.00, class : 91.14
--------------------------------------------------------
Accuracies on test: jigsaw : 97.16, class : 53.50
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 6
New epoch - lr: 0.0005
0/22 of epoch 7/30 jigsaw : 0.749, class : 1.040, t_rotation : 0.982, entropy : 3.087 - acc jigsaw : 65.62, class : 71.88 [bs:32]
Accuracies on val: jigsaw : 100.00, class : 88.61
--------------------------------------------------------
Accuracies on test: jigsaw : 97.73, class : 52.72
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 7
New epoch - lr: 0.0005
0/22 of epoch 8/30 jigsaw : 0.687, class : 0.924, t_rotation : 0.905, entropy : 2.825 - acc jigsaw : 68.75, class : 78.12 [bs:32]
Accuracies on val: jigsaw : 100.00, class : 94.94
--------------------------------------------------------
Accuracies on test: jigsaw : 97.76, class : 56.73
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 8
New epoch - lr: 0.0005
0/22 of epoch 9/30 jigsaw : 0.902, class : 0.409, t_rotation : 0.641, entropy : 2.548 - acc jigsaw : 56.25, class : 87.50 [bs:32]
Accuracies on val: jigsaw : 100.00, class : 98.73
--------------------------------------------------------
Accuracies on test: jigsaw : 94.18, class : 57.05
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 9
New epoch - lr: 0.0005
0/22 of epoch 10/30 jigsaw : 0.568, class : 0.384, t_rotation : 1.285, entropy : 2.343 - acc jigsaw : 71.88, class : 84.38 [bs:32]
Accuracies on val: jigsaw : 100.00, class : 97.47
--------------------------------------------------------
Accuracies on test: jigsaw : 97.02, class : 60.03
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 10
New epoch - lr: 0.0005
0/22 of epoch 11/30 jigsaw : 0.853, class : 0.340, t_rotation : 0.766, entropy : 2.215 - acc jigsaw : 56.25, class : 84.38 [bs:32]
Accuracies on val: jigsaw : 98.73, class : 97.47
--------------------------------------------------------
Accuracies on test: jigsaw : 95.42, class : 61.66
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 11
New epoch - lr: 0.0005
0/22 of epoch 12/30 jigsaw : 0.605, class : 0.319, t_rotation : 0.665, entropy : 2.013 - acc jigsaw : 81.25, class : 81.25 [bs:32]
Accuracies on val: jigsaw : 98.73, class : 98.73
--------------------------------------------------------
Accuracies on test: jigsaw : 93.15, class : 61.31
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 12
New epoch - lr: 0.0005
0/22 of epoch 13/30 jigsaw : 0.744, class : 0.224, t_rotation : 0.763, entropy : 1.889 - acc jigsaw : 68.75, class : 81.25 [bs:32]
Accuracies on val: jigsaw : 98.73, class : 100.00
--------------------------------------------------------
Accuracies on test: jigsaw : 94.68, class : 62.80
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 13
New epoch - lr: 0.0005
0/22 of epoch 14/30 jigsaw : 0.615, class : 0.194, t_rotation : 1.129, entropy : 2.229 - acc jigsaw : 71.88, class : 84.38 [bs:32]
Accuracies on val: jigsaw : 98.73, class : 100.00
--------------------------------------------------------
Accuracies on test: jigsaw : 92.90, class : 63.44
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 14
New epoch - lr: 0.0005
0/22 of epoch 15/30 jigsaw : 0.609, class : 0.144, t_rotation : 0.734, entropy : 1.820 - acc jigsaw : 68.75, class : 81.25 [bs:32]
Accuracies on val: jigsaw : 100.00, class : 100.00
--------------------------------------------------------
Accuracies on test: jigsaw : 96.77, class : 62.90
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 15
New epoch - lr: 0.0005
0/22 of epoch 16/30 jigsaw : 0.532, class : 0.138, t_rotation : 0.716, entropy : 1.852 - acc jigsaw : 71.88, class : 71.88 [bs:32]
Accuracies on val: jigsaw : 100.00, class : 100.00
--------------------------------------------------------
Accuracies on test: jigsaw : 95.03, class : 63.12
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 16
New epoch - lr: 0.0005
0/22 of epoch 17/30 jigsaw : 0.494, class : 0.219, t_rotation : 0.778, entropy : 1.282 - acc jigsaw : 75.00, class : 93.75 [bs:32]
Accuracies on val: jigsaw : 100.00, class : 100.00
--------------------------------------------------------
Accuracies on test: jigsaw : 93.40, class : 62.23
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 17
New epoch - lr: 0.0005
0/22 of epoch 18/30 jigsaw : 0.575, class : 0.180, t_rotation : 0.883, entropy : 1.820 - acc jigsaw : 81.25, class : 81.25 [bs:32]
Accuracies on val: jigsaw : 98.73, class : 100.00
--------------------------------------------------------
Accuracies on test: jigsaw : 82.53, class : 62.69
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 18
New epoch - lr: 0.0005
0/22 of epoch 19/30 jigsaw : 0.745, class : 0.089, t_rotation : 1.112, entropy : 1.269 - acc jigsaw : 65.62, class : 81.25 [bs:32]
Accuracies on val: jigsaw : 100.00, class : 100.00
--------------------------------------------------------
Accuracies on test: jigsaw : 93.26, class : 62.37
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 19
New epoch - lr: 0.0005
0/22 of epoch 20/30 jigsaw : 0.634, class : 0.104, t_rotation : 0.775, entropy : 1.320 - acc jigsaw : 71.88, class : 78.12 [bs:32]
Accuracies on val: jigsaw : 98.73, class : 100.00
--------------------------------------------------------
Accuracies on test: jigsaw : 92.23, class : 63.44
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 20
New epoch - lr: 0.0005
0/22 of epoch 21/30 jigsaw : 0.476, class : 0.075, t_rotation : 0.885, entropy : 1.348 - acc jigsaw : 81.25, class : 78.12 [bs:32]
Accuracies on val: jigsaw : 98.73, class : 100.00
--------------------------------------------------------
Accuracies on test: jigsaw : 97.16, class : 63.01
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 21
New epoch - lr: 0.0005
0/22 of epoch 22/30 jigsaw : 0.521, class : 0.141, t_rotation : 1.063, entropy : 1.825 - acc jigsaw : 59.38, class : 78.12 [bs:32]
Accuracies on val: jigsaw : 98.73, class : 100.00
--------------------------------------------------------
Accuracies on test: jigsaw : 93.36, class : 63.93
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 22
New epoch - lr: 0.0005
0/22 of epoch 23/30 jigsaw : 0.511, class : 0.055, t_rotation : 1.176, entropy : 1.632 - acc jigsaw : 75.00, class : 78.12 [bs:32]
Accuracies on val: jigsaw : 98.73, class : 100.00
--------------------------------------------------------
Accuracies on test: jigsaw : 96.02, class : 63.01
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 23
New epoch - lr: 5e-05
0/22 of epoch 24/30 jigsaw : 0.646, class : 0.058, t_rotation : 0.648, entropy : 1.473 - acc jigsaw : 65.62, class : 68.75 [bs:32]
Accuracies on val: jigsaw : 98.73, class : 100.00
--------------------------------------------------------
Accuracies on test: jigsaw : 96.49, class : 63.40
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 24
New epoch - lr: 5e-05
0/22 of epoch 25/30 jigsaw : 0.452, class : 0.046, t_rotation : 1.123, entropy : 1.498 - acc jigsaw : 78.12, class : 78.12 [bs:32]
Accuracies on val: jigsaw : 98.73, class : 100.00
--------------------------------------------------------
Accuracies on test: jigsaw : 95.63, class : 63.58
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 25
New epoch - lr: 5e-05
0/22 of epoch 26/30 jigsaw : 0.566, class : 0.046, t_rotation : 0.649, entropy : 1.130 - acc jigsaw : 78.12, class : 90.62 [bs:32]
Accuracies on val: jigsaw : 98.73, class : 100.00
--------------------------------------------------------
Accuracies on test: jigsaw : 95.14, class : 63.68
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 26
New epoch - lr: 5e-05
0/22 of epoch 27/30 jigsaw : 0.470, class : 0.143, t_rotation : 0.516, entropy : 0.913 - acc jigsaw : 71.88, class : 81.25 [bs:32]
Accuracies on val: jigsaw : 98.73, class : 100.00
--------------------------------------------------------
Accuracies on test: jigsaw : 95.17, class : 64.11
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 27
New epoch - lr: 5e-05
0/22 of epoch 28/30 jigsaw : 0.605, class : 0.052, t_rotation : 1.007, entropy : 1.430 - acc jigsaw : 75.00, class : 78.12 [bs:32]
Accuracies on val: jigsaw : 98.73, class : 100.00
--------------------------------------------------------
Accuracies on test: jigsaw : 96.13, class : 63.79
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 28
New epoch - lr: 5e-05
0/22 of epoch 29/30 jigsaw : 0.717, class : 0.092, t_rotation : 0.468, entropy : 1.007 - acc jigsaw : 62.50, class : 87.50 [bs:32]
Accuracies on val: jigsaw : 98.73, class : 100.00
--------------------------------------------------------
Accuracies on test: jigsaw : 97.34, class : 63.65
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 29
New epoch - lr: 5e-05
0/22 of epoch 30/30 jigsaw : 0.565, class : 0.034, t_rotation : 0.928, entropy : 1.392 - acc jigsaw : 81.25, class : 87.50 [bs:32]
Accuracies on val: jigsaw : 98.73, class : 100.00
--------------------------------------------------------
Accuracies on test: jigsaw : 95.70, class : 63.68
--------------------------------------------------------
2020-01-03 18:35:00
amazon
['webcam']
unsupervised_task_weight: 0.8
bias_hole_image: 0.4
target_rotation_weight: 0.7
entropy_weight 0.1
only_classify the ordered image: True
Highest accuracy on validation set appears on epoch  tensor(29)
Highest accuracy on test set appears on epoch  tensor(26)
Accuracy on test set when the accuracy on validation set is highest:0.637
Highest accuracy on test set:0.641
It took 584.388
--------------------------------------------------------
******************Start training**************************************
--------------------------------------------------------
Dataset size: training 2536, validation 281, testing 498
--------------------------------------------------------
Namespace(TTA=False, batch_size=32, bias_whole_image=0.4, classify_only_ordered_images_or_not=True, domains_list=['amazon', 'dslr', 'webcam'], entropy_loss_weight=0.1, epochs=30, folder_name='test', image_size=222, jitter=0.4, learning_rate=0.0005, limit_source=None, limit_target=None, max_scale=1.0, min_scale=0.8, n_classes=65, nesterov=False, network='resnet50', number_of_unsupervised_classes=4, ooo_weight=0, parameters_lists=[[0.8, 0.4, 0.7, 0.1]], random_horiz_flip=0.5, repeat_times=1, source=['amazon'], suffix='', target='dslr', target_domain_list=['amazon', 'dslr', 'webcam'], target_domain_unsupervised_task_loss_weight=0.7, tf_logger=True, tile_random_grayscale=0.1, train_all=True, unsupervised_task_weight=0.8, val_size=0.1)
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 0
New epoch - lr: 0.0005
0/79 of epoch 1/30 jigsaw : 1.313, class : 4.202, t_rotation : 1.401, entropy : 4.117 - acc jigsaw : 31.25, class : 0.00 [bs:32]
30/79 of epoch 1/30 jigsaw : 1.020, class : 3.555, t_rotation : 1.207, entropy : 3.921 - acc jigsaw : 65.62, class : 9.38 [bs:32]
60/79 of epoch 1/30 jigsaw : 1.288, class : 2.592, t_rotation : 0.916, entropy : 3.661 - acc jigsaw : 40.62, class : 46.88 [bs:32]
Accuracies on val: jigsaw : 99.64, class : 56.23
--------------------------------------------------------
Accuracies on test: jigsaw : 99.80, class : 44.38
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 1
New epoch - lr: 0.0005
0/79 of epoch 2/30 jigsaw : 1.035, class : 2.632, t_rotation : 1.009, entropy : 3.484 - acc jigsaw : 50.00, class : 37.50 [bs:32]
30/79 of epoch 2/30 jigsaw : 0.739, class : 2.230, t_rotation : 0.863, entropy : 3.111 - acc jigsaw : 68.75, class : 56.25 [bs:32]
60/79 of epoch 2/30 jigsaw : 0.858, class : 1.512, t_rotation : 0.720, entropy : 2.818 - acc jigsaw : 65.62, class : 43.75 [bs:32]
Accuracies on val: jigsaw : 98.93, class : 71.17
--------------------------------------------------------
Accuracies on test: jigsaw : 99.20, class : 59.44
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 2
New epoch - lr: 0.0005
0/79 of epoch 3/30 jigsaw : 0.663, class : 1.872, t_rotation : 0.821, entropy : 2.713 - acc jigsaw : 75.00, class : 62.50 [bs:32]
30/79 of epoch 3/30 jigsaw : 1.022, class : 1.212, t_rotation : 0.663, entropy : 2.354 - acc jigsaw : 59.38, class : 62.50 [bs:32]
60/79 of epoch 3/30 jigsaw : 0.735, class : 1.116, t_rotation : 0.557, entropy : 2.083 - acc jigsaw : 65.62, class : 59.38 [bs:32]
Accuracies on val: jigsaw : 97.86, class : 76.51
--------------------------------------------------------
Accuracies on test: jigsaw : 98.19, class : 68.67
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 3
New epoch - lr: 0.0005
0/79 of epoch 4/30 jigsaw : 0.725, class : 1.075, t_rotation : 0.736, entropy : 1.758 - acc jigsaw : 62.50, class : 65.62 [bs:32]
30/79 of epoch 4/30 jigsaw : 0.747, class : 0.993, t_rotation : 0.680, entropy : 1.482 - acc jigsaw : 59.38, class : 59.38 [bs:32]
60/79 of epoch 4/30 jigsaw : 0.993, class : 0.758, t_rotation : 0.533, entropy : 1.365 - acc jigsaw : 50.00, class : 78.12 [bs:32]
Accuracies on val: jigsaw : 94.31, class : 79.36
--------------------------------------------------------
Accuracies on test: jigsaw : 98.19, class : 73.49
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 4
New epoch - lr: 0.0005
0/79 of epoch 5/30 jigsaw : 0.588, class : 0.815, t_rotation : 0.638, entropy : 1.548 - acc jigsaw : 71.88, class : 75.00 [bs:32]
30/79 of epoch 5/30 jigsaw : 0.837, class : 0.598, t_rotation : 0.596, entropy : 1.421 - acc jigsaw : 62.50, class : 62.50 [bs:32]
60/79 of epoch 5/30 jigsaw : 0.718, class : 0.942, t_rotation : 0.494, entropy : 1.274 - acc jigsaw : 59.38, class : 75.00 [bs:32]
Accuracies on val: jigsaw : 95.73, class : 80.78
--------------------------------------------------------
Accuracies on test: jigsaw : 99.20, class : 77.51
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 5
New epoch - lr: 0.0005
0/79 of epoch 6/30 jigsaw : 0.650, class : 0.853, t_rotation : 0.441, entropy : 1.674 - acc jigsaw : 78.12, class : 65.62 [bs:32]
30/79 of epoch 6/30 jigsaw : 0.616, class : 0.422, t_rotation : 0.356, entropy : 1.538 - acc jigsaw : 68.75, class : 62.50 [bs:32]
60/79 of epoch 6/30 jigsaw : 0.844, class : 0.909, t_rotation : 0.302, entropy : 1.407 - acc jigsaw : 62.50, class : 59.38 [bs:32]
Accuracies on val: jigsaw : 95.02, class : 81.85
--------------------------------------------------------
Accuracies on test: jigsaw : 99.20, class : 74.90
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 6
New epoch - lr: 0.0005
0/79 of epoch 7/30 jigsaw : 0.474, class : 0.518, t_rotation : 0.430, entropy : 1.063 - acc jigsaw : 87.50, class : 62.50 [bs:32]
30/79 of epoch 7/30 jigsaw : 0.453, class : 0.902, t_rotation : 0.356, entropy : 0.915 - acc jigsaw : 78.12, class : 56.25 [bs:32]
60/79 of epoch 7/30 jigsaw : 0.726, class : 0.370, t_rotation : 0.340, entropy : 0.910 - acc jigsaw : 71.88, class : 81.25 [bs:32]
Accuracies on val: jigsaw : 95.02, class : 85.05
--------------------------------------------------------
Accuracies on test: jigsaw : 99.40, class : 79.52
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 7
New epoch - lr: 0.0005
0/79 of epoch 8/30 jigsaw : 0.631, class : 0.694, t_rotation : 0.603, entropy : 1.076 - acc jigsaw : 68.75, class : 53.12 [bs:32]
30/79 of epoch 8/30 jigsaw : 0.486, class : 0.422, t_rotation : 0.434, entropy : 0.968 - acc jigsaw : 78.12, class : 71.88 [bs:32]
60/79 of epoch 8/30 jigsaw : 0.636, class : 0.700, t_rotation : 0.353, entropy : 0.869 - acc jigsaw : 71.88, class : 68.75 [bs:32]
Accuracies on val: jigsaw : 93.24, class : 84.34
--------------------------------------------------------
Accuracies on test: jigsaw : 99.60, class : 80.92
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 8
New epoch - lr: 0.0005
0/79 of epoch 9/30 jigsaw : 0.747, class : 0.528, t_rotation : 0.622, entropy : 0.787 - acc jigsaw : 65.62, class : 65.62 [bs:32]
30/79 of epoch 9/30 jigsaw : 0.431, class : 0.409, t_rotation : 0.475, entropy : 0.589 - acc jigsaw : 78.12, class : 65.62 [bs:32]
60/79 of epoch 9/30 jigsaw : 0.817, class : 0.199, t_rotation : 0.359, entropy : 0.634 - acc jigsaw : 62.50, class : 75.00 [bs:32]
Accuracies on val: jigsaw : 95.37, class : 84.34
--------------------------------------------------------
Accuracies on test: jigsaw : 99.60, class : 81.53
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 9
New epoch - lr: 0.0005
0/79 of epoch 10/30 jigsaw : 0.573, class : 0.236, t_rotation : 0.352, entropy : 0.683 - acc jigsaw : 75.00, class : 71.88 [bs:32]
30/79 of epoch 10/30 jigsaw : 0.696, class : 0.365, t_rotation : 0.229, entropy : 0.556 - acc jigsaw : 75.00, class : 78.12 [bs:32]
60/79 of epoch 10/30 jigsaw : 0.461, class : 0.655, t_rotation : 0.209, entropy : 0.435 - acc jigsaw : 78.12, class : 65.62 [bs:32]
Accuracies on val: jigsaw : 92.88, class : 85.05
--------------------------------------------------------
Accuracies on test: jigsaw : 99.60, class : 82.13
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 10
New epoch - lr: 0.0005
0/79 of epoch 11/30 jigsaw : 0.414, class : 0.466, t_rotation : 0.320, entropy : 1.197 - acc jigsaw : 84.38, class : 71.88 [bs:32]
30/79 of epoch 11/30 jigsaw : 0.353, class : 0.205, t_rotation : 0.241, entropy : 1.119 - acc jigsaw : 84.38, class : 81.25 [bs:32]
60/79 of epoch 11/30 jigsaw : 0.739, class : 0.488, t_rotation : 0.219, entropy : 1.071 - acc jigsaw : 71.88, class : 81.25 [bs:32]
Accuracies on val: jigsaw : 88.61, class : 85.41
--------------------------------------------------------
Accuracies on test: jigsaw : 98.80, class : 80.92
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 11
New epoch - lr: 0.0005
0/79 of epoch 12/30 jigsaw : 0.740, class : 0.842, t_rotation : 0.285, entropy : 0.451 - acc jigsaw : 71.88, class : 56.25 [bs:32]
30/79 of epoch 12/30 jigsaw : 0.313, class : 0.258, t_rotation : 0.171, entropy : 0.405 - acc jigsaw : 93.75, class : 75.00 [bs:32]
60/79 of epoch 12/30 jigsaw : 0.844, class : 0.118, t_rotation : 0.133, entropy : 0.360 - acc jigsaw : 65.62, class : 68.75 [bs:32]
Accuracies on val: jigsaw : 92.17, class : 85.41
--------------------------------------------------------
Accuracies on test: jigsaw : 99.20, class : 81.33
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 12
New epoch - lr: 0.0005
0/79 of epoch 13/30 jigsaw : 0.544, class : 0.207, t_rotation : 0.199, entropy : 0.633 - acc jigsaw : 81.25, class : 68.75 [bs:32]
30/79 of epoch 13/30 jigsaw : 0.388, class : 0.193, t_rotation : 0.155, entropy : 0.531 - acc jigsaw : 84.38, class : 87.50 [bs:32]
60/79 of epoch 13/30 jigsaw : 0.558, class : 0.065, t_rotation : 0.109, entropy : 0.496 - acc jigsaw : 81.25, class : 90.62 [bs:32]
Accuracies on val: jigsaw : 94.66, class : 85.77
--------------------------------------------------------
Accuracies on test: jigsaw : 99.80, class : 82.33
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 13
New epoch - lr: 0.0005
0/79 of epoch 14/30 jigsaw : 0.385, class : 0.172, t_rotation : 0.314, entropy : 0.507 - acc jigsaw : 81.25, class : 68.75 [bs:32]
30/79 of epoch 14/30 jigsaw : 0.562, class : 0.568, t_rotation : 0.155, entropy : 0.395 - acc jigsaw : 78.12, class : 65.62 [bs:32]
60/79 of epoch 14/30 jigsaw : 0.666, class : 0.304, t_rotation : 0.120, entropy : 0.394 - acc jigsaw : 71.88, class : 65.62 [bs:32]
Accuracies on val: jigsaw : 94.66, class : 87.54
--------------------------------------------------------
Accuracies on test: jigsaw : 99.80, class : 82.53
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 14
New epoch - lr: 0.0005
0/79 of epoch 15/30 jigsaw : 0.469, class : 0.400, t_rotation : 0.560, entropy : 0.339 - acc jigsaw : 81.25, class : 65.62 [bs:32]
30/79 of epoch 15/30 jigsaw : 0.400, class : 0.230, t_rotation : 0.227, entropy : 0.296 - acc jigsaw : 84.38, class : 68.75 [bs:32]
60/79 of epoch 15/30 jigsaw : 0.793, class : 0.132, t_rotation : 0.145, entropy : 0.280 - acc jigsaw : 59.38, class : 75.00 [bs:32]
Accuracies on val: jigsaw : 92.88, class : 87.19
--------------------------------------------------------
Accuracies on test: jigsaw : 99.80, class : 83.13
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 15
New epoch - lr: 0.0005
0/79 of epoch 16/30 jigsaw : 0.446, class : 0.052, t_rotation : 0.195, entropy : 0.557 - acc jigsaw : 84.38, class : 71.88 [bs:32]
30/79 of epoch 16/30 jigsaw : 0.469, class : 0.420, t_rotation : 0.065, entropy : 0.510 - acc jigsaw : 81.25, class : 78.12 [bs:32]
60/79 of epoch 16/30 jigsaw : 0.370, class : 0.272, t_rotation : 0.057, entropy : 0.467 - acc jigsaw : 84.38, class : 71.88 [bs:32]
Accuracies on val: jigsaw : 93.95, class : 87.19
--------------------------------------------------------
Accuracies on test: jigsaw : 99.80, class : 84.14
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 16
New epoch - lr: 0.0005
0/79 of epoch 17/30 jigsaw : 0.520, class : 0.084, t_rotation : 0.245, entropy : 0.242 - acc jigsaw : 81.25, class : 68.75 [bs:32]
30/79 of epoch 17/30 jigsaw : 0.391, class : 0.247, t_rotation : 0.085, entropy : 0.183 - acc jigsaw : 81.25, class : 81.25 [bs:32]
60/79 of epoch 17/30 jigsaw : 0.481, class : 0.312, t_rotation : 0.060, entropy : 0.181 - acc jigsaw : 75.00, class : 75.00 [bs:32]
Accuracies on val: jigsaw : 92.88, class : 87.19
--------------------------------------------------------
Accuracies on test: jigsaw : 100.00, class : 83.73
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 17
New epoch - lr: 0.0005
0/79 of epoch 18/30 jigsaw : 0.389, class : 0.214, t_rotation : 0.096, entropy : 0.496 - acc jigsaw : 81.25, class : 81.25 [bs:32]
30/79 of epoch 18/30 jigsaw : 0.215, class : 0.331, t_rotation : 0.046, entropy : 0.397 - acc jigsaw : 93.75, class : 71.88 [bs:32]
60/79 of epoch 18/30 jigsaw : 0.702, class : 0.245, t_rotation : 0.035, entropy : 0.329 - acc jigsaw : 81.25, class : 59.38 [bs:32]
Accuracies on val: jigsaw : 82.56, class : 86.83
--------------------------------------------------------
Accuracies on test: jigsaw : 99.40, class : 83.94
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 18
New epoch - lr: 0.0005
0/79 of epoch 19/30 jigsaw : 0.337, class : 0.302, t_rotation : 0.318, entropy : 0.246 - acc jigsaw : 87.50, class : 62.50 [bs:32]
30/79 of epoch 19/30 jigsaw : 0.290, class : 0.127, t_rotation : 0.138, entropy : 0.196 - acc jigsaw : 90.62, class : 84.38 [bs:32]
60/79 of epoch 19/30 jigsaw : 0.534, class : 0.068, t_rotation : 0.077, entropy : 0.159 - acc jigsaw : 81.25, class : 71.88 [bs:32]
Accuracies on val: jigsaw : 87.54, class : 88.26
--------------------------------------------------------
Accuracies on test: jigsaw : 99.40, class : 84.34
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 19
New epoch - lr: 0.0005
0/79 of epoch 20/30 jigsaw : 0.809, class : 0.194, t_rotation : 0.125, entropy : 0.368 - acc jigsaw : 65.62, class : 56.25 [bs:32]
30/79 of epoch 20/30 jigsaw : 0.531, class : 0.088, t_rotation : 0.052, entropy : 0.304 - acc jigsaw : 84.38, class : 68.75 [bs:32]
60/79 of epoch 20/30 jigsaw : 0.349, class : 0.040, t_rotation : 0.028, entropy : 0.263 - acc jigsaw : 84.38, class : 84.38 [bs:32]
Accuracies on val: jigsaw : 90.04, class : 88.61
--------------------------------------------------------
Accuracies on test: jigsaw : 99.40, class : 84.34
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 20
New epoch - lr: 0.0005
0/79 of epoch 21/30 jigsaw : 0.548, class : 0.120, t_rotation : 0.304, entropy : 0.125 - acc jigsaw : 84.38, class : 75.00 [bs:32]
30/79 of epoch 21/30 jigsaw : 0.409, class : 0.113, t_rotation : 0.082, entropy : 0.083 - acc jigsaw : 87.50, class : 68.75 [bs:32]
60/79 of epoch 21/30 jigsaw : 0.186, class : 0.154, t_rotation : 0.047, entropy : 0.062 - acc jigsaw : 93.75, class : 71.88 [bs:32]
Accuracies on val: jigsaw : 93.59, class : 87.90
--------------------------------------------------------
Accuracies on test: jigsaw : 99.40, class : 84.14
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 21
New epoch - lr: 0.0005
0/79 of epoch 22/30 jigsaw : 0.563, class : 0.098, t_rotation : 0.101, entropy : 0.292 - acc jigsaw : 78.12, class : 71.88 [bs:32]
30/79 of epoch 22/30 jigsaw : 0.341, class : 0.117, t_rotation : 0.032, entropy : 0.226 - acc jigsaw : 87.50, class : 81.25 [bs:32]
60/79 of epoch 22/30 jigsaw : 0.399, class : 0.137, t_rotation : 0.041, entropy : 0.165 - acc jigsaw : 84.38, class : 71.88 [bs:32]
Accuracies on val: jigsaw : 93.24, class : 87.19
--------------------------------------------------------
Accuracies on test: jigsaw : 100.00, class : 85.34
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 22
New epoch - lr: 0.0005
0/79 of epoch 23/30 jigsaw : 0.471, class : 0.704, t_rotation : 0.152, entropy : 0.204 - acc jigsaw : 75.00, class : 56.25 [bs:32]
30/79 of epoch 23/30 jigsaw : 0.298, class : 0.396, t_rotation : 0.052, entropy : 0.162 - acc jigsaw : 87.50, class : 75.00 [bs:32]
60/79 of epoch 23/30 jigsaw : 0.379, class : 0.131, t_rotation : 0.046, entropy : 0.149 - acc jigsaw : 87.50, class : 65.62 [bs:32]
Accuracies on val: jigsaw : 90.04, class : 86.83
--------------------------------------------------------
Accuracies on test: jigsaw : 99.80, class : 85.74
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 23
New epoch - lr: 5e-05
0/79 of epoch 24/30 jigsaw : 0.535, class : 0.032, t_rotation : 0.218, entropy : 0.451 - acc jigsaw : 78.12, class : 59.38 [bs:32]
30/79 of epoch 24/30 jigsaw : 0.218, class : 0.123, t_rotation : 0.151, entropy : 0.439 - acc jigsaw : 93.75, class : 71.88 [bs:32]
60/79 of epoch 24/30 jigsaw : 0.268, class : 0.106, t_rotation : 0.114, entropy : 0.418 - acc jigsaw : 87.50, class : 68.75 [bs:32]
Accuracies on val: jigsaw : 92.53, class : 88.61
--------------------------------------------------------
Accuracies on test: jigsaw : 100.00, class : 85.14
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 24
New epoch - lr: 5e-05
0/79 of epoch 25/30 jigsaw : 0.333, class : 0.075, t_rotation : 0.132, entropy : 0.133 - acc jigsaw : 84.38, class : 71.88 [bs:32]
30/79 of epoch 25/30 jigsaw : 0.272, class : 0.120, t_rotation : 0.107, entropy : 0.131 - acc jigsaw : 84.38, class : 71.88 [bs:32]
60/79 of epoch 25/30 jigsaw : 0.131, class : 0.022, t_rotation : 0.087, entropy : 0.129 - acc jigsaw : 96.88, class : 59.38 [bs:32]
Accuracies on val: jigsaw : 95.02, class : 87.90
--------------------------------------------------------
Accuracies on test: jigsaw : 100.00, class : 85.34
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 25
New epoch - lr: 5e-05
0/79 of epoch 26/30 jigsaw : 0.180, class : 0.198, t_rotation : 0.095, entropy : 0.238 - acc jigsaw : 96.88, class : 68.75 [bs:32]
30/79 of epoch 26/30 jigsaw : 0.357, class : 0.213, t_rotation : 0.074, entropy : 0.236 - acc jigsaw : 84.38, class : 84.38 [bs:32]
60/79 of epoch 26/30 jigsaw : 0.268, class : 0.037, t_rotation : 0.061, entropy : 0.230 - acc jigsaw : 90.62, class : 84.38 [bs:32]
Accuracies on val: jigsaw : 94.31, class : 88.97
--------------------------------------------------------
Accuracies on test: jigsaw : 100.00, class : 85.14
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 26
New epoch - lr: 5e-05
0/79 of epoch 27/30 jigsaw : 0.345, class : 0.153, t_rotation : 0.159, entropy : 0.059 - acc jigsaw : 84.38, class : 68.75 [bs:32]
30/79 of epoch 27/30 jigsaw : 0.283, class : 0.048, t_rotation : 0.122, entropy : 0.058 - acc jigsaw : 90.62, class : 78.12 [bs:32]
60/79 of epoch 27/30 jigsaw : 0.433, class : 0.149, t_rotation : 0.096, entropy : 0.056 - acc jigsaw : 84.38, class : 90.62 [bs:32]
Accuracies on val: jigsaw : 95.02, class : 87.90
--------------------------------------------------------
Accuracies on test: jigsaw : 100.00, class : 85.74
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 27
New epoch - lr: 5e-05
0/79 of epoch 28/30 jigsaw : 0.305, class : 0.087, t_rotation : 0.037, entropy : 0.319 - acc jigsaw : 87.50, class : 71.88 [bs:32]
30/79 of epoch 28/30 jigsaw : 0.220, class : 0.153, t_rotation : 0.026, entropy : 0.313 - acc jigsaw : 93.75, class : 75.00 [bs:32]
60/79 of epoch 28/30 jigsaw : 0.358, class : 0.149, t_rotation : 0.023, entropy : 0.308 - acc jigsaw : 84.38, class : 75.00 [bs:32]
Accuracies on val: jigsaw : 93.24, class : 88.97
--------------------------------------------------------
Accuracies on test: jigsaw : 100.00, class : 85.74
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 28
New epoch - lr: 5e-05
0/79 of epoch 29/30 jigsaw : 0.421, class : 0.143, t_rotation : 0.068, entropy : 0.216 - acc jigsaw : 75.00, class : 56.25 [bs:32]
30/79 of epoch 29/30 jigsaw : 0.253, class : 0.231, t_rotation : 0.056, entropy : 0.212 - acc jigsaw : 93.75, class : 90.62 [bs:32]
60/79 of epoch 29/30 jigsaw : 0.272, class : 0.141, t_rotation : 0.047, entropy : 0.206 - acc jigsaw : 90.62, class : 84.38 [bs:32]
Accuracies on val: jigsaw : 93.59, class : 88.26
--------------------------------------------------------
Accuracies on test: jigsaw : 100.00, class : 85.74
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 29
New epoch - lr: 5e-05
0/79 of epoch 30/30 jigsaw : 0.170, class : 0.092, t_rotation : 0.179, entropy : 0.361 - acc jigsaw : 90.62, class : 65.62 [bs:32]
30/79 of epoch 30/30 jigsaw : 0.148, class : 0.174, t_rotation : 0.142, entropy : 0.351 - acc jigsaw : 96.88, class : 75.00 [bs:32]
60/79 of epoch 30/30 jigsaw : 0.446, class : 0.263, t_rotation : 0.114, entropy : 0.339 - acc jigsaw : 75.00, class : 65.62 [bs:32]
Accuracies on val: jigsaw : 94.31, class : 87.19
--------------------------------------------------------
Accuracies on test: jigsaw : 100.00, class : 85.54
--------------------------------------------------------
2020-01-03 18:57:16
dslr
['amazon']
unsupervised_task_weight: 0.8
bias_hole_image: 0.4
target_rotation_weight: 0.7
entropy_weight 0.1
only_classify the ordered image: True
Highest accuracy on validation set appears on epoch  tensor(27)
Highest accuracy on test set appears on epoch  tensor(28)
Accuracy on test set when the accuracy on validation set is highest:0.857
Highest accuracy on test set:0.857
It took 1335.86
--------------------------------------------------------
******************Start training**************************************
--------------------------------------------------------
Dataset size: training 716, validation 79, testing 498
--------------------------------------------------------
Namespace(TTA=False, batch_size=32, bias_whole_image=0.4, classify_only_ordered_images_or_not=True, domains_list=['amazon', 'dslr', 'webcam'], entropy_loss_weight=0.1, epochs=30, folder_name='test', image_size=222, jitter=0.4, learning_rate=0.0005, limit_source=None, limit_target=None, max_scale=1.0, min_scale=0.8, n_classes=65, nesterov=False, network='resnet50', number_of_unsupervised_classes=4, ooo_weight=0, parameters_lists=[[0.8, 0.4, 0.7, 0.1]], random_horiz_flip=0.5, repeat_times=1, source=['webcam'], suffix='', target='dslr', target_domain_list=['amazon', 'dslr', 'webcam'], target_domain_unsupervised_task_loss_weight=0.7, tf_logger=True, tile_random_grayscale=0.1, train_all=True, unsupervised_task_weight=0.8, val_size=0.1)
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 0
New epoch - lr: 0.0005
0/22 of epoch 1/30 jigsaw : 1.392, class : 4.167, t_rotation : 1.500, entropy : 4.107 - acc jigsaw : 12.50, class : 0.00 [bs:32]
Accuracies on val: jigsaw : 100.00, class : 7.59
--------------------------------------------------------
Accuracies on test: jigsaw : 100.00, class : 7.23
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 1
New epoch - lr: 0.0005
0/22 of epoch 2/30 jigsaw : 1.206, class : 3.649, t_rotation : 1.067, entropy : 4.007 - acc jigsaw : 46.88, class : 6.25 [bs:32]
Accuracies on val: jigsaw : 98.73, class : 37.97
--------------------------------------------------------
Accuracies on test: jigsaw : 99.60, class : 30.72
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 2
New epoch - lr: 0.0005
0/22 of epoch 3/30 jigsaw : 1.002, class : 2.823, t_rotation : 1.170, entropy : 3.726 - acc jigsaw : 59.38, class : 43.75 [bs:32]
Accuracies on val: jigsaw : 97.47, class : 59.49
--------------------------------------------------------
Accuracies on test: jigsaw : 98.80, class : 58.84
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 3
New epoch - lr: 0.0005
0/22 of epoch 4/30 jigsaw : 0.888, class : 2.322, t_rotation : 0.917, entropy : 3.445 - acc jigsaw : 59.38, class : 56.25 [bs:32]
Accuracies on val: jigsaw : 96.20, class : 64.56
--------------------------------------------------------
Accuracies on test: jigsaw : 98.39, class : 70.68
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 4
New epoch - lr: 0.0005
0/22 of epoch 5/30 jigsaw : 0.921, class : 1.907, t_rotation : 0.723, entropy : 3.190 - acc jigsaw : 62.50, class : 62.50 [bs:32]
Accuracies on val: jigsaw : 98.73, class : 73.42
--------------------------------------------------------
Accuracies on test: jigsaw : 99.40, class : 77.71
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 5
New epoch - lr: 0.0005
0/22 of epoch 6/30 jigsaw : 0.544, class : 0.985, t_rotation : 0.832, entropy : 2.769 - acc jigsaw : 78.12, class : 90.62 [bs:32]
Accuracies on val: jigsaw : 97.47, class : 84.81
--------------------------------------------------------
Accuracies on test: jigsaw : 98.39, class : 85.54
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 6
New epoch - lr: 0.0005
0/22 of epoch 7/30 jigsaw : 0.632, class : 0.985, t_rotation : 0.724, entropy : 2.450 - acc jigsaw : 78.12, class : 78.12 [bs:32]
Accuracies on val: jigsaw : 97.47, class : 91.14
--------------------------------------------------------
Accuracies on test: jigsaw : 98.80, class : 91.57
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 7
New epoch - lr: 0.0005
0/22 of epoch 8/30 jigsaw : 0.435, class : 0.857, t_rotation : 0.600, entropy : 2.138 - acc jigsaw : 96.88, class : 81.25 [bs:32]
Accuracies on val: jigsaw : 98.73, class : 93.67
--------------------------------------------------------
Accuracies on test: jigsaw : 99.20, class : 95.18
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 8
New epoch - lr: 0.0005
0/22 of epoch 9/30 jigsaw : 0.663, class : 0.743, t_rotation : 0.515, entropy : 1.499 - acc jigsaw : 62.50, class : 68.75 [bs:32]
Accuracies on val: jigsaw : 98.73, class : 93.67
--------------------------------------------------------
Accuracies on test: jigsaw : 99.60, class : 96.79
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 9
New epoch - lr: 0.0005
0/22 of epoch 10/30 jigsaw : 0.543, class : 0.473, t_rotation : 0.709, entropy : 1.796 - acc jigsaw : 71.88, class : 81.25 [bs:32]
Accuracies on val: jigsaw : 98.73, class : 94.94
--------------------------------------------------------
Accuracies on test: jigsaw : 99.80, class : 97.19
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 10
New epoch - lr: 0.0005
0/22 of epoch 11/30 jigsaw : 0.400, class : 0.195, t_rotation : 0.519, entropy : 1.283 - acc jigsaw : 90.62, class : 87.50 [bs:32]
Accuracies on val: jigsaw : 98.73, class : 94.94
--------------------------------------------------------
Accuracies on test: jigsaw : 99.80, class : 97.79
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 11
New epoch - lr: 0.0005
0/22 of epoch 12/30 jigsaw : 0.414, class : 0.288, t_rotation : 0.576, entropy : 1.229 - acc jigsaw : 84.38, class : 93.75 [bs:32]
Accuracies on val: jigsaw : 98.73, class : 97.47
--------------------------------------------------------
Accuracies on test: jigsaw : 99.60, class : 98.19
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 12
New epoch - lr: 0.0005
0/22 of epoch 13/30 jigsaw : 0.601, class : 0.188, t_rotation : 0.546, entropy : 1.049 - acc jigsaw : 71.88, class : 81.25 [bs:32]
Accuracies on val: jigsaw : 97.47, class : 97.47
--------------------------------------------------------
Accuracies on test: jigsaw : 99.80, class : 98.59
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 13
New epoch - lr: 0.0005
0/22 of epoch 14/30 jigsaw : 0.450, class : 0.151, t_rotation : 0.531, entropy : 1.116 - acc jigsaw : 75.00, class : 81.25 [bs:32]
Accuracies on val: jigsaw : 97.47, class : 98.73
--------------------------------------------------------
Accuracies on test: jigsaw : 99.80, class : 99.40
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 14
New epoch - lr: 0.0005
0/22 of epoch 15/30 jigsaw : 0.571, class : 0.107, t_rotation : 0.479, entropy : 0.780 - acc jigsaw : 71.88, class : 84.38 [bs:32]
Accuracies on val: jigsaw : 98.73, class : 98.73
--------------------------------------------------------
Accuracies on test: jigsaw : 99.80, class : 99.40
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 15
New epoch - lr: 0.0005
0/22 of epoch 16/30 jigsaw : 0.520, class : 0.176, t_rotation : 0.333, entropy : 0.689 - acc jigsaw : 68.75, class : 84.38 [bs:32]
Accuracies on val: jigsaw : 97.47, class : 97.47
--------------------------------------------------------
Accuracies on test: jigsaw : 99.40, class : 99.00
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 16
New epoch - lr: 0.0005
0/22 of epoch 17/30 jigsaw : 0.495, class : 0.101, t_rotation : 0.332, entropy : 0.870 - acc jigsaw : 75.00, class : 78.12 [bs:32]
Accuracies on val: jigsaw : 97.47, class : 98.73
--------------------------------------------------------
Accuracies on test: jigsaw : 99.80, class : 99.60
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 17
New epoch - lr: 0.0005
0/22 of epoch 18/30 jigsaw : 0.400, class : 0.136, t_rotation : 0.377, entropy : 0.626 - acc jigsaw : 78.12, class : 87.50 [bs:32]
Accuracies on val: jigsaw : 97.47, class : 98.73
--------------------------------------------------------
Accuracies on test: jigsaw : 100.00, class : 99.40
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 18
New epoch - lr: 0.0005
0/22 of epoch 19/30 jigsaw : 0.405, class : 0.145, t_rotation : 0.472, entropy : 0.606 - acc jigsaw : 78.12, class : 84.38 [bs:32]
Accuracies on val: jigsaw : 97.47, class : 98.73
--------------------------------------------------------
Accuracies on test: jigsaw : 100.00, class : 99.80
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 19
New epoch - lr: 0.0005
0/22 of epoch 20/30 jigsaw : 0.559, class : 0.060, t_rotation : 0.406, entropy : 0.655 - acc jigsaw : 78.12, class : 81.25 [bs:32]
Accuracies on val: jigsaw : 97.47, class : 98.73
--------------------------------------------------------
Accuracies on test: jigsaw : 99.80, class : 99.60
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 20
New epoch - lr: 0.0005
0/22 of epoch 21/30 jigsaw : 0.474, class : 0.121, t_rotation : 0.462, entropy : 0.283 - acc jigsaw : 84.38, class : 71.88 [bs:32]
Accuracies on val: jigsaw : 97.47, class : 98.73
--------------------------------------------------------
Accuracies on test: jigsaw : 100.00, class : 99.80
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 21
New epoch - lr: 0.0005
0/22 of epoch 22/30 jigsaw : 0.442, class : 0.114, t_rotation : 0.571, entropy : 0.500 - acc jigsaw : 75.00, class : 84.38 [bs:32]
Accuracies on val: jigsaw : 98.73, class : 98.73
--------------------------------------------------------
Accuracies on test: jigsaw : 100.00, class : 99.60
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 22
New epoch - lr: 0.0005
0/22 of epoch 23/30 jigsaw : 0.355, class : 0.073, t_rotation : 0.548, entropy : 0.262 - acc jigsaw : 87.50, class : 84.38 [bs:32]
Accuracies on val: jigsaw : 98.73, class : 98.73
--------------------------------------------------------
Accuracies on test: jigsaw : 99.60, class : 99.80
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 23
New epoch - lr: 5e-05
0/22 of epoch 24/30 jigsaw : 0.444, class : 0.032, t_rotation : 0.395, entropy : 0.316 - acc jigsaw : 81.25, class : 78.12 [bs:32]
Accuracies on val: jigsaw : 98.73, class : 98.73
--------------------------------------------------------
Accuracies on test: jigsaw : 99.80, class : 99.80
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 24
New epoch - lr: 5e-05
0/22 of epoch 25/30 jigsaw : 0.390, class : 0.047, t_rotation : 0.287, entropy : 0.370 - acc jigsaw : 81.25, class : 75.00 [bs:32]
Accuracies on val: jigsaw : 98.73, class : 98.73
--------------------------------------------------------
Accuracies on test: jigsaw : 99.60, class : 99.80
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 25
New epoch - lr: 5e-05
0/22 of epoch 26/30 jigsaw : 0.287, class : 0.053, t_rotation : 0.343, entropy : 0.617 - acc jigsaw : 90.62, class : 84.38 [bs:32]
Accuracies on val: jigsaw : 98.73, class : 98.73
--------------------------------------------------------
Accuracies on test: jigsaw : 99.60, class : 99.80
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 26
New epoch - lr: 5e-05
0/22 of epoch 27/30 jigsaw : 0.357, class : 0.063, t_rotation : 0.268, entropy : 0.429 - acc jigsaw : 87.50, class : 87.50 [bs:32]
Accuracies on val: jigsaw : 98.73, class : 98.73
--------------------------------------------------------
Accuracies on test: jigsaw : 99.80, class : 99.80
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 27
New epoch - lr: 5e-05
0/22 of epoch 28/30 jigsaw : 0.376, class : 0.043, t_rotation : 0.257, entropy : 0.349 - acc jigsaw : 87.50, class : 93.75 [bs:32]
Accuracies on val: jigsaw : 98.73, class : 98.73
--------------------------------------------------------
Accuracies on test: jigsaw : 99.60, class : 99.80
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 28
New epoch - lr: 5e-05
0/22 of epoch 29/30 jigsaw : 0.349, class : 0.034, t_rotation : 0.285, entropy : 0.349 - acc jigsaw : 84.38, class : 81.25 [bs:32]
Accuracies on val: jigsaw : 98.73, class : 98.73
--------------------------------------------------------
Accuracies on test: jigsaw : 99.80, class : 99.80
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 29
New epoch - lr: 5e-05
0/22 of epoch 30/30 jigsaw : 0.398, class : 0.076, t_rotation : 0.284, entropy : 0.458 - acc jigsaw : 84.38, class : 81.25 [bs:32]
Accuracies on val: jigsaw : 98.73, class : 98.73
--------------------------------------------------------
Accuracies on test: jigsaw : 99.80, class : 99.80
--------------------------------------------------------
2020-01-03 19:05:04
dslr
['webcam']
unsupervised_task_weight: 0.8
bias_hole_image: 0.4
target_rotation_weight: 0.7
entropy_weight 0.1
only_classify the ordered image: True
Highest accuracy on validation set appears on epoch  tensor(29)
Highest accuracy on test set appears on epoch  tensor(29)
Accuracy on test set when the accuracy on validation set is highest:0.998
Highest accuracy on test set:0.998
It took 467.472
--------------------------------------------------------
******************Start training**************************************
--------------------------------------------------------
Dataset size: training 2536, validation 281, testing 795
--------------------------------------------------------
Namespace(TTA=False, batch_size=32, bias_whole_image=0.4, classify_only_ordered_images_or_not=True, domains_list=['amazon', 'dslr', 'webcam'], entropy_loss_weight=0.1, epochs=30, folder_name='test', image_size=222, jitter=0.4, learning_rate=0.0005, limit_source=None, limit_target=None, max_scale=1.0, min_scale=0.8, n_classes=65, nesterov=False, network='resnet50', number_of_unsupervised_classes=4, ooo_weight=0, parameters_lists=[[0.8, 0.4, 0.7, 0.1]], random_horiz_flip=0.5, repeat_times=1, source=['amazon'], suffix='', target='webcam', target_domain_list=['amazon', 'dslr', 'webcam'], target_domain_unsupervised_task_loss_weight=0.7, tf_logger=True, tile_random_grayscale=0.1, train_all=True, unsupervised_task_weight=0.8, val_size=0.1)
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 0
New epoch - lr: 0.0005
0/79 of epoch 1/30 jigsaw : 1.348, class : 4.142, t_rotation : 1.397, entropy : 4.132 - acc jigsaw : 28.12, class : 0.00 [bs:32]
30/79 of epoch 1/30 jigsaw : 1.207, class : 3.610, t_rotation : 0.954, entropy : 3.904 - acc jigsaw : 53.12, class : 9.38 [bs:32]
60/79 of epoch 1/30 jigsaw : 1.169, class : 2.868, t_rotation : 0.718, entropy : 3.654 - acc jigsaw : 59.38, class : 28.12 [bs:32]
Accuracies on val: jigsaw : 99.64, class : 55.87
--------------------------------------------------------
Accuracies on test: jigsaw : 98.36, class : 39.12
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 1
New epoch - lr: 0.0005
0/79 of epoch 2/30 jigsaw : 1.036, class : 2.611, t_rotation : 0.878, entropy : 3.526 - acc jigsaw : 59.38, class : 43.75 [bs:32]
30/79 of epoch 2/30 jigsaw : 1.036, class : 2.317, t_rotation : 0.865, entropy : 3.310 - acc jigsaw : 68.75, class : 53.12 [bs:32]
60/79 of epoch 2/30 jigsaw : 0.948, class : 1.556, t_rotation : 0.814, entropy : 2.787 - acc jigsaw : 56.25, class : 62.50 [bs:32]
Accuracies on val: jigsaw : 97.51, class : 76.16
--------------------------------------------------------
Accuracies on test: jigsaw : 98.74, class : 65.53
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 2
New epoch - lr: 0.0005
0/79 of epoch 3/30 jigsaw : 0.609, class : 1.295, t_rotation : 0.800, entropy : 2.995 - acc jigsaw : 84.38, class : 75.00 [bs:32]
30/79 of epoch 3/30 jigsaw : 0.886, class : 1.074, t_rotation : 0.739, entropy : 2.591 - acc jigsaw : 53.12, class : 68.75 [bs:32]
60/79 of epoch 3/30 jigsaw : 0.936, class : 0.736, t_rotation : 0.632, entropy : 2.474 - acc jigsaw : 56.25, class : 59.38 [bs:32]
Accuracies on val: jigsaw : 97.15, class : 79.00
--------------------------------------------------------
Accuracies on test: jigsaw : 99.62, class : 70.31
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 3
New epoch - lr: 0.0005
0/79 of epoch 4/30 jigsaw : 0.577, class : 0.702, t_rotation : 0.752, entropy : 2.593 - acc jigsaw : 81.25, class : 81.25 [bs:32]
30/79 of epoch 4/30 jigsaw : 1.013, class : 0.408, t_rotation : 0.553, entropy : 1.761 - acc jigsaw : 59.38, class : 75.00 [bs:32]
60/79 of epoch 4/30 jigsaw : 0.918, class : 0.737, t_rotation : 0.505, entropy : 2.032 - acc jigsaw : 59.38, class : 75.00 [bs:32]
Accuracies on val: jigsaw : 97.86, class : 80.78
--------------------------------------------------------
Accuracies on test: jigsaw : 99.25, class : 71.70
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 4
New epoch - lr: 0.0005
0/79 of epoch 5/30 jigsaw : 0.864, class : 0.318, t_rotation : 0.526, entropy : 2.041 - acc jigsaw : 65.62, class : 71.88 [bs:32]
30/79 of epoch 5/30 jigsaw : 0.825, class : 1.174, t_rotation : 0.543, entropy : 1.861 - acc jigsaw : 59.38, class : 53.12 [bs:32]
60/79 of epoch 5/30 jigsaw : 0.897, class : 0.312, t_rotation : 0.507, entropy : 1.185 - acc jigsaw : 65.62, class : 62.50 [bs:32]
Accuracies on val: jigsaw : 88.61, class : 83.27
--------------------------------------------------------
Accuracies on test: jigsaw : 99.25, class : 75.85
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 5
New epoch - lr: 0.0005
0/79 of epoch 6/30 jigsaw : 0.791, class : 0.654, t_rotation : 0.355, entropy : 1.299 - acc jigsaw : 65.62, class : 50.00 [bs:32]
30/79 of epoch 6/30 jigsaw : 0.525, class : 0.539, t_rotation : 0.297, entropy : 1.586 - acc jigsaw : 81.25, class : 81.25 [bs:32]
60/79 of epoch 6/30 jigsaw : 0.872, class : 0.375, t_rotation : 0.468, entropy : 0.739 - acc jigsaw : 59.38, class : 68.75 [bs:32]
Accuracies on val: jigsaw : 96.09, class : 82.56
--------------------------------------------------------
Accuracies on test: jigsaw : 98.74, class : 76.60
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 6
New epoch - lr: 0.0005
0/79 of epoch 7/30 jigsaw : 0.650, class : 0.708, t_rotation : 0.625, entropy : 1.417 - acc jigsaw : 71.88, class : 71.88 [bs:32]
30/79 of epoch 7/30 jigsaw : 0.586, class : 1.085, t_rotation : 0.248, entropy : 1.357 - acc jigsaw : 75.00, class : 59.38 [bs:32]
60/79 of epoch 7/30 jigsaw : 0.634, class : 0.618, t_rotation : 0.280, entropy : 1.378 - acc jigsaw : 81.25, class : 68.75 [bs:32]
Accuracies on val: jigsaw : 95.02, class : 83.27
--------------------------------------------------------
Accuracies on test: jigsaw : 99.37, class : 76.98
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 7
New epoch - lr: 0.0005
0/79 of epoch 8/30 jigsaw : 0.653, class : 0.203, t_rotation : 0.559, entropy : 1.145 - acc jigsaw : 75.00, class : 71.88 [bs:32]
30/79 of epoch 8/30 jigsaw : 0.710, class : 0.793, t_rotation : 0.318, entropy : 0.954 - acc jigsaw : 68.75, class : 75.00 [bs:32]
60/79 of epoch 8/30 jigsaw : 0.857, class : 0.719, t_rotation : 0.249, entropy : 1.185 - acc jigsaw : 59.38, class : 68.75 [bs:32]
Accuracies on val: jigsaw : 93.59, class : 83.99
--------------------------------------------------------
Accuracies on test: jigsaw : 99.62, class : 76.86
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 8
New epoch - lr: 0.0005
0/79 of epoch 9/30 jigsaw : 0.589, class : 0.342, t_rotation : 0.521, entropy : 0.929 - acc jigsaw : 75.00, class : 59.38 [bs:32]
30/79 of epoch 9/30 jigsaw : 0.578, class : 0.217, t_rotation : 0.278, entropy : 1.106 - acc jigsaw : 75.00, class : 71.88 [bs:32]
60/79 of epoch 9/30 jigsaw : 0.530, class : 0.527, t_rotation : 0.201, entropy : 0.960 - acc jigsaw : 71.88, class : 78.12 [bs:32]
Accuracies on val: jigsaw : 95.37, class : 84.34
--------------------------------------------------------
Accuracies on test: jigsaw : 99.50, class : 77.99
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 9
New epoch - lr: 0.0005
0/79 of epoch 10/30 jigsaw : 0.501, class : 0.211, t_rotation : 0.369, entropy : 1.260 - acc jigsaw : 81.25, class : 62.50 [bs:32]
30/79 of epoch 10/30 jigsaw : 0.430, class : 0.458, t_rotation : 0.207, entropy : 0.656 - acc jigsaw : 78.12, class : 87.50 [bs:32]
60/79 of epoch 10/30 jigsaw : 0.566, class : 0.167, t_rotation : 0.280, entropy : 0.750 - acc jigsaw : 78.12, class : 78.12 [bs:32]
Accuracies on val: jigsaw : 97.51, class : 84.70
--------------------------------------------------------
Accuracies on test: jigsaw : 100.00, class : 77.61
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 10
New epoch - lr: 0.0005
0/79 of epoch 11/30 jigsaw : 0.480, class : 0.159, t_rotation : 0.406, entropy : 1.098 - acc jigsaw : 71.88, class : 65.62 [bs:32]
30/79 of epoch 11/30 jigsaw : 0.490, class : 0.355, t_rotation : 0.284, entropy : 0.862 - acc jigsaw : 81.25, class : 78.12 [bs:32]
60/79 of epoch 11/30 jigsaw : 0.607, class : 0.455, t_rotation : 0.267, entropy : 0.787 - acc jigsaw : 71.88, class : 68.75 [bs:32]
Accuracies on val: jigsaw : 94.66, class : 84.70
--------------------------------------------------------
Accuracies on test: jigsaw : 98.87, class : 78.36
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 11
New epoch - lr: 0.0005
0/79 of epoch 12/30 jigsaw : 0.715, class : 0.127, t_rotation : 0.502, entropy : 0.569 - acc jigsaw : 71.88, class : 68.75 [bs:32]
30/79 of epoch 12/30 jigsaw : 0.403, class : 0.561, t_rotation : 0.197, entropy : 0.576 - acc jigsaw : 87.50, class : 78.12 [bs:32]
60/79 of epoch 12/30 jigsaw : 0.364, class : 0.373, t_rotation : 0.180, entropy : 0.705 - acc jigsaw : 81.25, class : 84.38 [bs:32]
Accuracies on val: jigsaw : 93.24, class : 87.54
--------------------------------------------------------
Accuracies on test: jigsaw : 99.62, class : 79.87
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 12
New epoch - lr: 0.0005
0/79 of epoch 13/30 jigsaw : 0.626, class : 0.524, t_rotation : 0.303, entropy : 0.709 - acc jigsaw : 71.88, class : 62.50 [bs:32]
30/79 of epoch 13/30 jigsaw : 0.546, class : 0.255, t_rotation : 0.243, entropy : 0.399 - acc jigsaw : 81.25, class : 81.25 [bs:32]
60/79 of epoch 13/30 jigsaw : 1.149, class : 0.426, t_rotation : 0.149, entropy : 0.817 - acc jigsaw : 62.50, class : 75.00 [bs:32]
Accuracies on val: jigsaw : 95.37, class : 85.77
--------------------------------------------------------
Accuracies on test: jigsaw : 99.75, class : 80.00
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 13
New epoch - lr: 0.0005
0/79 of epoch 14/30 jigsaw : 0.577, class : 0.065, t_rotation : 0.396, entropy : 0.806 - acc jigsaw : 68.75, class : 68.75 [bs:32]
30/79 of epoch 14/30 jigsaw : 0.359, class : 0.126, t_rotation : 0.221, entropy : 0.536 - acc jigsaw : 93.75, class : 81.25 [bs:32]
60/79 of epoch 14/30 jigsaw : 0.477, class : 0.247, t_rotation : 0.141, entropy : 0.654 - acc jigsaw : 81.25, class : 78.12 [bs:32]
Accuracies on val: jigsaw : 94.31, class : 85.05
--------------------------------------------------------
Accuracies on test: jigsaw : 100.00, class : 79.12
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 14
New epoch - lr: 0.0005
0/79 of epoch 15/30 jigsaw : 0.475, class : 0.267, t_rotation : 0.462, entropy : 0.717 - acc jigsaw : 81.25, class : 75.00 [bs:32]
30/79 of epoch 15/30 jigsaw : 0.502, class : 0.046, t_rotation : 0.096, entropy : 0.775 - acc jigsaw : 75.00, class : 68.75 [bs:32]
60/79 of epoch 15/30 jigsaw : 0.487, class : 0.180, t_rotation : 0.107, entropy : 0.650 - acc jigsaw : 75.00, class : 75.00 [bs:32]
Accuracies on val: jigsaw : 91.81, class : 85.41
--------------------------------------------------------
Accuracies on test: jigsaw : 99.50, class : 79.25
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 15
New epoch - lr: 0.0005
0/79 of epoch 16/30 jigsaw : 0.444, class : 0.375, t_rotation : 0.328, entropy : 0.656 - acc jigsaw : 84.38, class : 65.62 [bs:32]
30/79 of epoch 16/30 jigsaw : 0.371, class : 0.431, t_rotation : 0.077, entropy : 0.735 - acc jigsaw : 87.50, class : 71.88 [bs:32]
60/79 of epoch 16/30 jigsaw : 0.304, class : 0.176, t_rotation : 0.108, entropy : 0.387 - acc jigsaw : 87.50, class : 75.00 [bs:32]
Accuracies on val: jigsaw : 85.05, class : 86.12
--------------------------------------------------------
Accuracies on test: jigsaw : 98.36, class : 78.49
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 16
New epoch - lr: 0.0005
0/79 of epoch 17/30 jigsaw : 0.301, class : 0.112, t_rotation : 0.229, entropy : 0.638 - acc jigsaw : 90.62, class : 68.75 [bs:32]
30/79 of epoch 17/30 jigsaw : 0.301, class : 0.292, t_rotation : 0.062, entropy : 0.806 - acc jigsaw : 87.50, class : 75.00 [bs:32]
60/79 of epoch 17/30 jigsaw : 0.424, class : 0.393, t_rotation : 0.082, entropy : 0.504 - acc jigsaw : 78.12, class : 81.25 [bs:32]
Accuracies on val: jigsaw : 92.88, class : 86.12
--------------------------------------------------------
Accuracies on test: jigsaw : 99.75, class : 80.63
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 17
New epoch - lr: 0.0005
0/79 of epoch 18/30 jigsaw : 0.376, class : 0.060, t_rotation : 0.179, entropy : 0.462 - acc jigsaw : 84.38, class : 78.12 [bs:32]
30/79 of epoch 18/30 jigsaw : 0.553, class : 0.240, t_rotation : 0.063, entropy : 0.196 - acc jigsaw : 81.25, class : 81.25 [bs:32]
60/79 of epoch 18/30 jigsaw : 0.652, class : 0.159, t_rotation : 0.066, entropy : 0.382 - acc jigsaw : 68.75, class : 81.25 [bs:32]
Accuracies on val: jigsaw : 96.44, class : 86.12
--------------------------------------------------------
Accuracies on test: jigsaw : 99.87, class : 80.63
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 18
New epoch - lr: 0.0005
0/79 of epoch 19/30 jigsaw : 0.272, class : 0.057, t_rotation : 0.246, entropy : 0.574 - acc jigsaw : 90.62, class : 75.00 [bs:32]
30/79 of epoch 19/30 jigsaw : 0.306, class : 0.086, t_rotation : 0.080, entropy : 0.503 - acc jigsaw : 90.62, class : 75.00 [bs:32]
60/79 of epoch 19/30 jigsaw : 0.319, class : 0.610, t_rotation : 0.036, entropy : 0.365 - acc jigsaw : 87.50, class : 71.88 [bs:32]
Accuracies on val: jigsaw : 94.31, class : 86.12
--------------------------------------------------------
Accuracies on test: jigsaw : 99.87, class : 79.75
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 19
New epoch - lr: 0.0005
0/79 of epoch 20/30 jigsaw : 0.419, class : 0.054, t_rotation : 0.181, entropy : 0.415 - acc jigsaw : 81.25, class : 75.00 [bs:32]
30/79 of epoch 20/30 jigsaw : 0.278, class : 0.175, t_rotation : 0.157, entropy : 0.393 - acc jigsaw : 93.75, class : 81.25 [bs:32]
60/79 of epoch 20/30 jigsaw : 0.497, class : 0.261, t_rotation : 0.070, entropy : 0.413 - acc jigsaw : 87.50, class : 81.25 [bs:32]
Accuracies on val: jigsaw : 91.81, class : 86.12
--------------------------------------------------------
Accuracies on test: jigsaw : 99.75, class : 80.75
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 20
New epoch - lr: 0.0005
0/79 of epoch 21/30 jigsaw : 0.864, class : 0.105, t_rotation : 0.188, entropy : 0.330 - acc jigsaw : 78.12, class : 59.38 [bs:32]
30/79 of epoch 21/30 jigsaw : 0.435, class : 0.172, t_rotation : 0.058, entropy : 0.419 - acc jigsaw : 84.38, class : 78.12 [bs:32]
60/79 of epoch 21/30 jigsaw : 0.498, class : 0.300, t_rotation : 0.018, entropy : 0.330 - acc jigsaw : 81.25, class : 81.25 [bs:32]
Accuracies on val: jigsaw : 92.17, class : 83.63
--------------------------------------------------------
Accuracies on test: jigsaw : 99.50, class : 79.75
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 21
New epoch - lr: 0.0005
0/79 of epoch 22/30 jigsaw : 0.332, class : 0.097, t_rotation : 0.087, entropy : 0.246 - acc jigsaw : 84.38, class : 71.88 [bs:32]
30/79 of epoch 22/30 jigsaw : 0.437, class : 0.203, t_rotation : 0.102, entropy : 0.469 - acc jigsaw : 84.38, class : 75.00 [bs:32]
60/79 of epoch 22/30 jigsaw : 0.435, class : 0.056, t_rotation : 0.053, entropy : 0.223 - acc jigsaw : 81.25, class : 84.38 [bs:32]
Accuracies on val: jigsaw : 91.10, class : 86.48
--------------------------------------------------------
Accuracies on test: jigsaw : 99.87, class : 80.38
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 22
New epoch - lr: 0.0005
0/79 of epoch 23/30 jigsaw : 0.418, class : 0.038, t_rotation : 0.107, entropy : 0.324 - acc jigsaw : 84.38, class : 81.25 [bs:32]
30/79 of epoch 23/30 jigsaw : 0.273, class : 0.152, t_rotation : 0.034, entropy : 0.314 - acc jigsaw : 87.50, class : 81.25 [bs:32]
60/79 of epoch 23/30 jigsaw : 0.543, class : 0.095, t_rotation : 0.057, entropy : 0.380 - acc jigsaw : 75.00, class : 87.50 [bs:32]
Accuracies on val: jigsaw : 93.24, class : 86.48
--------------------------------------------------------
Accuracies on test: jigsaw : 100.00, class : 81.51
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 23
New epoch - lr: 5e-05
0/79 of epoch 24/30 jigsaw : 0.417, class : 0.031, t_rotation : 0.352, entropy : 0.315 - acc jigsaw : 84.38, class : 75.00 [bs:32]
30/79 of epoch 24/30 jigsaw : 0.302, class : 0.460, t_rotation : 0.161, entropy : 0.353 - acc jigsaw : 87.50, class : 71.88 [bs:32]
60/79 of epoch 24/30 jigsaw : 0.384, class : 0.142, t_rotation : 0.128, entropy : 0.249 - acc jigsaw : 87.50, class : 75.00 [bs:32]
Accuracies on val: jigsaw : 92.88, class : 86.83
--------------------------------------------------------
Accuracies on test: jigsaw : 100.00, class : 81.38
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 24
New epoch - lr: 5e-05
0/79 of epoch 25/30 jigsaw : 0.428, class : 0.069, t_rotation : 0.200, entropy : 0.675 - acc jigsaw : 84.38, class : 84.38 [bs:32]
30/79 of epoch 25/30 jigsaw : 0.279, class : 0.030, t_rotation : 0.068, entropy : 0.443 - acc jigsaw : 87.50, class : 68.75 [bs:32]
60/79 of epoch 25/30 jigsaw : 0.388, class : 0.083, t_rotation : 0.036, entropy : 0.282 - acc jigsaw : 87.50, class : 81.25 [bs:32]
Accuracies on val: jigsaw : 92.53, class : 87.19
--------------------------------------------------------
Accuracies on test: jigsaw : 100.00, class : 81.76
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 25
New epoch - lr: 5e-05
0/79 of epoch 26/30 jigsaw : 0.450, class : 0.261, t_rotation : 0.363, entropy : 0.264 - acc jigsaw : 81.25, class : 59.38 [bs:32]
30/79 of epoch 26/30 jigsaw : 0.327, class : 0.258, t_rotation : 0.068, entropy : 0.445 - acc jigsaw : 84.38, class : 75.00 [bs:32]
60/79 of epoch 26/30 jigsaw : 0.301, class : 0.209, t_rotation : 0.094, entropy : 0.220 - acc jigsaw : 84.38, class : 75.00 [bs:32]
Accuracies on val: jigsaw : 93.95, class : 86.48
--------------------------------------------------------
Accuracies on test: jigsaw : 100.00, class : 81.38
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 26
New epoch - lr: 5e-05
0/79 of epoch 27/30 jigsaw : 0.251, class : 0.168, t_rotation : 0.097, entropy : 0.385 - acc jigsaw : 93.75, class : 65.62 [bs:32]
30/79 of epoch 27/30 jigsaw : 0.141, class : 0.142, t_rotation : 0.040, entropy : 0.372 - acc jigsaw : 96.88, class : 68.75 [bs:32]
60/79 of epoch 27/30 jigsaw : 0.410, class : 0.054, t_rotation : 0.065, entropy : 0.465 - acc jigsaw : 84.38, class : 87.50 [bs:32]
Accuracies on val: jigsaw : 93.95, class : 87.54
--------------------------------------------------------
Accuracies on test: jigsaw : 100.00, class : 81.51
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 27
New epoch - lr: 5e-05
0/79 of epoch 28/30 jigsaw : 0.288, class : 0.071, t_rotation : 0.133, entropy : 0.415 - acc jigsaw : 87.50, class : 75.00 [bs:32]
30/79 of epoch 28/30 jigsaw : 0.321, class : 0.127, t_rotation : 0.073, entropy : 0.313 - acc jigsaw : 84.38, class : 59.38 [bs:32]
60/79 of epoch 28/30 jigsaw : 0.397, class : 0.123, t_rotation : 0.045, entropy : 0.283 - acc jigsaw : 87.50, class : 78.12 [bs:32]
Accuracies on val: jigsaw : 93.59, class : 87.19
--------------------------------------------------------
Accuracies on test: jigsaw : 100.00, class : 81.38
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 28
New epoch - lr: 5e-05
0/79 of epoch 29/30 jigsaw : 0.289, class : 0.143, t_rotation : 0.140, entropy : 0.423 - acc jigsaw : 87.50, class : 81.25 [bs:32]
30/79 of epoch 29/30 jigsaw : 0.223, class : 0.074, t_rotation : 0.023, entropy : 0.254 - acc jigsaw : 93.75, class : 84.38 [bs:32]
60/79 of epoch 29/30 jigsaw : 0.226, class : 0.081, t_rotation : 0.084, entropy : 0.154 - acc jigsaw : 93.75, class : 90.62 [bs:32]
Accuracies on val: jigsaw : 96.80, class : 87.19
--------------------------------------------------------
Accuracies on test: jigsaw : 100.00, class : 81.01
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 29
New epoch - lr: 5e-05
0/79 of epoch 30/30 jigsaw : 0.259, class : 0.042, t_rotation : 0.140, entropy : 0.340 - acc jigsaw : 90.62, class : 75.00 [bs:32]
30/79 of epoch 30/30 jigsaw : 0.212, class : 0.369, t_rotation : 0.155, entropy : 0.210 - acc jigsaw : 90.62, class : 75.00 [bs:32]
60/79 of epoch 30/30 jigsaw : 0.276, class : 0.114, t_rotation : 0.104, entropy : 0.427 - acc jigsaw : 84.38, class : 68.75 [bs:32]
Accuracies on val: jigsaw : 95.37, class : 86.83
--------------------------------------------------------
Accuracies on test: jigsaw : 100.00, class : 81.38
--------------------------------------------------------
2020-01-03 19:26:55
webcam
['amazon']
unsupervised_task_weight: 0.8
bias_hole_image: 0.4
target_rotation_weight: 0.7
entropy_weight 0.1
only_classify the ordered image: True
Highest accuracy on validation set appears on epoch  tensor(26)
Highest accuracy on test set appears on epoch  tensor(24)
Accuracy on test set when the accuracy on validation set is highest:0.815
Highest accuracy on test set:0.818
It took 1310.27
--------------------------------------------------------
******************Start training**************************************
--------------------------------------------------------
Dataset size: training 449, validation 49, testing 795
--------------------------------------------------------
Namespace(TTA=False, batch_size=32, bias_whole_image=0.4, classify_only_ordered_images_or_not=True, domains_list=['amazon', 'dslr', 'webcam'], entropy_loss_weight=0.1, epochs=30, folder_name='test', image_size=222, jitter=0.4, learning_rate=0.0005, limit_source=None, limit_target=None, max_scale=1.0, min_scale=0.8, n_classes=65, nesterov=False, network='resnet50', number_of_unsupervised_classes=4, ooo_weight=0, parameters_lists=[[0.8, 0.4, 0.7, 0.1]], random_horiz_flip=0.5, repeat_times=1, source=['dslr'], suffix='', target='webcam', target_domain_list=['amazon', 'dslr', 'webcam'], target_domain_unsupervised_task_loss_weight=0.7, tf_logger=True, tile_random_grayscale=0.1, train_all=True, unsupervised_task_weight=0.8, val_size=0.1)
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 0
New epoch - lr: 0.0005
0/14 of epoch 1/30 jigsaw : 1.467, class : 4.159, t_rotation : 1.455, entropy : 4.133 - acc jigsaw : 21.88, class : 0.00 [bs:32]
Accuracies on val: jigsaw : 100.00, class : 10.20
--------------------------------------------------------
Accuracies on test: jigsaw : 100.00, class : 9.81
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 1
New epoch - lr: 0.0005
0/14 of epoch 2/30 jigsaw : 0.970, class : 3.690, t_rotation : 1.220, entropy : 4.101 - acc jigsaw : 68.75, class : 15.62 [bs:32]
Accuracies on val: jigsaw : 100.00, class : 20.41
--------------------------------------------------------
Accuracies on test: jigsaw : 100.00, class : 19.62
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 2
New epoch - lr: 0.0005
0/14 of epoch 3/30 jigsaw : 1.136, class : 2.901, t_rotation : 1.204, entropy : 3.913 - acc jigsaw : 56.25, class : 31.25 [bs:32]
Accuracies on val: jigsaw : 100.00, class : 34.69
--------------------------------------------------------
Accuracies on test: jigsaw : 99.87, class : 25.91
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 3
New epoch - lr: 0.0005
0/14 of epoch 4/30 jigsaw : 0.951, class : 2.703, t_rotation : 1.161, entropy : 3.633 - acc jigsaw : 59.38, class : 34.38 [bs:32]
Accuracies on val: jigsaw : 100.00, class : 44.90
--------------------------------------------------------
Accuracies on test: jigsaw : 100.00, class : 31.95
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 4
New epoch - lr: 0.0005
0/14 of epoch 5/30 jigsaw : 0.978, class : 2.472, t_rotation : 1.002, entropy : 3.467 - acc jigsaw : 53.12, class : 40.62 [bs:32]
Accuracies on val: jigsaw : 100.00, class : 57.14
--------------------------------------------------------
Accuracies on test: jigsaw : 100.00, class : 45.66
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 5
New epoch - lr: 0.0005
0/14 of epoch 6/30 jigsaw : 0.888, class : 1.764, t_rotation : 1.041, entropy : 3.302 - acc jigsaw : 53.12, class : 46.88 [bs:32]
Accuracies on val: jigsaw : 100.00, class : 63.27
--------------------------------------------------------
Accuracies on test: jigsaw : 99.87, class : 57.61
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 6
New epoch - lr: 0.0005
0/14 of epoch 7/30 jigsaw : 0.761, class : 1.725, t_rotation : 0.851, entropy : 3.275 - acc jigsaw : 68.75, class : 56.25 [bs:32]
Accuracies on val: jigsaw : 100.00, class : 69.39
--------------------------------------------------------
Accuracies on test: jigsaw : 99.87, class : 68.30
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 7
New epoch - lr: 0.0005
0/14 of epoch 8/30 jigsaw : 0.604, class : 1.184, t_rotation : 0.906, entropy : 2.870 - acc jigsaw : 78.12, class : 71.88 [bs:32]
Accuracies on val: jigsaw : 100.00, class : 79.59
--------------------------------------------------------
Accuracies on test: jigsaw : 99.37, class : 77.48
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 8
New epoch - lr: 0.0005
0/14 of epoch 9/30 jigsaw : 0.699, class : 0.702, t_rotation : 0.730, entropy : 2.447 - acc jigsaw : 78.12, class : 87.50 [bs:32]
Accuracies on val: jigsaw : 100.00, class : 83.67
--------------------------------------------------------
Accuracies on test: jigsaw : 99.37, class : 78.87
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 9
New epoch - lr: 0.0005
0/14 of epoch 10/30 jigsaw : 0.482, class : 1.003, t_rotation : 0.522, entropy : 2.802 - acc jigsaw : 75.00, class : 81.25 [bs:32]
Accuracies on val: jigsaw : 100.00, class : 87.76
--------------------------------------------------------
Accuracies on test: jigsaw : 98.87, class : 81.76
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 10
New epoch - lr: 0.0005
0/14 of epoch 11/30 jigsaw : 0.838, class : 0.513, t_rotation : 0.626, entropy : 2.390 - acc jigsaw : 53.12, class : 65.62 [bs:32]
Accuracies on val: jigsaw : 100.00, class : 83.67
--------------------------------------------------------
Accuracies on test: jigsaw : 98.36, class : 85.91
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 11
New epoch - lr: 0.0005
0/14 of epoch 12/30 jigsaw : 0.806, class : 0.797, t_rotation : 0.716, entropy : 2.298 - acc jigsaw : 68.75, class : 71.88 [bs:32]
Accuracies on val: jigsaw : 100.00, class : 87.76
--------------------------------------------------------
Accuracies on test: jigsaw : 99.12, class : 86.79
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 12
New epoch - lr: 0.0005
0/14 of epoch 13/30 jigsaw : 0.677, class : 0.655, t_rotation : 0.930, entropy : 2.081 - acc jigsaw : 62.50, class : 81.25 [bs:32]
Accuracies on val: jigsaw : 100.00, class : 89.80
--------------------------------------------------------
Accuracies on test: jigsaw : 99.25, class : 89.31
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 13
New epoch - lr: 0.0005
0/14 of epoch 14/30 jigsaw : 0.679, class : 0.636, t_rotation : 0.582, entropy : 1.800 - acc jigsaw : 71.88, class : 65.62 [bs:32]
Accuracies on val: jigsaw : 100.00, class : 91.84
--------------------------------------------------------
Accuracies on test: jigsaw : 99.62, class : 90.06
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 14
New epoch - lr: 0.0005
0/14 of epoch 15/30 jigsaw : 0.793, class : 0.319, t_rotation : 0.630, entropy : 1.527 - acc jigsaw : 71.88, class : 71.88 [bs:32]
Accuracies on val: jigsaw : 100.00, class : 95.92
--------------------------------------------------------
Accuracies on test: jigsaw : 99.50, class : 91.45
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 15
New epoch - lr: 0.0005
0/14 of epoch 16/30 jigsaw : 0.383, class : 0.337, t_rotation : 0.506, entropy : 1.901 - acc jigsaw : 96.88, class : 81.25 [bs:32]
Accuracies on val: jigsaw : 100.00, class : 93.88
--------------------------------------------------------
Accuracies on test: jigsaw : 98.74, class : 93.08
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 16
New epoch - lr: 0.0005
0/14 of epoch 17/30 jigsaw : 0.744, class : 0.134, t_rotation : 0.499, entropy : 1.454 - acc jigsaw : 71.88, class : 78.12 [bs:32]
Accuracies on val: jigsaw : 100.00, class : 93.88
--------------------------------------------------------
Accuracies on test: jigsaw : 99.25, class : 94.21
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 17
New epoch - lr: 0.0005
0/14 of epoch 18/30 jigsaw : 0.574, class : 0.276, t_rotation : 0.576, entropy : 1.752 - acc jigsaw : 84.38, class : 84.38 [bs:32]
Accuracies on val: jigsaw : 100.00, class : 95.92
--------------------------------------------------------
Accuracies on test: jigsaw : 98.62, class : 94.84
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 18
New epoch - lr: 0.0005
0/14 of epoch 19/30 jigsaw : 0.597, class : 0.179, t_rotation : 0.405, entropy : 1.472 - acc jigsaw : 65.62, class : 78.12 [bs:32]
Accuracies on val: jigsaw : 100.00, class : 95.92
--------------------------------------------------------
Accuracies on test: jigsaw : 99.37, class : 94.97
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 19
New epoch - lr: 0.0005
0/14 of epoch 20/30 jigsaw : 0.518, class : 0.237, t_rotation : 0.590, entropy : 0.903 - acc jigsaw : 71.88, class : 78.12 [bs:32]
Accuracies on val: jigsaw : 100.00, class : 95.92
--------------------------------------------------------
Accuracies on test: jigsaw : 99.62, class : 95.60
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 20
New epoch - lr: 0.0005
0/14 of epoch 21/30 jigsaw : 0.878, class : 0.192, t_rotation : 0.702, entropy : 0.776 - acc jigsaw : 62.50, class : 65.62 [bs:32]
Accuracies on val: jigsaw : 100.00, class : 95.92
--------------------------------------------------------
Accuracies on test: jigsaw : 99.25, class : 95.60
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 21
New epoch - lr: 0.0005
0/14 of epoch 22/30 jigsaw : 0.532, class : 0.255, t_rotation : 0.503, entropy : 0.893 - acc jigsaw : 71.88, class : 71.88 [bs:32]
Accuracies on val: jigsaw : 100.00, class : 97.96
--------------------------------------------------------
Accuracies on test: jigsaw : 98.11, class : 95.97
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 22
New epoch - lr: 0.0005
0/14 of epoch 23/30 jigsaw : 0.388, class : 0.222, t_rotation : 0.503, entropy : 0.999 - acc jigsaw : 84.38, class : 96.88 [bs:32]
Accuracies on val: jigsaw : 100.00, class : 97.96
--------------------------------------------------------
Accuracies on test: jigsaw : 99.37, class : 96.35
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 23
New epoch - lr: 5e-05
0/14 of epoch 24/30 jigsaw : 0.423, class : 0.085, t_rotation : 0.453, entropy : 0.989 - acc jigsaw : 84.38, class : 81.25 [bs:32]
Accuracies on val: jigsaw : 100.00, class : 100.00
--------------------------------------------------------
Accuracies on test: jigsaw : 99.62, class : 96.23
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 24
New epoch - lr: 5e-05
0/14 of epoch 25/30 jigsaw : 0.346, class : 0.110, t_rotation : 0.390, entropy : 1.200 - acc jigsaw : 84.38, class : 81.25 [bs:32]
Accuracies on val: jigsaw : 100.00, class : 97.96
--------------------------------------------------------
Accuracies on test: jigsaw : 99.87, class : 96.10
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 25
New epoch - lr: 5e-05
0/14 of epoch 26/30 jigsaw : 0.398, class : 0.086, t_rotation : 0.450, entropy : 0.925 - acc jigsaw : 84.38, class : 78.12 [bs:32]
Accuracies on val: jigsaw : 100.00, class : 100.00
--------------------------------------------------------
Accuracies on test: jigsaw : 99.62, class : 96.23
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 26
New epoch - lr: 5e-05
0/14 of epoch 27/30 jigsaw : 0.712, class : 0.052, t_rotation : 0.406, entropy : 1.023 - acc jigsaw : 62.50, class : 84.38 [bs:32]
Accuracies on val: jigsaw : 100.00, class : 100.00
--------------------------------------------------------
Accuracies on test: jigsaw : 99.87, class : 96.23
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 27
New epoch - lr: 5e-05
0/14 of epoch 28/30 jigsaw : 0.359, class : 0.266, t_rotation : 0.364, entropy : 0.838 - acc jigsaw : 87.50, class : 90.62 [bs:32]
Accuracies on val: jigsaw : 100.00, class : 100.00
--------------------------------------------------------
Accuracies on test: jigsaw : 99.75, class : 96.35
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 28
New epoch - lr: 5e-05
0/14 of epoch 29/30 jigsaw : 0.530, class : 0.165, t_rotation : 0.611, entropy : 0.612 - acc jigsaw : 81.25, class : 87.50 [bs:32]
Accuracies on val: jigsaw : 100.00, class : 100.00
--------------------------------------------------------
Accuracies on test: jigsaw : 99.37, class : 96.35
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 29
New epoch - lr: 5e-05
0/14 of epoch 30/30 jigsaw : 0.445, class : 0.034, t_rotation : 0.451, entropy : 0.941 - acc jigsaw : 78.12, class : 87.50 [bs:32]
Accuracies on val: jigsaw : 100.00, class : 100.00
--------------------------------------------------------
Accuracies on test: jigsaw : 99.75, class : 96.35
--------------------------------------------------------
2020-01-03 19:32:37
webcam
['dslr']
unsupervised_task_weight: 0.8
bias_hole_image: 0.4
target_rotation_weight: 0.7
entropy_weight 0.1
only_classify the ordered image: True
Highest accuracy on validation set appears on epoch  tensor(29)
Highest accuracy on test set appears on epoch  tensor(29)
Accuracy on test set when the accuracy on validation set is highest:0.964
Highest accuracy on test set:0.964
It took 341.413
--------------------------------------------------------
