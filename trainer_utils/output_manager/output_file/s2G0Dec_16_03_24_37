display-im6.q16: unable to open X server `' @ error/display.c/DisplayImageCommand/432.
******************Start training**************************************
--------------------------------------------------------
Dataset size: training 7150, validation 793, testing 2048
--------------------------------------------------------
Namespace(TTA=False, batch_size=128, bias_whole_image=0.3, classify_only_ordered_images_or_not=True, domains_list=['photo', 'sketch', 'cartoon', 'art_painting'], entropy_loss_weight=0.1, epochs=30, folder_name='test', image_size=222, jitter=0.4, learning_rate=0.001, limit_source=None, limit_target=None, max_scale=1.0, min_scale=0.8, n_classes=7, nesterov=False, network='resnet18', ooo_weight=0, parameters_lists=[[0.8, 0.3, 0.8, 0.1], [0.8, 0.5, 0.8, 0.1], [0.8, 0.6, 0.8, 0.1]], random_horiz_flip=0.5, repeat_times=3, source=['photo', 'sketch', 'cartoon'], suffix='', target='art_painting', target_domain_list=['art_painting', 'cartoon', 'sketch', 'photo'], target_domain_unsupervised_task_loss_weight=0.8, tf_logger=True, tile_random_grayscale=0.1, train_all=True, unsupervised_task_weight=0.8, val_size=0.1)
--------------------------------------------------------
/home/giorgio/Files/pycharm_project/pytorch_interpreter/lib/python3.7/site-packages/torch/optim/lr_scheduler.py:100: UserWarning: Detected call of `lr_scheduler.step()` before `optimizer.step()`. In PyTorch 1.1.0 and later, you should call them in the opposite order: `optimizer.step()` before `lr_scheduler.step()`.  Failure to do this will result in PyTorch skipping the first value of the learning rate schedule.See more details at https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate
  "https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate", UserWarning)
--------------------------------------------------------
current epoch:%d 0
New epoch - lr: 0.001
0/55 of epoch 1/30 jigsaw : 1.622, class : 1.973, t_rotation : 1.607, entropy : 1.795 - acc jigsaw : 18.75, class : 17.97 [bs:128]
30/55 of epoch 1/30 jigsaw : 1.051, class : 1.031, t_rotation : 1.183, entropy : 1.735 - acc jigsaw : 58.59, class : 60.16 [bs:128]
Accuracies on val: jigsaw : 95.33, class : 75.79
--------------------------------------------------------
Accuracies on test: jigsaw : 91.55, class : 64.79
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 1
New epoch - lr: 0.001
0/55 of epoch 2/30 jigsaw : 0.920, class : 0.863, t_rotation : 0.929, entropy : 1.469 - acc jigsaw : 57.03, class : 60.16 [bs:128]
30/55 of epoch 2/30 jigsaw : 0.651, class : 0.543, t_rotation : 0.799, entropy : 1.179 - acc jigsaw : 75.78, class : 73.44 [bs:128]
Accuracies on val: jigsaw : 94.70, class : 85.37
--------------------------------------------------------
Accuracies on test: jigsaw : 89.75, class : 76.51
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 2
New epoch - lr: 0.001
0/55 of epoch 3/30 jigsaw : 0.628, class : 0.457, t_rotation : 0.751, entropy : 1.012 - acc jigsaw : 74.22, class : 76.56 [bs:128]
30/55 of epoch 3/30 jigsaw : 0.535, class : 0.306, t_rotation : 0.689, entropy : 0.764 - acc jigsaw : 79.69, class : 71.88 [bs:128]
Accuracies on val: jigsaw : 92.81, class : 89.28
--------------------------------------------------------
Accuracies on test: jigsaw : 89.60, class : 81.74
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 3
New epoch - lr: 0.001
0/55 of epoch 4/30 jigsaw : 0.584, class : 0.382, t_rotation : 0.578, entropy : 0.737 - acc jigsaw : 78.91, class : 73.44 [bs:128]
30/55 of epoch 4/30 jigsaw : 0.510, class : 0.220, t_rotation : 0.597, entropy : 0.754 - acc jigsaw : 82.03, class : 74.22 [bs:128]
Accuracies on val: jigsaw : 95.21, class : 89.03
--------------------------------------------------------
Accuracies on test: jigsaw : 92.04, class : 82.67
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 4
New epoch - lr: 0.001
0/55 of epoch 5/30 jigsaw : 0.557, class : 0.226, t_rotation : 0.709, entropy : 0.741 - acc jigsaw : 76.56, class : 74.22 [bs:128]
30/55 of epoch 5/30 jigsaw : 0.382, class : 0.138, t_rotation : 0.484, entropy : 0.505 - acc jigsaw : 88.28, class : 78.91 [bs:128]
Accuracies on val: jigsaw : 93.95, class : 89.66
--------------------------------------------------------
Accuracies on test: jigsaw : 92.04, class : 84.33
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 5
New epoch - lr: 0.001
0/55 of epoch 6/30 jigsaw : 0.469, class : 0.218, t_rotation : 0.648, entropy : 0.604 - acc jigsaw : 82.81, class : 74.22 [bs:128]
30/55 of epoch 6/30 jigsaw : 0.345, class : 0.266, t_rotation : 0.439, entropy : 0.401 - acc jigsaw : 85.94, class : 73.44 [bs:128]
Accuracies on val: jigsaw : 94.70, class : 90.54
--------------------------------------------------------
Accuracies on test: jigsaw : 93.31, class : 85.99
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 6
New epoch - lr: 0.001
0/55 of epoch 7/30 jigsaw : 0.413, class : 0.133, t_rotation : 0.437, entropy : 0.420 - acc jigsaw : 89.06, class : 71.09 [bs:128]
30/55 of epoch 7/30 jigsaw : 0.332, class : 0.219, t_rotation : 0.351, entropy : 0.482 - acc jigsaw : 89.06, class : 74.22 [bs:128]
Accuracies on val: jigsaw : 95.21, class : 90.42
--------------------------------------------------------
Accuracies on test: jigsaw : 92.19, class : 87.50
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 7
New epoch - lr: 0.001
0/55 of epoch 8/30 jigsaw : 0.315, class : 0.191, t_rotation : 0.425, entropy : 0.407 - acc jigsaw : 91.41, class : 70.31 [bs:128]
30/55 of epoch 8/30 jigsaw : 0.358, class : 0.223, t_rotation : 0.327, entropy : 0.465 - acc jigsaw : 82.03, class : 72.66 [bs:128]
Accuracies on val: jigsaw : 95.46, class : 92.69
--------------------------------------------------------
Accuracies on test: jigsaw : 94.73, class : 88.33
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 8
New epoch - lr: 0.001
0/55 of epoch 9/30 jigsaw : 0.327, class : 0.127, t_rotation : 0.395, entropy : 0.310 - acc jigsaw : 88.28, class : 79.69 [bs:128]
30/55 of epoch 9/30 jigsaw : 0.337, class : 0.257, t_rotation : 0.316, entropy : 0.329 - acc jigsaw : 88.28, class : 64.06 [bs:128]
Accuracies on val: jigsaw : 96.60, class : 90.54
--------------------------------------------------------
Accuracies on test: jigsaw : 94.87, class : 89.11
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 9
New epoch - lr: 0.001
0/55 of epoch 10/30 jigsaw : 0.282, class : 0.183, t_rotation : 0.338, entropy : 0.300 - acc jigsaw : 92.19, class : 78.91 [bs:128]
30/55 of epoch 10/30 jigsaw : 0.278, class : 0.278, t_rotation : 0.312, entropy : 0.409 - acc jigsaw : 89.06, class : 71.09 [bs:128]
Accuracies on val: jigsaw : 96.22, class : 91.93
--------------------------------------------------------
Accuracies on test: jigsaw : 94.53, class : 89.45
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 10
New epoch - lr: 0.001
0/55 of epoch 11/30 jigsaw : 0.309, class : 0.136, t_rotation : 0.362, entropy : 0.362 - acc jigsaw : 86.72, class : 75.78 [bs:128]
30/55 of epoch 11/30 jigsaw : 0.317, class : 0.115, t_rotation : 0.273, entropy : 0.425 - acc jigsaw : 89.84, class : 78.91 [bs:128]
Accuracies on val: jigsaw : 96.09, class : 91.93
--------------------------------------------------------
Accuracies on test: jigsaw : 93.80, class : 88.57
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 11
New epoch - lr: 0.001
0/55 of epoch 12/30 jigsaw : 0.281, class : 0.121, t_rotation : 0.326, entropy : 0.386 - acc jigsaw : 91.41, class : 68.75 [bs:128]
30/55 of epoch 12/30 jigsaw : 0.215, class : 0.108, t_rotation : 0.301, entropy : 0.327 - acc jigsaw : 91.41, class : 76.56 [bs:128]
Accuracies on val: jigsaw : 96.72, class : 92.31
--------------------------------------------------------
Accuracies on test: jigsaw : 95.70, class : 89.01
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 12
New epoch - lr: 0.001
0/55 of epoch 13/30 jigsaw : 0.206, class : 0.155, t_rotation : 0.342, entropy : 0.261 - acc jigsaw : 91.41, class : 74.22 [bs:128]
30/55 of epoch 13/30 jigsaw : 0.304, class : 0.109, t_rotation : 0.301, entropy : 0.248 - acc jigsaw : 89.84, class : 68.75 [bs:128]
Accuracies on val: jigsaw : 96.97, class : 92.56
--------------------------------------------------------
Accuracies on test: jigsaw : 95.12, class : 89.26
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 13
New epoch - lr: 0.001
0/55 of epoch 14/30 jigsaw : 0.222, class : 0.062, t_rotation : 0.303, entropy : 0.232 - acc jigsaw : 91.41, class : 76.56 [bs:128]
30/55 of epoch 14/30 jigsaw : 0.183, class : 0.044, t_rotation : 0.220, entropy : 0.217 - acc jigsaw : 94.53, class : 71.88 [bs:128]
Accuracies on val: jigsaw : 95.08, class : 92.69
--------------------------------------------------------
Accuracies on test: jigsaw : 96.39, class : 90.09
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 14
New epoch - lr: 0.001
0/55 of epoch 15/30 jigsaw : 0.166, class : 0.079, t_rotation : 0.268, entropy : 0.235 - acc jigsaw : 92.97, class : 72.66 [bs:128]
30/55 of epoch 15/30 jigsaw : 0.249, class : 0.090, t_rotation : 0.246, entropy : 0.256 - acc jigsaw : 89.06, class : 78.91 [bs:128]
Accuracies on val: jigsaw : 96.97, class : 92.69
--------------------------------------------------------
Accuracies on test: jigsaw : 96.88, class : 89.79
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 15
New epoch - lr: 0.001
0/55 of epoch 16/30 jigsaw : 0.226, class : 0.127, t_rotation : 0.221, entropy : 0.179 - acc jigsaw : 92.19, class : 69.53 [bs:128]
30/55 of epoch 16/30 jigsaw : 0.196, class : 0.185, t_rotation : 0.191, entropy : 0.239 - acc jigsaw : 92.97, class : 70.31 [bs:128]
Accuracies on val: jigsaw : 96.47, class : 93.82
--------------------------------------------------------
Accuracies on test: jigsaw : 97.12, class : 89.75
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 16
New epoch - lr: 0.001
0/55 of epoch 17/30 jigsaw : 0.200, class : 0.091, t_rotation : 0.248, entropy : 0.202 - acc jigsaw : 93.75, class : 72.66 [bs:128]
30/55 of epoch 17/30 jigsaw : 0.156, class : 0.062, t_rotation : 0.156, entropy : 0.206 - acc jigsaw : 96.09, class : 72.66 [bs:128]
Accuracies on val: jigsaw : 97.23, class : 93.95
--------------------------------------------------------
Accuracies on test: jigsaw : 96.48, class : 90.33
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 17
New epoch - lr: 0.001
0/55 of epoch 18/30 jigsaw : 0.107, class : 0.098, t_rotation : 0.272, entropy : 0.278 - acc jigsaw : 97.66, class : 76.56 [bs:128]
30/55 of epoch 18/30 jigsaw : 0.275, class : 0.102, t_rotation : 0.191, entropy : 0.181 - acc jigsaw : 85.94, class : 76.56 [bs:128]
Accuracies on val: jigsaw : 96.72, class : 93.19
--------------------------------------------------------
Accuracies on test: jigsaw : 96.34, class : 91.11
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 18
New epoch - lr: 0.001
0/55 of epoch 19/30 jigsaw : 0.344, class : 0.073, t_rotation : 0.287, entropy : 0.226 - acc jigsaw : 85.94, class : 77.34 [bs:128]
30/55 of epoch 19/30 jigsaw : 0.169, class : 0.076, t_rotation : 0.187, entropy : 0.287 - acc jigsaw : 93.75, class : 74.22 [bs:128]
Accuracies on val: jigsaw : 96.47, class : 93.19
--------------------------------------------------------
Accuracies on test: jigsaw : 95.51, class : 90.48
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 19
New epoch - lr: 0.001
0/55 of epoch 20/30 jigsaw : 0.147, class : 0.145, t_rotation : 0.247, entropy : 0.192 - acc jigsaw : 93.75, class : 66.41 [bs:128]
30/55 of epoch 20/30 jigsaw : 0.241, class : 0.097, t_rotation : 0.163, entropy : 0.207 - acc jigsaw : 92.19, class : 74.22 [bs:128]
Accuracies on val: jigsaw : 96.60, class : 94.07
--------------------------------------------------------
Accuracies on test: jigsaw : 96.73, class : 90.48
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 20
New epoch - lr: 0.001
0/55 of epoch 21/30 jigsaw : 0.229, class : 0.080, t_rotation : 0.237, entropy : 0.175 - acc jigsaw : 91.41, class : 77.34 [bs:128]
30/55 of epoch 21/30 jigsaw : 0.254, class : 0.054, t_rotation : 0.124, entropy : 0.176 - acc jigsaw : 89.84, class : 77.34 [bs:128]
Accuracies on val: jigsaw : 97.23, class : 94.20
--------------------------------------------------------
Accuracies on test: jigsaw : 96.83, class : 90.38
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 21
New epoch - lr: 0.001
0/55 of epoch 22/30 jigsaw : 0.155, class : 0.098, t_rotation : 0.208, entropy : 0.197 - acc jigsaw : 92.97, class : 75.00 [bs:128]
30/55 of epoch 22/30 jigsaw : 0.154, class : 0.105, t_rotation : 0.090, entropy : 0.194 - acc jigsaw : 93.75, class : 69.53 [bs:128]
Accuracies on val: jigsaw : 96.34, class : 94.45
--------------------------------------------------------
Accuracies on test: jigsaw : 97.07, class : 90.62
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 22
New epoch - lr: 0.001
0/55 of epoch 23/30 jigsaw : 0.215, class : 0.123, t_rotation : 0.195, entropy : 0.147 - acc jigsaw : 91.41, class : 69.53 [bs:128]
30/55 of epoch 23/30 jigsaw : 0.190, class : 0.056, t_rotation : 0.104, entropy : 0.142 - acc jigsaw : 92.97, class : 74.22 [bs:128]
Accuracies on val: jigsaw : 96.85, class : 94.45
--------------------------------------------------------
Accuracies on test: jigsaw : 98.00, class : 90.58
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 23
New epoch - lr: 0.0001
0/55 of epoch 24/30 jigsaw : 0.254, class : 0.030, t_rotation : 0.201, entropy : 0.146 - acc jigsaw : 92.19, class : 75.78 [bs:128]
30/55 of epoch 24/30 jigsaw : 0.160, class : 0.089, t_rotation : 0.302, entropy : 0.220 - acc jigsaw : 95.31, class : 70.31 [bs:128]
Accuracies on val: jigsaw : 97.35, class : 94.45
--------------------------------------------------------
Accuracies on test: jigsaw : 97.61, class : 90.67
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 24
New epoch - lr: 0.0001
0/55 of epoch 25/30 jigsaw : 0.222, class : 0.040, t_rotation : 0.187, entropy : 0.276 - acc jigsaw : 92.97, class : 62.50 [bs:128]
30/55 of epoch 25/30 jigsaw : 0.234, class : 0.024, t_rotation : 0.309, entropy : 0.186 - acc jigsaw : 92.19, class : 73.44 [bs:128]
Accuracies on val: jigsaw : 97.23, class : 94.33
--------------------------------------------------------
Accuracies on test: jigsaw : 97.56, class : 90.48
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 25
New epoch - lr: 0.0001
0/55 of epoch 26/30 jigsaw : 0.133, class : 0.067, t_rotation : 0.152, entropy : 0.075 - acc jigsaw : 94.53, class : 67.19 [bs:128]
30/55 of epoch 26/30 jigsaw : 0.224, class : 0.020, t_rotation : 0.191, entropy : 0.237 - acc jigsaw : 94.53, class : 78.91 [bs:128]
Accuracies on val: jigsaw : 96.60, class : 94.07
--------------------------------------------------------
Accuracies on test: jigsaw : 97.41, class : 90.62
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 26
New epoch - lr: 0.0001
0/55 of epoch 27/30 jigsaw : 0.093, class : 0.036, t_rotation : 0.138, entropy : 0.251 - acc jigsaw : 95.31, class : 74.22 [bs:128]
30/55 of epoch 27/30 jigsaw : 0.214, class : 0.041, t_rotation : 0.189, entropy : 0.168 - acc jigsaw : 92.19, class : 79.69 [bs:128]
Accuracies on val: jigsaw : 96.34, class : 93.95
--------------------------------------------------------
Accuracies on test: jigsaw : 97.36, class : 90.82
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 27
New epoch - lr: 0.0001
0/55 of epoch 28/30 jigsaw : 0.126, class : 0.085, t_rotation : 0.173, entropy : 0.116 - acc jigsaw : 95.31, class : 74.22 [bs:128]
30/55 of epoch 28/30 jigsaw : 0.166, class : 0.036, t_rotation : 0.278, entropy : 0.206 - acc jigsaw : 93.75, class : 74.22 [bs:128]
Accuracies on val: jigsaw : 96.72, class : 94.45
--------------------------------------------------------
Accuracies on test: jigsaw : 97.66, class : 90.72
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 28
New epoch - lr: 0.0001
0/55 of epoch 29/30 jigsaw : 0.246, class : 0.028, t_rotation : 0.139, entropy : 0.140 - acc jigsaw : 92.19, class : 76.56 [bs:128]
30/55 of epoch 29/30 jigsaw : 0.249, class : 0.075, t_rotation : 0.154, entropy : 0.205 - acc jigsaw : 92.19, class : 74.22 [bs:128]
Accuracies on val: jigsaw : 96.60, class : 94.58
--------------------------------------------------------
Accuracies on test: jigsaw : 97.46, class : 90.77
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 29
New epoch - lr: 0.0001
0/55 of epoch 30/30 jigsaw : 0.163, class : 0.063, t_rotation : 0.289, entropy : 0.272 - acc jigsaw : 93.75, class : 77.34 [bs:128]
30/55 of epoch 30/30 jigsaw : 0.156, class : 0.059, t_rotation : 0.174, entropy : 0.195 - acc jigsaw : 94.53, class : 70.31 [bs:128]
Accuracies on val: jigsaw : 97.10, class : 94.20
--------------------------------------------------------
Accuracies on test: jigsaw : 97.95, class : 90.72
--------------------------------------------------------
2019-12-16 03:48:31
art_painting
['photo', 'sketch', 'cartoon']
unsupervised_task_weight: 0.8
bias_hole_image: 0.3
target_rotation_weight: 0.8
entropy_weight 0.1
only_classify the ordered image: True
Highest accuracy on validation set appears on epoch  tensor(28)
Highest accuracy on test set appears on epoch  tensor(17)
Accuracy on test set when the accuracy on validation set is highest:0.908
Highest accuracy on test set:0.911
It took 1340.14
--------------------------------------------------------
******************Start training**************************************
--------------------------------------------------------
Dataset size: training 7150, validation 793, testing 2048
--------------------------------------------------------
Namespace(TTA=False, batch_size=128, bias_whole_image=0.3, classify_only_ordered_images_or_not=True, domains_list=['photo', 'sketch', 'cartoon', 'art_painting'], entropy_loss_weight=0.1, epochs=30, folder_name='test', image_size=222, jitter=0.4, learning_rate=0.001, limit_source=None, limit_target=None, max_scale=1.0, min_scale=0.8, n_classes=7, nesterov=False, network='resnet18', ooo_weight=0, parameters_lists=[[0.8, 0.3, 0.8, 0.1], [0.8, 0.5, 0.8, 0.1], [0.8, 0.6, 0.8, 0.1]], random_horiz_flip=0.5, repeat_times=3, source=['photo', 'sketch', 'cartoon'], suffix='', target='art_painting', target_domain_list=['art_painting', 'cartoon', 'sketch', 'photo'], target_domain_unsupervised_task_loss_weight=0.8, tf_logger=True, tile_random_grayscale=0.1, train_all=True, unsupervised_task_weight=0.8, val_size=0.1)
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 0
New epoch - lr: 0.001
0/55 of epoch 1/30 jigsaw : 1.780, class : 2.039, t_rotation : 1.731, entropy : 1.806 - acc jigsaw : 16.41, class : 15.62 [bs:128]
30/55 of epoch 1/30 jigsaw : 1.108, class : 1.111, t_rotation : 1.136, entropy : 1.734 - acc jigsaw : 57.81, class : 64.06 [bs:128]
Accuracies on val: jigsaw : 94.70, class : 74.78
--------------------------------------------------------
Accuracies on test: jigsaw : 94.24, class : 63.62
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 1
New epoch - lr: 0.001
0/55 of epoch 2/30 jigsaw : 0.862, class : 0.760, t_rotation : 0.908, entropy : 1.515 - acc jigsaw : 64.84, class : 69.53 [bs:128]
30/55 of epoch 2/30 jigsaw : 0.622, class : 0.540, t_rotation : 0.763, entropy : 1.329 - acc jigsaw : 78.12, class : 68.75 [bs:128]
Accuracies on val: jigsaw : 93.57, class : 83.23
--------------------------------------------------------
Accuracies on test: jigsaw : 87.94, class : 77.73
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 2
New epoch - lr: 0.001
0/55 of epoch 3/30 jigsaw : 0.617, class : 0.424, t_rotation : 0.660, entropy : 1.037 - acc jigsaw : 75.00, class : 63.28 [bs:128]
30/55 of epoch 3/30 jigsaw : 0.606, class : 0.347, t_rotation : 0.602, entropy : 0.846 - acc jigsaw : 73.44, class : 62.50 [bs:128]
Accuracies on val: jigsaw : 94.20, class : 84.24
--------------------------------------------------------
Accuracies on test: jigsaw : 89.89, class : 81.79
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 3
New epoch - lr: 0.001
0/55 of epoch 4/30 jigsaw : 0.574, class : 0.337, t_rotation : 0.687, entropy : 0.701 - acc jigsaw : 78.91, class : 71.88 [bs:128]
30/55 of epoch 4/30 jigsaw : 0.447, class : 0.344, t_rotation : 0.652, entropy : 0.586 - acc jigsaw : 82.03, class : 66.41 [bs:128]
Accuracies on val: jigsaw : 95.59, class : 86.25
--------------------------------------------------------
Accuracies on test: jigsaw : 94.43, class : 84.57
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 4
New epoch - lr: 0.001
0/55 of epoch 5/30 jigsaw : 0.457, class : 0.331, t_rotation : 0.538, entropy : 0.534 - acc jigsaw : 89.06, class : 70.31 [bs:128]
30/55 of epoch 5/30 jigsaw : 0.471, class : 0.229, t_rotation : 0.480, entropy : 0.478 - acc jigsaw : 82.03, class : 77.34 [bs:128]
Accuracies on val: jigsaw : 96.09, class : 87.52
--------------------------------------------------------
Accuracies on test: jigsaw : 94.19, class : 85.84
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 5
New epoch - lr: 0.001
0/55 of epoch 6/30 jigsaw : 0.381, class : 0.237, t_rotation : 0.520, entropy : 0.592 - acc jigsaw : 86.72, class : 74.22 [bs:128]
30/55 of epoch 6/30 jigsaw : 0.330, class : 0.204, t_rotation : 0.348, entropy : 0.525 - acc jigsaw : 89.84, class : 74.22 [bs:128]
Accuracies on val: jigsaw : 94.58, class : 90.16
--------------------------------------------------------
Accuracies on test: jigsaw : 93.02, class : 86.87
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 6
New epoch - lr: 0.001
0/55 of epoch 7/30 jigsaw : 0.335, class : 0.176, t_rotation : 0.435, entropy : 0.415 - acc jigsaw : 90.62, class : 71.09 [bs:128]
30/55 of epoch 7/30 jigsaw : 0.290, class : 0.282, t_rotation : 0.381, entropy : 0.462 - acc jigsaw : 89.84, class : 70.31 [bs:128]
Accuracies on val: jigsaw : 97.35, class : 89.16
--------------------------------------------------------
Accuracies on test: jigsaw : 94.78, class : 86.08
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 7
New epoch - lr: 0.001
0/55 of epoch 8/30 jigsaw : 0.306, class : 0.157, t_rotation : 0.480, entropy : 0.605 - acc jigsaw : 92.19, class : 78.91 [bs:128]
30/55 of epoch 8/30 jigsaw : 0.381, class : 0.231, t_rotation : 0.320, entropy : 0.355 - acc jigsaw : 85.94, class : 69.53 [bs:128]
Accuracies on val: jigsaw : 97.10, class : 89.91
--------------------------------------------------------
Accuracies on test: jigsaw : 95.21, class : 87.60
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 8
New epoch - lr: 0.001
0/55 of epoch 9/30 jigsaw : 0.317, class : 0.126, t_rotation : 0.342, entropy : 0.426 - acc jigsaw : 88.28, class : 67.97 [bs:128]
30/55 of epoch 9/30 jigsaw : 0.180, class : 0.070, t_rotation : 0.343, entropy : 0.393 - acc jigsaw : 94.53, class : 75.00 [bs:128]
Accuracies on val: jigsaw : 97.10, class : 90.16
--------------------------------------------------------
Accuracies on test: jigsaw : 95.90, class : 88.43
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 9
New epoch - lr: 0.001
0/55 of epoch 10/30 jigsaw : 0.216, class : 0.099, t_rotation : 0.366, entropy : 0.342 - acc jigsaw : 95.31, class : 73.44 [bs:128]
30/55 of epoch 10/30 jigsaw : 0.261, class : 0.083, t_rotation : 0.324, entropy : 0.325 - acc jigsaw : 89.84, class : 67.97 [bs:128]
Accuracies on val: jigsaw : 96.22, class : 90.04
--------------------------------------------------------
Accuracies on test: jigsaw : 95.21, class : 88.43
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 10
New epoch - lr: 0.001
0/55 of epoch 11/30 jigsaw : 0.275, class : 0.137, t_rotation : 0.357, entropy : 0.288 - acc jigsaw : 91.41, class : 78.91 [bs:128]
30/55 of epoch 11/30 jigsaw : 0.215, class : 0.122, t_rotation : 0.285, entropy : 0.304 - acc jigsaw : 91.41, class : 75.78 [bs:128]
Accuracies on val: jigsaw : 97.48, class : 89.53
--------------------------------------------------------
Accuracies on test: jigsaw : 95.46, class : 88.28
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 11
New epoch - lr: 0.001
0/55 of epoch 12/30 jigsaw : 0.269, class : 0.042, t_rotation : 0.304, entropy : 0.294 - acc jigsaw : 88.28, class : 75.78 [bs:128]
30/55 of epoch 12/30 jigsaw : 0.306, class : 0.175, t_rotation : 0.260, entropy : 0.280 - acc jigsaw : 89.84, class : 74.22 [bs:128]
Accuracies on val: jigsaw : 96.60, class : 91.80
--------------------------------------------------------
Accuracies on test: jigsaw : 96.24, class : 89.06
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 12
New epoch - lr: 0.001
0/55 of epoch 13/30 jigsaw : 0.268, class : 0.091, t_rotation : 0.364, entropy : 0.255 - acc jigsaw : 89.84, class : 72.66 [bs:128]
30/55 of epoch 13/30 jigsaw : 0.210, class : 0.139, t_rotation : 0.313, entropy : 0.302 - acc jigsaw : 92.19, class : 73.44 [bs:128]
Accuracies on val: jigsaw : 95.71, class : 91.42
--------------------------------------------------------
Accuracies on test: jigsaw : 96.48, class : 89.36
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 13
New epoch - lr: 0.001
0/55 of epoch 14/30 jigsaw : 0.207, class : 0.092, t_rotation : 0.388, entropy : 0.310 - acc jigsaw : 94.53, class : 71.09 [bs:128]
30/55 of epoch 14/30 jigsaw : 0.171, class : 0.081, t_rotation : 0.233, entropy : 0.199 - acc jigsaw : 94.53, class : 75.78 [bs:128]
Accuracies on val: jigsaw : 97.86, class : 92.43
--------------------------------------------------------
Accuracies on test: jigsaw : 96.09, class : 89.06
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 14
New epoch - lr: 0.001
0/55 of epoch 15/30 jigsaw : 0.164, class : 0.132, t_rotation : 0.411, entropy : 0.247 - acc jigsaw : 94.53, class : 80.47 [bs:128]
30/55 of epoch 15/30 jigsaw : 0.304, class : 0.141, t_rotation : 0.125, entropy : 0.207 - acc jigsaw : 89.06, class : 76.56 [bs:128]
Accuracies on val: jigsaw : 98.23, class : 92.69
--------------------------------------------------------
Accuracies on test: jigsaw : 95.95, class : 89.11
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 15
New epoch - lr: 0.001
0/55 of epoch 16/30 jigsaw : 0.211, class : 0.066, t_rotation : 0.229, entropy : 0.256 - acc jigsaw : 92.97, class : 74.22 [bs:128]
30/55 of epoch 16/30 jigsaw : 0.251, class : 0.158, t_rotation : 0.185, entropy : 0.188 - acc jigsaw : 91.41, class : 71.88 [bs:128]
Accuracies on val: jigsaw : 98.11, class : 91.42
--------------------------------------------------------
Accuracies on test: jigsaw : 97.07, class : 88.96
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 16
New epoch - lr: 0.001
0/55 of epoch 17/30 jigsaw : 0.144, class : 0.022, t_rotation : 0.273, entropy : 0.268 - acc jigsaw : 95.31, class : 71.09 [bs:128]
30/55 of epoch 17/30 jigsaw : 0.214, class : 0.161, t_rotation : 0.201, entropy : 0.314 - acc jigsaw : 92.97, class : 75.78 [bs:128]
Accuracies on val: jigsaw : 98.36, class : 93.06
--------------------------------------------------------
Accuracies on test: jigsaw : 96.88, class : 89.79
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 17
New epoch - lr: 0.001
0/55 of epoch 18/30 jigsaw : 0.223, class : 0.120, t_rotation : 0.152, entropy : 0.225 - acc jigsaw : 92.97, class : 75.78 [bs:128]
30/55 of epoch 18/30 jigsaw : 0.290, class : 0.135, t_rotation : 0.188, entropy : 0.237 - acc jigsaw : 89.06, class : 75.78 [bs:128]
Accuracies on val: jigsaw : 97.60, class : 93.44
--------------------------------------------------------
Accuracies on test: jigsaw : 97.12, class : 88.82
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 18
New epoch - lr: 0.001
0/55 of epoch 19/30 jigsaw : 0.230, class : 0.068, t_rotation : 0.253, entropy : 0.245 - acc jigsaw : 92.19, class : 75.00 [bs:128]
30/55 of epoch 19/30 jigsaw : 0.229, class : 0.099, t_rotation : 0.154, entropy : 0.185 - acc jigsaw : 90.62, class : 71.88 [bs:128]
Accuracies on val: jigsaw : 96.47, class : 93.19
--------------------------------------------------------
Accuracies on test: jigsaw : 95.61, class : 89.50
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 19
New epoch - lr: 0.001
0/55 of epoch 20/30 jigsaw : 0.196, class : 0.069, t_rotation : 0.192, entropy : 0.171 - acc jigsaw : 92.19, class : 76.56 [bs:128]
30/55 of epoch 20/30 jigsaw : 0.272, class : 0.087, t_rotation : 0.099, entropy : 0.166 - acc jigsaw : 87.50, class : 74.22 [bs:128]
Accuracies on val: jigsaw : 97.86, class : 93.57
--------------------------------------------------------
Accuracies on test: jigsaw : 97.31, class : 89.99
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 20
New epoch - lr: 0.001
0/55 of epoch 21/30 jigsaw : 0.145, class : 0.121, t_rotation : 0.157, entropy : 0.215 - acc jigsaw : 96.09, class : 75.00 [bs:128]
30/55 of epoch 21/30 jigsaw : 0.188, class : 0.012, t_rotation : 0.148, entropy : 0.260 - acc jigsaw : 93.75, class : 70.31 [bs:128]
Accuracies on val: jigsaw : 97.60, class : 92.94
--------------------------------------------------------
Accuracies on test: jigsaw : 97.07, class : 89.01
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 21
New epoch - lr: 0.001
0/55 of epoch 22/30 jigsaw : 0.160, class : 0.085, t_rotation : 0.227, entropy : 0.213 - acc jigsaw : 92.97, class : 75.00 [bs:128]
30/55 of epoch 22/30 jigsaw : 0.186, class : 0.075, t_rotation : 0.124, entropy : 0.192 - acc jigsaw : 94.53, class : 73.44 [bs:128]
Accuracies on val: jigsaw : 97.23, class : 93.32
--------------------------------------------------------
Accuracies on test: jigsaw : 97.17, class : 90.28
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 22
New epoch - lr: 0.001
0/55 of epoch 23/30 jigsaw : 0.147, class : 0.084, t_rotation : 0.240, entropy : 0.223 - acc jigsaw : 93.75, class : 76.56 [bs:128]
30/55 of epoch 23/30 jigsaw : 0.253, class : 0.122, t_rotation : 0.171, entropy : 0.207 - acc jigsaw : 90.62, class : 80.47 [bs:128]
Accuracies on val: jigsaw : 98.74, class : 94.07
--------------------------------------------------------
Accuracies on test: jigsaw : 96.97, class : 89.70
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 23
New epoch - lr: 0.0001
0/55 of epoch 24/30 jigsaw : 0.158, class : 0.023, t_rotation : 0.166, entropy : 0.217 - acc jigsaw : 93.75, class : 81.25 [bs:128]
30/55 of epoch 24/30 jigsaw : 0.135, class : 0.046, t_rotation : 0.194, entropy : 0.236 - acc jigsaw : 96.09, class : 76.56 [bs:128]
Accuracies on val: jigsaw : 98.74, class : 93.82
--------------------------------------------------------
Accuracies on test: jigsaw : 97.31, class : 89.50
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 24
New epoch - lr: 0.0001
0/55 of epoch 25/30 jigsaw : 0.212, class : 0.069, t_rotation : 0.211, entropy : 0.136 - acc jigsaw : 90.62, class : 66.41 [bs:128]
30/55 of epoch 25/30 jigsaw : 0.110, class : 0.040, t_rotation : 0.230, entropy : 0.263 - acc jigsaw : 96.88, class : 71.09 [bs:128]
Accuracies on val: jigsaw : 98.61, class : 93.82
--------------------------------------------------------
Accuracies on test: jigsaw : 97.12, class : 89.55
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 25
New epoch - lr: 0.0001
0/55 of epoch 26/30 jigsaw : 0.085, class : 0.020, t_rotation : 0.232, entropy : 0.221 - acc jigsaw : 98.44, class : 71.88 [bs:128]
30/55 of epoch 26/30 jigsaw : 0.130, class : 0.040, t_rotation : 0.144, entropy : 0.139 - acc jigsaw : 95.31, class : 73.44 [bs:128]
Accuracies on val: jigsaw : 98.61, class : 93.69
--------------------------------------------------------
Accuracies on test: jigsaw : 97.46, class : 89.55
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 26
New epoch - lr: 0.0001
0/55 of epoch 27/30 jigsaw : 0.158, class : 0.045, t_rotation : 0.170, entropy : 0.153 - acc jigsaw : 94.53, class : 76.56 [bs:128]
30/55 of epoch 27/30 jigsaw : 0.148, class : 0.052, t_rotation : 0.196, entropy : 0.159 - acc jigsaw : 93.75, class : 74.22 [bs:128]
Accuracies on val: jigsaw : 98.49, class : 93.95
--------------------------------------------------------
Accuracies on test: jigsaw : 97.66, class : 89.70
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 27
New epoch - lr: 0.0001
0/55 of epoch 28/30 jigsaw : 0.199, class : 0.030, t_rotation : 0.248, entropy : 0.165 - acc jigsaw : 92.19, class : 76.56 [bs:128]
30/55 of epoch 28/30 jigsaw : 0.279, class : 0.053, t_rotation : 0.150, entropy : 0.202 - acc jigsaw : 92.19, class : 71.88 [bs:128]
Accuracies on val: jigsaw : 98.49, class : 93.82
--------------------------------------------------------
Accuracies on test: jigsaw : 98.00, class : 89.94
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 28
New epoch - lr: 0.0001
0/55 of epoch 29/30 jigsaw : 0.151, class : 0.029, t_rotation : 0.201, entropy : 0.176 - acc jigsaw : 94.53, class : 78.91 [bs:128]
30/55 of epoch 29/30 jigsaw : 0.203, class : 0.117, t_rotation : 0.146, entropy : 0.198 - acc jigsaw : 91.41, class : 72.66 [bs:128]
Accuracies on val: jigsaw : 98.23, class : 94.07
--------------------------------------------------------
Accuracies on test: jigsaw : 98.00, class : 89.60
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 29
New epoch - lr: 0.0001
0/55 of epoch 30/30 jigsaw : 0.154, class : 0.025, t_rotation : 0.271, entropy : 0.151 - acc jigsaw : 94.53, class : 72.66 [bs:128]
30/55 of epoch 30/30 jigsaw : 0.127, class : 0.016, t_rotation : 0.161, entropy : 0.197 - acc jigsaw : 95.31, class : 78.91 [bs:128]
Accuracies on val: jigsaw : 98.11, class : 93.44
--------------------------------------------------------
Accuracies on test: jigsaw : 97.71, class : 89.75
--------------------------------------------------------
2019-12-16 04:11:04
art_painting
['photo', 'sketch', 'cartoon']
unsupervised_task_weight: 0.8
bias_hole_image: 0.3
target_rotation_weight: 0.8
entropy_weight 0.1
only_classify the ordered image: True
Highest accuracy on validation set appears on epoch  tensor(28)
Highest accuracy on test set appears on epoch  tensor(21)
Accuracy on test set when the accuracy on validation set is highest:0.896
Highest accuracy on test set:0.903
It took 1352.7
--------------------------------------------------------
******************Start training**************************************
--------------------------------------------------------
Dataset size: training 7150, validation 793, testing 2048
--------------------------------------------------------
Namespace(TTA=False, batch_size=128, bias_whole_image=0.3, classify_only_ordered_images_or_not=True, domains_list=['photo', 'sketch', 'cartoon', 'art_painting'], entropy_loss_weight=0.1, epochs=30, folder_name='test', image_size=222, jitter=0.4, learning_rate=0.001, limit_source=None, limit_target=None, max_scale=1.0, min_scale=0.8, n_classes=7, nesterov=False, network='resnet18', ooo_weight=0, parameters_lists=[[0.8, 0.3, 0.8, 0.1], [0.8, 0.5, 0.8, 0.1], [0.8, 0.6, 0.8, 0.1]], random_horiz_flip=0.5, repeat_times=3, source=['photo', 'sketch', 'cartoon'], suffix='', target='art_painting', target_domain_list=['art_painting', 'cartoon', 'sketch', 'photo'], target_domain_unsupervised_task_loss_weight=0.8, tf_logger=True, tile_random_grayscale=0.1, train_all=True, unsupervised_task_weight=0.8, val_size=0.1)
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 0
New epoch - lr: 0.001
0/55 of epoch 1/30 jigsaw : 1.511, class : 2.275, t_rotation : 1.453, entropy : 1.790 - acc jigsaw : 27.34, class : 13.28 [bs:128]
30/55 of epoch 1/30 jigsaw : 1.032, class : 1.236, t_rotation : 1.089, entropy : 1.718 - acc jigsaw : 63.28, class : 45.31 [bs:128]
Accuracies on val: jigsaw : 96.22, class : 75.28
--------------------------------------------------------
Accuracies on test: jigsaw : 92.53, class : 61.91
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 1
New epoch - lr: 0.001
0/55 of epoch 2/30 jigsaw : 0.749, class : 0.803, t_rotation : 1.080, entropy : 1.516 - acc jigsaw : 67.97, class : 71.09 [bs:128]
30/55 of epoch 2/30 jigsaw : 0.692, class : 0.687, t_rotation : 0.887, entropy : 1.222 - acc jigsaw : 71.09, class : 67.19 [bs:128]
Accuracies on val: jigsaw : 95.08, class : 82.35
--------------------------------------------------------
Accuracies on test: jigsaw : 92.19, class : 76.86
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 2
New epoch - lr: 0.001
0/55 of epoch 3/30 jigsaw : 0.596, class : 0.501, t_rotation : 0.803, entropy : 1.039 - acc jigsaw : 76.56, class : 71.88 [bs:128]
30/55 of epoch 3/30 jigsaw : 0.676, class : 0.306, t_rotation : 0.647, entropy : 0.772 - acc jigsaw : 70.31, class : 68.75 [bs:128]
Accuracies on val: jigsaw : 95.71, class : 88.40
--------------------------------------------------------
Accuracies on test: jigsaw : 92.19, class : 80.52
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 3
New epoch - lr: 0.001
0/55 of epoch 4/30 jigsaw : 0.606, class : 0.314, t_rotation : 0.662, entropy : 0.852 - acc jigsaw : 75.00, class : 73.44 [bs:128]
30/55 of epoch 4/30 jigsaw : 0.482, class : 0.424, t_rotation : 0.513, entropy : 0.610 - acc jigsaw : 81.25, class : 71.09 [bs:128]
Accuracies on val: jigsaw : 95.71, class : 89.66
--------------------------------------------------------
Accuracies on test: jigsaw : 90.72, class : 82.91
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 4
New epoch - lr: 0.001
0/55 of epoch 5/30 jigsaw : 0.413, class : 0.260, t_rotation : 0.532, entropy : 0.573 - acc jigsaw : 86.72, class : 73.44 [bs:128]
30/55 of epoch 5/30 jigsaw : 0.481, class : 0.217, t_rotation : 0.482, entropy : 0.379 - acc jigsaw : 85.16, class : 71.09 [bs:128]
Accuracies on val: jigsaw : 95.08, class : 90.16
--------------------------------------------------------
Accuracies on test: jigsaw : 92.19, class : 84.52
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 5
New epoch - lr: 0.001
0/55 of epoch 6/30 jigsaw : 0.474, class : 0.265, t_rotation : 0.428, entropy : 0.469 - acc jigsaw : 84.38, class : 75.00 [bs:128]
30/55 of epoch 6/30 jigsaw : 0.473, class : 0.175, t_rotation : 0.506, entropy : 0.559 - acc jigsaw : 81.25, class : 75.78 [bs:128]
Accuracies on val: jigsaw : 95.46, class : 92.43
--------------------------------------------------------
Accuracies on test: jigsaw : 93.31, class : 85.16
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 6
New epoch - lr: 0.001
0/55 of epoch 7/30 jigsaw : 0.369, class : 0.226, t_rotation : 0.596, entropy : 0.515 - acc jigsaw : 86.72, class : 76.56 [bs:128]
30/55 of epoch 7/30 jigsaw : 0.364, class : 0.146, t_rotation : 0.364, entropy : 0.392 - acc jigsaw : 85.16, class : 73.44 [bs:128]
Accuracies on val: jigsaw : 95.71, class : 92.81
--------------------------------------------------------
Accuracies on test: jigsaw : 94.68, class : 87.21
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 7
New epoch - lr: 0.001
0/55 of epoch 8/30 jigsaw : 0.395, class : 0.233, t_rotation : 0.437, entropy : 0.393 - acc jigsaw : 86.72, class : 71.88 [bs:128]
30/55 of epoch 8/30 jigsaw : 0.365, class : 0.233, t_rotation : 0.343, entropy : 0.442 - acc jigsaw : 85.16, class : 77.34 [bs:128]
Accuracies on val: jigsaw : 95.33, class : 93.06
--------------------------------------------------------
Accuracies on test: jigsaw : 92.97, class : 85.89
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 8
New epoch - lr: 0.001
0/55 of epoch 9/30 jigsaw : 0.338, class : 0.121, t_rotation : 0.305, entropy : 0.379 - acc jigsaw : 88.28, class : 74.22 [bs:128]
30/55 of epoch 9/30 jigsaw : 0.201, class : 0.182, t_rotation : 0.312, entropy : 0.352 - acc jigsaw : 93.75, class : 71.09 [bs:128]
Accuracies on val: jigsaw : 96.09, class : 92.56
--------------------------------------------------------
Accuracies on test: jigsaw : 93.90, class : 86.28
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 9
New epoch - lr: 0.001
0/55 of epoch 10/30 jigsaw : 0.349, class : 0.214, t_rotation : 0.313, entropy : 0.470 - acc jigsaw : 83.59, class : 73.44 [bs:128]
30/55 of epoch 10/30 jigsaw : 0.320, class : 0.187, t_rotation : 0.294, entropy : 0.376 - acc jigsaw : 85.16, class : 73.44 [bs:128]
Accuracies on val: jigsaw : 96.60, class : 92.94
--------------------------------------------------------
Accuracies on test: jigsaw : 93.95, class : 88.18
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 10
New epoch - lr: 0.001
0/55 of epoch 11/30 jigsaw : 0.224, class : 0.105, t_rotation : 0.334, entropy : 0.333 - acc jigsaw : 92.19, class : 71.09 [bs:128]
30/55 of epoch 11/30 jigsaw : 0.272, class : 0.094, t_rotation : 0.301, entropy : 0.367 - acc jigsaw : 93.75, class : 77.34 [bs:128]
Accuracies on val: jigsaw : 95.21, class : 92.69
--------------------------------------------------------
Accuracies on test: jigsaw : 94.34, class : 87.74
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 11
New epoch - lr: 0.001
0/55 of epoch 12/30 jigsaw : 0.168, class : 0.049, t_rotation : 0.248, entropy : 0.250 - acc jigsaw : 94.53, class : 74.22 [bs:128]
30/55 of epoch 12/30 jigsaw : 0.290, class : 0.090, t_rotation : 0.318, entropy : 0.336 - acc jigsaw : 88.28, class : 75.78 [bs:128]
Accuracies on val: jigsaw : 96.22, class : 93.06
--------------------------------------------------------
Accuracies on test: jigsaw : 95.46, class : 87.70
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 12
New epoch - lr: 0.001
0/55 of epoch 13/30 jigsaw : 0.281, class : 0.168, t_rotation : 0.356, entropy : 0.279 - acc jigsaw : 91.41, class : 76.56 [bs:128]
30/55 of epoch 13/30 jigsaw : 0.219, class : 0.117, t_rotation : 0.212, entropy : 0.251 - acc jigsaw : 92.19, class : 72.66 [bs:128]
Accuracies on val: jigsaw : 96.09, class : 92.81
--------------------------------------------------------
Accuracies on test: jigsaw : 95.75, class : 87.30
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 13
New epoch - lr: 0.001
0/55 of epoch 14/30 jigsaw : 0.205, class : 0.073, t_rotation : 0.351, entropy : 0.274 - acc jigsaw : 92.19, class : 70.31 [bs:128]
30/55 of epoch 14/30 jigsaw : 0.229, class : 0.160, t_rotation : 0.131, entropy : 0.220 - acc jigsaw : 92.97, class : 76.56 [bs:128]
Accuracies on val: jigsaw : 94.33, class : 93.82
--------------------------------------------------------
Accuracies on test: jigsaw : 95.12, class : 87.94
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 14
New epoch - lr: 0.001
0/55 of epoch 15/30 jigsaw : 0.204, class : 0.045, t_rotation : 0.387, entropy : 0.287 - acc jigsaw : 92.19, class : 74.22 [bs:128]
30/55 of epoch 15/30 jigsaw : 0.237, class : 0.164, t_rotation : 0.227, entropy : 0.277 - acc jigsaw : 90.62, class : 67.19 [bs:128]
Accuracies on val: jigsaw : 96.09, class : 94.33
--------------------------------------------------------
Accuracies on test: jigsaw : 96.04, class : 87.65
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 15
New epoch - lr: 0.001
0/55 of epoch 16/30 jigsaw : 0.212, class : 0.111, t_rotation : 0.254, entropy : 0.168 - acc jigsaw : 92.19, class : 71.09 [bs:128]
30/55 of epoch 16/30 jigsaw : 0.177, class : 0.079, t_rotation : 0.170, entropy : 0.306 - acc jigsaw : 92.97, class : 72.66 [bs:128]
Accuracies on val: jigsaw : 95.71, class : 93.69
--------------------------------------------------------
Accuracies on test: jigsaw : 96.68, class : 88.09
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 16
New epoch - lr: 0.001
0/55 of epoch 17/30 jigsaw : 0.234, class : 0.059, t_rotation : 0.383, entropy : 0.350 - acc jigsaw : 89.06, class : 76.56 [bs:128]
30/55 of epoch 17/30 jigsaw : 0.286, class : 0.057, t_rotation : 0.175, entropy : 0.282 - acc jigsaw : 89.84, class : 82.03 [bs:128]
Accuracies on val: jigsaw : 95.96, class : 94.33
--------------------------------------------------------
Accuracies on test: jigsaw : 96.39, class : 88.04
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 17
New epoch - lr: 0.001
0/55 of epoch 18/30 jigsaw : 0.282, class : 0.074, t_rotation : 0.204, entropy : 0.178 - acc jigsaw : 87.50, class : 76.56 [bs:128]
30/55 of epoch 18/30 jigsaw : 0.196, class : 0.046, t_rotation : 0.233, entropy : 0.230 - acc jigsaw : 93.75, class : 80.47 [bs:128]
Accuracies on val: jigsaw : 96.09, class : 94.45
--------------------------------------------------------
Accuracies on test: jigsaw : 95.85, class : 88.48
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 18
New epoch - lr: 0.001
0/55 of epoch 19/30 jigsaw : 0.209, class : 0.092, t_rotation : 0.212, entropy : 0.267 - acc jigsaw : 90.62, class : 71.88 [bs:128]
30/55 of epoch 19/30 jigsaw : 0.189, class : 0.078, t_rotation : 0.139, entropy : 0.260 - acc jigsaw : 93.75, class : 82.03 [bs:128]
Accuracies on val: jigsaw : 96.34, class : 93.95
--------------------------------------------------------
Accuracies on test: jigsaw : 96.92, class : 89.70
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 19
New epoch - lr: 0.001
0/55 of epoch 20/30 jigsaw : 0.139, class : 0.033, t_rotation : 0.270, entropy : 0.274 - acc jigsaw : 94.53, class : 79.69 [bs:128]
30/55 of epoch 20/30 jigsaw : 0.097, class : 0.080, t_rotation : 0.148, entropy : 0.146 - acc jigsaw : 96.88, class : 70.31 [bs:128]
Accuracies on val: jigsaw : 94.83, class : 94.58
--------------------------------------------------------
Accuracies on test: jigsaw : 96.78, class : 89.36
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 20
New epoch - lr: 0.001
0/55 of epoch 21/30 jigsaw : 0.104, class : 0.092, t_rotation : 0.181, entropy : 0.257 - acc jigsaw : 98.44, class : 72.66 [bs:128]
30/55 of epoch 21/30 jigsaw : 0.185, class : 0.061, t_rotation : 0.114, entropy : 0.249 - acc jigsaw : 92.97, class : 76.56 [bs:128]
Accuracies on val: jigsaw : 96.22, class : 94.58
--------------------------------------------------------
Accuracies on test: jigsaw : 97.80, class : 89.65
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 21
New epoch - lr: 0.001
0/55 of epoch 22/30 jigsaw : 0.163, class : 0.051, t_rotation : 0.149, entropy : 0.203 - acc jigsaw : 93.75, class : 78.12 [bs:128]
30/55 of epoch 22/30 jigsaw : 0.224, class : 0.091, t_rotation : 0.154, entropy : 0.091 - acc jigsaw : 90.62, class : 82.81 [bs:128]
Accuracies on val: jigsaw : 95.21, class : 94.58
--------------------------------------------------------
Accuracies on test: jigsaw : 97.27, class : 89.06
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 22
New epoch - lr: 0.001
0/55 of epoch 23/30 jigsaw : 0.152, class : 0.017, t_rotation : 0.225, entropy : 0.205 - acc jigsaw : 95.31, class : 76.56 [bs:128]
30/55 of epoch 23/30 jigsaw : 0.170, class : 0.054, t_rotation : 0.082, entropy : 0.146 - acc jigsaw : 94.53, class : 76.56 [bs:128]
Accuracies on val: jigsaw : 96.22, class : 95.46
--------------------------------------------------------
Accuracies on test: jigsaw : 96.48, class : 89.26
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 23
New epoch - lr: 0.0001
0/55 of epoch 24/30 jigsaw : 0.149, class : 0.098, t_rotation : 0.140, entropy : 0.175 - acc jigsaw : 94.53, class : 78.91 [bs:128]
30/55 of epoch 24/30 jigsaw : 0.211, class : 0.016, t_rotation : 0.242, entropy : 0.129 - acc jigsaw : 90.62, class : 79.69 [bs:128]
Accuracies on val: jigsaw : 97.10, class : 95.71
--------------------------------------------------------
Accuracies on test: jigsaw : 97.41, class : 89.60
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 24
New epoch - lr: 0.0001
0/55 of epoch 25/30 jigsaw : 0.183, class : 0.038, t_rotation : 0.250, entropy : 0.231 - acc jigsaw : 93.75, class : 76.56 [bs:128]
30/55 of epoch 25/30 jigsaw : 0.167, class : 0.051, t_rotation : 0.141, entropy : 0.155 - acc jigsaw : 93.75, class : 78.12 [bs:128]
Accuracies on val: jigsaw : 96.47, class : 95.59
--------------------------------------------------------
Accuracies on test: jigsaw : 97.36, class : 89.70
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 25
New epoch - lr: 0.0001
0/55 of epoch 26/30 jigsaw : 0.194, class : 0.021, t_rotation : 0.116, entropy : 0.168 - acc jigsaw : 93.75, class : 76.56 [bs:128]
30/55 of epoch 26/30 jigsaw : 0.144, class : 0.025, t_rotation : 0.262, entropy : 0.236 - acc jigsaw : 92.19, class : 76.56 [bs:128]
Accuracies on val: jigsaw : 96.97, class : 95.33
--------------------------------------------------------
Accuracies on test: jigsaw : 97.56, class : 89.60
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 26
New epoch - lr: 0.0001
0/55 of epoch 27/30 jigsaw : 0.150, class : 0.014, t_rotation : 0.159, entropy : 0.128 - acc jigsaw : 96.09, class : 76.56 [bs:128]
30/55 of epoch 27/30 jigsaw : 0.200, class : 0.041, t_rotation : 0.219, entropy : 0.241 - acc jigsaw : 92.97, class : 82.03 [bs:128]
Accuracies on val: jigsaw : 96.60, class : 95.46
--------------------------------------------------------
Accuracies on test: jigsaw : 98.14, class : 89.55
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 27
New epoch - lr: 0.0001
0/55 of epoch 28/30 jigsaw : 0.140, class : 0.034, t_rotation : 0.197, entropy : 0.238 - acc jigsaw : 94.53, class : 78.91 [bs:128]
30/55 of epoch 28/30 jigsaw : 0.134, class : 0.038, t_rotation : 0.132, entropy : 0.159 - acc jigsaw : 95.31, class : 80.47 [bs:128]
Accuracies on val: jigsaw : 96.72, class : 95.59
--------------------------------------------------------
Accuracies on test: jigsaw : 97.71, class : 89.31
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 28
New epoch - lr: 0.0001
0/55 of epoch 29/30 jigsaw : 0.147, class : 0.078, t_rotation : 0.148, entropy : 0.148 - acc jigsaw : 93.75, class : 77.34 [bs:128]
30/55 of epoch 29/30 jigsaw : 0.127, class : 0.052, t_rotation : 0.091, entropy : 0.151 - acc jigsaw : 94.53, class : 79.69 [bs:128]
Accuracies on val: jigsaw : 97.23, class : 95.46
--------------------------------------------------------
Accuracies on test: jigsaw : 98.10, class : 89.60
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 29
New epoch - lr: 0.0001
0/55 of epoch 30/30 jigsaw : 0.198, class : 0.036, t_rotation : 0.272, entropy : 0.198 - acc jigsaw : 91.41, class : 81.25 [bs:128]
30/55 of epoch 30/30 jigsaw : 0.146, class : 0.049, t_rotation : 0.132, entropy : 0.111 - acc jigsaw : 96.88, class : 80.47 [bs:128]
Accuracies on val: jigsaw : 96.97, class : 95.84
--------------------------------------------------------
Accuracies on test: jigsaw : 98.44, class : 89.40
--------------------------------------------------------
2019-12-16 04:34:16
art_painting
['photo', 'sketch', 'cartoon']
unsupervised_task_weight: 0.8
bias_hole_image: 0.3
target_rotation_weight: 0.8
entropy_weight 0.1
only_classify the ordered image: True
Highest accuracy on validation set appears on epoch  tensor(29)
Highest accuracy on test set appears on epoch  tensor(24)
Accuracy on test set when the accuracy on validation set is highest:0.894
Highest accuracy on test set:0.897
It took 1391.07
--------------------------------------------------------
******************Start training**************************************
--------------------------------------------------------
Dataset size: training 6884, validation 763, testing 2344
--------------------------------------------------------
Namespace(TTA=False, batch_size=128, bias_whole_image=0.3, classify_only_ordered_images_or_not=True, domains_list=['photo', 'sketch', 'cartoon', 'art_painting'], entropy_loss_weight=0.1, epochs=30, folder_name='test', image_size=222, jitter=0.4, learning_rate=0.001, limit_source=None, limit_target=None, max_scale=1.0, min_scale=0.8, n_classes=7, nesterov=False, network='resnet18', ooo_weight=0, parameters_lists=[[0.8, 0.3, 0.8, 0.1], [0.8, 0.5, 0.8, 0.1], [0.8, 0.6, 0.8, 0.1]], random_horiz_flip=0.5, repeat_times=3, source=['photo', 'sketch', 'art_painting'], suffix='', target='cartoon', target_domain_list=['art_painting', 'cartoon', 'sketch', 'photo'], target_domain_unsupervised_task_loss_weight=0.8, tf_logger=True, tile_random_grayscale=0.1, train_all=True, unsupervised_task_weight=0.8, val_size=0.1)
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 0
New epoch - lr: 0.001
0/53 of epoch 1/30 jigsaw : 1.431, class : 2.130, t_rotation : 1.467, entropy : 1.737 - acc jigsaw : 31.25, class : 25.00 [bs:128]
30/53 of epoch 1/30 jigsaw : 1.026, class : 1.235, t_rotation : 1.064, entropy : 1.689 - acc jigsaw : 57.03, class : 55.47 [bs:128]
Accuracies on val: jigsaw : 90.56, class : 78.90
--------------------------------------------------------
Accuracies on test: jigsaw : 92.28, class : 58.11
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 1
New epoch - lr: 0.001
0/53 of epoch 2/30 jigsaw : 0.917, class : 0.637, t_rotation : 0.937, entropy : 1.510 - acc jigsaw : 62.50, class : 64.84 [bs:128]
30/53 of epoch 2/30 jigsaw : 0.712, class : 0.458, t_rotation : 0.738, entropy : 1.024 - acc jigsaw : 75.00, class : 72.66 [bs:128]
Accuracies on val: jigsaw : 88.07, class : 87.42
--------------------------------------------------------
Accuracies on test: jigsaw : 93.17, class : 72.48
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 2
New epoch - lr: 0.001
0/53 of epoch 3/30 jigsaw : 0.720, class : 0.369, t_rotation : 0.709, entropy : 1.102 - acc jigsaw : 69.53, class : 71.09 [bs:128]
30/53 of epoch 3/30 jigsaw : 0.553, class : 0.445, t_rotation : 0.611, entropy : 0.959 - acc jigsaw : 78.12, class : 66.41 [bs:128]
Accuracies on val: jigsaw : 91.74, class : 87.94
--------------------------------------------------------
Accuracies on test: jigsaw : 97.35, class : 75.98
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 3
New epoch - lr: 0.001
0/53 of epoch 4/30 jigsaw : 0.640, class : 0.306, t_rotation : 0.581, entropy : 0.821 - acc jigsaw : 75.78, class : 67.19 [bs:128]
30/53 of epoch 4/30 jigsaw : 0.564, class : 0.346, t_rotation : 0.489, entropy : 0.632 - acc jigsaw : 79.69, class : 69.53 [bs:128]
Accuracies on val: jigsaw : 90.30, class : 89.65
--------------------------------------------------------
Accuracies on test: jigsaw : 96.08, class : 76.58
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 4
New epoch - lr: 0.001
0/53 of epoch 5/30 jigsaw : 0.525, class : 0.277, t_rotation : 0.364, entropy : 0.565 - acc jigsaw : 79.69, class : 66.41 [bs:128]
30/53 of epoch 5/30 jigsaw : 0.643, class : 0.206, t_rotation : 0.382, entropy : 0.705 - acc jigsaw : 74.22, class : 77.34 [bs:128]
Accuracies on val: jigsaw : 92.27, class : 90.96
--------------------------------------------------------
Accuracies on test: jigsaw : 96.54, class : 78.11
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 5
New epoch - lr: 0.001
0/53 of epoch 6/30 jigsaw : 0.474, class : 0.221, t_rotation : 0.411, entropy : 0.496 - acc jigsaw : 79.69, class : 71.88 [bs:128]
30/53 of epoch 6/30 jigsaw : 0.481, class : 0.323, t_rotation : 0.299, entropy : 0.609 - acc jigsaw : 83.59, class : 70.31 [bs:128]
Accuracies on val: jigsaw : 92.01, class : 92.27
--------------------------------------------------------
Accuracies on test: jigsaw : 96.46, class : 78.92
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 6
New epoch - lr: 0.001
0/53 of epoch 7/30 jigsaw : 0.517, class : 0.147, t_rotation : 0.277, entropy : 0.570 - acc jigsaw : 76.56, class : 67.97 [bs:128]
30/53 of epoch 7/30 jigsaw : 0.374, class : 0.195, t_rotation : 0.283, entropy : 0.430 - acc jigsaw : 86.72, class : 74.22 [bs:128]
Accuracies on val: jigsaw : 93.84, class : 91.61
--------------------------------------------------------
Accuracies on test: jigsaw : 97.95, class : 80.29
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 7
New epoch - lr: 0.001
0/53 of epoch 8/30 jigsaw : 0.360, class : 0.248, t_rotation : 0.252, entropy : 0.384 - acc jigsaw : 85.16, class : 65.62 [bs:128]
30/53 of epoch 8/30 jigsaw : 0.360, class : 0.133, t_rotation : 0.215, entropy : 0.354 - acc jigsaw : 89.06, class : 72.66 [bs:128]
Accuracies on val: jigsaw : 93.18, class : 92.79
--------------------------------------------------------
Accuracies on test: jigsaw : 97.40, class : 80.55
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 8
New epoch - lr: 0.001
0/53 of epoch 9/30 jigsaw : 0.390, class : 0.164, t_rotation : 0.284, entropy : 0.401 - acc jigsaw : 88.28, class : 70.31 [bs:128]
30/53 of epoch 9/30 jigsaw : 0.215, class : 0.121, t_rotation : 0.231, entropy : 0.380 - acc jigsaw : 92.19, class : 71.88 [bs:128]
Accuracies on val: jigsaw : 92.01, class : 93.84
--------------------------------------------------------
Accuracies on test: jigsaw : 96.59, class : 78.67
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 9
New epoch - lr: 0.001
0/53 of epoch 10/30 jigsaw : 0.334, class : 0.112, t_rotation : 0.191, entropy : 0.270 - acc jigsaw : 90.62, class : 66.41 [bs:128]
30/53 of epoch 10/30 jigsaw : 0.284, class : 0.118, t_rotation : 0.153, entropy : 0.285 - acc jigsaw : 90.62, class : 71.09 [bs:128]
Accuracies on val: jigsaw : 92.53, class : 93.71
--------------------------------------------------------
Accuracies on test: jigsaw : 97.61, class : 79.82
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 10
New epoch - lr: 0.001
0/53 of epoch 11/30 jigsaw : 0.324, class : 0.139, t_rotation : 0.185, entropy : 0.436 - acc jigsaw : 85.16, class : 71.88 [bs:128]
30/53 of epoch 11/30 jigsaw : 0.289, class : 0.212, t_rotation : 0.168, entropy : 0.363 - acc jigsaw : 89.84, class : 68.75 [bs:128]
Accuracies on val: jigsaw : 93.05, class : 94.23
--------------------------------------------------------
Accuracies on test: jigsaw : 97.23, class : 80.80
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 11
New epoch - lr: 0.001
0/53 of epoch 12/30 jigsaw : 0.345, class : 0.109, t_rotation : 0.188, entropy : 0.358 - acc jigsaw : 88.28, class : 75.00 [bs:128]
30/53 of epoch 12/30 jigsaw : 0.237, class : 0.192, t_rotation : 0.184, entropy : 0.279 - acc jigsaw : 95.31, class : 74.22 [bs:128]
Accuracies on val: jigsaw : 92.01, class : 94.10
--------------------------------------------------------
Accuracies on test: jigsaw : 97.44, class : 80.67
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 12
New epoch - lr: 0.001
0/53 of epoch 13/30 jigsaw : 0.325, class : 0.053, t_rotation : 0.165, entropy : 0.369 - acc jigsaw : 86.72, class : 75.78 [bs:128]
30/53 of epoch 13/30 jigsaw : 0.344, class : 0.139, t_rotation : 0.151, entropy : 0.338 - acc jigsaw : 88.28, class : 76.56 [bs:128]
Accuracies on val: jigsaw : 94.23, class : 94.23
--------------------------------------------------------
Accuracies on test: jigsaw : 98.12, class : 81.66
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 13
New epoch - lr: 0.001
0/53 of epoch 14/30 jigsaw : 0.214, class : 0.065, t_rotation : 0.183, entropy : 0.329 - acc jigsaw : 89.84, class : 65.62 [bs:128]
30/53 of epoch 14/30 jigsaw : 0.293, class : 0.050, t_rotation : 0.149, entropy : 0.264 - acc jigsaw : 89.84, class : 76.56 [bs:128]
Accuracies on val: jigsaw : 93.18, class : 94.50
--------------------------------------------------------
Accuracies on test: jigsaw : 98.25, class : 81.23
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 14
New epoch - lr: 0.001
0/53 of epoch 15/30 jigsaw : 0.220, class : 0.094, t_rotation : 0.195, entropy : 0.300 - acc jigsaw : 92.19, class : 71.09 [bs:128]
30/53 of epoch 15/30 jigsaw : 0.240, class : 0.210, t_rotation : 0.174, entropy : 0.229 - acc jigsaw : 89.84, class : 67.97 [bs:128]
Accuracies on val: jigsaw : 93.97, class : 94.10
--------------------------------------------------------
Accuracies on test: jigsaw : 98.29, class : 81.44
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 15
New epoch - lr: 0.001
0/53 of epoch 16/30 jigsaw : 0.237, class : 0.103, t_rotation : 0.208, entropy : 0.258 - acc jigsaw : 92.97, class : 69.53 [bs:128]
30/53 of epoch 16/30 jigsaw : 0.313, class : 0.075, t_rotation : 0.098, entropy : 0.286 - acc jigsaw : 88.28, class : 75.00 [bs:128]
Accuracies on val: jigsaw : 92.40, class : 94.50
--------------------------------------------------------
Accuracies on test: jigsaw : 98.55, class : 80.84
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 16
New epoch - lr: 0.001
0/53 of epoch 17/30 jigsaw : 0.252, class : 0.031, t_rotation : 0.103, entropy : 0.270 - acc jigsaw : 91.41, class : 75.00 [bs:128]
30/53 of epoch 17/30 jigsaw : 0.298, class : 0.123, t_rotation : 0.118, entropy : 0.257 - acc jigsaw : 89.06, class : 64.84 [bs:128]
Accuracies on val: jigsaw : 93.58, class : 95.02
--------------------------------------------------------
Accuracies on test: jigsaw : 98.55, class : 82.21
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 17
New epoch - lr: 0.001
0/53 of epoch 18/30 jigsaw : 0.249, class : 0.111, t_rotation : 0.123, entropy : 0.321 - acc jigsaw : 91.41, class : 68.75 [bs:128]
30/53 of epoch 18/30 jigsaw : 0.186, class : 0.015, t_rotation : 0.112, entropy : 0.153 - acc jigsaw : 93.75, class : 75.78 [bs:128]
Accuracies on val: jigsaw : 94.23, class : 95.02
--------------------------------------------------------
Accuracies on test: jigsaw : 98.59, class : 80.97
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 18
New epoch - lr: 0.001
0/53 of epoch 19/30 jigsaw : 0.209, class : 0.076, t_rotation : 0.082, entropy : 0.228 - acc jigsaw : 92.19, class : 69.53 [bs:128]
30/53 of epoch 19/30 jigsaw : 0.268, class : 0.130, t_rotation : 0.099, entropy : 0.215 - acc jigsaw : 89.84, class : 75.78 [bs:128]
Accuracies on val: jigsaw : 93.84, class : 95.02
--------------------------------------------------------
Accuracies on test: jigsaw : 98.25, class : 80.50
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 19
New epoch - lr: 0.001
0/53 of epoch 20/30 jigsaw : 0.275, class : 0.024, t_rotation : 0.111, entropy : 0.256 - acc jigsaw : 91.41, class : 70.31 [bs:128]
30/53 of epoch 20/30 jigsaw : 0.182, class : 0.058, t_rotation : 0.081, entropy : 0.297 - acc jigsaw : 92.19, class : 71.88 [bs:128]
Accuracies on val: jigsaw : 94.50, class : 94.63
--------------------------------------------------------
Accuracies on test: jigsaw : 98.85, class : 82.08
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 20
New epoch - lr: 0.001
0/53 of epoch 21/30 jigsaw : 0.323, class : 0.037, t_rotation : 0.091, entropy : 0.189 - acc jigsaw : 89.84, class : 69.53 [bs:128]
30/53 of epoch 21/30 jigsaw : 0.246, class : 0.023, t_rotation : 0.114, entropy : 0.218 - acc jigsaw : 93.75, class : 74.22 [bs:128]
Accuracies on val: jigsaw : 94.50, class : 94.50
--------------------------------------------------------
Accuracies on test: jigsaw : 98.93, class : 81.91
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 21
New epoch - lr: 0.001
0/53 of epoch 22/30 jigsaw : 0.202, class : 0.013, t_rotation : 0.109, entropy : 0.216 - acc jigsaw : 91.41, class : 80.47 [bs:128]
30/53 of epoch 22/30 jigsaw : 0.236, class : 0.029, t_rotation : 0.093, entropy : 0.201 - acc jigsaw : 89.06, class : 79.69 [bs:128]
Accuracies on val: jigsaw : 94.89, class : 93.97
--------------------------------------------------------
Accuracies on test: jigsaw : 98.81, class : 83.06
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 22
New epoch - lr: 0.001
0/53 of epoch 23/30 jigsaw : 0.180, class : 0.030, t_rotation : 0.172, entropy : 0.184 - acc jigsaw : 94.53, class : 82.81 [bs:128]
30/53 of epoch 23/30 jigsaw : 0.148, class : 0.041, t_rotation : 0.055, entropy : 0.206 - acc jigsaw : 94.53, class : 72.66 [bs:128]
Accuracies on val: jigsaw : 93.18, class : 94.76
--------------------------------------------------------
Accuracies on test: jigsaw : 98.34, class : 82.21
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 23
New epoch - lr: 0.0001
0/53 of epoch 24/30 jigsaw : 0.164, class : 0.072, t_rotation : 0.099, entropy : 0.170 - acc jigsaw : 96.09, class : 69.53 [bs:128]
30/53 of epoch 24/30 jigsaw : 0.223, class : 0.049, t_rotation : 0.079, entropy : 0.195 - acc jigsaw : 92.97, class : 76.56 [bs:128]
Accuracies on val: jigsaw : 94.50, class : 94.76
--------------------------------------------------------
Accuracies on test: jigsaw : 98.89, class : 82.38
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 24
New epoch - lr: 0.0001
0/53 of epoch 25/30 jigsaw : 0.139, class : 0.013, t_rotation : 0.089, entropy : 0.239 - acc jigsaw : 96.09, class : 70.31 [bs:128]
30/53 of epoch 25/30 jigsaw : 0.328, class : 0.090, t_rotation : 0.174, entropy : 0.293 - acc jigsaw : 88.28, class : 79.69 [bs:128]
Accuracies on val: jigsaw : 93.84, class : 94.89
--------------------------------------------------------
Accuracies on test: jigsaw : 98.68, class : 82.42
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 25
New epoch - lr: 0.0001
0/53 of epoch 26/30 jigsaw : 0.216, class : 0.064, t_rotation : 0.121, entropy : 0.179 - acc jigsaw : 90.62, class : 72.66 [bs:128]
30/53 of epoch 26/30 jigsaw : 0.223, class : 0.088, t_rotation : 0.058, entropy : 0.189 - acc jigsaw : 92.97, class : 71.09 [bs:128]
Accuracies on val: jigsaw : 94.89, class : 95.02
--------------------------------------------------------
Accuracies on test: jigsaw : 99.02, class : 82.12
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 26
New epoch - lr: 0.0001
0/53 of epoch 27/30 jigsaw : 0.285, class : 0.094, t_rotation : 0.069, entropy : 0.219 - acc jigsaw : 89.84, class : 81.25 [bs:128]
30/53 of epoch 27/30 jigsaw : 0.124, class : 0.056, t_rotation : 0.158, entropy : 0.254 - acc jigsaw : 94.53, class : 68.75 [bs:128]
Accuracies on val: jigsaw : 94.50, class : 94.76
--------------------------------------------------------
Accuracies on test: jigsaw : 99.15, class : 82.72
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 27
New epoch - lr: 0.0001
0/53 of epoch 28/30 jigsaw : 0.193, class : 0.032, t_rotation : 0.096, entropy : 0.240 - acc jigsaw : 92.19, class : 74.22 [bs:128]
30/53 of epoch 28/30 jigsaw : 0.212, class : 0.072, t_rotation : 0.108, entropy : 0.257 - acc jigsaw : 91.41, class : 69.53 [bs:128]
Accuracies on val: jigsaw : 94.23, class : 94.76
--------------------------------------------------------
Accuracies on test: jigsaw : 98.98, class : 82.08
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 28
New epoch - lr: 0.0001
0/53 of epoch 29/30 jigsaw : 0.192, class : 0.024, t_rotation : 0.132, entropy : 0.164 - acc jigsaw : 92.97, class : 74.22 [bs:128]
30/53 of epoch 29/30 jigsaw : 0.176, class : 0.040, t_rotation : 0.073, entropy : 0.206 - acc jigsaw : 95.31, class : 70.31 [bs:128]
Accuracies on val: jigsaw : 94.10, class : 95.15
--------------------------------------------------------
Accuracies on test: jigsaw : 98.68, class : 82.25
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 29
New epoch - lr: 0.0001
0/53 of epoch 30/30 jigsaw : 0.156, class : 0.018, t_rotation : 0.061, entropy : 0.181 - acc jigsaw : 94.53, class : 72.66 [bs:128]
30/53 of epoch 30/30 jigsaw : 0.149, class : 0.037, t_rotation : 0.061, entropy : 0.129 - acc jigsaw : 93.75, class : 66.41 [bs:128]
Accuracies on val: jigsaw : 95.02, class : 94.89
--------------------------------------------------------
Accuracies on test: jigsaw : 99.32, class : 82.47
--------------------------------------------------------
2019-12-16 04:56:47
cartoon
['photo', 'sketch', 'art_painting']
unsupervised_task_weight: 0.8
bias_hole_image: 0.3
target_rotation_weight: 0.8
entropy_weight 0.1
only_classify the ordered image: True
Highest accuracy on validation set appears on epoch  tensor(28)
Highest accuracy on test set appears on epoch  tensor(21)
Accuracy on test set when the accuracy on validation set is highest:0.823
Highest accuracy on test set:0.831
It took 1350.61
--------------------------------------------------------
******************Start training**************************************
--------------------------------------------------------
Dataset size: training 6884, validation 763, testing 2344
--------------------------------------------------------
Namespace(TTA=False, batch_size=128, bias_whole_image=0.3, classify_only_ordered_images_or_not=True, domains_list=['photo', 'sketch', 'cartoon', 'art_painting'], entropy_loss_weight=0.1, epochs=30, folder_name='test', image_size=222, jitter=0.4, learning_rate=0.001, limit_source=None, limit_target=None, max_scale=1.0, min_scale=0.8, n_classes=7, nesterov=False, network='resnet18', ooo_weight=0, parameters_lists=[[0.8, 0.3, 0.8, 0.1], [0.8, 0.5, 0.8, 0.1], [0.8, 0.6, 0.8, 0.1]], random_horiz_flip=0.5, repeat_times=3, source=['photo', 'sketch', 'art_painting'], suffix='', target='cartoon', target_domain_list=['art_painting', 'cartoon', 'sketch', 'photo'], target_domain_unsupervised_task_loss_weight=0.8, tf_logger=True, tile_random_grayscale=0.1, train_all=True, unsupervised_task_weight=0.8, val_size=0.1)
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 0
New epoch - lr: 0.001
0/53 of epoch 1/30 jigsaw : 1.407, class : 2.185, t_rotation : 1.427, entropy : 1.736 - acc jigsaw : 25.00, class : 11.72 [bs:128]
30/53 of epoch 1/30 jigsaw : 1.062, class : 1.379, t_rotation : 1.085, entropy : 1.694 - acc jigsaw : 54.69, class : 42.19 [bs:128]
Accuracies on val: jigsaw : 92.92, class : 69.86
--------------------------------------------------------
Accuracies on test: jigsaw : 92.28, class : 59.98
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 1
New epoch - lr: 0.001
0/53 of epoch 2/30 jigsaw : 0.836, class : 0.877, t_rotation : 0.953, entropy : 1.418 - acc jigsaw : 66.41, class : 58.59 [bs:128]
30/53 of epoch 2/30 jigsaw : 0.676, class : 0.499, t_rotation : 0.711, entropy : 1.208 - acc jigsaw : 76.56, class : 71.88 [bs:128]
Accuracies on val: jigsaw : 91.22, class : 82.57
--------------------------------------------------------
Accuracies on test: jigsaw : 95.31, class : 68.22
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 2
New epoch - lr: 0.001
0/53 of epoch 3/30 jigsaw : 0.659, class : 0.494, t_rotation : 0.658, entropy : 0.996 - acc jigsaw : 73.44, class : 67.19 [bs:128]
30/53 of epoch 3/30 jigsaw : 0.562, class : 0.294, t_rotation : 0.681, entropy : 0.783 - acc jigsaw : 80.47, class : 77.34 [bs:128]
Accuracies on val: jigsaw : 90.96, class : 87.68
--------------------------------------------------------
Accuracies on test: jigsaw : 95.65, class : 71.54
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 3
New epoch - lr: 0.001
0/53 of epoch 4/30 jigsaw : 0.550, class : 0.421, t_rotation : 0.545, entropy : 0.759 - acc jigsaw : 78.12, class : 69.53 [bs:128]
30/53 of epoch 4/30 jigsaw : 0.671, class : 0.205, t_rotation : 0.427, entropy : 0.625 - acc jigsaw : 70.31, class : 75.78 [bs:128]
Accuracies on val: jigsaw : 90.69, class : 90.04
--------------------------------------------------------
Accuracies on test: jigsaw : 95.78, class : 73.93
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 4
New epoch - lr: 0.001
0/53 of epoch 5/30 jigsaw : 0.540, class : 0.224, t_rotation : 0.487, entropy : 0.589 - acc jigsaw : 76.56, class : 76.56 [bs:128]
30/53 of epoch 5/30 jigsaw : 0.460, class : 0.219, t_rotation : 0.320, entropy : 0.486 - acc jigsaw : 83.59, class : 70.31 [bs:128]
Accuracies on val: jigsaw : 91.48, class : 90.43
--------------------------------------------------------
Accuracies on test: jigsaw : 97.10, class : 76.62
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 5
New epoch - lr: 0.001
0/53 of epoch 6/30 jigsaw : 0.484, class : 0.205, t_rotation : 0.345, entropy : 0.567 - acc jigsaw : 80.47, class : 73.44 [bs:128]
30/53 of epoch 6/30 jigsaw : 0.401, class : 0.215, t_rotation : 0.333, entropy : 0.524 - acc jigsaw : 83.59, class : 72.66 [bs:128]
Accuracies on val: jigsaw : 91.35, class : 91.87
--------------------------------------------------------
Accuracies on test: jigsaw : 96.97, class : 75.64
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 6
New epoch - lr: 0.001
0/53 of epoch 7/30 jigsaw : 0.445, class : 0.262, t_rotation : 0.243, entropy : 0.493 - acc jigsaw : 83.59, class : 69.53 [bs:128]
30/53 of epoch 7/30 jigsaw : 0.375, class : 0.226, t_rotation : 0.247, entropy : 0.390 - acc jigsaw : 88.28, class : 67.97 [bs:128]
Accuracies on val: jigsaw : 91.61, class : 92.53
--------------------------------------------------------
Accuracies on test: jigsaw : 97.18, class : 76.49
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 7
New epoch - lr: 0.001
0/53 of epoch 8/30 jigsaw : 0.321, class : 0.207, t_rotation : 0.275, entropy : 0.470 - acc jigsaw : 86.72, class : 64.84 [bs:128]
30/53 of epoch 8/30 jigsaw : 0.378, class : 0.170, t_rotation : 0.211, entropy : 0.484 - acc jigsaw : 85.94, class : 71.09 [bs:128]
Accuracies on val: jigsaw : 91.87, class : 92.92
--------------------------------------------------------
Accuracies on test: jigsaw : 97.10, class : 77.47
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 8
New epoch - lr: 0.001
0/53 of epoch 9/30 jigsaw : 0.340, class : 0.099, t_rotation : 0.252, entropy : 0.454 - acc jigsaw : 92.19, class : 79.69 [bs:128]
30/53 of epoch 9/30 jigsaw : 0.367, class : 0.120, t_rotation : 0.185, entropy : 0.480 - acc jigsaw : 86.72, class : 75.00 [bs:128]
Accuracies on val: jigsaw : 92.53, class : 93.84
--------------------------------------------------------
Accuracies on test: jigsaw : 98.08, class : 79.10
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 9
New epoch - lr: 0.001
0/53 of epoch 10/30 jigsaw : 0.414, class : 0.087, t_rotation : 0.242, entropy : 0.350 - acc jigsaw : 89.06, class : 67.19 [bs:128]
30/53 of epoch 10/30 jigsaw : 0.268, class : 0.204, t_rotation : 0.215, entropy : 0.393 - acc jigsaw : 89.84, class : 72.66 [bs:128]
Accuracies on val: jigsaw : 93.58, class : 93.32
--------------------------------------------------------
Accuracies on test: jigsaw : 98.42, class : 78.07
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 10
New epoch - lr: 0.001
0/53 of epoch 11/30 jigsaw : 0.229, class : 0.194, t_rotation : 0.186, entropy : 0.317 - acc jigsaw : 93.75, class : 71.88 [bs:128]
30/53 of epoch 11/30 jigsaw : 0.262, class : 0.138, t_rotation : 0.129, entropy : 0.347 - acc jigsaw : 92.19, class : 67.19 [bs:128]
Accuracies on val: jigsaw : 92.53, class : 93.97
--------------------------------------------------------
Accuracies on test: jigsaw : 98.25, class : 78.16
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 11
New epoch - lr: 0.001
0/53 of epoch 12/30 jigsaw : 0.380, class : 0.095, t_rotation : 0.172, entropy : 0.323 - acc jigsaw : 87.50, class : 77.34 [bs:128]
30/53 of epoch 12/30 jigsaw : 0.200, class : 0.161, t_rotation : 0.123, entropy : 0.280 - acc jigsaw : 93.75, class : 71.09 [bs:128]
Accuracies on val: jigsaw : 93.05, class : 93.45
--------------------------------------------------------
Accuracies on test: jigsaw : 98.17, class : 78.54
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 12
New epoch - lr: 0.001
0/53 of epoch 13/30 jigsaw : 0.258, class : 0.043, t_rotation : 0.206, entropy : 0.310 - acc jigsaw : 91.41, class : 71.09 [bs:128]
30/53 of epoch 13/30 jigsaw : 0.291, class : 0.139, t_rotation : 0.157, entropy : 0.256 - acc jigsaw : 90.62, class : 75.78 [bs:128]
Accuracies on val: jigsaw : 94.76, class : 93.58
--------------------------------------------------------
Accuracies on test: jigsaw : 98.51, class : 77.99
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 13
New epoch - lr: 0.001
0/53 of epoch 14/30 jigsaw : 0.173, class : 0.102, t_rotation : 0.156, entropy : 0.234 - acc jigsaw : 95.31, class : 70.31 [bs:128]
30/53 of epoch 14/30 jigsaw : 0.320, class : 0.106, t_rotation : 0.176, entropy : 0.287 - acc jigsaw : 88.28, class : 75.00 [bs:128]
Accuracies on val: jigsaw : 93.32, class : 93.18
--------------------------------------------------------
Accuracies on test: jigsaw : 98.46, class : 80.08
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 14
New epoch - lr: 0.001
0/53 of epoch 15/30 jigsaw : 0.255, class : 0.157, t_rotation : 0.090, entropy : 0.230 - acc jigsaw : 90.62, class : 75.78 [bs:128]
30/53 of epoch 15/30 jigsaw : 0.319, class : 0.119, t_rotation : 0.096, entropy : 0.272 - acc jigsaw : 92.19, class : 72.66 [bs:128]
Accuracies on val: jigsaw : 93.97, class : 93.71
--------------------------------------------------------
Accuracies on test: jigsaw : 98.68, class : 80.38
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 15
New epoch - lr: 0.001
0/53 of epoch 16/30 jigsaw : 0.289, class : 0.110, t_rotation : 0.111, entropy : 0.296 - acc jigsaw : 86.72, class : 71.09 [bs:128]
30/53 of epoch 16/30 jigsaw : 0.226, class : 0.161, t_rotation : 0.102, entropy : 0.257 - acc jigsaw : 94.53, class : 70.31 [bs:128]
Accuracies on val: jigsaw : 93.71, class : 93.32
--------------------------------------------------------
Accuracies on test: jigsaw : 98.85, class : 80.97
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 16
New epoch - lr: 0.001
0/53 of epoch 17/30 jigsaw : 0.271, class : 0.057, t_rotation : 0.091, entropy : 0.306 - acc jigsaw : 90.62, class : 74.22 [bs:128]
30/53 of epoch 17/30 jigsaw : 0.233, class : 0.116, t_rotation : 0.112, entropy : 0.303 - acc jigsaw : 93.75, class : 72.66 [bs:128]
Accuracies on val: jigsaw : 93.84, class : 94.63
--------------------------------------------------------
Accuracies on test: jigsaw : 99.10, class : 80.33
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 17
New epoch - lr: 0.001
0/53 of epoch 18/30 jigsaw : 0.239, class : 0.090, t_rotation : 0.181, entropy : 0.251 - acc jigsaw : 93.75, class : 70.31 [bs:128]
30/53 of epoch 18/30 jigsaw : 0.172, class : 0.067, t_rotation : 0.171, entropy : 0.198 - acc jigsaw : 94.53, class : 77.34 [bs:128]
Accuracies on val: jigsaw : 93.58, class : 94.36
--------------------------------------------------------
Accuracies on test: jigsaw : 98.81, class : 81.14
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 18
New epoch - lr: 0.001
0/53 of epoch 19/30 jigsaw : 0.268, class : 0.186, t_rotation : 0.155, entropy : 0.235 - acc jigsaw : 92.97, class : 69.53 [bs:128]
30/53 of epoch 19/30 jigsaw : 0.221, class : 0.087, t_rotation : 0.073, entropy : 0.199 - acc jigsaw : 92.97, class : 72.66 [bs:128]
Accuracies on val: jigsaw : 94.63, class : 93.71
--------------------------------------------------------
Accuracies on test: jigsaw : 98.85, class : 81.87
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 19
New epoch - lr: 0.001
0/53 of epoch 20/30 jigsaw : 0.217, class : 0.073, t_rotation : 0.134, entropy : 0.203 - acc jigsaw : 92.97, class : 72.66 [bs:128]
30/53 of epoch 20/30 jigsaw : 0.168, class : 0.063, t_rotation : 0.069, entropy : 0.226 - acc jigsaw : 92.97, class : 75.00 [bs:128]
Accuracies on val: jigsaw : 93.45, class : 94.23
--------------------------------------------------------
Accuracies on test: jigsaw : 98.63, class : 79.99
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 20
New epoch - lr: 0.001
0/53 of epoch 21/30 jigsaw : 0.198, class : 0.050, t_rotation : 0.091, entropy : 0.252 - acc jigsaw : 92.97, class : 73.44 [bs:128]
30/53 of epoch 21/30 jigsaw : 0.289, class : 0.057, t_rotation : 0.072, entropy : 0.204 - acc jigsaw : 91.41, class : 74.22 [bs:128]
Accuracies on val: jigsaw : 93.32, class : 94.10
--------------------------------------------------------
Accuracies on test: jigsaw : 98.93, class : 80.12
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 21
New epoch - lr: 0.001
0/53 of epoch 22/30 jigsaw : 0.182, class : 0.058, t_rotation : 0.127, entropy : 0.151 - acc jigsaw : 93.75, class : 71.09 [bs:128]
30/53 of epoch 22/30 jigsaw : 0.252, class : 0.086, t_rotation : 0.115, entropy : 0.189 - acc jigsaw : 91.41, class : 75.00 [bs:128]
Accuracies on val: jigsaw : 94.10, class : 94.36
--------------------------------------------------------
Accuracies on test: jigsaw : 98.93, class : 79.99
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 22
New epoch - lr: 0.001
0/53 of epoch 23/30 jigsaw : 0.181, class : 0.077, t_rotation : 0.163, entropy : 0.196 - acc jigsaw : 95.31, class : 77.34 [bs:128]
30/53 of epoch 23/30 jigsaw : 0.164, class : 0.090, t_rotation : 0.112, entropy : 0.213 - acc jigsaw : 93.75, class : 71.09 [bs:128]
Accuracies on val: jigsaw : 93.71, class : 94.23
--------------------------------------------------------
Accuracies on test: jigsaw : 99.53, class : 81.02
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 23
New epoch - lr: 0.0001
0/53 of epoch 24/30 jigsaw : 0.221, class : 0.042, t_rotation : 0.205, entropy : 0.227 - acc jigsaw : 91.41, class : 81.25 [bs:128]
30/53 of epoch 24/30 jigsaw : 0.141, class : 0.047, t_rotation : 0.088, entropy : 0.155 - acc jigsaw : 94.53, class : 67.97 [bs:128]
Accuracies on val: jigsaw : 94.36, class : 94.76
--------------------------------------------------------
Accuracies on test: jigsaw : 99.40, class : 81.36
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 24
New epoch - lr: 0.0001
0/53 of epoch 25/30 jigsaw : 0.166, class : 0.181, t_rotation : 0.152, entropy : 0.219 - acc jigsaw : 95.31, class : 72.66 [bs:128]
30/53 of epoch 25/30 jigsaw : 0.146, class : 0.087, t_rotation : 0.101, entropy : 0.203 - acc jigsaw : 96.09, class : 75.00 [bs:128]
Accuracies on val: jigsaw : 94.50, class : 94.63
--------------------------------------------------------
Accuracies on test: jigsaw : 99.45, class : 81.44
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 25
New epoch - lr: 0.0001
0/53 of epoch 26/30 jigsaw : 0.172, class : 0.072, t_rotation : 0.143, entropy : 0.216 - acc jigsaw : 94.53, class : 72.66 [bs:128]
30/53 of epoch 26/30 jigsaw : 0.225, class : 0.028, t_rotation : 0.095, entropy : 0.281 - acc jigsaw : 89.06, class : 71.09 [bs:128]
Accuracies on val: jigsaw : 93.71, class : 94.76
--------------------------------------------------------
Accuracies on test: jigsaw : 99.27, class : 81.23
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 26
New epoch - lr: 0.0001
0/53 of epoch 27/30 jigsaw : 0.156, class : 0.033, t_rotation : 0.101, entropy : 0.159 - acc jigsaw : 95.31, class : 74.22 [bs:128]
30/53 of epoch 27/30 jigsaw : 0.181, class : 0.028, t_rotation : 0.113, entropy : 0.197 - acc jigsaw : 92.97, class : 74.22 [bs:128]
Accuracies on val: jigsaw : 93.32, class : 94.76
--------------------------------------------------------
Accuracies on test: jigsaw : 99.32, class : 81.10
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 27
New epoch - lr: 0.0001
0/53 of epoch 28/30 jigsaw : 0.176, class : 0.055, t_rotation : 0.096, entropy : 0.262 - acc jigsaw : 93.75, class : 75.78 [bs:128]
30/53 of epoch 28/30 jigsaw : 0.145, class : 0.077, t_rotation : 0.118, entropy : 0.219 - acc jigsaw : 95.31, class : 72.66 [bs:128]
Accuracies on val: jigsaw : 93.84, class : 94.63
--------------------------------------------------------
Accuracies on test: jigsaw : 99.40, class : 81.36
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 28
New epoch - lr: 0.0001
0/53 of epoch 29/30 jigsaw : 0.165, class : 0.027, t_rotation : 0.167, entropy : 0.145 - acc jigsaw : 92.19, class : 71.88 [bs:128]
30/53 of epoch 29/30 jigsaw : 0.188, class : 0.037, t_rotation : 0.093, entropy : 0.157 - acc jigsaw : 96.88, class : 75.00 [bs:128]
Accuracies on val: jigsaw : 93.84, class : 94.76
--------------------------------------------------------
Accuracies on test: jigsaw : 99.32, class : 81.48
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 29
New epoch - lr: 0.0001
0/53 of epoch 30/30 jigsaw : 0.200, class : 0.033, t_rotation : 0.074, entropy : 0.177 - acc jigsaw : 92.19, class : 78.12 [bs:128]
30/53 of epoch 30/30 jigsaw : 0.236, class : 0.067, t_rotation : 0.192, entropy : 0.182 - acc jigsaw : 90.62, class : 71.88 [bs:128]
Accuracies on val: jigsaw : 93.97, class : 95.02
--------------------------------------------------------
Accuracies on test: jigsaw : 99.40, class : 80.93
--------------------------------------------------------
2019-12-16 05:19:08
cartoon
['photo', 'sketch', 'art_painting']
unsupervised_task_weight: 0.8
bias_hole_image: 0.3
target_rotation_weight: 0.8
entropy_weight 0.1
only_classify the ordered image: True
Highest accuracy on validation set appears on epoch  tensor(29)
Highest accuracy on test set appears on epoch  tensor(18)
Accuracy on test set when the accuracy on validation set is highest:0.809
Highest accuracy on test set:0.819
It took 1340.56
--------------------------------------------------------
******************Start training**************************************
--------------------------------------------------------
Dataset size: training 6884, validation 763, testing 2344
--------------------------------------------------------
Namespace(TTA=False, batch_size=128, bias_whole_image=0.3, classify_only_ordered_images_or_not=True, domains_list=['photo', 'sketch', 'cartoon', 'art_painting'], entropy_loss_weight=0.1, epochs=30, folder_name='test', image_size=222, jitter=0.4, learning_rate=0.001, limit_source=None, limit_target=None, max_scale=1.0, min_scale=0.8, n_classes=7, nesterov=False, network='resnet18', ooo_weight=0, parameters_lists=[[0.8, 0.3, 0.8, 0.1], [0.8, 0.5, 0.8, 0.1], [0.8, 0.6, 0.8, 0.1]], random_horiz_flip=0.5, repeat_times=3, source=['photo', 'sketch', 'art_painting'], suffix='', target='cartoon', target_domain_list=['art_painting', 'cartoon', 'sketch', 'photo'], target_domain_unsupervised_task_loss_weight=0.8, tf_logger=True, tile_random_grayscale=0.1, train_all=True, unsupervised_task_weight=0.8, val_size=0.1)
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 0
New epoch - lr: 0.001
0/53 of epoch 1/30 jigsaw : 1.602, class : 2.178, t_rotation : 1.574, entropy : 1.731 - acc jigsaw : 20.31, class : 9.38 [bs:128]
30/53 of epoch 1/30 jigsaw : 1.037, class : 1.270, t_rotation : 1.098, entropy : 1.613 - acc jigsaw : 56.25, class : 57.81 [bs:128]
Accuracies on val: jigsaw : 88.99, class : 78.77
--------------------------------------------------------
Accuracies on test: jigsaw : 95.86, class : 59.22
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 1
New epoch - lr: 0.001
0/53 of epoch 2/30 jigsaw : 0.945, class : 0.732, t_rotation : 0.873, entropy : 1.358 - acc jigsaw : 58.59, class : 62.50 [bs:128]
30/53 of epoch 2/30 jigsaw : 0.696, class : 0.557, t_rotation : 0.727, entropy : 1.018 - acc jigsaw : 71.09, class : 66.41 [bs:128]
Accuracies on val: jigsaw : 90.30, class : 85.45
--------------------------------------------------------
Accuracies on test: jigsaw : 95.48, class : 72.87
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 2
New epoch - lr: 0.001
0/53 of epoch 3/30 jigsaw : 0.701, class : 0.475, t_rotation : 0.682, entropy : 0.993 - acc jigsaw : 75.00, class : 67.97 [bs:128]
30/53 of epoch 3/30 jigsaw : 0.567, class : 0.431, t_rotation : 0.529, entropy : 0.746 - acc jigsaw : 76.56, class : 64.84 [bs:128]
Accuracies on val: jigsaw : 92.53, class : 89.65
--------------------------------------------------------
Accuracies on test: jigsaw : 97.27, class : 76.83
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 3
New epoch - lr: 0.001
0/53 of epoch 4/30 jigsaw : 0.518, class : 0.310, t_rotation : 0.549, entropy : 0.667 - acc jigsaw : 80.47, class : 66.41 [bs:128]
30/53 of epoch 4/30 jigsaw : 0.529, class : 0.249, t_rotation : 0.487, entropy : 0.572 - acc jigsaw : 83.59, class : 71.88 [bs:128]
Accuracies on val: jigsaw : 93.45, class : 91.09
--------------------------------------------------------
Accuracies on test: jigsaw : 96.80, class : 76.02
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 4
New epoch - lr: 0.001
0/53 of epoch 5/30 jigsaw : 0.532, class : 0.207, t_rotation : 0.377, entropy : 0.564 - acc jigsaw : 82.81, class : 71.88 [bs:128]
30/53 of epoch 5/30 jigsaw : 0.430, class : 0.194, t_rotation : 0.363, entropy : 0.573 - acc jigsaw : 86.72, class : 75.00 [bs:128]
Accuracies on val: jigsaw : 93.97, class : 91.87
--------------------------------------------------------
Accuracies on test: jigsaw : 96.16, class : 78.46
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 5
New epoch - lr: 0.001
0/53 of epoch 6/30 jigsaw : 0.449, class : 0.196, t_rotation : 0.306, entropy : 0.464 - acc jigsaw : 82.03, class : 72.66 [bs:128]
30/53 of epoch 6/30 jigsaw : 0.400, class : 0.124, t_rotation : 0.329, entropy : 0.473 - acc jigsaw : 85.94, class : 71.09 [bs:128]
Accuracies on val: jigsaw : 94.23, class : 92.66
--------------------------------------------------------
Accuracies on test: jigsaw : 97.23, class : 78.28
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 6
New epoch - lr: 0.001
0/53 of epoch 7/30 jigsaw : 0.443, class : 0.144, t_rotation : 0.309, entropy : 0.500 - acc jigsaw : 84.38, class : 73.44 [bs:128]
30/53 of epoch 7/30 jigsaw : 0.323, class : 0.140, t_rotation : 0.287, entropy : 0.446 - acc jigsaw : 90.62, class : 75.00 [bs:128]
Accuracies on val: jigsaw : 94.10, class : 92.40
--------------------------------------------------------
Accuracies on test: jigsaw : 96.25, class : 80.29
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 7
New epoch - lr: 0.001
0/53 of epoch 8/30 jigsaw : 0.235, class : 0.177, t_rotation : 0.306, entropy : 0.355 - acc jigsaw : 92.97, class : 75.00 [bs:128]
30/53 of epoch 8/30 jigsaw : 0.338, class : 0.114, t_rotation : 0.153, entropy : 0.482 - acc jigsaw : 86.72, class : 75.78 [bs:128]
Accuracies on val: jigsaw : 94.23, class : 92.40
--------------------------------------------------------
Accuracies on test: jigsaw : 96.97, class : 79.95
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 8
New epoch - lr: 0.001
0/53 of epoch 9/30 jigsaw : 0.406, class : 0.224, t_rotation : 0.284, entropy : 0.392 - acc jigsaw : 86.72, class : 68.75 [bs:128]
30/53 of epoch 9/30 jigsaw : 0.343, class : 0.072, t_rotation : 0.231, entropy : 0.431 - acc jigsaw : 89.84, class : 76.56 [bs:128]
Accuracies on val: jigsaw : 94.10, class : 93.58
--------------------------------------------------------
Accuracies on test: jigsaw : 97.18, class : 81.27
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 9
New epoch - lr: 0.001
0/53 of epoch 10/30 jigsaw : 0.206, class : 0.199, t_rotation : 0.305, entropy : 0.392 - acc jigsaw : 93.75, class : 67.97 [bs:128]
30/53 of epoch 10/30 jigsaw : 0.281, class : 0.174, t_rotation : 0.158, entropy : 0.327 - acc jigsaw : 91.41, class : 67.19 [bs:128]
Accuracies on val: jigsaw : 94.23, class : 93.32
--------------------------------------------------------
Accuracies on test: jigsaw : 97.10, class : 81.02
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 10
New epoch - lr: 0.001
0/53 of epoch 11/30 jigsaw : 0.309, class : 0.102, t_rotation : 0.176, entropy : 0.339 - acc jigsaw : 89.06, class : 64.06 [bs:128]
30/53 of epoch 11/30 jigsaw : 0.317, class : 0.066, t_rotation : 0.160, entropy : 0.381 - acc jigsaw : 87.50, class : 69.53 [bs:128]
Accuracies on val: jigsaw : 94.63, class : 94.89
--------------------------------------------------------
Accuracies on test: jigsaw : 97.78, class : 79.82
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 11
New epoch - lr: 0.001
0/53 of epoch 12/30 jigsaw : 0.162, class : 0.064, t_rotation : 0.219, entropy : 0.370 - acc jigsaw : 95.31, class : 73.44 [bs:128]
30/53 of epoch 12/30 jigsaw : 0.231, class : 0.106, t_rotation : 0.169, entropy : 0.311 - acc jigsaw : 90.62, class : 71.09 [bs:128]
Accuracies on val: jigsaw : 95.41, class : 94.10
--------------------------------------------------------
Accuracies on test: jigsaw : 98.21, class : 81.53
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 12
New epoch - lr: 0.001
0/53 of epoch 13/30 jigsaw : 0.388, class : 0.174, t_rotation : 0.187, entropy : 0.379 - acc jigsaw : 88.28, class : 75.00 [bs:128]
30/53 of epoch 13/30 jigsaw : 0.172, class : 0.042, t_rotation : 0.130, entropy : 0.212 - acc jigsaw : 93.75, class : 72.66 [bs:128]
Accuracies on val: jigsaw : 96.33, class : 93.97
--------------------------------------------------------
Accuracies on test: jigsaw : 98.59, class : 80.84
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 13
New epoch - lr: 0.001
0/53 of epoch 14/30 jigsaw : 0.234, class : 0.101, t_rotation : 0.148, entropy : 0.251 - acc jigsaw : 91.41, class : 71.88 [bs:128]
30/53 of epoch 14/30 jigsaw : 0.255, class : 0.085, t_rotation : 0.086, entropy : 0.221 - acc jigsaw : 92.97, class : 71.09 [bs:128]
Accuracies on val: jigsaw : 94.50, class : 93.58
--------------------------------------------------------
Accuracies on test: jigsaw : 98.34, class : 81.31
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 14
New epoch - lr: 0.001
0/53 of epoch 15/30 jigsaw : 0.289, class : 0.164, t_rotation : 0.266, entropy : 0.303 - acc jigsaw : 87.50, class : 63.28 [bs:128]
30/53 of epoch 15/30 jigsaw : 0.264, class : 0.119, t_rotation : 0.091, entropy : 0.259 - acc jigsaw : 89.06, class : 72.66 [bs:128]
Accuracies on val: jigsaw : 94.76, class : 93.18
--------------------------------------------------------
Accuracies on test: jigsaw : 97.87, class : 82.08
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 15
New epoch - lr: 0.001
0/53 of epoch 16/30 jigsaw : 0.260, class : 0.124, t_rotation : 0.180, entropy : 0.310 - acc jigsaw : 92.19, class : 75.00 [bs:128]
30/53 of epoch 16/30 jigsaw : 0.302, class : 0.128, t_rotation : 0.188, entropy : 0.268 - acc jigsaw : 89.06, class : 67.97 [bs:128]
Accuracies on val: jigsaw : 95.15, class : 94.23
--------------------------------------------------------
Accuracies on test: jigsaw : 97.95, class : 81.66
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 16
New epoch - lr: 0.001
0/53 of epoch 17/30 jigsaw : 0.365, class : 0.032, t_rotation : 0.092, entropy : 0.326 - acc jigsaw : 85.94, class : 71.88 [bs:128]
30/53 of epoch 17/30 jigsaw : 0.289, class : 0.053, t_rotation : 0.166, entropy : 0.188 - acc jigsaw : 88.28, class : 69.53 [bs:128]
Accuracies on val: jigsaw : 95.02, class : 95.02
--------------------------------------------------------
Accuracies on test: jigsaw : 98.34, class : 81.61
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 17
New epoch - lr: 0.001
0/53 of epoch 18/30 jigsaw : 0.269, class : 0.085, t_rotation : 0.095, entropy : 0.288 - acc jigsaw : 86.72, class : 71.09 [bs:128]
30/53 of epoch 18/30 jigsaw : 0.264, class : 0.056, t_rotation : 0.159, entropy : 0.182 - acc jigsaw : 92.97, class : 72.66 [bs:128]
Accuracies on val: jigsaw : 95.54, class : 95.54
--------------------------------------------------------
Accuracies on test: jigsaw : 98.93, class : 80.50
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 18
New epoch - lr: 0.001
0/53 of epoch 19/30 jigsaw : 0.278, class : 0.067, t_rotation : 0.181, entropy : 0.182 - acc jigsaw : 89.84, class : 72.66 [bs:128]
30/53 of epoch 19/30 jigsaw : 0.172, class : 0.123, t_rotation : 0.159, entropy : 0.184 - acc jigsaw : 95.31, class : 81.25 [bs:128]
Accuracies on val: jigsaw : 95.02, class : 95.02
--------------------------------------------------------
Accuracies on test: jigsaw : 98.85, class : 81.66
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 19
New epoch - lr: 0.001
0/53 of epoch 20/30 jigsaw : 0.211, class : 0.040, t_rotation : 0.115, entropy : 0.206 - acc jigsaw : 92.97, class : 71.09 [bs:128]
30/53 of epoch 20/30 jigsaw : 0.325, class : 0.084, t_rotation : 0.057, entropy : 0.203 - acc jigsaw : 90.62, class : 74.22 [bs:128]
Accuracies on val: jigsaw : 96.20, class : 94.50
--------------------------------------------------------
Accuracies on test: jigsaw : 98.93, class : 82.08
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 20
New epoch - lr: 0.001
0/53 of epoch 21/30 jigsaw : 0.267, class : 0.088, t_rotation : 0.214, entropy : 0.261 - acc jigsaw : 88.28, class : 76.56 [bs:128]
30/53 of epoch 21/30 jigsaw : 0.193, class : 0.016, t_rotation : 0.128, entropy : 0.220 - acc jigsaw : 92.97, class : 75.78 [bs:128]
Accuracies on val: jigsaw : 97.25, class : 94.76
--------------------------------------------------------
Accuracies on test: jigsaw : 99.02, class : 82.25
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 21
New epoch - lr: 0.001
0/53 of epoch 22/30 jigsaw : 0.256, class : 0.051, t_rotation : 0.101, entropy : 0.225 - acc jigsaw : 92.19, class : 67.97 [bs:128]
30/53 of epoch 22/30 jigsaw : 0.172, class : 0.097, t_rotation : 0.103, entropy : 0.181 - acc jigsaw : 92.19, class : 69.53 [bs:128]
Accuracies on val: jigsaw : 96.99, class : 94.89
--------------------------------------------------------
Accuracies on test: jigsaw : 99.02, class : 81.70
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 22
New epoch - lr: 0.001
0/53 of epoch 23/30 jigsaw : 0.185, class : 0.046, t_rotation : 0.092, entropy : 0.269 - acc jigsaw : 92.19, class : 78.91 [bs:128]
30/53 of epoch 23/30 jigsaw : 0.273, class : 0.041, t_rotation : 0.063, entropy : 0.223 - acc jigsaw : 90.62, class : 75.78 [bs:128]
Accuracies on val: jigsaw : 95.28, class : 95.67
--------------------------------------------------------
Accuracies on test: jigsaw : 98.68, class : 82.34
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 23
New epoch - lr: 0.0001
0/53 of epoch 24/30 jigsaw : 0.175, class : 0.066, t_rotation : 0.133, entropy : 0.242 - acc jigsaw : 94.53, class : 68.75 [bs:128]
30/53 of epoch 24/30 jigsaw : 0.165, class : 0.029, t_rotation : 0.164, entropy : 0.174 - acc jigsaw : 93.75, class : 72.66 [bs:128]
Accuracies on val: jigsaw : 96.33, class : 95.41
--------------------------------------------------------
Accuracies on test: jigsaw : 99.15, class : 82.17
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 24
New epoch - lr: 0.0001
0/53 of epoch 25/30 jigsaw : 0.219, class : 0.040, t_rotation : 0.099, entropy : 0.154 - acc jigsaw : 92.19, class : 77.34 [bs:128]
30/53 of epoch 25/30 jigsaw : 0.218, class : 0.088, t_rotation : 0.129, entropy : 0.242 - acc jigsaw : 91.41, class : 78.91 [bs:128]
Accuracies on val: jigsaw : 96.72, class : 95.67
--------------------------------------------------------
Accuracies on test: jigsaw : 99.27, class : 82.21
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 25
New epoch - lr: 0.0001
0/53 of epoch 26/30 jigsaw : 0.238, class : 0.085, t_rotation : 0.081, entropy : 0.234 - acc jigsaw : 91.41, class : 76.56 [bs:128]
30/53 of epoch 26/30 jigsaw : 0.125, class : 0.017, t_rotation : 0.179, entropy : 0.203 - acc jigsaw : 94.53, class : 78.91 [bs:128]
Accuracies on val: jigsaw : 96.59, class : 95.28
--------------------------------------------------------
Accuracies on test: jigsaw : 99.23, class : 82.76
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 26
New epoch - lr: 0.0001
0/53 of epoch 27/30 jigsaw : 0.150, class : 0.085, t_rotation : 0.115, entropy : 0.157 - acc jigsaw : 94.53, class : 73.44 [bs:128]
30/53 of epoch 27/30 jigsaw : 0.256, class : 0.045, t_rotation : 0.054, entropy : 0.186 - acc jigsaw : 90.62, class : 74.22 [bs:128]
Accuracies on val: jigsaw : 96.20, class : 95.54
--------------------------------------------------------
Accuracies on test: jigsaw : 99.23, class : 82.68
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 27
New epoch - lr: 0.0001
0/53 of epoch 28/30 jigsaw : 0.255, class : 0.066, t_rotation : 0.105, entropy : 0.197 - acc jigsaw : 88.28, class : 75.00 [bs:128]
30/53 of epoch 28/30 jigsaw : 0.160, class : 0.053, t_rotation : 0.096, entropy : 0.199 - acc jigsaw : 93.75, class : 71.88 [bs:128]
Accuracies on val: jigsaw : 96.33, class : 95.54
--------------------------------------------------------
Accuracies on test: jigsaw : 99.19, class : 82.25
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 28
New epoch - lr: 0.0001
0/53 of epoch 29/30 jigsaw : 0.181, class : 0.040, t_rotation : 0.099, entropy : 0.233 - acc jigsaw : 95.31, class : 67.19 [bs:128]
30/53 of epoch 29/30 jigsaw : 0.154, class : 0.063, t_rotation : 0.149, entropy : 0.162 - acc jigsaw : 95.31, class : 75.00 [bs:128]
Accuracies on val: jigsaw : 95.67, class : 95.67
--------------------------------------------------------
Accuracies on test: jigsaw : 98.98, class : 82.64
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 29
New epoch - lr: 0.0001
0/53 of epoch 30/30 jigsaw : 0.238, class : 0.128, t_rotation : 0.083, entropy : 0.199 - acc jigsaw : 91.41, class : 73.44 [bs:128]
30/53 of epoch 30/30 jigsaw : 0.146, class : 0.017, t_rotation : 0.103, entropy : 0.214 - acc jigsaw : 96.09, class : 71.09 [bs:128]
Accuracies on val: jigsaw : 96.72, class : 95.54
--------------------------------------------------------
Accuracies on test: jigsaw : 99.27, class : 82.59
--------------------------------------------------------
2019-12-16 05:41:33
cartoon
['photo', 'sketch', 'art_painting']
unsupervised_task_weight: 0.8
bias_hole_image: 0.3
target_rotation_weight: 0.8
entropy_weight 0.1
only_classify the ordered image: True
Highest accuracy on validation set appears on epoch  tensor(28)
Highest accuracy on test set appears on epoch  tensor(25)
Accuracy on test set when the accuracy on validation set is highest:0.826
Highest accuracy on test set:0.828
It took 1344.15
--------------------------------------------------------
******************Start training**************************************
--------------------------------------------------------
Dataset size: training 5457, validation 605, testing 3929
--------------------------------------------------------
Namespace(TTA=False, batch_size=128, bias_whole_image=0.3, classify_only_ordered_images_or_not=True, domains_list=['photo', 'sketch', 'cartoon', 'art_painting'], entropy_loss_weight=0.1, epochs=30, folder_name='test', image_size=222, jitter=0.4, learning_rate=0.001, limit_source=None, limit_target=None, max_scale=1.0, min_scale=0.8, n_classes=7, nesterov=False, network='resnet18', ooo_weight=0, parameters_lists=[[0.8, 0.3, 0.8, 0.1], [0.8, 0.5, 0.8, 0.1], [0.8, 0.6, 0.8, 0.1]], random_horiz_flip=0.5, repeat_times=3, source=['photo', 'cartoon', 'art_painting'], suffix='', target='sketch', target_domain_list=['art_painting', 'cartoon', 'sketch', 'photo'], target_domain_unsupervised_task_loss_weight=0.8, tf_logger=True, tile_random_grayscale=0.1, train_all=True, unsupervised_task_weight=0.8, val_size=0.1)
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 0
New epoch - lr: 0.001
0/42 of epoch 1/30 jigsaw : 1.658, class : 2.344, t_rotation : 1.663, entropy : 1.603 - acc jigsaw : 13.28, class : 14.84 [bs:128]
30/42 of epoch 1/30 jigsaw : 1.086, class : 1.129, t_rotation : 0.847, entropy : 1.719 - acc jigsaw : 57.03, class : 52.34 [bs:128]
Accuracies on val: jigsaw : 88.10, class : 67.11
--------------------------------------------------------
Accuracies on test: jigsaw : 91.17, class : 50.88
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 1
New epoch - lr: 0.001
0/42 of epoch 2/30 jigsaw : 0.979, class : 0.907, t_rotation : 0.737, entropy : 1.667 - acc jigsaw : 60.94, class : 68.75 [bs:128]
30/42 of epoch 2/30 jigsaw : 0.835, class : 0.444, t_rotation : 0.581, entropy : 1.369 - acc jigsaw : 63.28, class : 74.22 [bs:128]
Accuracies on val: jigsaw : 90.08, class : 83.80
--------------------------------------------------------
Accuracies on test: jigsaw : 88.80, class : 65.87
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 2
New epoch - lr: 0.001
0/42 of epoch 3/30 jigsaw : 0.902, class : 0.594, t_rotation : 0.596, entropy : 1.160 - acc jigsaw : 61.72, class : 65.62 [bs:128]
30/42 of epoch 3/30 jigsaw : 0.698, class : 0.388, t_rotation : 0.521, entropy : 0.957 - acc jigsaw : 72.66, class : 74.22 [bs:128]
Accuracies on val: jigsaw : 93.39, class : 87.11
--------------------------------------------------------
Accuracies on test: jigsaw : 91.19, class : 71.67
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 3
New epoch - lr: 0.001
0/42 of epoch 4/30 jigsaw : 0.689, class : 0.280, t_rotation : 0.457, entropy : 0.910 - acc jigsaw : 71.09, class : 74.22 [bs:128]
30/42 of epoch 4/30 jigsaw : 0.691, class : 0.252, t_rotation : 0.404, entropy : 0.796 - acc jigsaw : 73.44, class : 72.66 [bs:128]
Accuracies on val: jigsaw : 91.90, class : 87.77
--------------------------------------------------------
Accuracies on test: jigsaw : 91.88, class : 72.41
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 4
New epoch - lr: 0.001
0/42 of epoch 5/30 jigsaw : 0.664, class : 0.376, t_rotation : 0.413, entropy : 0.663 - acc jigsaw : 73.44, class : 70.31 [bs:128]
30/42 of epoch 5/30 jigsaw : 0.587, class : 0.341, t_rotation : 0.344, entropy : 0.549 - acc jigsaw : 78.12, class : 69.53 [bs:128]
Accuracies on val: jigsaw : 93.06, class : 88.60
--------------------------------------------------------
Accuracies on test: jigsaw : 93.79, class : 72.36
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 5
New epoch - lr: 0.001
0/42 of epoch 6/30 jigsaw : 0.478, class : 0.322, t_rotation : 0.317, entropy : 0.519 - acc jigsaw : 83.59, class : 71.88 [bs:128]
30/42 of epoch 6/30 jigsaw : 0.479, class : 0.244, t_rotation : 0.261, entropy : 0.477 - acc jigsaw : 82.81, class : 72.66 [bs:128]
Accuracies on val: jigsaw : 92.23, class : 88.60
--------------------------------------------------------
Accuracies on test: jigsaw : 93.23, class : 74.27
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 6
New epoch - lr: 0.001
0/42 of epoch 7/30 jigsaw : 0.550, class : 0.291, t_rotation : 0.372, entropy : 0.518 - acc jigsaw : 78.12, class : 74.22 [bs:128]
30/42 of epoch 7/30 jigsaw : 0.458, class : 0.132, t_rotation : 0.323, entropy : 0.451 - acc jigsaw : 83.59, class : 72.66 [bs:128]
Accuracies on val: jigsaw : 92.73, class : 89.75
--------------------------------------------------------
Accuracies on test: jigsaw : 94.40, class : 75.90
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 7
New epoch - lr: 0.001
0/42 of epoch 8/30 jigsaw : 0.496, class : 0.167, t_rotation : 0.214, entropy : 0.479 - acc jigsaw : 80.47, class : 79.69 [bs:128]
30/42 of epoch 8/30 jigsaw : 0.400, class : 0.148, t_rotation : 0.201, entropy : 0.431 - acc jigsaw : 85.94, class : 74.22 [bs:128]
Accuracies on val: jigsaw : 92.40, class : 89.42
--------------------------------------------------------
Accuracies on test: jigsaw : 95.34, class : 75.59
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 8
New epoch - lr: 0.001
0/42 of epoch 9/30 jigsaw : 0.391, class : 0.192, t_rotation : 0.207, entropy : 0.497 - acc jigsaw : 82.81, class : 69.53 [bs:128]
30/42 of epoch 9/30 jigsaw : 0.489, class : 0.219, t_rotation : 0.202, entropy : 0.464 - acc jigsaw : 81.25, class : 75.00 [bs:128]
Accuracies on val: jigsaw : 92.23, class : 91.24
--------------------------------------------------------
Accuracies on test: jigsaw : 96.49, class : 76.46
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 9
New epoch - lr: 0.001
0/42 of epoch 10/30 jigsaw : 0.384, class : 0.191, t_rotation : 0.235, entropy : 0.448 - acc jigsaw : 85.94, class : 73.44 [bs:128]
30/42 of epoch 10/30 jigsaw : 0.402, class : 0.189, t_rotation : 0.200, entropy : 0.415 - acc jigsaw : 85.94, class : 78.12 [bs:128]
Accuracies on val: jigsaw : 93.72, class : 90.25
--------------------------------------------------------
Accuracies on test: jigsaw : 97.25, class : 78.06
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 10
New epoch - lr: 0.001
0/42 of epoch 11/30 jigsaw : 0.369, class : 0.186, t_rotation : 0.220, entropy : 0.358 - acc jigsaw : 85.94, class : 75.00 [bs:128]
30/42 of epoch 11/30 jigsaw : 0.403, class : 0.098, t_rotation : 0.169, entropy : 0.353 - acc jigsaw : 88.28, class : 71.88 [bs:128]
Accuracies on val: jigsaw : 94.38, class : 91.57
--------------------------------------------------------
Accuracies on test: jigsaw : 97.38, class : 76.74
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 11
New epoch - lr: 0.001
0/42 of epoch 12/30 jigsaw : 0.455, class : 0.089, t_rotation : 0.242, entropy : 0.423 - acc jigsaw : 82.81, class : 77.34 [bs:128]
30/42 of epoch 12/30 jigsaw : 0.334, class : 0.136, t_rotation : 0.220, entropy : 0.401 - acc jigsaw : 88.28, class : 75.00 [bs:128]
Accuracies on val: jigsaw : 93.72, class : 91.74
--------------------------------------------------------
Accuracies on test: jigsaw : 94.68, class : 79.36
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 12
New epoch - lr: 0.001
0/42 of epoch 13/30 jigsaw : 0.360, class : 0.061, t_rotation : 0.161, entropy : 0.310 - acc jigsaw : 87.50, class : 75.78 [bs:128]
30/42 of epoch 13/30 jigsaw : 0.319, class : 0.230, t_rotation : 0.128, entropy : 0.288 - acc jigsaw : 85.94, class : 71.09 [bs:128]
Accuracies on val: jigsaw : 93.88, class : 92.07
--------------------------------------------------------
Accuracies on test: jigsaw : 97.45, class : 78.47
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 13
New epoch - lr: 0.001
0/42 of epoch 14/30 jigsaw : 0.314, class : 0.069, t_rotation : 0.266, entropy : 0.360 - acc jigsaw : 89.06, class : 67.97 [bs:128]
30/42 of epoch 14/30 jigsaw : 0.327, class : 0.139, t_rotation : 0.241, entropy : 0.347 - acc jigsaw : 85.94, class : 78.91 [bs:128]
Accuracies on val: jigsaw : 93.55, class : 92.56
--------------------------------------------------------
Accuracies on test: jigsaw : 96.64, class : 78.77
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 14
New epoch - lr: 0.001
0/42 of epoch 15/30 jigsaw : 0.284, class : 0.063, t_rotation : 0.100, entropy : 0.396 - acc jigsaw : 91.41, class : 76.56 [bs:128]
30/42 of epoch 15/30 jigsaw : 0.516, class : 0.121, t_rotation : 0.087, entropy : 0.399 - acc jigsaw : 78.91, class : 64.84 [bs:128]
Accuracies on val: jigsaw : 94.05, class : 91.74
--------------------------------------------------------
Accuracies on test: jigsaw : 96.67, class : 80.58
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 15
New epoch - lr: 0.001
0/42 of epoch 16/30 jigsaw : 0.443, class : 0.113, t_rotation : 0.239, entropy : 0.349 - acc jigsaw : 82.03, class : 79.69 [bs:128]
30/42 of epoch 16/30 jigsaw : 0.258, class : 0.170, t_rotation : 0.182, entropy : 0.323 - acc jigsaw : 90.62, class : 71.09 [bs:128]
Accuracies on val: jigsaw : 93.39, class : 92.40
--------------------------------------------------------
Accuracies on test: jigsaw : 97.48, class : 81.06
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 16
New epoch - lr: 0.001
0/42 of epoch 17/30 jigsaw : 0.349, class : 0.111, t_rotation : 0.260, entropy : 0.316 - acc jigsaw : 89.84, class : 70.31 [bs:128]
30/42 of epoch 17/30 jigsaw : 0.287, class : 0.096, t_rotation : 0.187, entropy : 0.287 - acc jigsaw : 89.84, class : 71.88 [bs:128]
Accuracies on val: jigsaw : 94.88, class : 92.40
--------------------------------------------------------
Accuracies on test: jigsaw : 96.77, class : 81.42
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 17
New epoch - lr: 0.001
0/42 of epoch 18/30 jigsaw : 0.306, class : 0.095, t_rotation : 0.247, entropy : 0.278 - acc jigsaw : 86.72, class : 78.12 [bs:128]
30/42 of epoch 18/30 jigsaw : 0.245, class : 0.101, t_rotation : 0.193, entropy : 0.262 - acc jigsaw : 90.62, class : 71.09 [bs:128]
Accuracies on val: jigsaw : 94.71, class : 92.89
--------------------------------------------------------
Accuracies on test: jigsaw : 98.22, class : 81.29
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 18
New epoch - lr: 0.001
0/42 of epoch 19/30 jigsaw : 0.309, class : 0.053, t_rotation : 0.162, entropy : 0.233 - acc jigsaw : 88.28, class : 76.56 [bs:128]
30/42 of epoch 19/30 jigsaw : 0.339, class : 0.059, t_rotation : 0.123, entropy : 0.222 - acc jigsaw : 88.28, class : 78.12 [bs:128]
Accuracies on val: jigsaw : 94.55, class : 92.89
--------------------------------------------------------
Accuracies on test: jigsaw : 99.08, class : 81.17
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 19
New epoch - lr: 0.001
0/42 of epoch 20/30 jigsaw : 0.278, class : 0.030, t_rotation : 0.121, entropy : 0.235 - acc jigsaw : 86.72, class : 75.78 [bs:128]
30/42 of epoch 20/30 jigsaw : 0.274, class : 0.047, t_rotation : 0.116, entropy : 0.237 - acc jigsaw : 92.19, class : 71.88 [bs:128]
Accuracies on val: jigsaw : 93.55, class : 92.56
--------------------------------------------------------
Accuracies on test: jigsaw : 98.80, class : 79.21
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 20
New epoch - lr: 0.001
0/42 of epoch 21/30 jigsaw : 0.364, class : 0.082, t_rotation : 0.147, entropy : 0.203 - acc jigsaw : 89.06, class : 75.78 [bs:128]
30/42 of epoch 21/30 jigsaw : 0.249, class : 0.057, t_rotation : 0.127, entropy : 0.179 - acc jigsaw : 91.41, class : 75.78 [bs:128]
Accuracies on val: jigsaw : 93.39, class : 92.23
--------------------------------------------------------
Accuracies on test: jigsaw : 98.45, class : 81.27
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 21
New epoch - lr: 0.001
0/42 of epoch 22/30 jigsaw : 0.273, class : 0.044, t_rotation : 0.169, entropy : 0.230 - acc jigsaw : 89.06, class : 76.56 [bs:128]
30/42 of epoch 22/30 jigsaw : 0.274, class : 0.106, t_rotation : 0.148, entropy : 0.215 - acc jigsaw : 90.62, class : 71.09 [bs:128]
Accuracies on val: jigsaw : 92.89, class : 92.73
--------------------------------------------------------
Accuracies on test: jigsaw : 97.53, class : 81.90
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 22
New epoch - lr: 0.001
0/42 of epoch 23/30 jigsaw : 0.219, class : 0.075, t_rotation : 0.167, entropy : 0.273 - acc jigsaw : 91.41, class : 78.12 [bs:128]
30/42 of epoch 23/30 jigsaw : 0.257, class : 0.035, t_rotation : 0.142, entropy : 0.234 - acc jigsaw : 89.06, class : 75.00 [bs:128]
Accuracies on val: jigsaw : 93.55, class : 93.55
--------------------------------------------------------
Accuracies on test: jigsaw : 98.19, class : 81.52
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 23
New epoch - lr: 0.0001
0/42 of epoch 24/30 jigsaw : 0.239, class : 0.056, t_rotation : 0.130, entropy : 0.164 - acc jigsaw : 95.31, class : 71.88 [bs:128]
30/42 of epoch 24/30 jigsaw : 0.272, class : 0.010, t_rotation : 0.127, entropy : 0.163 - acc jigsaw : 90.62, class : 83.59 [bs:128]
Accuracies on val: jigsaw : 93.39, class : 93.55
--------------------------------------------------------
Accuracies on test: jigsaw : 98.57, class : 81.22
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 24
New epoch - lr: 0.0001
0/42 of epoch 25/30 jigsaw : 0.312, class : 0.030, t_rotation : 0.146, entropy : 0.182 - acc jigsaw : 89.84, class : 74.22 [bs:128]
30/42 of epoch 25/30 jigsaw : 0.272, class : 0.069, t_rotation : 0.143, entropy : 0.181 - acc jigsaw : 88.28, class : 75.78 [bs:128]
Accuracies on val: jigsaw : 93.72, class : 93.55
--------------------------------------------------------
Accuracies on test: jigsaw : 98.65, class : 81.14
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 25
New epoch - lr: 0.0001
0/42 of epoch 26/30 jigsaw : 0.246, class : 0.016, t_rotation : 0.144, entropy : 0.173 - acc jigsaw : 91.41, class : 76.56 [bs:128]
30/42 of epoch 26/30 jigsaw : 0.193, class : 0.044, t_rotation : 0.141, entropy : 0.173 - acc jigsaw : 93.75, class : 73.44 [bs:128]
Accuracies on val: jigsaw : 93.39, class : 93.72
--------------------------------------------------------
Accuracies on test: jigsaw : 98.55, class : 81.55
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 26
New epoch - lr: 0.0001
0/42 of epoch 27/30 jigsaw : 0.211, class : 0.071, t_rotation : 0.115, entropy : 0.172 - acc jigsaw : 91.41, class : 78.12 [bs:128]
30/42 of epoch 27/30 jigsaw : 0.288, class : 0.065, t_rotation : 0.113, entropy : 0.170 - acc jigsaw : 85.94, class : 78.12 [bs:128]
Accuracies on val: jigsaw : 93.39, class : 93.55
--------------------------------------------------------
Accuracies on test: jigsaw : 98.47, class : 81.32
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 27
New epoch - lr: 0.0001
0/42 of epoch 28/30 jigsaw : 0.245, class : 0.027, t_rotation : 0.135, entropy : 0.148 - acc jigsaw : 90.62, class : 77.34 [bs:128]
30/42 of epoch 28/30 jigsaw : 0.210, class : 0.104, t_rotation : 0.129, entropy : 0.147 - acc jigsaw : 94.53, class : 75.00 [bs:128]
Accuracies on val: jigsaw : 94.38, class : 93.55
--------------------------------------------------------
Accuracies on test: jigsaw : 99.03, class : 81.11
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 28
New epoch - lr: 0.0001
0/42 of epoch 29/30 jigsaw : 0.241, class : 0.035, t_rotation : 0.066, entropy : 0.213 - acc jigsaw : 92.19, class : 71.09 [bs:128]
30/42 of epoch 29/30 jigsaw : 0.263, class : 0.049, t_rotation : 0.063, entropy : 0.213 - acc jigsaw : 89.06, class : 81.25 [bs:128]
Accuracies on val: jigsaw : 93.39, class : 93.72
--------------------------------------------------------
Accuracies on test: jigsaw : 98.55, class : 81.62
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 29
New epoch - lr: 0.0001
0/42 of epoch 30/30 jigsaw : 0.257, class : 0.042, t_rotation : 0.096, entropy : 0.179 - acc jigsaw : 90.62, class : 70.31 [bs:128]
30/42 of epoch 30/30 jigsaw : 0.184, class : 0.088, t_rotation : 0.093, entropy : 0.176 - acc jigsaw : 91.41, class : 77.34 [bs:128]
Accuracies on val: jigsaw : 94.21, class : 93.72
--------------------------------------------------------
Accuracies on test: jigsaw : 98.88, class : 80.99
--------------------------------------------------------
2019-12-16 05:59:57
sketch
['photo', 'cartoon', 'art_painting']
unsupervised_task_weight: 0.8
bias_hole_image: 0.3
target_rotation_weight: 0.8
entropy_weight 0.1
only_classify the ordered image: True
Highest accuracy on validation set appears on epoch  tensor(29)
Highest accuracy on test set appears on epoch  tensor(21)
Accuracy on test set when the accuracy on validation set is highest:0.810
Highest accuracy on test set:0.819
It took 1104.18
--------------------------------------------------------
******************Start training**************************************
--------------------------------------------------------
Dataset size: training 5457, validation 605, testing 3929
--------------------------------------------------------
Namespace(TTA=False, batch_size=128, bias_whole_image=0.3, classify_only_ordered_images_or_not=True, domains_list=['photo', 'sketch', 'cartoon', 'art_painting'], entropy_loss_weight=0.1, epochs=30, folder_name='test', image_size=222, jitter=0.4, learning_rate=0.001, limit_source=None, limit_target=None, max_scale=1.0, min_scale=0.8, n_classes=7, nesterov=False, network='resnet18', ooo_weight=0, parameters_lists=[[0.8, 0.3, 0.8, 0.1], [0.8, 0.5, 0.8, 0.1], [0.8, 0.6, 0.8, 0.1]], random_horiz_flip=0.5, repeat_times=3, source=['photo', 'cartoon', 'art_painting'], suffix='', target='sketch', target_domain_list=['art_painting', 'cartoon', 'sketch', 'photo'], target_domain_unsupervised_task_loss_weight=0.8, tf_logger=True, tile_random_grayscale=0.1, train_all=True, unsupervised_task_weight=0.8, val_size=0.1)
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 0
New epoch - lr: 0.001
0/42 of epoch 1/30 jigsaw : 1.524, class : 2.122, t_rotation : 1.459, entropy : 1.806 - acc jigsaw : 21.09, class : 13.28 [bs:128]
30/42 of epoch 1/30 jigsaw : 1.065, class : 1.088, t_rotation : 0.805, entropy : 1.754 - acc jigsaw : 60.16, class : 55.47 [bs:128]
Accuracies on val: jigsaw : 90.74, class : 75.37
--------------------------------------------------------
Accuracies on test: jigsaw : 95.24, class : 48.79
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 1
New epoch - lr: 0.001
0/42 of epoch 2/30 jigsaw : 0.977, class : 0.967, t_rotation : 0.824, entropy : 1.662 - acc jigsaw : 58.59, class : 60.16 [bs:128]
30/42 of epoch 2/30 jigsaw : 0.835, class : 0.589, t_rotation : 0.665, entropy : 1.361 - acc jigsaw : 68.75, class : 70.31 [bs:128]
Accuracies on val: jigsaw : 94.21, class : 82.48
--------------------------------------------------------
Accuracies on test: jigsaw : 93.36, class : 65.21
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 2
New epoch - lr: 0.001
0/42 of epoch 3/30 jigsaw : 0.874, class : 0.444, t_rotation : 0.588, entropy : 1.180 - acc jigsaw : 57.81, class : 74.22 [bs:128]
30/42 of epoch 3/30 jigsaw : 0.710, class : 0.513, t_rotation : 0.470, entropy : 1.023 - acc jigsaw : 75.00, class : 72.66 [bs:128]
Accuracies on val: jigsaw : 96.36, class : 86.12
--------------------------------------------------------
Accuracies on test: jigsaw : 96.33, class : 68.08
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 3
New epoch - lr: 0.001
0/42 of epoch 4/30 jigsaw : 0.765, class : 0.284, t_rotation : 0.425, entropy : 0.963 - acc jigsaw : 68.75, class : 78.12 [bs:128]
30/42 of epoch 4/30 jigsaw : 0.638, class : 0.267, t_rotation : 0.350, entropy : 0.841 - acc jigsaw : 70.31, class : 71.88 [bs:128]
Accuracies on val: jigsaw : 93.72, class : 87.11
--------------------------------------------------------
Accuracies on test: jigsaw : 94.99, class : 71.57
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 4
New epoch - lr: 0.001
0/42 of epoch 5/30 jigsaw : 0.671, class : 0.343, t_rotation : 0.339, entropy : 0.735 - acc jigsaw : 71.88, class : 69.53 [bs:128]
30/42 of epoch 5/30 jigsaw : 0.522, class : 0.227, t_rotation : 0.301, entropy : 0.626 - acc jigsaw : 83.59, class : 75.78 [bs:128]
Accuracies on val: jigsaw : 94.21, class : 89.92
--------------------------------------------------------
Accuracies on test: jigsaw : 94.71, class : 72.59
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 5
New epoch - lr: 0.001
0/42 of epoch 6/30 jigsaw : 0.509, class : 0.311, t_rotation : 0.341, entropy : 0.668 - acc jigsaw : 78.12, class : 73.44 [bs:128]
30/42 of epoch 6/30 jigsaw : 0.445, class : 0.271, t_rotation : 0.271, entropy : 0.576 - acc jigsaw : 81.25, class : 73.44 [bs:128]
Accuracies on val: jigsaw : 94.38, class : 89.59
--------------------------------------------------------
Accuracies on test: jigsaw : 95.16, class : 74.78
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 6
New epoch - lr: 0.001
0/42 of epoch 7/30 jigsaw : 0.504, class : 0.266, t_rotation : 0.229, entropy : 0.580 - acc jigsaw : 84.38, class : 79.69 [bs:128]
30/42 of epoch 7/30 jigsaw : 0.387, class : 0.179, t_rotation : 0.195, entropy : 0.503 - acc jigsaw : 82.81, class : 72.66 [bs:128]
Accuracies on val: jigsaw : 93.55, class : 90.58
--------------------------------------------------------
Accuracies on test: jigsaw : 96.36, class : 74.73
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 7
New epoch - lr: 0.001
0/42 of epoch 8/30 jigsaw : 0.404, class : 0.311, t_rotation : 0.230, entropy : 0.455 - acc jigsaw : 84.38, class : 70.31 [bs:128]
30/42 of epoch 8/30 jigsaw : 0.382, class : 0.105, t_rotation : 0.199, entropy : 0.432 - acc jigsaw : 89.06, class : 72.66 [bs:128]
Accuracies on val: jigsaw : 95.54, class : 91.74
--------------------------------------------------------
Accuracies on test: jigsaw : 97.51, class : 74.14
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 8
New epoch - lr: 0.001
0/42 of epoch 9/30 jigsaw : 0.495, class : 0.274, t_rotation : 0.318, entropy : 0.511 - acc jigsaw : 82.03, class : 71.09 [bs:128]
30/42 of epoch 9/30 jigsaw : 0.429, class : 0.114, t_rotation : 0.245, entropy : 0.488 - acc jigsaw : 84.38, class : 77.34 [bs:128]
Accuracies on val: jigsaw : 94.88, class : 90.41
--------------------------------------------------------
Accuracies on test: jigsaw : 98.24, class : 78.09
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 9
New epoch - lr: 0.001
0/42 of epoch 10/30 jigsaw : 0.434, class : 0.221, t_rotation : 0.260, entropy : 0.414 - acc jigsaw : 85.94, class : 67.97 [bs:128]
30/42 of epoch 10/30 jigsaw : 0.490, class : 0.282, t_rotation : 0.222, entropy : 0.385 - acc jigsaw : 82.81, class : 80.47 [bs:128]
Accuracies on val: jigsaw : 96.20, class : 91.07
--------------------------------------------------------
Accuracies on test: jigsaw : 97.68, class : 77.40
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 10
New epoch - lr: 0.001
0/42 of epoch 11/30 jigsaw : 0.274, class : 0.088, t_rotation : 0.180, entropy : 0.348 - acc jigsaw : 93.75, class : 71.09 [bs:128]
30/42 of epoch 11/30 jigsaw : 0.383, class : 0.212, t_rotation : 0.153, entropy : 0.342 - acc jigsaw : 85.94, class : 74.22 [bs:128]
Accuracies on val: jigsaw : 96.53, class : 91.90
--------------------------------------------------------
Accuracies on test: jigsaw : 97.05, class : 79.31
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 11
New epoch - lr: 0.001
0/42 of epoch 12/30 jigsaw : 0.289, class : 0.175, t_rotation : 0.205, entropy : 0.313 - acc jigsaw : 89.84, class : 74.22 [bs:128]
30/42 of epoch 12/30 jigsaw : 0.277, class : 0.054, t_rotation : 0.190, entropy : 0.299 - acc jigsaw : 90.62, class : 78.91 [bs:128]
Accuracies on val: jigsaw : 95.37, class : 91.74
--------------------------------------------------------
Accuracies on test: jigsaw : 98.01, class : 79.89
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 12
New epoch - lr: 0.001
0/42 of epoch 13/30 jigsaw : 0.334, class : 0.079, t_rotation : 0.197, entropy : 0.338 - acc jigsaw : 86.72, class : 67.97 [bs:128]
30/42 of epoch 13/30 jigsaw : 0.205, class : 0.111, t_rotation : 0.158, entropy : 0.311 - acc jigsaw : 93.75, class : 72.66 [bs:128]
Accuracies on val: jigsaw : 95.21, class : 91.07
--------------------------------------------------------
Accuracies on test: jigsaw : 98.68, class : 78.09
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 13
New epoch - lr: 0.001
0/42 of epoch 14/30 jigsaw : 0.272, class : 0.105, t_rotation : 0.144, entropy : 0.268 - acc jigsaw : 92.19, class : 71.09 [bs:128]
30/42 of epoch 14/30 jigsaw : 0.255, class : 0.198, t_rotation : 0.120, entropy : 0.253 - acc jigsaw : 89.84, class : 70.31 [bs:128]
Accuracies on val: jigsaw : 94.38, class : 91.40
--------------------------------------------------------
Accuracies on test: jigsaw : 98.07, class : 79.64
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 14
New epoch - lr: 0.001
0/42 of epoch 15/30 jigsaw : 0.314, class : 0.063, t_rotation : 0.258, entropy : 0.281 - acc jigsaw : 90.62, class : 75.00 [bs:128]
30/42 of epoch 15/30 jigsaw : 0.305, class : 0.063, t_rotation : 0.251, entropy : 0.263 - acc jigsaw : 89.84, class : 74.22 [bs:128]
Accuracies on val: jigsaw : 96.53, class : 91.57
--------------------------------------------------------
Accuracies on test: jigsaw : 99.08, class : 78.52
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 15
New epoch - lr: 0.001
0/42 of epoch 16/30 jigsaw : 0.386, class : 0.129, t_rotation : 0.203, entropy : 0.266 - acc jigsaw : 86.72, class : 76.56 [bs:128]
30/42 of epoch 16/30 jigsaw : 0.341, class : 0.142, t_rotation : 0.184, entropy : 0.258 - acc jigsaw : 86.72, class : 79.69 [bs:128]
Accuracies on val: jigsaw : 95.87, class : 91.40
--------------------------------------------------------
Accuracies on test: jigsaw : 99.19, class : 80.07
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 16
New epoch - lr: 0.001
0/42 of epoch 17/30 jigsaw : 0.215, class : 0.069, t_rotation : 0.208, entropy : 0.285 - acc jigsaw : 93.75, class : 72.66 [bs:128]
30/42 of epoch 17/30 jigsaw : 0.427, class : 0.062, t_rotation : 0.183, entropy : 0.270 - acc jigsaw : 82.03, class : 71.88 [bs:128]
Accuracies on val: jigsaw : 95.54, class : 93.55
--------------------------------------------------------
Accuracies on test: jigsaw : 99.24, class : 78.37
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 17
New epoch - lr: 0.001
0/42 of epoch 18/30 jigsaw : 0.343, class : 0.099, t_rotation : 0.223, entropy : 0.291 - acc jigsaw : 89.06, class : 69.53 [bs:128]
30/42 of epoch 18/30 jigsaw : 0.235, class : 0.142, t_rotation : 0.182, entropy : 0.264 - acc jigsaw : 92.97, class : 74.22 [bs:128]
Accuracies on val: jigsaw : 95.37, class : 93.39
--------------------------------------------------------
Accuracies on test: jigsaw : 98.24, class : 80.83
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 18
New epoch - lr: 0.001
0/42 of epoch 19/30 jigsaw : 0.263, class : 0.052, t_rotation : 0.121, entropy : 0.278 - acc jigsaw : 91.41, class : 72.66 [bs:128]
30/42 of epoch 19/30 jigsaw : 0.301, class : 0.087, t_rotation : 0.109, entropy : 0.252 - acc jigsaw : 87.50, class : 71.88 [bs:128]
Accuracies on val: jigsaw : 95.04, class : 93.22
--------------------------------------------------------
Accuracies on test: jigsaw : 97.76, class : 81.85
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 19
New epoch - lr: 0.001
0/42 of epoch 20/30 jigsaw : 0.325, class : 0.091, t_rotation : 0.111, entropy : 0.241 - acc jigsaw : 89.84, class : 80.47 [bs:128]
30/42 of epoch 20/30 jigsaw : 0.333, class : 0.069, t_rotation : 0.091, entropy : 0.205 - acc jigsaw : 85.94, class : 76.56 [bs:128]
Accuracies on val: jigsaw : 94.88, class : 93.88
--------------------------------------------------------
Accuracies on test: jigsaw : 99.13, class : 81.62
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 20
New epoch - lr: 0.001
0/42 of epoch 21/30 jigsaw : 0.264, class : 0.061, t_rotation : 0.084, entropy : 0.254 - acc jigsaw : 91.41, class : 73.44 [bs:128]
30/42 of epoch 21/30 jigsaw : 0.312, class : 0.146, t_rotation : 0.077, entropy : 0.237 - acc jigsaw : 88.28, class : 76.56 [bs:128]
Accuracies on val: jigsaw : 96.03, class : 94.38
--------------------------------------------------------
Accuracies on test: jigsaw : 99.47, class : 81.70
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 21
New epoch - lr: 0.001
0/42 of epoch 22/30 jigsaw : 0.276, class : 0.058, t_rotation : 0.161, entropy : 0.176 - acc jigsaw : 91.41, class : 75.78 [bs:128]
30/42 of epoch 22/30 jigsaw : 0.255, class : 0.064, t_rotation : 0.112, entropy : 0.170 - acc jigsaw : 90.62, class : 78.12 [bs:128]
Accuracies on val: jigsaw : 95.21, class : 94.05
--------------------------------------------------------
Accuracies on test: jigsaw : 99.03, class : 80.73
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 22
New epoch - lr: 0.001
0/42 of epoch 23/30 jigsaw : 0.339, class : 0.118, t_rotation : 0.132, entropy : 0.176 - acc jigsaw : 89.84, class : 76.56 [bs:128]
30/42 of epoch 23/30 jigsaw : 0.216, class : 0.085, t_rotation : 0.108, entropy : 0.159 - acc jigsaw : 91.41, class : 77.34 [bs:128]
Accuracies on val: jigsaw : 96.36, class : 93.22
--------------------------------------------------------
Accuracies on test: jigsaw : 98.96, class : 82.21
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 23
New epoch - lr: 0.0001
0/42 of epoch 24/30 jigsaw : 0.175, class : 0.049, t_rotation : 0.171, entropy : 0.177 - acc jigsaw : 95.31, class : 71.09 [bs:128]
30/42 of epoch 24/30 jigsaw : 0.209, class : 0.074, t_rotation : 0.163, entropy : 0.175 - acc jigsaw : 92.97, class : 80.47 [bs:128]
Accuracies on val: jigsaw : 95.54, class : 93.88
--------------------------------------------------------
Accuracies on test: jigsaw : 98.88, class : 82.13
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 24
New epoch - lr: 0.0001
0/42 of epoch 25/30 jigsaw : 0.216, class : 0.057, t_rotation : 0.176, entropy : 0.137 - acc jigsaw : 92.19, class : 72.66 [bs:128]
30/42 of epoch 25/30 jigsaw : 0.188, class : 0.032, t_rotation : 0.171, entropy : 0.134 - acc jigsaw : 92.97, class : 75.78 [bs:128]
Accuracies on val: jigsaw : 95.54, class : 93.88
--------------------------------------------------------
Accuracies on test: jigsaw : 98.68, class : 81.45
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 25
New epoch - lr: 0.0001
0/42 of epoch 26/30 jigsaw : 0.134, class : 0.148, t_rotation : 0.090, entropy : 0.173 - acc jigsaw : 96.09, class : 73.44 [bs:128]
30/42 of epoch 26/30 jigsaw : 0.307, class : 0.052, t_rotation : 0.084, entropy : 0.174 - acc jigsaw : 88.28, class : 77.34 [bs:128]
Accuracies on val: jigsaw : 95.37, class : 93.88
--------------------------------------------------------
Accuracies on test: jigsaw : 98.73, class : 81.75
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 26
New epoch - lr: 0.0001
0/42 of epoch 27/30 jigsaw : 0.258, class : 0.027, t_rotation : 0.123, entropy : 0.131 - acc jigsaw : 89.06, class : 71.09 [bs:128]
30/42 of epoch 27/30 jigsaw : 0.228, class : 0.069, t_rotation : 0.117, entropy : 0.132 - acc jigsaw : 90.62, class : 73.44 [bs:128]
Accuracies on val: jigsaw : 95.37, class : 93.88
--------------------------------------------------------
Accuracies on test: jigsaw : 98.70, class : 81.75
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 27
New epoch - lr: 0.0001
0/42 of epoch 28/30 jigsaw : 0.297, class : 0.023, t_rotation : 0.096, entropy : 0.211 - acc jigsaw : 90.62, class : 78.12 [bs:128]
30/42 of epoch 28/30 jigsaw : 0.236, class : 0.019, t_rotation : 0.092, entropy : 0.208 - acc jigsaw : 92.97, class : 75.00 [bs:128]
Accuracies on val: jigsaw : 95.04, class : 93.72
--------------------------------------------------------
Accuracies on test: jigsaw : 98.63, class : 81.85
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 28
New epoch - lr: 0.0001
0/42 of epoch 29/30 jigsaw : 0.232, class : 0.052, t_rotation : 0.119, entropy : 0.193 - acc jigsaw : 91.41, class : 79.69 [bs:128]
30/42 of epoch 29/30 jigsaw : 0.265, class : 0.033, t_rotation : 0.114, entropy : 0.192 - acc jigsaw : 92.19, class : 73.44 [bs:128]
Accuracies on val: jigsaw : 95.54, class : 93.55
--------------------------------------------------------
Accuracies on test: jigsaw : 98.70, class : 81.70
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 29
New epoch - lr: 0.0001
0/42 of epoch 30/30 jigsaw : 0.289, class : 0.186, t_rotation : 0.242, entropy : 0.183 - acc jigsaw : 89.06, class : 78.12 [bs:128]
30/42 of epoch 30/30 jigsaw : 0.189, class : 0.072, t_rotation : 0.236, entropy : 0.180 - acc jigsaw : 92.97, class : 70.31 [bs:128]
Accuracies on val: jigsaw : 96.03, class : 93.72
--------------------------------------------------------
Accuracies on test: jigsaw : 98.70, class : 81.42
--------------------------------------------------------
2019-12-16 06:18:24
sketch
['photo', 'cartoon', 'art_painting']
unsupervised_task_weight: 0.8
bias_hole_image: 0.3
target_rotation_weight: 0.8
entropy_weight 0.1
only_classify the ordered image: True
Highest accuracy on validation set appears on epoch  tensor(20)
Highest accuracy on test set appears on epoch  tensor(22)
Accuracy on test set when the accuracy on validation set is highest:0.817
Highest accuracy on test set:0.822
It took 1106.29
--------------------------------------------------------
******************Start training**************************************
--------------------------------------------------------
Dataset size: training 5457, validation 605, testing 3929
--------------------------------------------------------
Namespace(TTA=False, batch_size=128, bias_whole_image=0.3, classify_only_ordered_images_or_not=True, domains_list=['photo', 'sketch', 'cartoon', 'art_painting'], entropy_loss_weight=0.1, epochs=30, folder_name='test', image_size=222, jitter=0.4, learning_rate=0.001, limit_source=None, limit_target=None, max_scale=1.0, min_scale=0.8, n_classes=7, nesterov=False, network='resnet18', ooo_weight=0, parameters_lists=[[0.8, 0.3, 0.8, 0.1], [0.8, 0.5, 0.8, 0.1], [0.8, 0.6, 0.8, 0.1]], random_horiz_flip=0.5, repeat_times=3, source=['photo', 'cartoon', 'art_painting'], suffix='', target='sketch', target_domain_list=['art_painting', 'cartoon', 'sketch', 'photo'], target_domain_unsupervised_task_loss_weight=0.8, tf_logger=True, tile_random_grayscale=0.1, train_all=True, unsupervised_task_weight=0.8, val_size=0.1)
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 0
New epoch - lr: 0.001
0/42 of epoch 1/30 jigsaw : 1.419, class : 2.122, t_rotation : 1.315, entropy : 1.804 - acc jigsaw : 31.25, class : 10.94 [bs:128]
30/42 of epoch 1/30 jigsaw : 1.078, class : 1.068, t_rotation : 0.846, entropy : 1.764 - acc jigsaw : 53.91, class : 57.81 [bs:128]
Accuracies on val: jigsaw : 90.91, class : 73.06
--------------------------------------------------------
Accuracies on test: jigsaw : 92.98, class : 37.34
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 1
New epoch - lr: 0.001
0/42 of epoch 2/30 jigsaw : 1.061, class : 0.877, t_rotation : 0.698, entropy : 1.670 - acc jigsaw : 54.69, class : 65.62 [bs:128]
30/42 of epoch 2/30 jigsaw : 0.814, class : 0.625, t_rotation : 0.525, entropy : 1.451 - acc jigsaw : 63.28, class : 69.53 [bs:128]
Accuracies on val: jigsaw : 93.06, class : 81.16
--------------------------------------------------------
Accuracies on test: jigsaw : 92.29, class : 60.17
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 2
New epoch - lr: 0.001
0/42 of epoch 3/30 jigsaw : 0.830, class : 0.450, t_rotation : 0.621, entropy : 1.207 - acc jigsaw : 66.41, class : 77.34 [bs:128]
30/42 of epoch 3/30 jigsaw : 0.760, class : 0.321, t_rotation : 0.529, entropy : 0.977 - acc jigsaw : 70.31, class : 76.56 [bs:128]
Accuracies on val: jigsaw : 91.07, class : 85.12
--------------------------------------------------------
Accuracies on test: jigsaw : 93.99, class : 68.24
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 3
New epoch - lr: 0.001
0/42 of epoch 4/30 jigsaw : 0.745, class : 0.473, t_rotation : 0.465, entropy : 0.887 - acc jigsaw : 65.62, class : 78.12 [bs:128]
30/42 of epoch 4/30 jigsaw : 0.623, class : 0.368, t_rotation : 0.407, entropy : 0.773 - acc jigsaw : 75.00, class : 71.88 [bs:128]
Accuracies on val: jigsaw : 91.40, class : 84.63
--------------------------------------------------------
Accuracies on test: jigsaw : 94.73, class : 70.78
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 4
New epoch - lr: 0.001
0/42 of epoch 5/30 jigsaw : 0.755, class : 0.235, t_rotation : 0.360, entropy : 0.659 - acc jigsaw : 67.19, class : 79.69 [bs:128]
30/42 of epoch 5/30 jigsaw : 0.513, class : 0.328, t_rotation : 0.308, entropy : 0.540 - acc jigsaw : 82.81, class : 69.53 [bs:128]
Accuracies on val: jigsaw : 92.56, class : 87.93
--------------------------------------------------------
Accuracies on test: jigsaw : 95.50, class : 73.45
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 5
New epoch - lr: 0.001
0/42 of epoch 6/30 jigsaw : 0.576, class : 0.198, t_rotation : 0.330, entropy : 0.678 - acc jigsaw : 77.34, class : 71.88 [bs:128]
30/42 of epoch 6/30 jigsaw : 0.441, class : 0.228, t_rotation : 0.279, entropy : 0.580 - acc jigsaw : 87.50, class : 75.78 [bs:128]
Accuracies on val: jigsaw : 93.39, class : 88.93
--------------------------------------------------------
Accuracies on test: jigsaw : 95.55, class : 75.21
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 6
New epoch - lr: 0.001
0/42 of epoch 7/30 jigsaw : 0.559, class : 0.227, t_rotation : 0.301, entropy : 0.594 - acc jigsaw : 78.91, class : 80.47 [bs:128]
30/42 of epoch 7/30 jigsaw : 0.497, class : 0.285, t_rotation : 0.250, entropy : 0.499 - acc jigsaw : 81.25, class : 79.69 [bs:128]
Accuracies on val: jigsaw : 94.88, class : 90.25
--------------------------------------------------------
Accuracies on test: jigsaw : 97.00, class : 74.80
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 7
New epoch - lr: 0.001
0/42 of epoch 8/30 jigsaw : 0.516, class : 0.118, t_rotation : 0.221, entropy : 0.496 - acc jigsaw : 82.03, class : 83.59 [bs:128]
30/42 of epoch 8/30 jigsaw : 0.418, class : 0.178, t_rotation : 0.210, entropy : 0.463 - acc jigsaw : 87.50, class : 80.47 [bs:128]
Accuracies on val: jigsaw : 95.21, class : 90.25
--------------------------------------------------------
Accuracies on test: jigsaw : 98.09, class : 77.12
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 8
New epoch - lr: 0.001
0/42 of epoch 9/30 jigsaw : 0.435, class : 0.098, t_rotation : 0.213, entropy : 0.411 - acc jigsaw : 85.16, class : 81.25 [bs:128]
30/42 of epoch 9/30 jigsaw : 0.491, class : 0.273, t_rotation : 0.201, entropy : 0.351 - acc jigsaw : 79.69, class : 76.56 [bs:128]
Accuracies on val: jigsaw : 94.55, class : 91.74
--------------------------------------------------------
Accuracies on test: jigsaw : 97.07, class : 76.76
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 9
New epoch - lr: 0.001
0/42 of epoch 10/30 jigsaw : 0.348, class : 0.081, t_rotation : 0.228, entropy : 0.446 - acc jigsaw : 86.72, class : 77.34 [bs:128]
30/42 of epoch 10/30 jigsaw : 0.366, class : 0.112, t_rotation : 0.203, entropy : 0.377 - acc jigsaw : 85.16, class : 71.88 [bs:128]
Accuracies on val: jigsaw : 94.88, class : 91.40
--------------------------------------------------------
Accuracies on test: jigsaw : 96.61, class : 76.10
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 10
New epoch - lr: 0.001
0/42 of epoch 11/30 jigsaw : 0.399, class : 0.176, t_rotation : 0.143, entropy : 0.338 - acc jigsaw : 88.28, class : 71.88 [bs:128]
30/42 of epoch 11/30 jigsaw : 0.397, class : 0.166, t_rotation : 0.132, entropy : 0.319 - acc jigsaw : 85.16, class : 78.91 [bs:128]
Accuracies on val: jigsaw : 95.04, class : 91.90
--------------------------------------------------------
Accuracies on test: jigsaw : 97.56, class : 77.48
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 11
New epoch - lr: 0.001
0/42 of epoch 12/30 jigsaw : 0.348, class : 0.143, t_rotation : 0.110, entropy : 0.428 - acc jigsaw : 86.72, class : 72.66 [bs:128]
30/42 of epoch 12/30 jigsaw : 0.388, class : 0.218, t_rotation : 0.081, entropy : 0.411 - acc jigsaw : 84.38, class : 76.56 [bs:128]
Accuracies on val: jigsaw : 93.55, class : 91.07
--------------------------------------------------------
Accuracies on test: jigsaw : 98.45, class : 76.15
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 12
New epoch - lr: 0.001
0/42 of epoch 13/30 jigsaw : 0.518, class : 0.205, t_rotation : 0.159, entropy : 0.454 - acc jigsaw : 82.03, class : 69.53 [bs:128]
30/42 of epoch 13/30 jigsaw : 0.305, class : 0.072, t_rotation : 0.137, entropy : 0.403 - acc jigsaw : 89.06, class : 74.22 [bs:128]
Accuracies on val: jigsaw : 93.72, class : 92.23
--------------------------------------------------------
Accuracies on test: jigsaw : 98.50, class : 75.01
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 13
New epoch - lr: 0.001
0/42 of epoch 14/30 jigsaw : 0.318, class : 0.076, t_rotation : 0.183, entropy : 0.316 - acc jigsaw : 90.62, class : 78.91 [bs:128]
30/42 of epoch 14/30 jigsaw : 0.338, class : 0.119, t_rotation : 0.149, entropy : 0.297 - acc jigsaw : 87.50, class : 85.94 [bs:128]
Accuracies on val: jigsaw : 95.04, class : 92.23
--------------------------------------------------------
Accuracies on test: jigsaw : 97.89, class : 77.07
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 14
New epoch - lr: 0.001
0/42 of epoch 15/30 jigsaw : 0.376, class : 0.078, t_rotation : 0.290, entropy : 0.276 - acc jigsaw : 88.28, class : 78.12 [bs:128]
30/42 of epoch 15/30 jigsaw : 0.437, class : 0.096, t_rotation : 0.239, entropy : 0.259 - acc jigsaw : 84.38, class : 76.56 [bs:128]
Accuracies on val: jigsaw : 96.03, class : 92.73
--------------------------------------------------------
Accuracies on test: jigsaw : 97.25, class : 77.22
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 15
New epoch - lr: 0.001
0/42 of epoch 16/30 jigsaw : 0.338, class : 0.160, t_rotation : 0.172, entropy : 0.276 - acc jigsaw : 86.72, class : 75.78 [bs:128]
30/42 of epoch 16/30 jigsaw : 0.229, class : 0.052, t_rotation : 0.131, entropy : 0.271 - acc jigsaw : 92.97, class : 75.00 [bs:128]
Accuracies on val: jigsaw : 94.71, class : 92.56
--------------------------------------------------------
Accuracies on test: jigsaw : 97.63, class : 78.88
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 16
New epoch - lr: 0.001
0/42 of epoch 17/30 jigsaw : 0.244, class : 0.081, t_rotation : 0.099, entropy : 0.304 - acc jigsaw : 92.97, class : 78.91 [bs:128]
30/42 of epoch 17/30 jigsaw : 0.293, class : 0.055, t_rotation : 0.091, entropy : 0.279 - acc jigsaw : 89.06, class : 77.34 [bs:128]
Accuracies on val: jigsaw : 95.04, class : 93.06
--------------------------------------------------------
Accuracies on test: jigsaw : 98.40, class : 79.00
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 17
New epoch - lr: 0.001
0/42 of epoch 18/30 jigsaw : 0.378, class : 0.051, t_rotation : 0.115, entropy : 0.325 - acc jigsaw : 85.16, class : 83.59 [bs:128]
30/42 of epoch 18/30 jigsaw : 0.299, class : 0.088, t_rotation : 0.098, entropy : 0.309 - acc jigsaw : 90.62, class : 76.56 [bs:128]
Accuracies on val: jigsaw : 94.21, class : 92.73
--------------------------------------------------------
Accuracies on test: jigsaw : 97.25, class : 79.77
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 18
New epoch - lr: 0.001
0/42 of epoch 19/30 jigsaw : 0.236, class : 0.134, t_rotation : 0.168, entropy : 0.245 - acc jigsaw : 91.41, class : 71.09 [bs:128]
30/42 of epoch 19/30 jigsaw : 0.263, class : 0.067, t_rotation : 0.154, entropy : 0.239 - acc jigsaw : 93.75, class : 71.88 [bs:128]
Accuracies on val: jigsaw : 91.40, class : 93.06
--------------------------------------------------------
Accuracies on test: jigsaw : 98.27, class : 79.51
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 19
New epoch - lr: 0.001
0/42 of epoch 20/30 jigsaw : 0.225, class : 0.019, t_rotation : 0.211, entropy : 0.228 - acc jigsaw : 93.75, class : 78.12 [bs:128]
30/42 of epoch 20/30 jigsaw : 0.233, class : 0.033, t_rotation : 0.157, entropy : 0.216 - acc jigsaw : 91.41, class : 81.25 [bs:128]
Accuracies on val: jigsaw : 94.05, class : 92.07
--------------------------------------------------------
Accuracies on test: jigsaw : 96.23, class : 80.25
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 20
New epoch - lr: 0.001
0/42 of epoch 21/30 jigsaw : 0.442, class : 0.161, t_rotation : 0.157, entropy : 0.275 - acc jigsaw : 84.38, class : 71.88 [bs:128]
30/42 of epoch 21/30 jigsaw : 0.171, class : 0.088, t_rotation : 0.118, entropy : 0.265 - acc jigsaw : 94.53, class : 77.34 [bs:128]
Accuracies on val: jigsaw : 94.05, class : 93.06
--------------------------------------------------------
Accuracies on test: jigsaw : 97.33, class : 81.47
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 21
New epoch - lr: 0.001
0/42 of epoch 22/30 jigsaw : 0.297, class : 0.043, t_rotation : 0.158, entropy : 0.262 - acc jigsaw : 89.84, class : 74.22 [bs:128]
30/42 of epoch 22/30 jigsaw : 0.284, class : 0.041, t_rotation : 0.108, entropy : 0.242 - acc jigsaw : 91.41, class : 73.44 [bs:128]
Accuracies on val: jigsaw : 94.21, class : 92.89
--------------------------------------------------------
Accuracies on test: jigsaw : 98.40, class : 80.02
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 22
New epoch - lr: 0.001
0/42 of epoch 23/30 jigsaw : 0.279, class : 0.062, t_rotation : 0.205, entropy : 0.243 - acc jigsaw : 88.28, class : 78.12 [bs:128]
30/42 of epoch 23/30 jigsaw : 0.298, class : 0.073, t_rotation : 0.144, entropy : 0.218 - acc jigsaw : 89.84, class : 71.88 [bs:128]
Accuracies on val: jigsaw : 94.55, class : 92.89
--------------------------------------------------------
Accuracies on test: jigsaw : 98.52, class : 80.15
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 23
New epoch - lr: 0.0001
0/42 of epoch 24/30 jigsaw : 0.244, class : 0.042, t_rotation : 0.134, entropy : 0.220 - acc jigsaw : 92.19, class : 69.53 [bs:128]
30/42 of epoch 24/30 jigsaw : 0.153, class : 0.072, t_rotation : 0.128, entropy : 0.219 - acc jigsaw : 95.31, class : 71.88 [bs:128]
Accuracies on val: jigsaw : 93.88, class : 93.06
--------------------------------------------------------
Accuracies on test: jigsaw : 97.94, class : 80.86
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 24
New epoch - lr: 0.0001
0/42 of epoch 25/30 jigsaw : 0.193, class : 0.043, t_rotation : 0.170, entropy : 0.176 - acc jigsaw : 93.75, class : 80.47 [bs:128]
30/42 of epoch 25/30 jigsaw : 0.170, class : 0.031, t_rotation : 0.166, entropy : 0.175 - acc jigsaw : 94.53, class : 81.25 [bs:128]
Accuracies on val: jigsaw : 94.71, class : 92.73
--------------------------------------------------------
Accuracies on test: jigsaw : 97.96, class : 80.63
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 25
New epoch - lr: 0.0001
0/42 of epoch 26/30 jigsaw : 0.202, class : 0.026, t_rotation : 0.105, entropy : 0.098 - acc jigsaw : 91.41, class : 76.56 [bs:128]
30/42 of epoch 26/30 jigsaw : 0.226, class : 0.068, t_rotation : 0.102, entropy : 0.098 - acc jigsaw : 90.62, class : 74.22 [bs:128]
Accuracies on val: jigsaw : 94.55, class : 92.73
--------------------------------------------------------
Accuracies on test: jigsaw : 98.04, class : 80.33
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 26
New epoch - lr: 0.0001
0/42 of epoch 27/30 jigsaw : 0.242, class : 0.040, t_rotation : 0.110, entropy : 0.247 - acc jigsaw : 91.41, class : 77.34 [bs:128]
30/42 of epoch 27/30 jigsaw : 0.191, class : 0.022, t_rotation : 0.108, entropy : 0.244 - acc jigsaw : 93.75, class : 82.81 [bs:128]
Accuracies on val: jigsaw : 94.88, class : 92.73
--------------------------------------------------------
Accuracies on test: jigsaw : 98.12, class : 80.86
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 27
New epoch - lr: 0.0001
0/42 of epoch 28/30 jigsaw : 0.252, class : 0.080, t_rotation : 0.134, entropy : 0.217 - acc jigsaw : 89.84, class : 74.22 [bs:128]
30/42 of epoch 28/30 jigsaw : 0.239, class : 0.062, t_rotation : 0.129, entropy : 0.214 - acc jigsaw : 92.19, class : 74.22 [bs:128]
Accuracies on val: jigsaw : 95.21, class : 93.06
--------------------------------------------------------
Accuracies on test: jigsaw : 98.22, class : 80.78
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 28
New epoch - lr: 0.0001
0/42 of epoch 29/30 jigsaw : 0.228, class : 0.059, t_rotation : 0.133, entropy : 0.195 - acc jigsaw : 92.97, class : 73.44 [bs:128]
30/42 of epoch 29/30 jigsaw : 0.241, class : 0.072, t_rotation : 0.127, entropy : 0.195 - acc jigsaw : 91.41, class : 80.47 [bs:128]
Accuracies on val: jigsaw : 95.04, class : 92.73
--------------------------------------------------------
Accuracies on test: jigsaw : 98.12, class : 80.89
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 29
New epoch - lr: 0.0001
0/42 of epoch 30/30 jigsaw : 0.267, class : 0.050, t_rotation : 0.088, entropy : 0.202 - acc jigsaw : 89.84, class : 74.22 [bs:128]
30/42 of epoch 30/30 jigsaw : 0.161, class : 0.047, t_rotation : 0.083, entropy : 0.201 - acc jigsaw : 94.53, class : 74.22 [bs:128]
Accuracies on val: jigsaw : 94.21, class : 92.56
--------------------------------------------------------
Accuracies on test: jigsaw : 98.14, class : 80.83
--------------------------------------------------------
2019-12-16 06:36:49
sketch
['photo', 'cartoon', 'art_painting']
unsupervised_task_weight: 0.8
bias_hole_image: 0.3
target_rotation_weight: 0.8
entropy_weight 0.1
only_classify the ordered image: True
Highest accuracy on validation set appears on epoch  tensor(27)
Highest accuracy on test set appears on epoch  tensor(20)
Accuracy on test set when the accuracy on validation set is highest:0.808
Highest accuracy on test set:0.815
It took 1105.47
--------------------------------------------------------
******************Start training**************************************
--------------------------------------------------------
Dataset size: training 7491, validation 830, testing 1670
--------------------------------------------------------
Namespace(TTA=False, batch_size=128, bias_whole_image=0.3, classify_only_ordered_images_or_not=True, domains_list=['photo', 'sketch', 'cartoon', 'art_painting'], entropy_loss_weight=0.1, epochs=30, folder_name='test', image_size=222, jitter=0.4, learning_rate=0.001, limit_source=None, limit_target=None, max_scale=1.0, min_scale=0.8, n_classes=7, nesterov=False, network='resnet18', ooo_weight=0, parameters_lists=[[0.8, 0.3, 0.8, 0.1], [0.8, 0.5, 0.8, 0.1], [0.8, 0.6, 0.8, 0.1]], random_horiz_flip=0.5, repeat_times=3, source=['sketch', 'cartoon', 'art_painting'], suffix='', target='photo', target_domain_list=['art_painting', 'cartoon', 'sketch', 'photo'], target_domain_unsupervised_task_loss_weight=0.8, tf_logger=True, tile_random_grayscale=0.1, train_all=True, unsupervised_task_weight=0.8, val_size=0.1)
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 0
New epoch - lr: 0.001
0/58 of epoch 1/30 jigsaw : 1.273, class : 2.062, t_rotation : 1.347, entropy : 1.835 - acc jigsaw : 47.66, class : 16.41 [bs:128]
30/58 of epoch 1/30 jigsaw : 1.023, class : 1.225, t_rotation : 0.799, entropy : 1.737 - acc jigsaw : 60.16, class : 48.44 [bs:128]
Accuracies on val: jigsaw : 88.67, class : 67.47
--------------------------------------------------------
Accuracies on test: jigsaw : 97.66, class : 83.11
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 1
New epoch - lr: 0.001
0/58 of epoch 2/30 jigsaw : 0.798, class : 0.809, t_rotation : 0.603, entropy : 1.343 - acc jigsaw : 65.62, class : 60.94 [bs:128]
30/58 of epoch 2/30 jigsaw : 0.762, class : 0.807, t_rotation : 0.420, entropy : 0.879 - acc jigsaw : 71.09, class : 63.28 [bs:128]
Accuracies on val: jigsaw : 85.54, class : 78.07
--------------------------------------------------------
Accuracies on test: jigsaw : 96.77, class : 94.73
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 2
New epoch - lr: 0.001
0/58 of epoch 3/30 jigsaw : 0.671, class : 0.493, t_rotation : 0.396, entropy : 0.621 - acc jigsaw : 74.22, class : 64.84 [bs:128]
30/58 of epoch 3/30 jigsaw : 0.691, class : 0.455, t_rotation : 0.336, entropy : 0.439 - acc jigsaw : 71.09, class : 67.97 [bs:128]
Accuracies on val: jigsaw : 90.00, class : 81.81
--------------------------------------------------------
Accuracies on test: jigsaw : 98.26, class : 96.05
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 3
New epoch - lr: 0.001
0/58 of epoch 4/30 jigsaw : 0.584, class : 0.375, t_rotation : 0.357, entropy : 0.330 - acc jigsaw : 78.91, class : 67.97 [bs:128]
30/58 of epoch 4/30 jigsaw : 0.550, class : 0.257, t_rotation : 0.321, entropy : 0.336 - acc jigsaw : 83.59, class : 71.09 [bs:128]
Accuracies on val: jigsaw : 89.28, class : 86.02
--------------------------------------------------------
Accuracies on test: jigsaw : 96.53, class : 97.13
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 4
New epoch - lr: 0.001
0/58 of epoch 5/30 jigsaw : 0.493, class : 0.261, t_rotation : 0.358, entropy : 0.229 - acc jigsaw : 81.25, class : 68.75 [bs:128]
30/58 of epoch 5/30 jigsaw : 0.540, class : 0.251, t_rotation : 0.309, entropy : 0.297 - acc jigsaw : 79.69, class : 79.69 [bs:128]
Accuracies on val: jigsaw : 89.76, class : 88.80
--------------------------------------------------------
Accuracies on test: jigsaw : 97.60, class : 97.31
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 5
New epoch - lr: 0.001
0/58 of epoch 6/30 jigsaw : 0.386, class : 0.245, t_rotation : 0.290, entropy : 0.175 - acc jigsaw : 85.16, class : 70.31 [bs:128]
30/58 of epoch 6/30 jigsaw : 0.374, class : 0.176, t_rotation : 0.192, entropy : 0.205 - acc jigsaw : 83.59, class : 72.66 [bs:128]
Accuracies on val: jigsaw : 87.83, class : 87.71
--------------------------------------------------------
Accuracies on test: jigsaw : 97.25, class : 97.37
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 6
New epoch - lr: 0.001
0/58 of epoch 7/30 jigsaw : 0.369, class : 0.123, t_rotation : 0.215, entropy : 0.123 - acc jigsaw : 83.59, class : 74.22 [bs:128]
30/58 of epoch 7/30 jigsaw : 0.425, class : 0.301, t_rotation : 0.168, entropy : 0.112 - acc jigsaw : 82.81, class : 72.66 [bs:128]
Accuracies on val: jigsaw : 89.16, class : 87.71
--------------------------------------------------------
Accuracies on test: jigsaw : 97.54, class : 97.72
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 7
New epoch - lr: 0.001
0/58 of epoch 8/30 jigsaw : 0.349, class : 0.188, t_rotation : 0.225, entropy : 0.228 - acc jigsaw : 85.94, class : 71.09 [bs:128]
30/58 of epoch 8/30 jigsaw : 0.375, class : 0.189, t_rotation : 0.117, entropy : 0.139 - acc jigsaw : 85.94, class : 71.09 [bs:128]
Accuracies on val: jigsaw : 88.67, class : 89.76
--------------------------------------------------------
Accuracies on test: jigsaw : 97.07, class : 97.54
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 8
New epoch - lr: 0.001
0/58 of epoch 9/30 jigsaw : 0.312, class : 0.200, t_rotation : 0.173, entropy : 0.145 - acc jigsaw : 89.84, class : 72.66 [bs:128]
30/58 of epoch 9/30 jigsaw : 0.442, class : 0.138, t_rotation : 0.096, entropy : 0.109 - acc jigsaw : 84.38, class : 71.88 [bs:128]
Accuracies on val: jigsaw : 91.45, class : 89.16
--------------------------------------------------------
Accuracies on test: jigsaw : 98.62, class : 97.78
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 9
New epoch - lr: 0.001
0/58 of epoch 10/30 jigsaw : 0.277, class : 0.206, t_rotation : 0.194, entropy : 0.124 - acc jigsaw : 91.41, class : 67.97 [bs:128]
30/58 of epoch 10/30 jigsaw : 0.228, class : 0.186, t_rotation : 0.185, entropy : 0.119 - acc jigsaw : 91.41, class : 71.09 [bs:128]
Accuracies on val: jigsaw : 93.01, class : 89.64
--------------------------------------------------------
Accuracies on test: jigsaw : 98.50, class : 97.90
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 10
New epoch - lr: 0.001
0/58 of epoch 11/30 jigsaw : 0.268, class : 0.150, t_rotation : 0.199, entropy : 0.124 - acc jigsaw : 89.06, class : 69.53 [bs:128]
30/58 of epoch 11/30 jigsaw : 0.303, class : 0.170, t_rotation : 0.059, entropy : 0.133 - acc jigsaw : 89.84, class : 75.00 [bs:128]
Accuracies on val: jigsaw : 92.53, class : 89.88
--------------------------------------------------------
Accuracies on test: jigsaw : 98.50, class : 97.78
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 11
New epoch - lr: 0.001
0/58 of epoch 12/30 jigsaw : 0.316, class : 0.216, t_rotation : 0.169, entropy : 0.127 - acc jigsaw : 88.28, class : 71.88 [bs:128]
30/58 of epoch 12/30 jigsaw : 0.399, class : 0.198, t_rotation : 0.103, entropy : 0.112 - acc jigsaw : 88.28, class : 75.00 [bs:128]
Accuracies on val: jigsaw : 92.29, class : 90.48
--------------------------------------------------------
Accuracies on test: jigsaw : 98.92, class : 97.84
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 12
New epoch - lr: 0.001
0/58 of epoch 13/30 jigsaw : 0.298, class : 0.117, t_rotation : 0.221, entropy : 0.074 - acc jigsaw : 89.84, class : 80.47 [bs:128]
30/58 of epoch 13/30 jigsaw : 0.300, class : 0.111, t_rotation : 0.097, entropy : 0.091 - acc jigsaw : 89.84, class : 71.09 [bs:128]
Accuracies on val: jigsaw : 92.41, class : 91.08
--------------------------------------------------------
Accuracies on test: jigsaw : 98.32, class : 97.90
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 13
New epoch - lr: 0.001
0/58 of epoch 14/30 jigsaw : 0.292, class : 0.192, t_rotation : 0.144, entropy : 0.129 - acc jigsaw : 85.94, class : 70.31 [bs:128]
30/58 of epoch 14/30 jigsaw : 0.260, class : 0.134, t_rotation : 0.075, entropy : 0.118 - acc jigsaw : 93.75, class : 67.97 [bs:128]
Accuracies on val: jigsaw : 93.49, class : 92.17
--------------------------------------------------------
Accuracies on test: jigsaw : 98.74, class : 97.90
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 14
New epoch - lr: 0.001
0/58 of epoch 15/30 jigsaw : 0.209, class : 0.071, t_rotation : 0.092, entropy : 0.067 - acc jigsaw : 91.41, class : 66.41 [bs:128]
30/58 of epoch 15/30 jigsaw : 0.297, class : 0.101, t_rotation : 0.090, entropy : 0.078 - acc jigsaw : 89.84, class : 76.56 [bs:128]
Accuracies on val: jigsaw : 92.65, class : 91.57
--------------------------------------------------------
Accuracies on test: jigsaw : 98.92, class : 98.08
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 15
New epoch - lr: 0.001
0/58 of epoch 16/30 jigsaw : 0.328, class : 0.061, t_rotation : 0.177, entropy : 0.115 - acc jigsaw : 87.50, class : 82.03 [bs:128]
30/58 of epoch 16/30 jigsaw : 0.249, class : 0.047, t_rotation : 0.058, entropy : 0.087 - acc jigsaw : 90.62, class : 79.69 [bs:128]
Accuracies on val: jigsaw : 94.10, class : 91.08
--------------------------------------------------------
Accuracies on test: jigsaw : 98.86, class : 97.90
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 16
New epoch - lr: 0.001
0/58 of epoch 17/30 jigsaw : 0.234, class : 0.170, t_rotation : 0.134, entropy : 0.025 - acc jigsaw : 89.06, class : 71.88 [bs:128]
30/58 of epoch 17/30 jigsaw : 0.319, class : 0.117, t_rotation : 0.087, entropy : 0.065 - acc jigsaw : 89.06, class : 69.53 [bs:128]
Accuracies on val: jigsaw : 93.01, class : 91.45
--------------------------------------------------------
Accuracies on test: jigsaw : 99.04, class : 97.84
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 17
New epoch - lr: 0.001
0/58 of epoch 18/30 jigsaw : 0.243, class : 0.063, t_rotation : 0.096, entropy : 0.112 - acc jigsaw : 92.19, class : 71.88 [bs:128]
30/58 of epoch 18/30 jigsaw : 0.317, class : 0.121, t_rotation : 0.069, entropy : 0.081 - acc jigsaw : 89.06, class : 77.34 [bs:128]
Accuracies on val: jigsaw : 94.46, class : 92.05
--------------------------------------------------------
Accuracies on test: jigsaw : 99.10, class : 97.84
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 18
New epoch - lr: 0.001
0/58 of epoch 19/30 jigsaw : 0.216, class : 0.079, t_rotation : 0.133, entropy : 0.135 - acc jigsaw : 92.97, class : 74.22 [bs:128]
30/58 of epoch 19/30 jigsaw : 0.174, class : 0.079, t_rotation : 0.102, entropy : 0.076 - acc jigsaw : 92.19, class : 74.22 [bs:128]
Accuracies on val: jigsaw : 93.61, class : 91.33
--------------------------------------------------------
Accuracies on test: jigsaw : 99.10, class : 98.08
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 19
New epoch - lr: 0.001
0/58 of epoch 20/30 jigsaw : 0.155, class : 0.169, t_rotation : 0.114, entropy : 0.078 - acc jigsaw : 94.53, class : 70.31 [bs:128]
30/58 of epoch 20/30 jigsaw : 0.258, class : 0.113, t_rotation : 0.151, entropy : 0.048 - acc jigsaw : 90.62, class : 75.00 [bs:128]
Accuracies on val: jigsaw : 94.34, class : 90.72
--------------------------------------------------------
Accuracies on test: jigsaw : 99.10, class : 98.14
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 20
New epoch - lr: 0.001
0/58 of epoch 21/30 jigsaw : 0.287, class : 0.073, t_rotation : 0.094, entropy : 0.081 - acc jigsaw : 91.41, class : 75.78 [bs:128]
30/58 of epoch 21/30 jigsaw : 0.139, class : 0.066, t_rotation : 0.092, entropy : 0.096 - acc jigsaw : 94.53, class : 71.09 [bs:128]
Accuracies on val: jigsaw : 94.82, class : 91.81
--------------------------------------------------------
Accuracies on test: jigsaw : 99.34, class : 98.02
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 21
New epoch - lr: 0.001
0/58 of epoch 22/30 jigsaw : 0.268, class : 0.097, t_rotation : 0.138, entropy : 0.045 - acc jigsaw : 91.41, class : 78.91 [bs:128]
30/58 of epoch 22/30 jigsaw : 0.185, class : 0.092, t_rotation : 0.076, entropy : 0.085 - acc jigsaw : 96.09, class : 75.78 [bs:128]
Accuracies on val: jigsaw : 92.89, class : 90.84
--------------------------------------------------------
Accuracies on test: jigsaw : 98.92, class : 98.32
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 22
New epoch - lr: 0.001
0/58 of epoch 23/30 jigsaw : 0.143, class : 0.051, t_rotation : 0.069, entropy : 0.052 - acc jigsaw : 96.88, class : 68.75 [bs:128]
30/58 of epoch 23/30 jigsaw : 0.183, class : 0.113, t_rotation : 0.049, entropy : 0.055 - acc jigsaw : 94.53, class : 75.78 [bs:128]
Accuracies on val: jigsaw : 94.10, class : 91.20
--------------------------------------------------------
Accuracies on test: jigsaw : 98.86, class : 98.20
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 23
New epoch - lr: 0.0001
0/58 of epoch 24/30 jigsaw : 0.208, class : 0.009, t_rotation : 0.113, entropy : 0.039 - acc jigsaw : 92.19, class : 78.12 [bs:128]
30/58 of epoch 24/30 jigsaw : 0.242, class : 0.047, t_rotation : 0.090, entropy : 0.081 - acc jigsaw : 91.41, class : 77.34 [bs:128]
Accuracies on val: jigsaw : 93.73, class : 91.93
--------------------------------------------------------
Accuracies on test: jigsaw : 99.22, class : 98.26
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 24
New epoch - lr: 0.0001
0/58 of epoch 25/30 jigsaw : 0.196, class : 0.043, t_rotation : 0.090, entropy : 0.054 - acc jigsaw : 92.19, class : 77.34 [bs:128]
30/58 of epoch 25/30 jigsaw : 0.301, class : 0.096, t_rotation : 0.114, entropy : 0.023 - acc jigsaw : 90.62, class : 75.78 [bs:128]
Accuracies on val: jigsaw : 94.58, class : 91.93
--------------------------------------------------------
Accuracies on test: jigsaw : 99.22, class : 98.26
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 25
New epoch - lr: 0.0001
0/58 of epoch 26/30 jigsaw : 0.262, class : 0.062, t_rotation : 0.141, entropy : 0.030 - acc jigsaw : 89.06, class : 73.44 [bs:128]
30/58 of epoch 26/30 jigsaw : 0.271, class : 0.052, t_rotation : 0.110, entropy : 0.065 - acc jigsaw : 90.62, class : 75.78 [bs:128]
Accuracies on val: jigsaw : 94.46, class : 92.17
--------------------------------------------------------
Accuracies on test: jigsaw : 99.22, class : 98.26
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 26
New epoch - lr: 0.0001
0/58 of epoch 27/30 jigsaw : 0.294, class : 0.053, t_rotation : 0.119, entropy : 0.065 - acc jigsaw : 92.97, class : 66.41 [bs:128]
30/58 of epoch 27/30 jigsaw : 0.289, class : 0.010, t_rotation : 0.093, entropy : 0.060 - acc jigsaw : 89.06, class : 78.91 [bs:128]
Accuracies on val: jigsaw : 94.58, class : 91.93
--------------------------------------------------------
Accuracies on test: jigsaw : 99.10, class : 98.26
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 27
New epoch - lr: 0.0001
0/58 of epoch 28/30 jigsaw : 0.147, class : 0.101, t_rotation : 0.067, entropy : 0.040 - acc jigsaw : 92.97, class : 68.75 [bs:128]
30/58 of epoch 28/30 jigsaw : 0.165, class : 0.039, t_rotation : 0.055, entropy : 0.036 - acc jigsaw : 93.75, class : 73.44 [bs:128]
Accuracies on val: jigsaw : 94.22, class : 92.05
--------------------------------------------------------
Accuracies on test: jigsaw : 99.40, class : 98.26
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 28
New epoch - lr: 0.0001
0/58 of epoch 29/30 jigsaw : 0.191, class : 0.035, t_rotation : 0.100, entropy : 0.045 - acc jigsaw : 94.53, class : 70.31 [bs:128]
30/58 of epoch 29/30 jigsaw : 0.263, class : 0.072, t_rotation : 0.128, entropy : 0.040 - acc jigsaw : 90.62, class : 79.69 [bs:128]
Accuracies on val: jigsaw : 94.70, class : 92.05
--------------------------------------------------------
Accuracies on test: jigsaw : 99.40, class : 98.32
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 29
New epoch - lr: 0.0001
0/58 of epoch 30/30 jigsaw : 0.120, class : 0.099, t_rotation : 0.092, entropy : 0.036 - acc jigsaw : 96.88, class : 72.66 [bs:128]
30/58 of epoch 30/30 jigsaw : 0.134, class : 0.135, t_rotation : 0.097, entropy : 0.055 - acc jigsaw : 94.53, class : 73.44 [bs:128]
Accuracies on val: jigsaw : 94.70, class : 92.53
--------------------------------------------------------
Accuracies on test: jigsaw : 99.22, class : 98.14
--------------------------------------------------------
2019-12-16 07:00:07
photo
['sketch', 'cartoon', 'art_painting']
unsupervised_task_weight: 0.8
bias_hole_image: 0.3
target_rotation_weight: 0.8
entropy_weight 0.1
only_classify the ordered image: True
Highest accuracy on validation set appears on epoch  tensor(29)
Highest accuracy on test set appears on epoch  tensor(28)
Accuracy on test set when the accuracy on validation set is highest:0.981
Highest accuracy on test set:0.983
It took 1397.65
--------------------------------------------------------
******************Start training**************************************
--------------------------------------------------------
Dataset size: training 7491, validation 830, testing 1670
--------------------------------------------------------
Namespace(TTA=False, batch_size=128, bias_whole_image=0.3, classify_only_ordered_images_or_not=True, domains_list=['photo', 'sketch', 'cartoon', 'art_painting'], entropy_loss_weight=0.1, epochs=30, folder_name='test', image_size=222, jitter=0.4, learning_rate=0.001, limit_source=None, limit_target=None, max_scale=1.0, min_scale=0.8, n_classes=7, nesterov=False, network='resnet18', ooo_weight=0, parameters_lists=[[0.8, 0.3, 0.8, 0.1], [0.8, 0.5, 0.8, 0.1], [0.8, 0.6, 0.8, 0.1]], random_horiz_flip=0.5, repeat_times=3, source=['sketch', 'cartoon', 'art_painting'], suffix='', target='photo', target_domain_list=['art_painting', 'cartoon', 'sketch', 'photo'], target_domain_unsupervised_task_loss_weight=0.8, tf_logger=True, tile_random_grayscale=0.1, train_all=True, unsupervised_task_weight=0.8, val_size=0.1)
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 0
New epoch - lr: 0.001
0/58 of epoch 1/30 jigsaw : 1.319, class : 2.234, t_rotation : 1.289, entropy : 1.447 - acc jigsaw : 39.84, class : 24.22 [bs:128]
30/58 of epoch 1/30 jigsaw : 0.998, class : 1.200, t_rotation : 0.811, entropy : 1.685 - acc jigsaw : 61.72, class : 46.88 [bs:128]
Accuracies on val: jigsaw : 87.11, class : 73.13
--------------------------------------------------------
Accuracies on test: jigsaw : 96.83, class : 77.66
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 1
New epoch - lr: 0.001
0/58 of epoch 2/30 jigsaw : 0.722, class : 0.791, t_rotation : 0.557, entropy : 1.273 - acc jigsaw : 72.66, class : 58.59 [bs:128]
30/58 of epoch 2/30 jigsaw : 0.700, class : 0.688, t_rotation : 0.444, entropy : 0.915 - acc jigsaw : 69.53, class : 63.28 [bs:128]
Accuracies on val: jigsaw : 89.04, class : 84.10
--------------------------------------------------------
Accuracies on test: jigsaw : 96.71, class : 90.96
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 2
New epoch - lr: 0.001
0/58 of epoch 3/30 jigsaw : 0.644, class : 0.554, t_rotation : 0.404, entropy : 0.770 - acc jigsaw : 77.34, class : 67.97 [bs:128]
30/58 of epoch 3/30 jigsaw : 0.756, class : 0.318, t_rotation : 0.423, entropy : 0.529 - acc jigsaw : 67.97, class : 70.31 [bs:128]
Accuracies on val: jigsaw : 90.24, class : 85.18
--------------------------------------------------------
Accuracies on test: jigsaw : 97.54, class : 93.95
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 3
New epoch - lr: 0.001
0/58 of epoch 4/30 jigsaw : 0.633, class : 0.335, t_rotation : 0.395, entropy : 0.526 - acc jigsaw : 76.56, class : 65.62 [bs:128]
30/58 of epoch 4/30 jigsaw : 0.505, class : 0.265, t_rotation : 0.302, entropy : 0.432 - acc jigsaw : 82.81, class : 74.22 [bs:128]
Accuracies on val: jigsaw : 90.84, class : 86.27
--------------------------------------------------------
Accuracies on test: jigsaw : 97.49, class : 92.69
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 4
New epoch - lr: 0.001
0/58 of epoch 5/30 jigsaw : 0.542, class : 0.277, t_rotation : 0.316, entropy : 0.404 - acc jigsaw : 80.47, class : 73.44 [bs:128]
30/58 of epoch 5/30 jigsaw : 0.478, class : 0.410, t_rotation : 0.253, entropy : 0.371 - acc jigsaw : 81.25, class : 64.06 [bs:128]
Accuracies on val: jigsaw : 92.05, class : 87.47
--------------------------------------------------------
Accuracies on test: jigsaw : 97.49, class : 95.51
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 5
New epoch - lr: 0.001
0/58 of epoch 6/30 jigsaw : 0.521, class : 0.276, t_rotation : 0.222, entropy : 0.310 - acc jigsaw : 78.91, class : 71.09 [bs:128]
30/58 of epoch 6/30 jigsaw : 0.429, class : 0.365, t_rotation : 0.203, entropy : 0.363 - acc jigsaw : 82.81, class : 67.19 [bs:128]
Accuracies on val: jigsaw : 92.29, class : 87.47
--------------------------------------------------------
Accuracies on test: jigsaw : 97.49, class : 97.49
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 6
New epoch - lr: 0.001
0/58 of epoch 7/30 jigsaw : 0.433, class : 0.223, t_rotation : 0.198, entropy : 0.318 - acc jigsaw : 87.50, class : 74.22 [bs:128]
30/58 of epoch 7/30 jigsaw : 0.409, class : 0.302, t_rotation : 0.248, entropy : 0.239 - acc jigsaw : 86.72, class : 72.66 [bs:128]
Accuracies on val: jigsaw : 90.96, class : 89.52
--------------------------------------------------------
Accuracies on test: jigsaw : 97.43, class : 97.31
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 7
New epoch - lr: 0.001
0/58 of epoch 8/30 jigsaw : 0.392, class : 0.346, t_rotation : 0.214, entropy : 0.158 - acc jigsaw : 85.94, class : 67.97 [bs:128]
30/58 of epoch 8/30 jigsaw : 0.419, class : 0.179, t_rotation : 0.165, entropy : 0.155 - acc jigsaw : 87.50, class : 71.88 [bs:128]
Accuracies on val: jigsaw : 92.89, class : 90.00
--------------------------------------------------------
Accuracies on test: jigsaw : 98.02, class : 97.25
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 8
New epoch - lr: 0.001
0/58 of epoch 9/30 jigsaw : 0.310, class : 0.222, t_rotation : 0.171, entropy : 0.188 - acc jigsaw : 89.06, class : 73.44 [bs:128]
30/58 of epoch 9/30 jigsaw : 0.434, class : 0.175, t_rotation : 0.132, entropy : 0.160 - acc jigsaw : 82.81, class : 75.00 [bs:128]
Accuracies on val: jigsaw : 92.41, class : 89.88
--------------------------------------------------------
Accuracies on test: jigsaw : 98.02, class : 97.25
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 9
New epoch - lr: 0.001
0/58 of epoch 10/30 jigsaw : 0.396, class : 0.227, t_rotation : 0.204, entropy : 0.170 - acc jigsaw : 84.38, class : 67.97 [bs:128]
30/58 of epoch 10/30 jigsaw : 0.389, class : 0.152, t_rotation : 0.141, entropy : 0.117 - acc jigsaw : 86.72, class : 69.53 [bs:128]
Accuracies on val: jigsaw : 94.10, class : 90.36
--------------------------------------------------------
Accuracies on test: jigsaw : 98.32, class : 97.54
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 10
New epoch - lr: 0.001
0/58 of epoch 11/30 jigsaw : 0.253, class : 0.112, t_rotation : 0.163, entropy : 0.055 - acc jigsaw : 90.62, class : 70.31 [bs:128]
30/58 of epoch 11/30 jigsaw : 0.235, class : 0.114, t_rotation : 0.139, entropy : 0.135 - acc jigsaw : 92.97, class : 68.75 [bs:128]
Accuracies on val: jigsaw : 94.70, class : 89.52
--------------------------------------------------------
Accuracies on test: jigsaw : 98.14, class : 97.72
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 11
New epoch - lr: 0.001
0/58 of epoch 12/30 jigsaw : 0.329, class : 0.185, t_rotation : 0.161, entropy : 0.113 - acc jigsaw : 87.50, class : 74.22 [bs:128]
30/58 of epoch 12/30 jigsaw : 0.340, class : 0.187, t_rotation : 0.092, entropy : 0.063 - acc jigsaw : 88.28, class : 71.09 [bs:128]
Accuracies on val: jigsaw : 93.49, class : 89.52
--------------------------------------------------------
Accuracies on test: jigsaw : 97.78, class : 97.78
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 12
New epoch - lr: 0.001
0/58 of epoch 13/30 jigsaw : 0.222, class : 0.161, t_rotation : 0.144, entropy : 0.105 - acc jigsaw : 92.19, class : 69.53 [bs:128]
30/58 of epoch 13/30 jigsaw : 0.263, class : 0.253, t_rotation : 0.100, entropy : 0.109 - acc jigsaw : 90.62, class : 71.88 [bs:128]
Accuracies on val: jigsaw : 93.37, class : 91.45
--------------------------------------------------------
Accuracies on test: jigsaw : 98.08, class : 97.84
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 13
New epoch - lr: 0.001
0/58 of epoch 14/30 jigsaw : 0.215, class : 0.096, t_rotation : 0.155, entropy : 0.089 - acc jigsaw : 92.19, class : 76.56 [bs:128]
30/58 of epoch 14/30 jigsaw : 0.334, class : 0.147, t_rotation : 0.108, entropy : 0.115 - acc jigsaw : 87.50, class : 80.47 [bs:128]
Accuracies on val: jigsaw : 93.98, class : 91.69
--------------------------------------------------------
Accuracies on test: jigsaw : 98.38, class : 97.78
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 14
New epoch - lr: 0.001
0/58 of epoch 15/30 jigsaw : 0.318, class : 0.123, t_rotation : 0.159, entropy : 0.070 - acc jigsaw : 88.28, class : 81.25 [bs:128]
30/58 of epoch 15/30 jigsaw : 0.213, class : 0.078, t_rotation : 0.112, entropy : 0.050 - acc jigsaw : 92.97, class : 75.78 [bs:128]
Accuracies on val: jigsaw : 95.54, class : 92.29
--------------------------------------------------------
Accuracies on test: jigsaw : 98.08, class : 97.78
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 15
New epoch - lr: 0.001
0/58 of epoch 16/30 jigsaw : 0.281, class : 0.059, t_rotation : 0.125, entropy : 0.128 - acc jigsaw : 89.06, class : 72.66 [bs:128]
30/58 of epoch 16/30 jigsaw : 0.268, class : 0.035, t_rotation : 0.123, entropy : 0.094 - acc jigsaw : 91.41, class : 76.56 [bs:128]
Accuracies on val: jigsaw : 93.98, class : 92.17
--------------------------------------------------------
Accuracies on test: jigsaw : 98.02, class : 97.78
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 16
New epoch - lr: 0.001
0/58 of epoch 17/30 jigsaw : 0.217, class : 0.177, t_rotation : 0.111, entropy : 0.098 - acc jigsaw : 92.97, class : 64.84 [bs:128]
30/58 of epoch 17/30 jigsaw : 0.296, class : 0.101, t_rotation : 0.073, entropy : 0.127 - acc jigsaw : 92.19, class : 66.41 [bs:128]
Accuracies on val: jigsaw : 94.82, class : 92.05
--------------------------------------------------------
Accuracies on test: jigsaw : 98.32, class : 98.08
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 17
New epoch - lr: 0.001
0/58 of epoch 18/30 jigsaw : 0.264, class : 0.107, t_rotation : 0.100, entropy : 0.073 - acc jigsaw : 87.50, class : 70.31 [bs:128]
30/58 of epoch 18/30 jigsaw : 0.201, class : 0.123, t_rotation : 0.157, entropy : 0.121 - acc jigsaw : 93.75, class : 74.22 [bs:128]
Accuracies on val: jigsaw : 94.70, class : 92.41
--------------------------------------------------------
Accuracies on test: jigsaw : 98.92, class : 97.84
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 18
New epoch - lr: 0.001
0/58 of epoch 19/30 jigsaw : 0.308, class : 0.063, t_rotation : 0.098, entropy : 0.057 - acc jigsaw : 89.06, class : 82.03 [bs:128]
30/58 of epoch 19/30 jigsaw : 0.159, class : 0.101, t_rotation : 0.088, entropy : 0.076 - acc jigsaw : 93.75, class : 66.41 [bs:128]
Accuracies on val: jigsaw : 94.10, class : 92.17
--------------------------------------------------------
Accuracies on test: jigsaw : 98.92, class : 97.90
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 19
New epoch - lr: 0.001
0/58 of epoch 20/30 jigsaw : 0.235, class : 0.074, t_rotation : 0.148, entropy : 0.126 - acc jigsaw : 92.97, class : 71.88 [bs:128]
30/58 of epoch 20/30 jigsaw : 0.189, class : 0.087, t_rotation : 0.097, entropy : 0.075 - acc jigsaw : 92.97, class : 75.78 [bs:128]
Accuracies on val: jigsaw : 94.46, class : 91.45
--------------------------------------------------------
Accuracies on test: jigsaw : 98.92, class : 97.72
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 20
New epoch - lr: 0.001
0/58 of epoch 21/30 jigsaw : 0.233, class : 0.128, t_rotation : 0.100, entropy : 0.050 - acc jigsaw : 93.75, class : 72.66 [bs:128]
30/58 of epoch 21/30 jigsaw : 0.302, class : 0.074, t_rotation : 0.056, entropy : 0.074 - acc jigsaw : 89.06, class : 67.19 [bs:128]
Accuracies on val: jigsaw : 94.34, class : 93.13
--------------------------------------------------------
Accuracies on test: jigsaw : 98.86, class : 97.90
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 21
New epoch - lr: 0.001
0/58 of epoch 22/30 jigsaw : 0.199, class : 0.048, t_rotation : 0.084, entropy : 0.102 - acc jigsaw : 92.19, class : 73.44 [bs:128]
30/58 of epoch 22/30 jigsaw : 0.156, class : 0.099, t_rotation : 0.053, entropy : 0.087 - acc jigsaw : 94.53, class : 71.09 [bs:128]
Accuracies on val: jigsaw : 95.54, class : 92.65
--------------------------------------------------------
Accuracies on test: jigsaw : 99.28, class : 98.08
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 22
New epoch - lr: 0.001
0/58 of epoch 23/30 jigsaw : 0.167, class : 0.038, t_rotation : 0.121, entropy : 0.067 - acc jigsaw : 93.75, class : 70.31 [bs:128]
30/58 of epoch 23/30 jigsaw : 0.247, class : 0.041, t_rotation : 0.066, entropy : 0.117 - acc jigsaw : 89.06, class : 75.00 [bs:128]
Accuracies on val: jigsaw : 92.65, class : 92.77
--------------------------------------------------------
Accuracies on test: jigsaw : 99.46, class : 98.32
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 23
New epoch - lr: 0.0001
0/58 of epoch 24/30 jigsaw : 0.188, class : 0.033, t_rotation : 0.154, entropy : 0.041 - acc jigsaw : 94.53, class : 69.53 [bs:128]
30/58 of epoch 24/30 jigsaw : 0.162, class : 0.119, t_rotation : 0.103, entropy : 0.078 - acc jigsaw : 95.31, class : 74.22 [bs:128]
Accuracies on val: jigsaw : 94.22, class : 93.37
--------------------------------------------------------
Accuracies on test: jigsaw : 99.58, class : 98.20
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 24
New epoch - lr: 0.0001
0/58 of epoch 25/30 jigsaw : 0.199, class : 0.024, t_rotation : 0.093, entropy : 0.034 - acc jigsaw : 92.97, class : 71.09 [bs:128]
30/58 of epoch 25/30 jigsaw : 0.200, class : 0.093, t_rotation : 0.071, entropy : 0.037 - acc jigsaw : 91.41, class : 77.34 [bs:128]
Accuracies on val: jigsaw : 95.18, class : 92.53
--------------------------------------------------------
Accuracies on test: jigsaw : 99.58, class : 98.38
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 25
New epoch - lr: 0.0001
0/58 of epoch 26/30 jigsaw : 0.127, class : 0.069, t_rotation : 0.173, entropy : 0.018 - acc jigsaw : 93.75, class : 70.31 [bs:128]
30/58 of epoch 26/30 jigsaw : 0.298, class : 0.104, t_rotation : 0.093, entropy : 0.057 - acc jigsaw : 89.84, class : 71.88 [bs:128]
Accuracies on val: jigsaw : 94.58, class : 92.77
--------------------------------------------------------
Accuracies on test: jigsaw : 99.52, class : 98.20
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 26
New epoch - lr: 0.0001
0/58 of epoch 27/30 jigsaw : 0.136, class : 0.044, t_rotation : 0.159, entropy : 0.076 - acc jigsaw : 95.31, class : 69.53 [bs:128]
30/58 of epoch 27/30 jigsaw : 0.282, class : 0.033, t_rotation : 0.091, entropy : 0.041 - acc jigsaw : 89.84, class : 73.44 [bs:128]
Accuracies on val: jigsaw : 94.70, class : 92.41
--------------------------------------------------------
Accuracies on test: jigsaw : 99.58, class : 98.38
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 27
New epoch - lr: 0.0001
0/58 of epoch 28/30 jigsaw : 0.253, class : 0.185, t_rotation : 0.086, entropy : 0.041 - acc jigsaw : 90.62, class : 71.88 [bs:128]
30/58 of epoch 28/30 jigsaw : 0.155, class : 0.027, t_rotation : 0.110, entropy : 0.066 - acc jigsaw : 95.31, class : 76.56 [bs:128]
Accuracies on val: jigsaw : 94.94, class : 92.53
--------------------------------------------------------
Accuracies on test: jigsaw : 99.52, class : 98.20
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 28
New epoch - lr: 0.0001
0/58 of epoch 29/30 jigsaw : 0.166, class : 0.036, t_rotation : 0.151, entropy : 0.119 - acc jigsaw : 94.53, class : 68.75 [bs:128]
30/58 of epoch 29/30 jigsaw : 0.136, class : 0.040, t_rotation : 0.107, entropy : 0.099 - acc jigsaw : 96.09, class : 77.34 [bs:128]
Accuracies on val: jigsaw : 95.30, class : 92.89
--------------------------------------------------------
Accuracies on test: jigsaw : 99.64, class : 98.32
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 29
New epoch - lr: 0.0001
0/58 of epoch 30/30 jigsaw : 0.151, class : 0.039, t_rotation : 0.082, entropy : 0.055 - acc jigsaw : 95.31, class : 75.78 [bs:128]
30/58 of epoch 30/30 jigsaw : 0.177, class : 0.086, t_rotation : 0.079, entropy : 0.066 - acc jigsaw : 95.31, class : 73.44 [bs:128]
Accuracies on val: jigsaw : 95.42, class : 92.89
--------------------------------------------------------
Accuracies on test: jigsaw : 99.46, class : 98.20
--------------------------------------------------------
2019-12-16 07:23:24
photo
['sketch', 'cartoon', 'art_painting']
unsupervised_task_weight: 0.8
bias_hole_image: 0.3
target_rotation_weight: 0.8
entropy_weight 0.1
only_classify the ordered image: True
Highest accuracy on validation set appears on epoch  tensor(23)
Highest accuracy on test set appears on epoch  tensor(26)
Accuracy on test set when the accuracy on validation set is highest:0.982
Highest accuracy on test set:0.984
It took 1396.69
--------------------------------------------------------
******************Start training**************************************
--------------------------------------------------------
Dataset size: training 7491, validation 830, testing 1670
--------------------------------------------------------
Namespace(TTA=False, batch_size=128, bias_whole_image=0.3, classify_only_ordered_images_or_not=True, domains_list=['photo', 'sketch', 'cartoon', 'art_painting'], entropy_loss_weight=0.1, epochs=30, folder_name='test', image_size=222, jitter=0.4, learning_rate=0.001, limit_source=None, limit_target=None, max_scale=1.0, min_scale=0.8, n_classes=7, nesterov=False, network='resnet18', ooo_weight=0, parameters_lists=[[0.8, 0.3, 0.8, 0.1], [0.8, 0.5, 0.8, 0.1], [0.8, 0.6, 0.8, 0.1]], random_horiz_flip=0.5, repeat_times=3, source=['sketch', 'cartoon', 'art_painting'], suffix='', target='photo', target_domain_list=['art_painting', 'cartoon', 'sketch', 'photo'], target_domain_unsupervised_task_loss_weight=0.8, tf_logger=True, tile_random_grayscale=0.1, train_all=True, unsupervised_task_weight=0.8, val_size=0.1)
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 0
New epoch - lr: 0.001
0/58 of epoch 1/30 jigsaw : 1.432, class : 2.030, t_rotation : 1.438, entropy : 1.835 - acc jigsaw : 25.00, class : 16.41 [bs:128]
30/58 of epoch 1/30 jigsaw : 1.041, class : 1.342, t_rotation : 0.859, entropy : 1.778 - acc jigsaw : 58.59, class : 50.00 [bs:128]
Accuracies on val: jigsaw : 86.02, class : 70.36
--------------------------------------------------------
Accuracies on test: jigsaw : 95.87, class : 86.53
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 1
New epoch - lr: 0.001
0/58 of epoch 2/30 jigsaw : 0.864, class : 0.849, t_rotation : 0.660, entropy : 1.413 - acc jigsaw : 69.53, class : 62.50 [bs:128]
30/58 of epoch 2/30 jigsaw : 0.723, class : 0.704, t_rotation : 0.483, entropy : 0.898 - acc jigsaw : 72.66, class : 70.31 [bs:128]
Accuracies on val: jigsaw : 88.55, class : 79.88
--------------------------------------------------------
Accuracies on test: jigsaw : 97.25, class : 93.71
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 2
New epoch - lr: 0.001
0/58 of epoch 3/30 jigsaw : 0.608, class : 0.560, t_rotation : 0.499, entropy : 0.692 - acc jigsaw : 77.34, class : 66.41 [bs:128]
30/58 of epoch 3/30 jigsaw : 0.553, class : 0.336, t_rotation : 0.310, entropy : 0.481 - acc jigsaw : 82.03, class : 74.22 [bs:128]
Accuracies on val: jigsaw : 89.88, class : 85.30
--------------------------------------------------------
Accuracies on test: jigsaw : 97.54, class : 95.93
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 3
New epoch - lr: 0.001
0/58 of epoch 4/30 jigsaw : 0.520, class : 0.519, t_rotation : 0.388, entropy : 0.328 - acc jigsaw : 79.69, class : 69.53 [bs:128]
30/58 of epoch 4/30 jigsaw : 0.693, class : 0.390, t_rotation : 0.256, entropy : 0.283 - acc jigsaw : 71.88, class : 71.09 [bs:128]
Accuracies on val: jigsaw : 88.07, class : 84.10
--------------------------------------------------------
Accuracies on test: jigsaw : 97.19, class : 96.95
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 4
New epoch - lr: 0.001
0/58 of epoch 5/30 jigsaw : 0.489, class : 0.266, t_rotation : 0.296, entropy : 0.272 - acc jigsaw : 82.03, class : 67.97 [bs:128]
30/58 of epoch 5/30 jigsaw : 0.562, class : 0.292, t_rotation : 0.288, entropy : 0.321 - acc jigsaw : 76.56, class : 77.34 [bs:128]
Accuracies on val: jigsaw : 89.52, class : 85.42
--------------------------------------------------------
Accuracies on test: jigsaw : 97.84, class : 97.25
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 5
New epoch - lr: 0.001
0/58 of epoch 6/30 jigsaw : 0.424, class : 0.233, t_rotation : 0.339, entropy : 0.243 - acc jigsaw : 85.94, class : 71.09 [bs:128]
30/58 of epoch 6/30 jigsaw : 0.356, class : 0.168, t_rotation : 0.142, entropy : 0.252 - acc jigsaw : 84.38, class : 73.44 [bs:128]
Accuracies on val: jigsaw : 90.72, class : 88.92
--------------------------------------------------------
Accuracies on test: jigsaw : 97.60, class : 97.43
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 6
New epoch - lr: 0.001
0/58 of epoch 7/30 jigsaw : 0.402, class : 0.418, t_rotation : 0.232, entropy : 0.264 - acc jigsaw : 82.03, class : 71.09 [bs:128]
30/58 of epoch 7/30 jigsaw : 0.305, class : 0.222, t_rotation : 0.179, entropy : 0.143 - acc jigsaw : 87.50, class : 75.00 [bs:128]
Accuracies on val: jigsaw : 89.28, class : 88.19
--------------------------------------------------------
Accuracies on test: jigsaw : 97.43, class : 97.43
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 7
New epoch - lr: 0.001
0/58 of epoch 8/30 jigsaw : 0.340, class : 0.263, t_rotation : 0.197, entropy : 0.207 - acc jigsaw : 87.50, class : 75.00 [bs:128]
30/58 of epoch 8/30 jigsaw : 0.272, class : 0.247, t_rotation : 0.124, entropy : 0.149 - acc jigsaw : 91.41, class : 71.88 [bs:128]
Accuracies on val: jigsaw : 89.28, class : 88.43
--------------------------------------------------------
Accuracies on test: jigsaw : 98.68, class : 97.78
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 8
New epoch - lr: 0.001
0/58 of epoch 9/30 jigsaw : 0.435, class : 0.169, t_rotation : 0.223, entropy : 0.142 - acc jigsaw : 84.38, class : 67.97 [bs:128]
30/58 of epoch 9/30 jigsaw : 0.307, class : 0.218, t_rotation : 0.139, entropy : 0.188 - acc jigsaw : 87.50, class : 64.06 [bs:128]
Accuracies on val: jigsaw : 91.20, class : 89.64
--------------------------------------------------------
Accuracies on test: jigsaw : 98.20, class : 97.84
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 9
New epoch - lr: 0.001
0/58 of epoch 10/30 jigsaw : 0.310, class : 0.303, t_rotation : 0.194, entropy : 0.152 - acc jigsaw : 89.84, class : 66.41 [bs:128]
30/58 of epoch 10/30 jigsaw : 0.296, class : 0.281, t_rotation : 0.119, entropy : 0.120 - acc jigsaw : 89.84, class : 74.22 [bs:128]
Accuracies on val: jigsaw : 90.12, class : 89.76
--------------------------------------------------------
Accuracies on test: jigsaw : 98.08, class : 97.84
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 10
New epoch - lr: 0.001
0/58 of epoch 11/30 jigsaw : 0.306, class : 0.109, t_rotation : 0.120, entropy : 0.141 - acc jigsaw : 86.72, class : 69.53 [bs:128]
30/58 of epoch 11/30 jigsaw : 0.317, class : 0.235, t_rotation : 0.117, entropy : 0.067 - acc jigsaw : 85.16, class : 72.66 [bs:128]
Accuracies on val: jigsaw : 92.65, class : 91.33
--------------------------------------------------------
Accuracies on test: jigsaw : 98.32, class : 97.60
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 11
New epoch - lr: 0.001
0/58 of epoch 12/30 jigsaw : 0.231, class : 0.168, t_rotation : 0.197, entropy : 0.167 - acc jigsaw : 89.84, class : 67.19 [bs:128]
30/58 of epoch 12/30 jigsaw : 0.279, class : 0.109, t_rotation : 0.121, entropy : 0.081 - acc jigsaw : 87.50, class : 71.88 [bs:128]
Accuracies on val: jigsaw : 93.61, class : 91.81
--------------------------------------------------------
Accuracies on test: jigsaw : 98.62, class : 97.60
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 12
New epoch - lr: 0.001
0/58 of epoch 13/30 jigsaw : 0.388, class : 0.220, t_rotation : 0.094, entropy : 0.138 - acc jigsaw : 88.28, class : 75.78 [bs:128]
30/58 of epoch 13/30 jigsaw : 0.249, class : 0.148, t_rotation : 0.170, entropy : 0.105 - acc jigsaw : 89.06, class : 75.00 [bs:128]
Accuracies on val: jigsaw : 92.29, class : 90.96
--------------------------------------------------------
Accuracies on test: jigsaw : 98.50, class : 97.90
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 13
New epoch - lr: 0.001
0/58 of epoch 14/30 jigsaw : 0.321, class : 0.118, t_rotation : 0.155, entropy : 0.073 - acc jigsaw : 89.84, class : 81.25 [bs:128]
30/58 of epoch 14/30 jigsaw : 0.252, class : 0.113, t_rotation : 0.132, entropy : 0.075 - acc jigsaw : 91.41, class : 75.78 [bs:128]
Accuracies on val: jigsaw : 92.77, class : 92.53
--------------------------------------------------------
Accuracies on test: jigsaw : 99.04, class : 97.66
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 14
New epoch - lr: 0.001
0/58 of epoch 15/30 jigsaw : 0.238, class : 0.119, t_rotation : 0.124, entropy : 0.104 - acc jigsaw : 90.62, class : 75.00 [bs:128]
30/58 of epoch 15/30 jigsaw : 0.214, class : 0.083, t_rotation : 0.093, entropy : 0.088 - acc jigsaw : 92.19, class : 77.34 [bs:128]
Accuracies on val: jigsaw : 93.86, class : 91.20
--------------------------------------------------------
Accuracies on test: jigsaw : 99.22, class : 97.78
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 15
New epoch - lr: 0.001
0/58 of epoch 16/30 jigsaw : 0.291, class : 0.130, t_rotation : 0.146, entropy : 0.110 - acc jigsaw : 89.06, class : 70.31 [bs:128]
30/58 of epoch 16/30 jigsaw : 0.245, class : 0.057, t_rotation : 0.103, entropy : 0.108 - acc jigsaw : 92.97, class : 76.56 [bs:128]
Accuracies on val: jigsaw : 95.54, class : 92.05
--------------------------------------------------------
Accuracies on test: jigsaw : 99.10, class : 97.96
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 16
New epoch - lr: 0.001
0/58 of epoch 17/30 jigsaw : 0.219, class : 0.086, t_rotation : 0.152, entropy : 0.092 - acc jigsaw : 92.19, class : 67.97 [bs:128]
30/58 of epoch 17/30 jigsaw : 0.217, class : 0.021, t_rotation : 0.072, entropy : 0.125 - acc jigsaw : 92.19, class : 77.34 [bs:128]
Accuracies on val: jigsaw : 93.98, class : 91.33
--------------------------------------------------------
Accuracies on test: jigsaw : 98.92, class : 97.72
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 17
New epoch - lr: 0.001
0/58 of epoch 18/30 jigsaw : 0.282, class : 0.080, t_rotation : 0.240, entropy : 0.121 - acc jigsaw : 87.50, class : 69.53 [bs:128]
30/58 of epoch 18/30 jigsaw : 0.239, class : 0.071, t_rotation : 0.099, entropy : 0.022 - acc jigsaw : 91.41, class : 71.88 [bs:128]
Accuracies on val: jigsaw : 90.84, class : 91.93
--------------------------------------------------------
Accuracies on test: jigsaw : 98.80, class : 98.26
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 18
New epoch - lr: 0.001
0/58 of epoch 19/30 jigsaw : 0.212, class : 0.102, t_rotation : 0.103, entropy : 0.102 - acc jigsaw : 92.97, class : 78.12 [bs:128]
30/58 of epoch 19/30 jigsaw : 0.178, class : 0.140, t_rotation : 0.091, entropy : 0.075 - acc jigsaw : 93.75, class : 74.22 [bs:128]
Accuracies on val: jigsaw : 95.18, class : 92.17
--------------------------------------------------------
Accuracies on test: jigsaw : 98.62, class : 98.02
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 19
New epoch - lr: 0.001
0/58 of epoch 20/30 jigsaw : 0.181, class : 0.077, t_rotation : 0.075, entropy : 0.075 - acc jigsaw : 94.53, class : 72.66 [bs:128]
30/58 of epoch 20/30 jigsaw : 0.234, class : 0.099, t_rotation : 0.084, entropy : 0.072 - acc jigsaw : 92.19, class : 69.53 [bs:128]
Accuracies on val: jigsaw : 95.54, class : 92.41
--------------------------------------------------------
Accuracies on test: jigsaw : 99.04, class : 97.96
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 20
New epoch - lr: 0.001
0/58 of epoch 21/30 jigsaw : 0.201, class : 0.135, t_rotation : 0.101, entropy : 0.077 - acc jigsaw : 93.75, class : 74.22 [bs:128]
30/58 of epoch 21/30 jigsaw : 0.232, class : 0.063, t_rotation : 0.053, entropy : 0.085 - acc jigsaw : 91.41, class : 78.12 [bs:128]
Accuracies on val: jigsaw : 94.70, class : 92.41
--------------------------------------------------------
Accuracies on test: jigsaw : 99.34, class : 98.14
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 21
New epoch - lr: 0.001
0/58 of epoch 22/30 jigsaw : 0.258, class : 0.088, t_rotation : 0.086, entropy : 0.082 - acc jigsaw : 89.84, class : 67.97 [bs:128]
30/58 of epoch 22/30 jigsaw : 0.239, class : 0.092, t_rotation : 0.056, entropy : 0.130 - acc jigsaw : 90.62, class : 71.88 [bs:128]
Accuracies on val: jigsaw : 95.30, class : 92.17
--------------------------------------------------------
Accuracies on test: jigsaw : 99.34, class : 97.90
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 22
New epoch - lr: 0.001
0/58 of epoch 23/30 jigsaw : 0.191, class : 0.059, t_rotation : 0.139, entropy : 0.067 - acc jigsaw : 90.62, class : 73.44 [bs:128]
30/58 of epoch 23/30 jigsaw : 0.190, class : 0.037, t_rotation : 0.075, entropy : 0.050 - acc jigsaw : 92.97, class : 72.66 [bs:128]
Accuracies on val: jigsaw : 94.46, class : 92.05
--------------------------------------------------------
Accuracies on test: jigsaw : 99.58, class : 98.20
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 23
New epoch - lr: 0.0001
0/58 of epoch 24/30 jigsaw : 0.169, class : 0.165, t_rotation : 0.066, entropy : 0.092 - acc jigsaw : 91.41, class : 70.31 [bs:128]
30/58 of epoch 24/30 jigsaw : 0.222, class : 0.045, t_rotation : 0.118, entropy : 0.073 - acc jigsaw : 92.97, class : 72.66 [bs:128]
Accuracies on val: jigsaw : 94.70, class : 92.17
--------------------------------------------------------
Accuracies on test: jigsaw : 99.58, class : 98.08
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 24
New epoch - lr: 0.0001
0/58 of epoch 25/30 jigsaw : 0.234, class : 0.042, t_rotation : 0.127, entropy : 0.049 - acc jigsaw : 91.41, class : 79.69 [bs:128]
30/58 of epoch 25/30 jigsaw : 0.231, class : 0.053, t_rotation : 0.128, entropy : 0.122 - acc jigsaw : 91.41, class : 78.12 [bs:128]
Accuracies on val: jigsaw : 94.58, class : 92.77
--------------------------------------------------------
Accuracies on test: jigsaw : 99.58, class : 98.08
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 25
New epoch - lr: 0.0001
0/58 of epoch 26/30 jigsaw : 0.233, class : 0.073, t_rotation : 0.083, entropy : 0.086 - acc jigsaw : 91.41, class : 72.66 [bs:128]
30/58 of epoch 26/30 jigsaw : 0.283, class : 0.081, t_rotation : 0.067, entropy : 0.044 - acc jigsaw : 86.72, class : 72.66 [bs:128]
Accuracies on val: jigsaw : 93.98, class : 92.29
--------------------------------------------------------
Accuracies on test: jigsaw : 99.34, class : 98.02
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 26
New epoch - lr: 0.0001
0/58 of epoch 27/30 jigsaw : 0.144, class : 0.034, t_rotation : 0.085, entropy : 0.121 - acc jigsaw : 97.66, class : 76.56 [bs:128]
30/58 of epoch 27/30 jigsaw : 0.168, class : 0.039, t_rotation : 0.138, entropy : 0.063 - acc jigsaw : 96.09, class : 80.47 [bs:128]
Accuracies on val: jigsaw : 93.98, class : 92.41
--------------------------------------------------------
Accuracies on test: jigsaw : 99.46, class : 98.14
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 27
New epoch - lr: 0.0001
0/58 of epoch 28/30 jigsaw : 0.163, class : 0.139, t_rotation : 0.110, entropy : 0.046 - acc jigsaw : 95.31, class : 70.31 [bs:128]
30/58 of epoch 28/30 jigsaw : 0.169, class : 0.017, t_rotation : 0.041, entropy : 0.057 - acc jigsaw : 91.41, class : 74.22 [bs:128]
Accuracies on val: jigsaw : 94.34, class : 92.65
--------------------------------------------------------
Accuracies on test: jigsaw : 99.58, class : 98.02
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 28
New epoch - lr: 0.0001
0/58 of epoch 29/30 jigsaw : 0.202, class : 0.067, t_rotation : 0.126, entropy : 0.065 - acc jigsaw : 92.97, class : 75.00 [bs:128]
30/58 of epoch 29/30 jigsaw : 0.168, class : 0.061, t_rotation : 0.092, entropy : 0.047 - acc jigsaw : 96.09, class : 72.66 [bs:128]
Accuracies on val: jigsaw : 93.86, class : 92.41
--------------------------------------------------------
Accuracies on test: jigsaw : 99.34, class : 98.08
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 29
New epoch - lr: 0.0001
0/58 of epoch 30/30 jigsaw : 0.134, class : 0.033, t_rotation : 0.106, entropy : 0.059 - acc jigsaw : 96.88, class : 72.66 [bs:128]
30/58 of epoch 30/30 jigsaw : 0.248, class : 0.038, t_rotation : 0.091, entropy : 0.069 - acc jigsaw : 92.19, class : 72.66 [bs:128]
Accuracies on val: jigsaw : 93.98, class : 92.41
--------------------------------------------------------
Accuracies on test: jigsaw : 99.52, class : 97.84
--------------------------------------------------------
2019-12-16 07:46:34
photo
['sketch', 'cartoon', 'art_painting']
unsupervised_task_weight: 0.8
bias_hole_image: 0.3
target_rotation_weight: 0.8
entropy_weight 0.1
only_classify the ordered image: True
Highest accuracy on validation set appears on epoch  tensor(24)
Highest accuracy on test set appears on epoch  tensor(17)
Accuracy on test set when the accuracy on validation set is highest:0.981
Highest accuracy on test set:0.983
It took 1388.93
--------------------------------------------------------
******************Start training**************************************
--------------------------------------------------------
Dataset size: training 7150, validation 793, testing 2048
--------------------------------------------------------
Namespace(TTA=False, batch_size=128, bias_whole_image=0.5, classify_only_ordered_images_or_not=True, domains_list=['photo', 'sketch', 'cartoon', 'art_painting'], entropy_loss_weight=0.1, epochs=30, folder_name='test', image_size=222, jitter=0.4, learning_rate=0.001, limit_source=None, limit_target=None, max_scale=1.0, min_scale=0.8, n_classes=7, nesterov=False, network='resnet18', ooo_weight=0, parameters_lists=[[0.8, 0.3, 0.8, 0.1], [0.8, 0.5, 0.8, 0.1], [0.8, 0.6, 0.8, 0.1]], random_horiz_flip=0.5, repeat_times=3, source=['photo', 'sketch', 'cartoon'], suffix='', target='art_painting', target_domain_list=['art_painting', 'cartoon', 'sketch', 'photo'], target_domain_unsupervised_task_loss_weight=0.8, tf_logger=True, tile_random_grayscale=0.1, train_all=True, unsupervised_task_weight=0.8, val_size=0.1)
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 0
New epoch - lr: 0.001
0/55 of epoch 1/30 jigsaw : 1.293, class : 2.199, t_rotation : 1.303, entropy : 1.804 - acc jigsaw : 42.97, class : 21.09 [bs:128]
30/55 of epoch 1/30 jigsaw : 0.905, class : 1.265, t_rotation : 0.886, entropy : 1.731 - acc jigsaw : 65.62, class : 55.47 [bs:128]
Accuracies on val: jigsaw : 97.10, class : 74.78
--------------------------------------------------------
Accuracies on test: jigsaw : 96.39, class : 63.33
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 1
New epoch - lr: 0.001
0/55 of epoch 2/30 jigsaw : 0.700, class : 0.730, t_rotation : 0.798, entropy : 1.544 - acc jigsaw : 72.66, class : 72.66 [bs:128]
30/55 of epoch 2/30 jigsaw : 0.697, class : 0.615, t_rotation : 0.766, entropy : 1.188 - acc jigsaw : 73.44, class : 71.88 [bs:128]
Accuracies on val: jigsaw : 96.60, class : 85.50
--------------------------------------------------------
Accuracies on test: jigsaw : 96.48, class : 74.37
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 2
New epoch - lr: 0.001
0/55 of epoch 3/30 jigsaw : 0.550, class : 0.316, t_rotation : 0.629, entropy : 1.101 - acc jigsaw : 76.56, class : 78.12 [bs:128]
30/55 of epoch 3/30 jigsaw : 0.594, class : 0.497, t_rotation : 0.529, entropy : 0.929 - acc jigsaw : 75.00, class : 78.91 [bs:128]
Accuracies on val: jigsaw : 96.85, class : 86.89
--------------------------------------------------------
Accuracies on test: jigsaw : 93.90, class : 78.52
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 3
New epoch - lr: 0.001
0/55 of epoch 4/30 jigsaw : 0.385, class : 0.423, t_rotation : 0.555, entropy : 0.901 - acc jigsaw : 85.16, class : 76.56 [bs:128]
30/55 of epoch 4/30 jigsaw : 0.471, class : 0.336, t_rotation : 0.432, entropy : 0.577 - acc jigsaw : 81.25, class : 78.91 [bs:128]
Accuracies on val: jigsaw : 96.72, class : 90.16
--------------------------------------------------------
Accuracies on test: jigsaw : 95.61, class : 82.37
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 4
New epoch - lr: 0.001
0/55 of epoch 5/30 jigsaw : 0.551, class : 0.344, t_rotation : 0.519, entropy : 0.574 - acc jigsaw : 75.78, class : 73.44 [bs:128]
30/55 of epoch 5/30 jigsaw : 0.353, class : 0.283, t_rotation : 0.435, entropy : 0.623 - acc jigsaw : 86.72, class : 73.44 [bs:128]
Accuracies on val: jigsaw : 97.98, class : 88.40
--------------------------------------------------------
Accuracies on test: jigsaw : 96.19, class : 84.96
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 5
New epoch - lr: 0.001
0/55 of epoch 6/30 jigsaw : 0.290, class : 0.234, t_rotation : 0.405, entropy : 0.559 - acc jigsaw : 91.41, class : 75.00 [bs:128]
30/55 of epoch 6/30 jigsaw : 0.368, class : 0.256, t_rotation : 0.387, entropy : 0.458 - acc jigsaw : 83.59, class : 81.25 [bs:128]
Accuracies on val: jigsaw : 95.46, class : 90.04
--------------------------------------------------------
Accuracies on test: jigsaw : 95.46, class : 84.77
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 6
New epoch - lr: 0.001
0/55 of epoch 7/30 jigsaw : 0.329, class : 0.163, t_rotation : 0.431, entropy : 0.473 - acc jigsaw : 89.84, class : 79.69 [bs:128]
30/55 of epoch 7/30 jigsaw : 0.309, class : 0.211, t_rotation : 0.330, entropy : 0.466 - acc jigsaw : 90.62, class : 80.47 [bs:128]
Accuracies on val: jigsaw : 97.10, class : 90.42
--------------------------------------------------------
Accuracies on test: jigsaw : 96.78, class : 85.50
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 7
New epoch - lr: 0.001
0/55 of epoch 8/30 jigsaw : 0.325, class : 0.112, t_rotation : 0.363, entropy : 0.508 - acc jigsaw : 86.72, class : 79.69 [bs:128]
30/55 of epoch 8/30 jigsaw : 0.377, class : 0.232, t_rotation : 0.261, entropy : 0.409 - acc jigsaw : 86.72, class : 81.25 [bs:128]
Accuracies on val: jigsaw : 96.97, class : 90.67
--------------------------------------------------------
Accuracies on test: jigsaw : 96.04, class : 86.52
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 8
New epoch - lr: 0.001
0/55 of epoch 9/30 jigsaw : 0.230, class : 0.205, t_rotation : 0.342, entropy : 0.447 - acc jigsaw : 92.97, class : 82.03 [bs:128]
30/55 of epoch 9/30 jigsaw : 0.211, class : 0.143, t_rotation : 0.251, entropy : 0.320 - acc jigsaw : 93.75, class : 80.47 [bs:128]
Accuracies on val: jigsaw : 97.60, class : 92.06
--------------------------------------------------------
Accuracies on test: jigsaw : 95.95, class : 86.72
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 9
New epoch - lr: 0.001
0/55 of epoch 10/30 jigsaw : 0.283, class : 0.101, t_rotation : 0.296, entropy : 0.335 - acc jigsaw : 90.62, class : 84.38 [bs:128]
30/55 of epoch 10/30 jigsaw : 0.182, class : 0.175, t_rotation : 0.264, entropy : 0.345 - acc jigsaw : 94.53, class : 78.12 [bs:128]
Accuracies on val: jigsaw : 98.23, class : 92.18
--------------------------------------------------------
Accuracies on test: jigsaw : 97.22, class : 87.50
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 10
New epoch - lr: 0.001
0/55 of epoch 11/30 jigsaw : 0.248, class : 0.099, t_rotation : 0.314, entropy : 0.336 - acc jigsaw : 92.19, class : 78.91 [bs:128]
30/55 of epoch 11/30 jigsaw : 0.221, class : 0.152, t_rotation : 0.273, entropy : 0.281 - acc jigsaw : 92.97, class : 84.38 [bs:128]
Accuracies on val: jigsaw : 95.84, class : 93.19
--------------------------------------------------------
Accuracies on test: jigsaw : 96.73, class : 87.94
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 11
New epoch - lr: 0.001
0/55 of epoch 12/30 jigsaw : 0.201, class : 0.094, t_rotation : 0.316, entropy : 0.371 - acc jigsaw : 92.97, class : 80.47 [bs:128]
30/55 of epoch 12/30 jigsaw : 0.269, class : 0.164, t_rotation : 0.231, entropy : 0.340 - acc jigsaw : 91.41, class : 75.00 [bs:128]
Accuracies on val: jigsaw : 96.47, class : 91.93
--------------------------------------------------------
Accuracies on test: jigsaw : 97.17, class : 88.43
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 12
New epoch - lr: 0.001
0/55 of epoch 13/30 jigsaw : 0.194, class : 0.118, t_rotation : 0.309, entropy : 0.290 - acc jigsaw : 92.19, class : 82.03 [bs:128]
30/55 of epoch 13/30 jigsaw : 0.235, class : 0.085, t_rotation : 0.210, entropy : 0.274 - acc jigsaw : 92.19, class : 81.25 [bs:128]
Accuracies on val: jigsaw : 96.47, class : 93.06
--------------------------------------------------------
Accuracies on test: jigsaw : 97.51, class : 89.45
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 13
New epoch - lr: 0.001
0/55 of epoch 14/30 jigsaw : 0.237, class : 0.127, t_rotation : 0.273, entropy : 0.342 - acc jigsaw : 92.19, class : 79.69 [bs:128]
30/55 of epoch 14/30 jigsaw : 0.286, class : 0.224, t_rotation : 0.194, entropy : 0.201 - acc jigsaw : 90.62, class : 78.12 [bs:128]
Accuracies on val: jigsaw : 97.98, class : 94.07
--------------------------------------------------------
Accuracies on test: jigsaw : 97.02, class : 89.60
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 14
New epoch - lr: 0.001
0/55 of epoch 15/30 jigsaw : 0.201, class : 0.151, t_rotation : 0.272, entropy : 0.283 - acc jigsaw : 94.53, class : 83.59 [bs:128]
30/55 of epoch 15/30 jigsaw : 0.207, class : 0.122, t_rotation : 0.185, entropy : 0.326 - acc jigsaw : 93.75, class : 87.50 [bs:128]
Accuracies on val: jigsaw : 95.96, class : 94.07
--------------------------------------------------------
Accuracies on test: jigsaw : 97.17, class : 88.38
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 15
New epoch - lr: 0.001
0/55 of epoch 16/30 jigsaw : 0.228, class : 0.148, t_rotation : 0.171, entropy : 0.324 - acc jigsaw : 91.41, class : 82.03 [bs:128]
30/55 of epoch 16/30 jigsaw : 0.235, class : 0.080, t_rotation : 0.105, entropy : 0.214 - acc jigsaw : 94.53, class : 80.47 [bs:128]
Accuracies on val: jigsaw : 96.22, class : 93.57
--------------------------------------------------------
Accuracies on test: jigsaw : 98.10, class : 88.77
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 16
New epoch - lr: 0.001
0/55 of epoch 17/30 jigsaw : 0.208, class : 0.138, t_rotation : 0.197, entropy : 0.234 - acc jigsaw : 93.75, class : 81.25 [bs:128]
30/55 of epoch 17/30 jigsaw : 0.230, class : 0.088, t_rotation : 0.116, entropy : 0.223 - acc jigsaw : 92.19, class : 82.03 [bs:128]
Accuracies on val: jigsaw : 97.23, class : 93.95
--------------------------------------------------------
Accuracies on test: jigsaw : 97.71, class : 88.92
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 17
New epoch - lr: 0.001
0/55 of epoch 18/30 jigsaw : 0.180, class : 0.130, t_rotation : 0.221, entropy : 0.231 - acc jigsaw : 92.97, class : 81.25 [bs:128]
30/55 of epoch 18/30 jigsaw : 0.152, class : 0.050, t_rotation : 0.174, entropy : 0.234 - acc jigsaw : 95.31, class : 81.25 [bs:128]
Accuracies on val: jigsaw : 96.97, class : 93.95
--------------------------------------------------------
Accuracies on test: jigsaw : 97.75, class : 88.87
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 18
New epoch - lr: 0.001
0/55 of epoch 19/30 jigsaw : 0.297, class : 0.047, t_rotation : 0.211, entropy : 0.215 - acc jigsaw : 91.41, class : 88.28 [bs:128]
30/55 of epoch 19/30 jigsaw : 0.235, class : 0.043, t_rotation : 0.152, entropy : 0.243 - acc jigsaw : 91.41, class : 78.91 [bs:128]
Accuracies on val: jigsaw : 96.60, class : 94.33
--------------------------------------------------------
Accuracies on test: jigsaw : 97.61, class : 89.75
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 19
New epoch - lr: 0.001
0/55 of epoch 20/30 jigsaw : 0.216, class : 0.059, t_rotation : 0.206, entropy : 0.180 - acc jigsaw : 92.97, class : 84.38 [bs:128]
30/55 of epoch 20/30 jigsaw : 0.199, class : 0.058, t_rotation : 0.120, entropy : 0.170 - acc jigsaw : 91.41, class : 82.81 [bs:128]
Accuracies on val: jigsaw : 97.10, class : 93.95
--------------------------------------------------------
Accuracies on test: jigsaw : 97.71, class : 89.99
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 20
New epoch - lr: 0.001
0/55 of epoch 21/30 jigsaw : 0.132, class : 0.069, t_rotation : 0.203, entropy : 0.249 - acc jigsaw : 96.09, class : 85.16 [bs:128]
30/55 of epoch 21/30 jigsaw : 0.183, class : 0.026, t_rotation : 0.164, entropy : 0.195 - acc jigsaw : 95.31, class : 80.47 [bs:128]
Accuracies on val: jigsaw : 96.97, class : 94.45
--------------------------------------------------------
Accuracies on test: jigsaw : 98.49, class : 89.65
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 21
New epoch - lr: 0.001
0/55 of epoch 22/30 jigsaw : 0.163, class : 0.081, t_rotation : 0.198, entropy : 0.281 - acc jigsaw : 93.75, class : 85.94 [bs:128]
30/55 of epoch 22/30 jigsaw : 0.253, class : 0.047, t_rotation : 0.113, entropy : 0.222 - acc jigsaw : 89.84, class : 82.03 [bs:128]
Accuracies on val: jigsaw : 96.34, class : 93.32
--------------------------------------------------------
Accuracies on test: jigsaw : 98.44, class : 88.87
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 22
New epoch - lr: 0.001
0/55 of epoch 23/30 jigsaw : 0.204, class : 0.031, t_rotation : 0.171, entropy : 0.219 - acc jigsaw : 92.19, class : 79.69 [bs:128]
30/55 of epoch 23/30 jigsaw : 0.174, class : 0.074, t_rotation : 0.118, entropy : 0.211 - acc jigsaw : 92.97, class : 83.59 [bs:128]
Accuracies on val: jigsaw : 97.60, class : 94.58
--------------------------------------------------------
Accuracies on test: jigsaw : 98.49, class : 89.99
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 23
New epoch - lr: 0.0001
0/55 of epoch 24/30 jigsaw : 0.146, class : 0.061, t_rotation : 0.130, entropy : 0.235 - acc jigsaw : 92.19, class : 82.03 [bs:128]
30/55 of epoch 24/30 jigsaw : 0.212, class : 0.098, t_rotation : 0.189, entropy : 0.190 - acc jigsaw : 90.62, class : 81.25 [bs:128]
Accuracies on val: jigsaw : 97.60, class : 94.45
--------------------------------------------------------
Accuracies on test: jigsaw : 98.49, class : 89.84
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 24
New epoch - lr: 0.0001
0/55 of epoch 25/30 jigsaw : 0.182, class : 0.058, t_rotation : 0.184, entropy : 0.166 - acc jigsaw : 92.19, class : 78.91 [bs:128]
30/55 of epoch 25/30 jigsaw : 0.126, class : 0.054, t_rotation : 0.165, entropy : 0.270 - acc jigsaw : 95.31, class : 88.28 [bs:128]
Accuracies on val: jigsaw : 96.72, class : 94.20
--------------------------------------------------------
Accuracies on test: jigsaw : 98.54, class : 89.84
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 25
New epoch - lr: 0.0001
0/55 of epoch 26/30 jigsaw : 0.128, class : 0.033, t_rotation : 0.133, entropy : 0.196 - acc jigsaw : 97.66, class : 82.81 [bs:128]
30/55 of epoch 26/30 jigsaw : 0.175, class : 0.060, t_rotation : 0.211, entropy : 0.211 - acc jigsaw : 95.31, class : 82.81 [bs:128]
Accuracies on val: jigsaw : 96.97, class : 94.20
--------------------------------------------------------
Accuracies on test: jigsaw : 98.39, class : 89.79
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 26
New epoch - lr: 0.0001
0/55 of epoch 27/30 jigsaw : 0.160, class : 0.052, t_rotation : 0.232, entropy : 0.236 - acc jigsaw : 95.31, class : 80.47 [bs:128]
30/55 of epoch 27/30 jigsaw : 0.143, class : 0.061, t_rotation : 0.174, entropy : 0.133 - acc jigsaw : 96.88, class : 80.47 [bs:128]
Accuracies on val: jigsaw : 96.60, class : 94.20
--------------------------------------------------------
Accuracies on test: jigsaw : 98.44, class : 89.75
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 27
New epoch - lr: 0.0001
0/55 of epoch 28/30 jigsaw : 0.174, class : 0.042, t_rotation : 0.193, entropy : 0.209 - acc jigsaw : 94.53, class : 88.28 [bs:128]
30/55 of epoch 28/30 jigsaw : 0.190, class : 0.096, t_rotation : 0.198, entropy : 0.120 - acc jigsaw : 92.19, class : 77.34 [bs:128]
Accuracies on val: jigsaw : 96.72, class : 94.70
--------------------------------------------------------
Accuracies on test: jigsaw : 99.17, class : 89.75
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 28
New epoch - lr: 0.0001
0/55 of epoch 29/30 jigsaw : 0.182, class : 0.038, t_rotation : 0.182, entropy : 0.143 - acc jigsaw : 92.97, class : 78.91 [bs:128]
30/55 of epoch 29/30 jigsaw : 0.148, class : 0.118, t_rotation : 0.246, entropy : 0.179 - acc jigsaw : 93.75, class : 82.81 [bs:128]
Accuracies on val: jigsaw : 97.60, class : 94.20
--------------------------------------------------------
Accuracies on test: jigsaw : 98.78, class : 89.89
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 29
New epoch - lr: 0.0001
0/55 of epoch 30/30 jigsaw : 0.175, class : 0.027, t_rotation : 0.169, entropy : 0.222 - acc jigsaw : 93.75, class : 76.56 [bs:128]
30/55 of epoch 30/30 jigsaw : 0.132, class : 0.052, t_rotation : 0.163, entropy : 0.167 - acc jigsaw : 95.31, class : 78.91 [bs:128]
Accuracies on val: jigsaw : 97.60, class : 94.20
--------------------------------------------------------
Accuracies on test: jigsaw : 99.12, class : 89.75
--------------------------------------------------------
2019-12-16 08:08:43
art_painting
['photo', 'sketch', 'cartoon']
unsupervised_task_weight: 0.8
bias_hole_image: 0.5
target_rotation_weight: 0.8
entropy_weight 0.1
only_classify the ordered image: True
Highest accuracy on validation set appears on epoch  tensor(27)
Highest accuracy on test set appears on epoch  tensor(22)
Accuracy on test set when the accuracy on validation set is highest:0.897
Highest accuracy on test set:0.900
It took 1329.19
--------------------------------------------------------
******************Start training**************************************
--------------------------------------------------------
Dataset size: training 7150, validation 793, testing 2048
--------------------------------------------------------
Namespace(TTA=False, batch_size=128, bias_whole_image=0.5, classify_only_ordered_images_or_not=True, domains_list=['photo', 'sketch', 'cartoon', 'art_painting'], entropy_loss_weight=0.1, epochs=30, folder_name='test', image_size=222, jitter=0.4, learning_rate=0.001, limit_source=None, limit_target=None, max_scale=1.0, min_scale=0.8, n_classes=7, nesterov=False, network='resnet18', ooo_weight=0, parameters_lists=[[0.8, 0.3, 0.8, 0.1], [0.8, 0.5, 0.8, 0.1], [0.8, 0.6, 0.8, 0.1]], random_horiz_flip=0.5, repeat_times=3, source=['photo', 'sketch', 'cartoon'], suffix='', target='art_painting', target_domain_list=['art_painting', 'cartoon', 'sketch', 'photo'], target_domain_unsupervised_task_loss_weight=0.8, tf_logger=True, tile_random_grayscale=0.1, train_all=True, unsupervised_task_weight=0.8, val_size=0.1)
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 0
New epoch - lr: 0.001
0/55 of epoch 1/30 jigsaw : 1.306, class : 2.121, t_rotation : 1.237, entropy : 1.811 - acc jigsaw : 39.84, class : 12.50 [bs:128]
30/55 of epoch 1/30 jigsaw : 0.909, class : 1.184, t_rotation : 0.922, entropy : 1.744 - acc jigsaw : 66.41, class : 56.25 [bs:128]
Accuracies on val: jigsaw : 97.48, class : 73.39
--------------------------------------------------------
Accuracies on test: jigsaw : 94.87, class : 61.72
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 1
New epoch - lr: 0.001
0/55 of epoch 2/30 jigsaw : 0.687, class : 0.777, t_rotation : 0.891, entropy : 1.523 - acc jigsaw : 71.09, class : 78.12 [bs:128]
30/55 of epoch 2/30 jigsaw : 0.582, class : 0.558, t_rotation : 0.704, entropy : 1.310 - acc jigsaw : 78.12, class : 75.00 [bs:128]
Accuracies on val: jigsaw : 96.34, class : 85.50
--------------------------------------------------------
Accuracies on test: jigsaw : 93.85, class : 74.46
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 2
New epoch - lr: 0.001
0/55 of epoch 3/30 jigsaw : 0.542, class : 0.391, t_rotation : 0.737, entropy : 1.084 - acc jigsaw : 78.91, class : 75.00 [bs:128]
30/55 of epoch 3/30 jigsaw : 0.541, class : 0.378, t_rotation : 0.579, entropy : 0.924 - acc jigsaw : 80.47, class : 75.00 [bs:128]
Accuracies on val: jigsaw : 95.59, class : 88.40
--------------------------------------------------------
Accuracies on test: jigsaw : 94.58, class : 79.69
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 3
New epoch - lr: 0.001
0/55 of epoch 4/30 jigsaw : 0.560, class : 0.336, t_rotation : 0.577, entropy : 0.740 - acc jigsaw : 79.69, class : 72.66 [bs:128]
30/55 of epoch 4/30 jigsaw : 0.336, class : 0.323, t_rotation : 0.417, entropy : 0.691 - acc jigsaw : 92.19, class : 72.66 [bs:128]
Accuracies on val: jigsaw : 96.60, class : 89.28
--------------------------------------------------------
Accuracies on test: jigsaw : 94.63, class : 82.91
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 4
New epoch - lr: 0.001
0/55 of epoch 5/30 jigsaw : 0.342, class : 0.218, t_rotation : 0.454, entropy : 0.573 - acc jigsaw : 85.16, class : 83.59 [bs:128]
30/55 of epoch 5/30 jigsaw : 0.434, class : 0.162, t_rotation : 0.394, entropy : 0.561 - acc jigsaw : 82.81, class : 79.69 [bs:128]
Accuracies on val: jigsaw : 96.97, class : 89.66
--------------------------------------------------------
Accuracies on test: jigsaw : 95.65, class : 85.74
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 5
New epoch - lr: 0.001
0/55 of epoch 6/30 jigsaw : 0.437, class : 0.274, t_rotation : 0.405, entropy : 0.481 - acc jigsaw : 81.25, class : 79.69 [bs:128]
30/55 of epoch 6/30 jigsaw : 0.291, class : 0.250, t_rotation : 0.376, entropy : 0.476 - acc jigsaw : 89.84, class : 82.03 [bs:128]
Accuracies on val: jigsaw : 96.85, class : 91.30
--------------------------------------------------------
Accuracies on test: jigsaw : 95.26, class : 83.98
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 6
New epoch - lr: 0.001
0/55 of epoch 7/30 jigsaw : 0.329, class : 0.232, t_rotation : 0.540, entropy : 0.548 - acc jigsaw : 87.50, class : 78.12 [bs:128]
30/55 of epoch 7/30 jigsaw : 0.363, class : 0.115, t_rotation : 0.270, entropy : 0.420 - acc jigsaw : 86.72, class : 73.44 [bs:128]
Accuracies on val: jigsaw : 95.46, class : 92.06
--------------------------------------------------------
Accuracies on test: jigsaw : 95.51, class : 85.45
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 7
New epoch - lr: 0.001
0/55 of epoch 8/30 jigsaw : 0.285, class : 0.208, t_rotation : 0.330, entropy : 0.444 - acc jigsaw : 89.06, class : 79.69 [bs:128]
30/55 of epoch 8/30 jigsaw : 0.286, class : 0.191, t_rotation : 0.353, entropy : 0.453 - acc jigsaw : 90.62, class : 78.12 [bs:128]
Accuracies on val: jigsaw : 96.97, class : 91.80
--------------------------------------------------------
Accuracies on test: jigsaw : 96.78, class : 86.08
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 8
New epoch - lr: 0.001
0/55 of epoch 9/30 jigsaw : 0.229, class : 0.108, t_rotation : 0.292, entropy : 0.375 - acc jigsaw : 93.75, class : 83.59 [bs:128]
30/55 of epoch 9/30 jigsaw : 0.251, class : 0.144, t_rotation : 0.283, entropy : 0.388 - acc jigsaw : 92.97, class : 81.25 [bs:128]
Accuracies on val: jigsaw : 97.35, class : 92.06
--------------------------------------------------------
Accuracies on test: jigsaw : 96.14, class : 87.35
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 9
New epoch - lr: 0.001
0/55 of epoch 10/30 jigsaw : 0.221, class : 0.112, t_rotation : 0.379, entropy : 0.357 - acc jigsaw : 94.53, class : 78.12 [bs:128]
30/55 of epoch 10/30 jigsaw : 0.246, class : 0.112, t_rotation : 0.300, entropy : 0.388 - acc jigsaw : 92.97, class : 75.78 [bs:128]
Accuracies on val: jigsaw : 96.22, class : 92.56
--------------------------------------------------------
Accuracies on test: jigsaw : 97.22, class : 87.74
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 10
New epoch - lr: 0.001
0/55 of epoch 11/30 jigsaw : 0.289, class : 0.091, t_rotation : 0.250, entropy : 0.298 - acc jigsaw : 91.41, class : 86.72 [bs:128]
30/55 of epoch 11/30 jigsaw : 0.225, class : 0.106, t_rotation : 0.262, entropy : 0.284 - acc jigsaw : 92.97, class : 80.47 [bs:128]
Accuracies on val: jigsaw : 97.10, class : 92.56
--------------------------------------------------------
Accuracies on test: jigsaw : 96.19, class : 88.53
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 11
New epoch - lr: 0.001
0/55 of epoch 12/30 jigsaw : 0.254, class : 0.138, t_rotation : 0.365, entropy : 0.229 - acc jigsaw : 89.84, class : 76.56 [bs:128]
30/55 of epoch 12/30 jigsaw : 0.157, class : 0.050, t_rotation : 0.142, entropy : 0.307 - acc jigsaw : 95.31, class : 82.03 [bs:128]
Accuracies on val: jigsaw : 96.85, class : 92.69
--------------------------------------------------------
Accuracies on test: jigsaw : 97.36, class : 88.62
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 12
New epoch - lr: 0.001
0/55 of epoch 13/30 jigsaw : 0.192, class : 0.156, t_rotation : 0.257, entropy : 0.319 - acc jigsaw : 92.97, class : 82.03 [bs:128]
30/55 of epoch 13/30 jigsaw : 0.238, class : 0.126, t_rotation : 0.192, entropy : 0.272 - acc jigsaw : 91.41, class : 81.25 [bs:128]
Accuracies on val: jigsaw : 97.35, class : 92.06
--------------------------------------------------------
Accuracies on test: jigsaw : 96.39, class : 88.96
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 13
New epoch - lr: 0.001
0/55 of epoch 14/30 jigsaw : 0.224, class : 0.122, t_rotation : 0.251, entropy : 0.289 - acc jigsaw : 91.41, class : 78.91 [bs:128]
30/55 of epoch 14/30 jigsaw : 0.136, class : 0.063, t_rotation : 0.221, entropy : 0.302 - acc jigsaw : 96.09, class : 78.12 [bs:128]
Accuracies on val: jigsaw : 97.86, class : 92.69
--------------------------------------------------------
Accuracies on test: jigsaw : 98.44, class : 88.82
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 14
New epoch - lr: 0.001
0/55 of epoch 15/30 jigsaw : 0.288, class : 0.051, t_rotation : 0.213, entropy : 0.317 - acc jigsaw : 89.84, class : 75.00 [bs:128]
30/55 of epoch 15/30 jigsaw : 0.160, class : 0.049, t_rotation : 0.157, entropy : 0.235 - acc jigsaw : 93.75, class : 86.72 [bs:128]
Accuracies on val: jigsaw : 97.86, class : 93.32
--------------------------------------------------------
Accuracies on test: jigsaw : 97.75, class : 88.62
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 15
New epoch - lr: 0.001
0/55 of epoch 16/30 jigsaw : 0.225, class : 0.036, t_rotation : 0.209, entropy : 0.259 - acc jigsaw : 92.19, class : 83.59 [bs:128]
30/55 of epoch 16/30 jigsaw : 0.155, class : 0.132, t_rotation : 0.138, entropy : 0.245 - acc jigsaw : 94.53, class : 82.03 [bs:128]
Accuracies on val: jigsaw : 97.48, class : 92.56
--------------------------------------------------------
Accuracies on test: jigsaw : 97.75, class : 89.01
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 16
New epoch - lr: 0.001
0/55 of epoch 17/30 jigsaw : 0.109, class : 0.119, t_rotation : 0.212, entropy : 0.230 - acc jigsaw : 96.09, class : 81.25 [bs:128]
30/55 of epoch 17/30 jigsaw : 0.190, class : 0.100, t_rotation : 0.157, entropy : 0.310 - acc jigsaw : 94.53, class : 84.38 [bs:128]
Accuracies on val: jigsaw : 96.85, class : 93.44
--------------------------------------------------------
Accuracies on test: jigsaw : 96.97, class : 89.21
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 17
New epoch - lr: 0.001
0/55 of epoch 18/30 jigsaw : 0.168, class : 0.053, t_rotation : 0.203, entropy : 0.198 - acc jigsaw : 93.75, class : 77.34 [bs:128]
30/55 of epoch 18/30 jigsaw : 0.172, class : 0.063, t_rotation : 0.313, entropy : 0.321 - acc jigsaw : 94.53, class : 87.50 [bs:128]
Accuracies on val: jigsaw : 95.96, class : 94.07
--------------------------------------------------------
Accuracies on test: jigsaw : 96.83, class : 88.87
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 18
New epoch - lr: 0.001
0/55 of epoch 19/30 jigsaw : 0.143, class : 0.039, t_rotation : 0.284, entropy : 0.284 - acc jigsaw : 95.31, class : 79.69 [bs:128]
30/55 of epoch 19/30 jigsaw : 0.177, class : 0.100, t_rotation : 0.109, entropy : 0.240 - acc jigsaw : 92.97, class : 80.47 [bs:128]
Accuracies on val: jigsaw : 94.45, class : 94.96
--------------------------------------------------------
Accuracies on test: jigsaw : 97.36, class : 89.36
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 19
New epoch - lr: 0.001
0/55 of epoch 20/30 jigsaw : 0.079, class : 0.066, t_rotation : 0.292, entropy : 0.264 - acc jigsaw : 98.44, class : 78.12 [bs:128]
30/55 of epoch 20/30 jigsaw : 0.186, class : 0.026, t_rotation : 0.099, entropy : 0.152 - acc jigsaw : 93.75, class : 78.91 [bs:128]
Accuracies on val: jigsaw : 97.10, class : 95.59
--------------------------------------------------------
Accuracies on test: jigsaw : 98.73, class : 88.82
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 20
New epoch - lr: 0.001
0/55 of epoch 21/30 jigsaw : 0.205, class : 0.112, t_rotation : 0.299, entropy : 0.185 - acc jigsaw : 92.97, class : 78.12 [bs:128]
30/55 of epoch 21/30 jigsaw : 0.159, class : 0.116, t_rotation : 0.132, entropy : 0.166 - acc jigsaw : 93.75, class : 81.25 [bs:128]
Accuracies on val: jigsaw : 95.46, class : 94.33
--------------------------------------------------------
Accuracies on test: jigsaw : 98.44, class : 89.16
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 21
New epoch - lr: 0.001
0/55 of epoch 22/30 jigsaw : 0.212, class : 0.107, t_rotation : 0.172, entropy : 0.175 - acc jigsaw : 92.19, class : 82.03 [bs:128]
30/55 of epoch 22/30 jigsaw : 0.140, class : 0.065, t_rotation : 0.084, entropy : 0.206 - acc jigsaw : 95.31, class : 80.47 [bs:128]
Accuracies on val: jigsaw : 96.34, class : 94.70
--------------------------------------------------------
Accuracies on test: jigsaw : 99.32, class : 89.60
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 22
New epoch - lr: 0.001
0/55 of epoch 23/30 jigsaw : 0.150, class : 0.039, t_rotation : 0.140, entropy : 0.176 - acc jigsaw : 93.75, class : 88.28 [bs:128]
30/55 of epoch 23/30 jigsaw : 0.094, class : 0.053, t_rotation : 0.216, entropy : 0.214 - acc jigsaw : 95.31, class : 84.38 [bs:128]
Accuracies on val: jigsaw : 97.60, class : 95.59
--------------------------------------------------------
Accuracies on test: jigsaw : 98.34, class : 89.65
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 23
New epoch - lr: 0.0001
0/55 of epoch 24/30 jigsaw : 0.187, class : 0.073, t_rotation : 0.151, entropy : 0.107 - acc jigsaw : 93.75, class : 78.91 [bs:128]
30/55 of epoch 24/30 jigsaw : 0.090, class : 0.080, t_rotation : 0.178, entropy : 0.135 - acc jigsaw : 96.09, class : 83.59 [bs:128]
Accuracies on val: jigsaw : 97.73, class : 95.71
--------------------------------------------------------
Accuracies on test: jigsaw : 98.34, class : 89.75
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 24
New epoch - lr: 0.0001
0/55 of epoch 25/30 jigsaw : 0.080, class : 0.086, t_rotation : 0.177, entropy : 0.211 - acc jigsaw : 99.22, class : 80.47 [bs:128]
30/55 of epoch 25/30 jigsaw : 0.183, class : 0.043, t_rotation : 0.221, entropy : 0.183 - acc jigsaw : 92.19, class : 87.50 [bs:128]
Accuracies on val: jigsaw : 97.73, class : 95.59
--------------------------------------------------------
Accuracies on test: jigsaw : 99.07, class : 89.60
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 25
New epoch - lr: 0.0001
0/55 of epoch 26/30 jigsaw : 0.065, class : 0.021, t_rotation : 0.290, entropy : 0.216 - acc jigsaw : 98.44, class : 81.25 [bs:128]
30/55 of epoch 26/30 jigsaw : 0.135, class : 0.088, t_rotation : 0.159, entropy : 0.217 - acc jigsaw : 95.31, class : 76.56 [bs:128]
Accuracies on val: jigsaw : 97.23, class : 95.71
--------------------------------------------------------
Accuracies on test: jigsaw : 98.88, class : 89.70
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 26
New epoch - lr: 0.0001
0/55 of epoch 27/30 jigsaw : 0.100, class : 0.079, t_rotation : 0.150, entropy : 0.169 - acc jigsaw : 95.31, class : 74.22 [bs:128]
30/55 of epoch 27/30 jigsaw : 0.120, class : 0.071, t_rotation : 0.251, entropy : 0.153 - acc jigsaw : 97.66, class : 85.94 [bs:128]
Accuracies on val: jigsaw : 97.35, class : 95.84
--------------------------------------------------------
Accuracies on test: jigsaw : 98.93, class : 89.60
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 27
New epoch - lr: 0.0001
0/55 of epoch 28/30 jigsaw : 0.153, class : 0.043, t_rotation : 0.149, entropy : 0.132 - acc jigsaw : 94.53, class : 77.34 [bs:128]
30/55 of epoch 28/30 jigsaw : 0.136, class : 0.054, t_rotation : 0.117, entropy : 0.202 - acc jigsaw : 96.88, class : 82.03 [bs:128]
Accuracies on val: jigsaw : 97.86, class : 95.46
--------------------------------------------------------
Accuracies on test: jigsaw : 99.32, class : 89.70
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 28
New epoch - lr: 0.0001
0/55 of epoch 29/30 jigsaw : 0.104, class : 0.039, t_rotation : 0.287, entropy : 0.160 - acc jigsaw : 96.88, class : 80.47 [bs:128]
30/55 of epoch 29/30 jigsaw : 0.215, class : 0.021, t_rotation : 0.182, entropy : 0.174 - acc jigsaw : 93.75, class : 86.72 [bs:128]
Accuracies on val: jigsaw : 97.98, class : 95.59
--------------------------------------------------------
Accuracies on test: jigsaw : 99.22, class : 89.99
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 29
New epoch - lr: 0.0001
0/55 of epoch 30/30 jigsaw : 0.122, class : 0.042, t_rotation : 0.116, entropy : 0.242 - acc jigsaw : 94.53, class : 77.34 [bs:128]
30/55 of epoch 30/30 jigsaw : 0.075, class : 0.015, t_rotation : 0.178, entropy : 0.162 - acc jigsaw : 97.66, class : 79.69 [bs:128]
Accuracies on val: jigsaw : 96.97, class : 95.21
--------------------------------------------------------
Accuracies on test: jigsaw : 98.78, class : 89.79
--------------------------------------------------------
2019-12-16 08:30:42
art_painting
['photo', 'sketch', 'cartoon']
unsupervised_task_weight: 0.8
bias_hole_image: 0.5
target_rotation_weight: 0.8
entropy_weight 0.1
only_classify the ordered image: True
Highest accuracy on validation set appears on epoch  tensor(26)
Highest accuracy on test set appears on epoch  tensor(28)
Accuracy on test set when the accuracy on validation set is highest:0.896
Highest accuracy on test set:0.900
It took 1318.68
--------------------------------------------------------
******************Start training**************************************
--------------------------------------------------------
Dataset size: training 7150, validation 793, testing 2048
--------------------------------------------------------
Namespace(TTA=False, batch_size=128, bias_whole_image=0.5, classify_only_ordered_images_or_not=True, domains_list=['photo', 'sketch', 'cartoon', 'art_painting'], entropy_loss_weight=0.1, epochs=30, folder_name='test', image_size=222, jitter=0.4, learning_rate=0.001, limit_source=None, limit_target=None, max_scale=1.0, min_scale=0.8, n_classes=7, nesterov=False, network='resnet18', ooo_weight=0, parameters_lists=[[0.8, 0.3, 0.8, 0.1], [0.8, 0.5, 0.8, 0.1], [0.8, 0.6, 0.8, 0.1]], random_horiz_flip=0.5, repeat_times=3, source=['photo', 'sketch', 'cartoon'], suffix='', target='art_painting', target_domain_list=['art_painting', 'cartoon', 'sketch', 'photo'], target_domain_unsupervised_task_loss_weight=0.8, tf_logger=True, tile_random_grayscale=0.1, train_all=True, unsupervised_task_weight=0.8, val_size=0.1)
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 0
New epoch - lr: 0.001
0/55 of epoch 1/30 jigsaw : 1.356, class : 2.096, t_rotation : 1.392, entropy : 1.862 - acc jigsaw : 28.91, class : 11.72 [bs:128]
30/55 of epoch 1/30 jigsaw : 0.935, class : 1.118, t_rotation : 0.831, entropy : 1.781 - acc jigsaw : 64.84, class : 60.16 [bs:128]
Accuracies on val: jigsaw : 96.60, class : 74.15
--------------------------------------------------------
Accuracies on test: jigsaw : 94.48, class : 59.81
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 1
New epoch - lr: 0.001
0/55 of epoch 2/30 jigsaw : 0.670, class : 0.793, t_rotation : 0.723, entropy : 1.565 - acc jigsaw : 78.12, class : 68.75 [bs:128]
30/55 of epoch 2/30 jigsaw : 0.606, class : 0.544, t_rotation : 0.761, entropy : 1.233 - acc jigsaw : 79.69, class : 75.78 [bs:128]
Accuracies on val: jigsaw : 95.59, class : 82.47
--------------------------------------------------------
Accuracies on test: jigsaw : 94.04, class : 76.56
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 2
New epoch - lr: 0.001
0/55 of epoch 3/30 jigsaw : 0.557, class : 0.495, t_rotation : 0.627, entropy : 1.079 - acc jigsaw : 81.25, class : 75.78 [bs:128]
30/55 of epoch 3/30 jigsaw : 0.540, class : 0.432, t_rotation : 0.541, entropy : 0.988 - acc jigsaw : 77.34, class : 77.34 [bs:128]
Accuracies on val: jigsaw : 96.60, class : 87.77
--------------------------------------------------------
Accuracies on test: jigsaw : 94.73, class : 80.57
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 3
New epoch - lr: 0.001
0/55 of epoch 4/30 jigsaw : 0.474, class : 0.385, t_rotation : 0.562, entropy : 0.805 - acc jigsaw : 83.59, class : 74.22 [bs:128]
30/55 of epoch 4/30 jigsaw : 0.378, class : 0.308, t_rotation : 0.466, entropy : 0.720 - acc jigsaw : 85.16, class : 77.34 [bs:128]
Accuracies on val: jigsaw : 97.86, class : 88.65
--------------------------------------------------------
Accuracies on test: jigsaw : 95.80, class : 81.93
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 4
New epoch - lr: 0.001
0/55 of epoch 5/30 jigsaw : 0.410, class : 0.312, t_rotation : 0.463, entropy : 0.621 - acc jigsaw : 84.38, class : 75.78 [bs:128]
30/55 of epoch 5/30 jigsaw : 0.442, class : 0.239, t_rotation : 0.469, entropy : 0.671 - acc jigsaw : 85.94, class : 80.47 [bs:128]
Accuracies on val: jigsaw : 98.23, class : 90.29
--------------------------------------------------------
Accuracies on test: jigsaw : 96.14, class : 85.01
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 5
New epoch - lr: 0.001
0/55 of epoch 6/30 jigsaw : 0.386, class : 0.288, t_rotation : 0.567, entropy : 0.636 - acc jigsaw : 85.16, class : 78.12 [bs:128]
30/55 of epoch 6/30 jigsaw : 0.324, class : 0.224, t_rotation : 0.381, entropy : 0.506 - acc jigsaw : 89.06, class : 83.59 [bs:128]
Accuracies on val: jigsaw : 97.10, class : 90.79
--------------------------------------------------------
Accuracies on test: jigsaw : 96.53, class : 86.57
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 6
New epoch - lr: 0.001
0/55 of epoch 7/30 jigsaw : 0.363, class : 0.243, t_rotation : 0.321, entropy : 0.422 - acc jigsaw : 85.16, class : 72.66 [bs:128]
30/55 of epoch 7/30 jigsaw : 0.299, class : 0.277, t_rotation : 0.315, entropy : 0.456 - acc jigsaw : 87.50, class : 75.78 [bs:128]
Accuracies on val: jigsaw : 96.97, class : 92.56
--------------------------------------------------------
Accuracies on test: jigsaw : 96.19, class : 86.96
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 7
New epoch - lr: 0.001
0/55 of epoch 8/30 jigsaw : 0.373, class : 0.162, t_rotation : 0.391, entropy : 0.483 - acc jigsaw : 88.28, class : 74.22 [bs:128]
30/55 of epoch 8/30 jigsaw : 0.368, class : 0.156, t_rotation : 0.245, entropy : 0.396 - acc jigsaw : 85.94, class : 82.81 [bs:128]
Accuracies on val: jigsaw : 96.34, class : 91.55
--------------------------------------------------------
Accuracies on test: jigsaw : 94.87, class : 87.84
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 8
New epoch - lr: 0.001
0/55 of epoch 9/30 jigsaw : 0.214, class : 0.087, t_rotation : 0.298, entropy : 0.354 - acc jigsaw : 94.53, class : 82.81 [bs:128]
30/55 of epoch 9/30 jigsaw : 0.229, class : 0.131, t_rotation : 0.316, entropy : 0.418 - acc jigsaw : 92.19, class : 80.47 [bs:128]
Accuracies on val: jigsaw : 97.60, class : 92.31
--------------------------------------------------------
Accuracies on test: jigsaw : 96.44, class : 87.79
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 9
New epoch - lr: 0.001
0/55 of epoch 10/30 jigsaw : 0.313, class : 0.098, t_rotation : 0.310, entropy : 0.357 - acc jigsaw : 89.06, class : 86.72 [bs:128]
30/55 of epoch 10/30 jigsaw : 0.267, class : 0.114, t_rotation : 0.332, entropy : 0.274 - acc jigsaw : 88.28, class : 80.47 [bs:128]
Accuracies on val: jigsaw : 98.99, class : 92.43
--------------------------------------------------------
Accuracies on test: jigsaw : 96.73, class : 88.23
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 10
New epoch - lr: 0.001
0/55 of epoch 11/30 jigsaw : 0.330, class : 0.214, t_rotation : 0.321, entropy : 0.358 - acc jigsaw : 87.50, class : 79.69 [bs:128]
30/55 of epoch 11/30 jigsaw : 0.310, class : 0.076, t_rotation : 0.210, entropy : 0.299 - acc jigsaw : 91.41, class : 85.94 [bs:128]
Accuracies on val: jigsaw : 97.35, class : 92.69
--------------------------------------------------------
Accuracies on test: jigsaw : 96.73, class : 88.87
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 11
New epoch - lr: 0.001
0/55 of epoch 12/30 jigsaw : 0.191, class : 0.087, t_rotation : 0.350, entropy : 0.292 - acc jigsaw : 93.75, class : 82.81 [bs:128]
30/55 of epoch 12/30 jigsaw : 0.359, class : 0.102, t_rotation : 0.319, entropy : 0.328 - acc jigsaw : 85.16, class : 80.47 [bs:128]
Accuracies on val: jigsaw : 98.61, class : 93.19
--------------------------------------------------------
Accuracies on test: jigsaw : 97.22, class : 88.87
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 12
New epoch - lr: 0.001
0/55 of epoch 13/30 jigsaw : 0.297, class : 0.144, t_rotation : 0.320, entropy : 0.295 - acc jigsaw : 89.06, class : 77.34 [bs:128]
30/55 of epoch 13/30 jigsaw : 0.226, class : 0.181, t_rotation : 0.141, entropy : 0.259 - acc jigsaw : 90.62, class : 82.81 [bs:128]
Accuracies on val: jigsaw : 98.74, class : 92.43
--------------------------------------------------------
Accuracies on test: jigsaw : 97.46, class : 89.65
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 13
New epoch - lr: 0.001
0/55 of epoch 14/30 jigsaw : 0.198, class : 0.194, t_rotation : 0.188, entropy : 0.236 - acc jigsaw : 94.53, class : 82.03 [bs:128]
30/55 of epoch 14/30 jigsaw : 0.267, class : 0.132, t_rotation : 0.260, entropy : 0.282 - acc jigsaw : 91.41, class : 78.91 [bs:128]
Accuracies on val: jigsaw : 97.73, class : 93.57
--------------------------------------------------------
Accuracies on test: jigsaw : 96.97, class : 88.96
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 14
New epoch - lr: 0.001
0/55 of epoch 15/30 jigsaw : 0.254, class : 0.157, t_rotation : 0.325, entropy : 0.306 - acc jigsaw : 91.41, class : 75.00 [bs:128]
30/55 of epoch 15/30 jigsaw : 0.263, class : 0.116, t_rotation : 0.135, entropy : 0.329 - acc jigsaw : 89.06, class : 84.38 [bs:128]
Accuracies on val: jigsaw : 98.36, class : 92.94
--------------------------------------------------------
Accuracies on test: jigsaw : 97.95, class : 89.50
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 15
New epoch - lr: 0.001
0/55 of epoch 16/30 jigsaw : 0.226, class : 0.047, t_rotation : 0.199, entropy : 0.339 - acc jigsaw : 92.97, class : 86.72 [bs:128]
30/55 of epoch 16/30 jigsaw : 0.190, class : 0.041, t_rotation : 0.233, entropy : 0.260 - acc jigsaw : 92.97, class : 75.78 [bs:128]
Accuracies on val: jigsaw : 98.11, class : 93.06
--------------------------------------------------------
Accuracies on test: jigsaw : 98.24, class : 89.21
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 16
New epoch - lr: 0.001
0/55 of epoch 17/30 jigsaw : 0.156, class : 0.046, t_rotation : 0.246, entropy : 0.251 - acc jigsaw : 93.75, class : 79.69 [bs:128]
30/55 of epoch 17/30 jigsaw : 0.259, class : 0.085, t_rotation : 0.121, entropy : 0.251 - acc jigsaw : 92.19, class : 77.34 [bs:128]
Accuracies on val: jigsaw : 98.61, class : 93.44
--------------------------------------------------------
Accuracies on test: jigsaw : 98.10, class : 90.14
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 17
New epoch - lr: 0.001
0/55 of epoch 18/30 jigsaw : 0.130, class : 0.053, t_rotation : 0.163, entropy : 0.238 - acc jigsaw : 95.31, class : 83.59 [bs:128]
30/55 of epoch 18/30 jigsaw : 0.157, class : 0.128, t_rotation : 0.244, entropy : 0.223 - acc jigsaw : 95.31, class : 80.47 [bs:128]
Accuracies on val: jigsaw : 98.11, class : 93.82
--------------------------------------------------------
Accuracies on test: jigsaw : 98.24, class : 89.26
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 18
New epoch - lr: 0.001
0/55 of epoch 19/30 jigsaw : 0.107, class : 0.099, t_rotation : 0.215, entropy : 0.169 - acc jigsaw : 96.09, class : 86.72 [bs:128]
30/55 of epoch 19/30 jigsaw : 0.232, class : 0.072, t_rotation : 0.183, entropy : 0.228 - acc jigsaw : 91.41, class : 82.03 [bs:128]
Accuracies on val: jigsaw : 98.11, class : 93.69
--------------------------------------------------------
Accuracies on test: jigsaw : 97.66, class : 90.23
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 19
New epoch - lr: 0.001
0/55 of epoch 20/30 jigsaw : 0.131, class : 0.092, t_rotation : 0.243, entropy : 0.215 - acc jigsaw : 96.09, class : 83.59 [bs:128]
30/55 of epoch 20/30 jigsaw : 0.233, class : 0.054, t_rotation : 0.138, entropy : 0.203 - acc jigsaw : 93.75, class : 79.69 [bs:128]
Accuracies on val: jigsaw : 97.48, class : 93.82
--------------------------------------------------------
Accuracies on test: jigsaw : 97.95, class : 89.45
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 20
New epoch - lr: 0.001
0/55 of epoch 21/30 jigsaw : 0.122, class : 0.048, t_rotation : 0.255, entropy : 0.175 - acc jigsaw : 97.66, class : 81.25 [bs:128]
30/55 of epoch 21/30 jigsaw : 0.190, class : 0.063, t_rotation : 0.121, entropy : 0.176 - acc jigsaw : 94.53, class : 77.34 [bs:128]
Accuracies on val: jigsaw : 97.98, class : 93.69
--------------------------------------------------------
Accuracies on test: jigsaw : 98.05, class : 90.28
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 21
New epoch - lr: 0.001
0/55 of epoch 22/30 jigsaw : 0.238, class : 0.058, t_rotation : 0.142, entropy : 0.190 - acc jigsaw : 93.75, class : 78.91 [bs:128]
30/55 of epoch 22/30 jigsaw : 0.274, class : 0.080, t_rotation : 0.128, entropy : 0.126 - acc jigsaw : 90.62, class : 84.38 [bs:128]
Accuracies on val: jigsaw : 97.48, class : 93.69
--------------------------------------------------------
Accuracies on test: jigsaw : 98.68, class : 90.23
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 22
New epoch - lr: 0.001
0/55 of epoch 23/30 jigsaw : 0.196, class : 0.026, t_rotation : 0.300, entropy : 0.196 - acc jigsaw : 89.06, class : 78.91 [bs:128]
30/55 of epoch 23/30 jigsaw : 0.165, class : 0.054, t_rotation : 0.106, entropy : 0.187 - acc jigsaw : 94.53, class : 81.25 [bs:128]
Accuracies on val: jigsaw : 98.61, class : 94.70
--------------------------------------------------------
Accuracies on test: jigsaw : 99.02, class : 89.79
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 23
New epoch - lr: 0.0001
0/55 of epoch 24/30 jigsaw : 0.125, class : 0.048, t_rotation : 0.219, entropy : 0.145 - acc jigsaw : 96.09, class : 81.25 [bs:128]
30/55 of epoch 24/30 jigsaw : 0.142, class : 0.042, t_rotation : 0.137, entropy : 0.165 - acc jigsaw : 92.97, class : 75.78 [bs:128]
Accuracies on val: jigsaw : 98.23, class : 94.33
--------------------------------------------------------
Accuracies on test: jigsaw : 98.63, class : 90.38
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 24
New epoch - lr: 0.0001
0/55 of epoch 25/30 jigsaw : 0.205, class : 0.034, t_rotation : 0.138, entropy : 0.271 - acc jigsaw : 92.97, class : 83.59 [bs:128]
30/55 of epoch 25/30 jigsaw : 0.082, class : 0.060, t_rotation : 0.230, entropy : 0.119 - acc jigsaw : 96.88, class : 80.47 [bs:128]
Accuracies on val: jigsaw : 98.11, class : 94.58
--------------------------------------------------------
Accuracies on test: jigsaw : 98.78, class : 90.48
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 25
New epoch - lr: 0.0001
0/55 of epoch 26/30 jigsaw : 0.099, class : 0.036, t_rotation : 0.226, entropy : 0.165 - acc jigsaw : 96.09, class : 81.25 [bs:128]
30/55 of epoch 26/30 jigsaw : 0.118, class : 0.018, t_rotation : 0.150, entropy : 0.174 - acc jigsaw : 96.88, class : 81.25 [bs:128]
Accuracies on val: jigsaw : 98.23, class : 94.70
--------------------------------------------------------
Accuracies on test: jigsaw : 98.88, class : 90.38
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 26
New epoch - lr: 0.0001
0/55 of epoch 27/30 jigsaw : 0.134, class : 0.111, t_rotation : 0.165, entropy : 0.194 - acc jigsaw : 95.31, class : 85.94 [bs:128]
30/55 of epoch 27/30 jigsaw : 0.202, class : 0.099, t_rotation : 0.221, entropy : 0.188 - acc jigsaw : 92.97, class : 83.59 [bs:128]
Accuracies on val: jigsaw : 98.49, class : 94.58
--------------------------------------------------------
Accuracies on test: jigsaw : 98.44, class : 90.33
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 27
New epoch - lr: 0.0001
0/55 of epoch 28/30 jigsaw : 0.176, class : 0.021, t_rotation : 0.200, entropy : 0.209 - acc jigsaw : 93.75, class : 81.25 [bs:128]
30/55 of epoch 28/30 jigsaw : 0.138, class : 0.113, t_rotation : 0.232, entropy : 0.146 - acc jigsaw : 92.97, class : 79.69 [bs:128]
Accuracies on val: jigsaw : 98.61, class : 94.07
--------------------------------------------------------
Accuracies on test: jigsaw : 98.78, class : 90.43
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 28
New epoch - lr: 0.0001
0/55 of epoch 29/30 jigsaw : 0.181, class : 0.100, t_rotation : 0.188, entropy : 0.172 - acc jigsaw : 90.62, class : 82.03 [bs:128]
30/55 of epoch 29/30 jigsaw : 0.060, class : 0.027, t_rotation : 0.200, entropy : 0.204 - acc jigsaw : 99.22, class : 81.25 [bs:128]
Accuracies on val: jigsaw : 98.74, class : 94.20
--------------------------------------------------------
Accuracies on test: jigsaw : 99.02, class : 90.58
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 29
New epoch - lr: 0.0001
0/55 of epoch 30/30 jigsaw : 0.099, class : 0.103, t_rotation : 0.194, entropy : 0.181 - acc jigsaw : 97.66, class : 78.91 [bs:128]
30/55 of epoch 30/30 jigsaw : 0.188, class : 0.069, t_rotation : 0.228, entropy : 0.151 - acc jigsaw : 94.53, class : 73.44 [bs:128]
Accuracies on val: jigsaw : 98.61, class : 94.20
--------------------------------------------------------
Accuracies on test: jigsaw : 98.97, class : 90.67
--------------------------------------------------------
2019-12-16 08:52:43
art_painting
['photo', 'sketch', 'cartoon']
unsupervised_task_weight: 0.8
bias_hole_image: 0.5
target_rotation_weight: 0.8
entropy_weight 0.1
only_classify the ordered image: True
Highest accuracy on validation set appears on epoch  tensor(25)
Highest accuracy on test set appears on epoch  tensor(29)
Accuracy on test set when the accuracy on validation set is highest:0.904
Highest accuracy on test set:0.907
It took 1320.15
--------------------------------------------------------
******************Start training**************************************
--------------------------------------------------------
Dataset size: training 6884, validation 763, testing 2344
--------------------------------------------------------
Namespace(TTA=False, batch_size=128, bias_whole_image=0.5, classify_only_ordered_images_or_not=True, domains_list=['photo', 'sketch', 'cartoon', 'art_painting'], entropy_loss_weight=0.1, epochs=30, folder_name='test', image_size=222, jitter=0.4, learning_rate=0.001, limit_source=None, limit_target=None, max_scale=1.0, min_scale=0.8, n_classes=7, nesterov=False, network='resnet18', ooo_weight=0, parameters_lists=[[0.8, 0.3, 0.8, 0.1], [0.8, 0.5, 0.8, 0.1], [0.8, 0.6, 0.8, 0.1]], random_horiz_flip=0.5, repeat_times=3, source=['photo', 'sketch', 'art_painting'], suffix='', target='cartoon', target_domain_list=['art_painting', 'cartoon', 'sketch', 'photo'], target_domain_unsupervised_task_loss_weight=0.8, tf_logger=True, tile_random_grayscale=0.1, train_all=True, unsupervised_task_weight=0.8, val_size=0.1)
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 0
New epoch - lr: 0.001
0/53 of epoch 1/30 jigsaw : 1.385, class : 2.188, t_rotation : 1.384, entropy : 1.694 - acc jigsaw : 29.69, class : 14.06 [bs:128]
30/53 of epoch 1/30 jigsaw : 0.893, class : 1.278, t_rotation : 0.902, entropy : 1.694 - acc jigsaw : 69.53, class : 58.59 [bs:128]
Accuracies on val: jigsaw : 95.02, class : 70.64
--------------------------------------------------------
Accuracies on test: jigsaw : 99.23, class : 55.29
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 1
New epoch - lr: 0.001
0/53 of epoch 2/30 jigsaw : 0.783, class : 0.854, t_rotation : 0.928, entropy : 1.508 - acc jigsaw : 71.09, class : 66.41 [bs:128]
30/53 of epoch 2/30 jigsaw : 0.603, class : 0.552, t_rotation : 0.682, entropy : 1.087 - acc jigsaw : 76.56, class : 73.44 [bs:128]
Accuracies on val: jigsaw : 93.32, class : 83.88
--------------------------------------------------------
Accuracies on test: jigsaw : 97.99, class : 68.64
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 2
New epoch - lr: 0.001
0/53 of epoch 3/30 jigsaw : 0.453, class : 0.466, t_rotation : 0.520, entropy : 0.990 - acc jigsaw : 84.38, class : 76.56 [bs:128]
30/53 of epoch 3/30 jigsaw : 0.547, class : 0.466, t_rotation : 0.464, entropy : 0.833 - acc jigsaw : 78.91, class : 73.44 [bs:128]
Accuracies on val: jigsaw : 93.45, class : 87.68
--------------------------------------------------------
Accuracies on test: jigsaw : 98.63, class : 72.44
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 3
New epoch - lr: 0.001
0/53 of epoch 4/30 jigsaw : 0.479, class : 0.331, t_rotation : 0.431, entropy : 0.726 - acc jigsaw : 81.25, class : 81.25 [bs:128]
30/53 of epoch 4/30 jigsaw : 0.465, class : 0.321, t_rotation : 0.405, entropy : 0.816 - acc jigsaw : 80.47, class : 75.78 [bs:128]
Accuracies on val: jigsaw : 95.28, class : 88.34
--------------------------------------------------------
Accuracies on test: jigsaw : 98.93, class : 74.87
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 4
New epoch - lr: 0.001
0/53 of epoch 5/30 jigsaw : 0.446, class : 0.270, t_rotation : 0.390, entropy : 0.647 - acc jigsaw : 89.06, class : 75.78 [bs:128]
30/53 of epoch 5/30 jigsaw : 0.346, class : 0.318, t_rotation : 0.312, entropy : 0.608 - acc jigsaw : 88.28, class : 79.69 [bs:128]
Accuracies on val: jigsaw : 94.89, class : 89.25
--------------------------------------------------------
Accuracies on test: jigsaw : 98.98, class : 77.99
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 5
New epoch - lr: 0.001
0/53 of epoch 6/30 jigsaw : 0.396, class : 0.211, t_rotation : 0.293, entropy : 0.499 - acc jigsaw : 88.28, class : 77.34 [bs:128]
30/53 of epoch 6/30 jigsaw : 0.439, class : 0.256, t_rotation : 0.329, entropy : 0.541 - acc jigsaw : 82.03, class : 78.91 [bs:128]
Accuracies on val: jigsaw : 93.97, class : 91.74
--------------------------------------------------------
Accuracies on test: jigsaw : 98.04, class : 77.52
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 6
New epoch - lr: 0.001
0/53 of epoch 7/30 jigsaw : 0.364, class : 0.141, t_rotation : 0.255, entropy : 0.542 - acc jigsaw : 84.38, class : 85.16 [bs:128]
30/53 of epoch 7/30 jigsaw : 0.367, class : 0.242, t_rotation : 0.240, entropy : 0.445 - acc jigsaw : 86.72, class : 74.22 [bs:128]
Accuracies on val: jigsaw : 94.63, class : 91.35
--------------------------------------------------------
Accuracies on test: jigsaw : 99.06, class : 77.47
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 7
New epoch - lr: 0.001
0/53 of epoch 8/30 jigsaw : 0.293, class : 0.172, t_rotation : 0.275, entropy : 0.391 - acc jigsaw : 85.16, class : 80.47 [bs:128]
30/53 of epoch 8/30 jigsaw : 0.335, class : 0.149, t_rotation : 0.256, entropy : 0.445 - acc jigsaw : 87.50, class : 73.44 [bs:128]
Accuracies on val: jigsaw : 95.02, class : 91.48
--------------------------------------------------------
Accuracies on test: jigsaw : 98.98, class : 80.16
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 8
New epoch - lr: 0.001
0/53 of epoch 9/30 jigsaw : 0.328, class : 0.118, t_rotation : 0.204, entropy : 0.450 - acc jigsaw : 87.50, class : 85.94 [bs:128]
30/53 of epoch 9/30 jigsaw : 0.417, class : 0.271, t_rotation : 0.223, entropy : 0.407 - acc jigsaw : 84.38, class : 75.00 [bs:128]
Accuracies on val: jigsaw : 95.15, class : 93.32
--------------------------------------------------------
Accuracies on test: jigsaw : 98.89, class : 77.69
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 9
New epoch - lr: 0.001
0/53 of epoch 10/30 jigsaw : 0.219, class : 0.143, t_rotation : 0.231, entropy : 0.376 - acc jigsaw : 92.97, class : 79.69 [bs:128]
30/53 of epoch 10/30 jigsaw : 0.339, class : 0.262, t_rotation : 0.235, entropy : 0.339 - acc jigsaw : 89.84, class : 75.78 [bs:128]
Accuracies on val: jigsaw : 97.38, class : 93.05
--------------------------------------------------------
Accuracies on test: jigsaw : 99.10, class : 78.46
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 10
New epoch - lr: 0.001
0/53 of epoch 11/30 jigsaw : 0.323, class : 0.119, t_rotation : 0.156, entropy : 0.400 - acc jigsaw : 89.06, class : 84.38 [bs:128]
30/53 of epoch 11/30 jigsaw : 0.308, class : 0.102, t_rotation : 0.130, entropy : 0.332 - acc jigsaw : 90.62, class : 88.28 [bs:128]
Accuracies on val: jigsaw : 95.81, class : 92.53
--------------------------------------------------------
Accuracies on test: jigsaw : 99.27, class : 80.38
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 11
New epoch - lr: 0.001
0/53 of epoch 12/30 jigsaw : 0.257, class : 0.092, t_rotation : 0.208, entropy : 0.391 - acc jigsaw : 91.41, class : 78.12 [bs:128]
30/53 of epoch 12/30 jigsaw : 0.312, class : 0.075, t_rotation : 0.141, entropy : 0.374 - acc jigsaw : 91.41, class : 84.38 [bs:128]
Accuracies on val: jigsaw : 96.46, class : 93.18
--------------------------------------------------------
Accuracies on test: jigsaw : 99.57, class : 78.88
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 12
New epoch - lr: 0.001
0/53 of epoch 13/30 jigsaw : 0.220, class : 0.177, t_rotation : 0.233, entropy : 0.360 - acc jigsaw : 91.41, class : 73.44 [bs:128]
30/53 of epoch 13/30 jigsaw : 0.279, class : 0.153, t_rotation : 0.158, entropy : 0.267 - acc jigsaw : 89.06, class : 78.12 [bs:128]
Accuracies on val: jigsaw : 94.76, class : 94.50
--------------------------------------------------------
Accuracies on test: jigsaw : 99.27, class : 78.80
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 13
New epoch - lr: 0.001
0/53 of epoch 14/30 jigsaw : 0.313, class : 0.077, t_rotation : 0.232, entropy : 0.279 - acc jigsaw : 86.72, class : 82.03 [bs:128]
30/53 of epoch 14/30 jigsaw : 0.173, class : 0.182, t_rotation : 0.122, entropy : 0.290 - acc jigsaw : 93.75, class : 84.38 [bs:128]
Accuracies on val: jigsaw : 95.81, class : 93.84
--------------------------------------------------------
Accuracies on test: jigsaw : 99.53, class : 81.48
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 14
New epoch - lr: 0.001
0/53 of epoch 15/30 jigsaw : 0.282, class : 0.065, t_rotation : 0.170, entropy : 0.281 - acc jigsaw : 86.72, class : 89.06 [bs:128]
30/53 of epoch 15/30 jigsaw : 0.200, class : 0.080, t_rotation : 0.102, entropy : 0.269 - acc jigsaw : 91.41, class : 79.69 [bs:128]
Accuracies on val: jigsaw : 95.41, class : 94.23
--------------------------------------------------------
Accuracies on test: jigsaw : 99.49, class : 78.58
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 15
New epoch - lr: 0.001
0/53 of epoch 16/30 jigsaw : 0.174, class : 0.150, t_rotation : 0.075, entropy : 0.238 - acc jigsaw : 93.75, class : 83.59 [bs:128]
30/53 of epoch 16/30 jigsaw : 0.333, class : 0.079, t_rotation : 0.085, entropy : 0.348 - acc jigsaw : 88.28, class : 82.03 [bs:128]
Accuracies on val: jigsaw : 95.15, class : 93.97
--------------------------------------------------------
Accuracies on test: jigsaw : 99.36, class : 80.50
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 16
New epoch - lr: 0.001
0/53 of epoch 17/30 jigsaw : 0.182, class : 0.053, t_rotation : 0.086, entropy : 0.324 - acc jigsaw : 92.97, class : 81.25 [bs:128]
30/53 of epoch 17/30 jigsaw : 0.274, class : 0.071, t_rotation : 0.085, entropy : 0.242 - acc jigsaw : 89.84, class : 81.25 [bs:128]
Accuracies on val: jigsaw : 95.02, class : 93.71
--------------------------------------------------------
Accuracies on test: jigsaw : 99.49, class : 82.17
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 17
New epoch - lr: 0.001
0/53 of epoch 18/30 jigsaw : 0.268, class : 0.080, t_rotation : 0.142, entropy : 0.276 - acc jigsaw : 91.41, class : 82.81 [bs:128]
30/53 of epoch 18/30 jigsaw : 0.256, class : 0.065, t_rotation : 0.086, entropy : 0.218 - acc jigsaw : 92.19, class : 82.03 [bs:128]
Accuracies on val: jigsaw : 95.94, class : 93.97
--------------------------------------------------------
Accuracies on test: jigsaw : 99.49, class : 80.29
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 18
New epoch - lr: 0.001
0/53 of epoch 19/30 jigsaw : 0.141, class : 0.071, t_rotation : 0.142, entropy : 0.278 - acc jigsaw : 96.88, class : 82.81 [bs:128]
30/53 of epoch 19/30 jigsaw : 0.162, class : 0.031, t_rotation : 0.115, entropy : 0.286 - acc jigsaw : 92.97, class : 85.16 [bs:128]
Accuracies on val: jigsaw : 95.41, class : 94.10
--------------------------------------------------------
Accuracies on test: jigsaw : 99.19, class : 81.27
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 19
New epoch - lr: 0.001
0/53 of epoch 20/30 jigsaw : 0.245, class : 0.057, t_rotation : 0.066, entropy : 0.232 - acc jigsaw : 89.84, class : 78.91 [bs:128]
30/53 of epoch 20/30 jigsaw : 0.243, class : 0.066, t_rotation : 0.104, entropy : 0.244 - acc jigsaw : 90.62, class : 82.03 [bs:128]
Accuracies on val: jigsaw : 95.67, class : 94.89
--------------------------------------------------------
Accuracies on test: jigsaw : 99.53, class : 79.56
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 20
New epoch - lr: 0.001
0/53 of epoch 21/30 jigsaw : 0.225, class : 0.053, t_rotation : 0.131, entropy : 0.287 - acc jigsaw : 90.62, class : 82.81 [bs:128]
30/53 of epoch 21/30 jigsaw : 0.195, class : 0.026, t_rotation : 0.066, entropy : 0.187 - acc jigsaw : 90.62, class : 78.12 [bs:128]
Accuracies on val: jigsaw : 94.89, class : 94.50
--------------------------------------------------------
Accuracies on test: jigsaw : 99.49, class : 80.89
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 21
New epoch - lr: 0.001
0/53 of epoch 22/30 jigsaw : 0.174, class : 0.025, t_rotation : 0.137, entropy : 0.222 - acc jigsaw : 92.97, class : 83.59 [bs:128]
30/53 of epoch 22/30 jigsaw : 0.200, class : 0.032, t_rotation : 0.109, entropy : 0.176 - acc jigsaw : 94.53, class : 76.56 [bs:128]
Accuracies on val: jigsaw : 96.59, class : 95.28
--------------------------------------------------------
Accuracies on test: jigsaw : 99.87, class : 80.33
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 22
New epoch - lr: 0.001
0/53 of epoch 23/30 jigsaw : 0.202, class : 0.071, t_rotation : 0.096, entropy : 0.221 - acc jigsaw : 92.97, class : 79.69 [bs:128]
30/53 of epoch 23/30 jigsaw : 0.128, class : 0.054, t_rotation : 0.058, entropy : 0.191 - acc jigsaw : 96.09, class : 85.16 [bs:128]
Accuracies on val: jigsaw : 95.15, class : 94.89
--------------------------------------------------------
Accuracies on test: jigsaw : 99.70, class : 81.14
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 23
New epoch - lr: 0.0001
0/53 of epoch 24/30 jigsaw : 0.210, class : 0.055, t_rotation : 0.123, entropy : 0.239 - acc jigsaw : 95.31, class : 81.25 [bs:128]
30/53 of epoch 24/30 jigsaw : 0.191, class : 0.044, t_rotation : 0.171, entropy : 0.193 - acc jigsaw : 92.97, class : 86.72 [bs:128]
Accuracies on val: jigsaw : 95.81, class : 95.15
--------------------------------------------------------
Accuracies on test: jigsaw : 99.79, class : 80.93
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 24
New epoch - lr: 0.0001
0/53 of epoch 25/30 jigsaw : 0.185, class : 0.133, t_rotation : 0.177, entropy : 0.182 - acc jigsaw : 95.31, class : 81.25 [bs:128]
30/53 of epoch 25/30 jigsaw : 0.227, class : 0.062, t_rotation : 0.144, entropy : 0.167 - acc jigsaw : 92.19, class : 78.12 [bs:128]
Accuracies on val: jigsaw : 95.28, class : 95.15
--------------------------------------------------------
Accuracies on test: jigsaw : 99.70, class : 81.14
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 25
New epoch - lr: 0.0001
0/53 of epoch 26/30 jigsaw : 0.131, class : 0.041, t_rotation : 0.158, entropy : 0.215 - acc jigsaw : 94.53, class : 82.81 [bs:128]
30/53 of epoch 26/30 jigsaw : 0.191, class : 0.101, t_rotation : 0.102, entropy : 0.206 - acc jigsaw : 94.53, class : 84.38 [bs:128]
Accuracies on val: jigsaw : 95.67, class : 95.41
--------------------------------------------------------
Accuracies on test: jigsaw : 99.74, class : 80.59
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 26
New epoch - lr: 0.0001
0/53 of epoch 27/30 jigsaw : 0.228, class : 0.054, t_rotation : 0.100, entropy : 0.169 - acc jigsaw : 91.41, class : 83.59 [bs:128]
30/53 of epoch 27/30 jigsaw : 0.182, class : 0.046, t_rotation : 0.129, entropy : 0.165 - acc jigsaw : 94.53, class : 83.59 [bs:128]
Accuracies on val: jigsaw : 95.81, class : 95.15
--------------------------------------------------------
Accuracies on test: jigsaw : 99.74, class : 81.36
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 27
New epoch - lr: 0.0001
0/53 of epoch 28/30 jigsaw : 0.264, class : 0.047, t_rotation : 0.106, entropy : 0.248 - acc jigsaw : 92.19, class : 82.03 [bs:128]
30/53 of epoch 28/30 jigsaw : 0.234, class : 0.055, t_rotation : 0.113, entropy : 0.209 - acc jigsaw : 89.84, class : 83.59 [bs:128]
Accuracies on val: jigsaw : 96.20, class : 95.02
--------------------------------------------------------
Accuracies on test: jigsaw : 99.83, class : 81.06
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 28
New epoch - lr: 0.0001
0/53 of epoch 29/30 jigsaw : 0.154, class : 0.011, t_rotation : 0.051, entropy : 0.156 - acc jigsaw : 95.31, class : 81.25 [bs:128]
30/53 of epoch 29/30 jigsaw : 0.174, class : 0.020, t_rotation : 0.094, entropy : 0.219 - acc jigsaw : 93.75, class : 81.25 [bs:128]
Accuracies on val: jigsaw : 95.67, class : 95.28
--------------------------------------------------------
Accuracies on test: jigsaw : 99.79, class : 80.72
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 29
New epoch - lr: 0.0001
0/53 of epoch 30/30 jigsaw : 0.160, class : 0.056, t_rotation : 0.095, entropy : 0.194 - acc jigsaw : 95.31, class : 85.16 [bs:128]
30/53 of epoch 30/30 jigsaw : 0.147, class : 0.044, t_rotation : 0.071, entropy : 0.262 - acc jigsaw : 96.09, class : 78.12 [bs:128]
Accuracies on val: jigsaw : 96.46, class : 95.02
--------------------------------------------------------
Accuracies on test: jigsaw : 99.91, class : 81.31
--------------------------------------------------------
2019-12-16 09:14:04
cartoon
['photo', 'sketch', 'art_painting']
unsupervised_task_weight: 0.8
bias_hole_image: 0.5
target_rotation_weight: 0.8
entropy_weight 0.1
only_classify the ordered image: True
Highest accuracy on validation set appears on epoch  tensor(25)
Highest accuracy on test set appears on epoch  tensor(16)
Accuracy on test set when the accuracy on validation set is highest:0.806
Highest accuracy on test set:0.822
It took 1280.76
--------------------------------------------------------
******************Start training**************************************
--------------------------------------------------------
Dataset size: training 6884, validation 763, testing 2344
--------------------------------------------------------
Namespace(TTA=False, batch_size=128, bias_whole_image=0.5, classify_only_ordered_images_or_not=True, domains_list=['photo', 'sketch', 'cartoon', 'art_painting'], entropy_loss_weight=0.1, epochs=30, folder_name='test', image_size=222, jitter=0.4, learning_rate=0.001, limit_source=None, limit_target=None, max_scale=1.0, min_scale=0.8, n_classes=7, nesterov=False, network='resnet18', ooo_weight=0, parameters_lists=[[0.8, 0.3, 0.8, 0.1], [0.8, 0.5, 0.8, 0.1], [0.8, 0.6, 0.8, 0.1]], random_horiz_flip=0.5, repeat_times=3, source=['photo', 'sketch', 'art_painting'], suffix='', target='cartoon', target_domain_list=['art_painting', 'cartoon', 'sketch', 'photo'], target_domain_unsupervised_task_loss_weight=0.8, tf_logger=True, tile_random_grayscale=0.1, train_all=True, unsupervised_task_weight=0.8, val_size=0.1)
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 0
New epoch - lr: 0.001
0/53 of epoch 1/30 jigsaw : 1.310, class : 2.215, t_rotation : 1.345, entropy : 1.671 - acc jigsaw : 47.66, class : 17.19 [bs:128]
30/53 of epoch 1/30 jigsaw : 0.857, class : 1.181, t_rotation : 0.926, entropy : 1.702 - acc jigsaw : 69.53, class : 60.94 [bs:128]
Accuracies on val: jigsaw : 96.99, class : 77.98
--------------------------------------------------------
Accuracies on test: jigsaw : 99.57, class : 58.45
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 1
New epoch - lr: 0.001
0/53 of epoch 2/30 jigsaw : 0.799, class : 0.904, t_rotation : 0.649, entropy : 1.364 - acc jigsaw : 64.84, class : 65.62 [bs:128]
30/53 of epoch 2/30 jigsaw : 0.609, class : 0.614, t_rotation : 0.610, entropy : 1.185 - acc jigsaw : 80.47, class : 68.75 [bs:128]
Accuracies on val: jigsaw : 95.67, class : 87.81
--------------------------------------------------------
Accuracies on test: jigsaw : 98.68, class : 71.08
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 2
New epoch - lr: 0.001
0/53 of epoch 3/30 jigsaw : 0.624, class : 0.426, t_rotation : 0.605, entropy : 0.918 - acc jigsaw : 75.00, class : 72.66 [bs:128]
30/53 of epoch 3/30 jigsaw : 0.490, class : 0.278, t_rotation : 0.477, entropy : 0.772 - acc jigsaw : 81.25, class : 75.78 [bs:128]
Accuracies on val: jigsaw : 95.41, class : 89.65
--------------------------------------------------------
Accuracies on test: jigsaw : 98.51, class : 74.74
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 3
New epoch - lr: 0.001
0/53 of epoch 4/30 jigsaw : 0.567, class : 0.287, t_rotation : 0.417, entropy : 0.672 - acc jigsaw : 78.91, class : 82.81 [bs:128]
30/53 of epoch 4/30 jigsaw : 0.417, class : 0.198, t_rotation : 0.414, entropy : 0.623 - acc jigsaw : 82.03, class : 80.47 [bs:128]
Accuracies on val: jigsaw : 96.46, class : 91.48
--------------------------------------------------------
Accuracies on test: jigsaw : 98.98, class : 76.96
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 4
New epoch - lr: 0.001
0/53 of epoch 5/30 jigsaw : 0.345, class : 0.306, t_rotation : 0.447, entropy : 0.644 - acc jigsaw : 86.72, class : 75.00 [bs:128]
30/53 of epoch 5/30 jigsaw : 0.494, class : 0.382, t_rotation : 0.447, entropy : 0.530 - acc jigsaw : 83.59, class : 74.22 [bs:128]
Accuracies on val: jigsaw : 94.89, class : 92.01
--------------------------------------------------------
Accuracies on test: jigsaw : 98.51, class : 77.82
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 5
New epoch - lr: 0.001
0/53 of epoch 6/30 jigsaw : 0.330, class : 0.372, t_rotation : 0.357, entropy : 0.415 - acc jigsaw : 90.62, class : 70.31 [bs:128]
30/53 of epoch 6/30 jigsaw : 0.389, class : 0.133, t_rotation : 0.233, entropy : 0.448 - acc jigsaw : 85.94, class : 75.78 [bs:128]
Accuracies on val: jigsaw : 96.46, class : 92.01
--------------------------------------------------------
Accuracies on test: jigsaw : 98.81, class : 77.60
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 6
New epoch - lr: 0.001
0/53 of epoch 7/30 jigsaw : 0.340, class : 0.201, t_rotation : 0.340, entropy : 0.533 - acc jigsaw : 85.94, class : 79.69 [bs:128]
30/53 of epoch 7/30 jigsaw : 0.341, class : 0.095, t_rotation : 0.265, entropy : 0.456 - acc jigsaw : 90.62, class : 82.81 [bs:128]
Accuracies on val: jigsaw : 95.67, class : 93.05
--------------------------------------------------------
Accuracies on test: jigsaw : 99.06, class : 78.16
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 7
New epoch - lr: 0.001
0/53 of epoch 8/30 jigsaw : 0.392, class : 0.227, t_rotation : 0.274, entropy : 0.501 - acc jigsaw : 83.59, class : 75.00 [bs:128]
30/53 of epoch 8/30 jigsaw : 0.346, class : 0.204, t_rotation : 0.172, entropy : 0.463 - acc jigsaw : 88.28, class : 82.03 [bs:128]
Accuracies on val: jigsaw : 95.15, class : 93.45
--------------------------------------------------------
Accuracies on test: jigsaw : 98.38, class : 78.84
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 8
New epoch - lr: 0.001
0/53 of epoch 9/30 jigsaw : 0.185, class : 0.273, t_rotation : 0.201, entropy : 0.469 - acc jigsaw : 95.31, class : 80.47 [bs:128]
30/53 of epoch 9/30 jigsaw : 0.330, class : 0.133, t_rotation : 0.212, entropy : 0.380 - acc jigsaw : 89.06, class : 76.56 [bs:128]
Accuracies on val: jigsaw : 96.33, class : 93.45
--------------------------------------------------------
Accuracies on test: jigsaw : 99.19, class : 80.76
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 9
New epoch - lr: 0.001
0/53 of epoch 10/30 jigsaw : 0.195, class : 0.059, t_rotation : 0.245, entropy : 0.452 - acc jigsaw : 94.53, class : 81.25 [bs:128]
30/53 of epoch 10/30 jigsaw : 0.330, class : 0.143, t_rotation : 0.154, entropy : 0.302 - acc jigsaw : 90.62, class : 77.34 [bs:128]
Accuracies on val: jigsaw : 96.07, class : 93.97
--------------------------------------------------------
Accuracies on test: jigsaw : 98.93, class : 78.75
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 10
New epoch - lr: 0.001
0/53 of epoch 11/30 jigsaw : 0.229, class : 0.117, t_rotation : 0.153, entropy : 0.390 - acc jigsaw : 92.19, class : 78.91 [bs:128]
30/53 of epoch 11/30 jigsaw : 0.332, class : 0.083, t_rotation : 0.139, entropy : 0.375 - acc jigsaw : 87.50, class : 84.38 [bs:128]
Accuracies on val: jigsaw : 96.72, class : 93.97
--------------------------------------------------------
Accuracies on test: jigsaw : 98.85, class : 80.89
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 11
New epoch - lr: 0.001
0/53 of epoch 12/30 jigsaw : 0.361, class : 0.136, t_rotation : 0.181, entropy : 0.352 - acc jigsaw : 85.94, class : 77.34 [bs:128]
30/53 of epoch 12/30 jigsaw : 0.205, class : 0.163, t_rotation : 0.177, entropy : 0.310 - acc jigsaw : 93.75, class : 79.69 [bs:128]
Accuracies on val: jigsaw : 97.38, class : 94.36
--------------------------------------------------------
Accuracies on test: jigsaw : 99.66, class : 79.27
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 12
New epoch - lr: 0.001
0/53 of epoch 13/30 jigsaw : 0.195, class : 0.041, t_rotation : 0.144, entropy : 0.306 - acc jigsaw : 93.75, class : 80.47 [bs:128]
30/53 of epoch 13/30 jigsaw : 0.242, class : 0.117, t_rotation : 0.164, entropy : 0.271 - acc jigsaw : 89.84, class : 83.59 [bs:128]
Accuracies on val: jigsaw : 96.72, class : 94.23
--------------------------------------------------------
Accuracies on test: jigsaw : 99.57, class : 80.72
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 13
New epoch - lr: 0.001
0/53 of epoch 14/30 jigsaw : 0.276, class : 0.064, t_rotation : 0.185, entropy : 0.255 - acc jigsaw : 90.62, class : 85.16 [bs:128]
30/53 of epoch 14/30 jigsaw : 0.171, class : 0.074, t_rotation : 0.144, entropy : 0.248 - acc jigsaw : 96.09, class : 80.47 [bs:128]
Accuracies on val: jigsaw : 96.99, class : 94.23
--------------------------------------------------------
Accuracies on test: jigsaw : 99.66, class : 81.91
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 14
New epoch - lr: 0.001
0/53 of epoch 15/30 jigsaw : 0.262, class : 0.110, t_rotation : 0.131, entropy : 0.266 - acc jigsaw : 90.62, class : 80.47 [bs:128]
30/53 of epoch 15/30 jigsaw : 0.179, class : 0.070, t_rotation : 0.094, entropy : 0.296 - acc jigsaw : 93.75, class : 85.94 [bs:128]
Accuracies on val: jigsaw : 96.85, class : 94.23
--------------------------------------------------------
Accuracies on test: jigsaw : 99.53, class : 82.21
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 15
New epoch - lr: 0.001
0/53 of epoch 16/30 jigsaw : 0.289, class : 0.099, t_rotation : 0.236, entropy : 0.234 - acc jigsaw : 89.06, class : 82.81 [bs:128]
30/53 of epoch 16/30 jigsaw : 0.147, class : 0.133, t_rotation : 0.125, entropy : 0.250 - acc jigsaw : 95.31, class : 77.34 [bs:128]
Accuracies on val: jigsaw : 96.59, class : 93.71
--------------------------------------------------------
Accuracies on test: jigsaw : 99.45, class : 81.06
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 16
New epoch - lr: 0.001
0/53 of epoch 17/30 jigsaw : 0.242, class : 0.095, t_rotation : 0.157, entropy : 0.223 - acc jigsaw : 89.84, class : 79.69 [bs:128]
30/53 of epoch 17/30 jigsaw : 0.215, class : 0.084, t_rotation : 0.097, entropy : 0.198 - acc jigsaw : 91.41, class : 75.78 [bs:128]
Accuracies on val: jigsaw : 96.72, class : 94.63
--------------------------------------------------------
Accuracies on test: jigsaw : 99.66, class : 81.06
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 17
New epoch - lr: 0.001
0/53 of epoch 18/30 jigsaw : 0.158, class : 0.076, t_rotation : 0.129, entropy : 0.173 - acc jigsaw : 94.53, class : 84.38 [bs:128]
30/53 of epoch 18/30 jigsaw : 0.254, class : 0.062, t_rotation : 0.129, entropy : 0.257 - acc jigsaw : 91.41, class : 79.69 [bs:128]
Accuracies on val: jigsaw : 96.72, class : 94.76
--------------------------------------------------------
Accuracies on test: jigsaw : 99.74, class : 80.72
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 18
New epoch - lr: 0.001
0/53 of epoch 19/30 jigsaw : 0.162, class : 0.107, t_rotation : 0.147, entropy : 0.167 - acc jigsaw : 92.19, class : 78.91 [bs:128]
30/53 of epoch 19/30 jigsaw : 0.214, class : 0.050, t_rotation : 0.095, entropy : 0.320 - acc jigsaw : 94.53, class : 78.91 [bs:128]
Accuracies on val: jigsaw : 97.12, class : 94.36
--------------------------------------------------------
Accuracies on test: jigsaw : 99.49, class : 82.21
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 19
New epoch - lr: 0.001
0/53 of epoch 20/30 jigsaw : 0.230, class : 0.054, t_rotation : 0.100, entropy : 0.256 - acc jigsaw : 91.41, class : 80.47 [bs:128]
30/53 of epoch 20/30 jigsaw : 0.195, class : 0.114, t_rotation : 0.100, entropy : 0.235 - acc jigsaw : 93.75, class : 79.69 [bs:128]
Accuracies on val: jigsaw : 96.46, class : 94.36
--------------------------------------------------------
Accuracies on test: jigsaw : 99.87, class : 81.91
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 20
New epoch - lr: 0.001
0/53 of epoch 21/30 jigsaw : 0.203, class : 0.107, t_rotation : 0.184, entropy : 0.263 - acc jigsaw : 89.84, class : 76.56 [bs:128]
30/53 of epoch 21/30 jigsaw : 0.247, class : 0.057, t_rotation : 0.059, entropy : 0.225 - acc jigsaw : 92.97, class : 78.91 [bs:128]
Accuracies on val: jigsaw : 97.51, class : 93.97
--------------------------------------------------------
Accuracies on test: jigsaw : 99.79, class : 81.57
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 21
New epoch - lr: 0.001
0/53 of epoch 22/30 jigsaw : 0.187, class : 0.071, t_rotation : 0.084, entropy : 0.204 - acc jigsaw : 95.31, class : 83.59 [bs:128]
30/53 of epoch 22/30 jigsaw : 0.232, class : 0.036, t_rotation : 0.070, entropy : 0.191 - acc jigsaw : 88.28, class : 79.69 [bs:128]
Accuracies on val: jigsaw : 96.46, class : 94.36
--------------------------------------------------------
Accuracies on test: jigsaw : 99.70, class : 81.14
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 22
New epoch - lr: 0.001
0/53 of epoch 23/30 jigsaw : 0.204, class : 0.035, t_rotation : 0.105, entropy : 0.239 - acc jigsaw : 92.19, class : 86.72 [bs:128]
30/53 of epoch 23/30 jigsaw : 0.209, class : 0.019, t_rotation : 0.075, entropy : 0.164 - acc jigsaw : 95.31, class : 88.28 [bs:128]
Accuracies on val: jigsaw : 97.12, class : 94.50
--------------------------------------------------------
Accuracies on test: jigsaw : 99.70, class : 81.61
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 23
New epoch - lr: 0.0001
0/53 of epoch 24/30 jigsaw : 0.094, class : 0.044, t_rotation : 0.107, entropy : 0.200 - acc jigsaw : 98.44, class : 80.47 [bs:128]
30/53 of epoch 24/30 jigsaw : 0.143, class : 0.019, t_rotation : 0.118, entropy : 0.171 - acc jigsaw : 96.09, class : 80.47 [bs:128]
Accuracies on val: jigsaw : 97.38, class : 95.02
--------------------------------------------------------
Accuracies on test: jigsaw : 99.74, class : 81.31
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 24
New epoch - lr: 0.0001
0/53 of epoch 25/30 jigsaw : 0.244, class : 0.048, t_rotation : 0.056, entropy : 0.184 - acc jigsaw : 91.41, class : 75.00 [bs:128]
30/53 of epoch 25/30 jigsaw : 0.178, class : 0.034, t_rotation : 0.129, entropy : 0.155 - acc jigsaw : 91.41, class : 85.16 [bs:128]
Accuracies on val: jigsaw : 97.38, class : 94.63
--------------------------------------------------------
Accuracies on test: jigsaw : 99.70, class : 81.36
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 25
New epoch - lr: 0.0001
0/53 of epoch 26/30 jigsaw : 0.236, class : 0.096, t_rotation : 0.148, entropy : 0.227 - acc jigsaw : 92.19, class : 85.16 [bs:128]
30/53 of epoch 26/30 jigsaw : 0.247, class : 0.054, t_rotation : 0.059, entropy : 0.207 - acc jigsaw : 93.75, class : 84.38 [bs:128]
Accuracies on val: jigsaw : 97.51, class : 94.89
--------------------------------------------------------
Accuracies on test: jigsaw : 99.70, class : 81.78
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 26
New epoch - lr: 0.0001
0/53 of epoch 27/30 jigsaw : 0.219, class : 0.065, t_rotation : 0.133, entropy : 0.204 - acc jigsaw : 92.19, class : 73.44 [bs:128]
30/53 of epoch 27/30 jigsaw : 0.110, class : 0.057, t_rotation : 0.099, entropy : 0.215 - acc jigsaw : 94.53, class : 82.81 [bs:128]
Accuracies on val: jigsaw : 97.25, class : 95.02
--------------------------------------------------------
Accuracies on test: jigsaw : 99.70, class : 81.14
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 27
New epoch - lr: 0.0001
0/53 of epoch 28/30 jigsaw : 0.166, class : 0.058, t_rotation : 0.141, entropy : 0.236 - acc jigsaw : 94.53, class : 76.56 [bs:128]
30/53 of epoch 28/30 jigsaw : 0.118, class : 0.075, t_rotation : 0.081, entropy : 0.208 - acc jigsaw : 96.09, class : 80.47 [bs:128]
Accuracies on val: jigsaw : 97.38, class : 94.76
--------------------------------------------------------
Accuracies on test: jigsaw : 99.74, class : 81.74
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 28
New epoch - lr: 0.0001
0/53 of epoch 29/30 jigsaw : 0.137, class : 0.027, t_rotation : 0.119, entropy : 0.194 - acc jigsaw : 96.09, class : 78.12 [bs:128]
30/53 of epoch 29/30 jigsaw : 0.114, class : 0.036, t_rotation : 0.125, entropy : 0.132 - acc jigsaw : 96.88, class : 78.91 [bs:128]
Accuracies on val: jigsaw : 97.64, class : 94.76
--------------------------------------------------------
Accuracies on test: jigsaw : 99.74, class : 81.27
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 29
New epoch - lr: 0.0001
0/53 of epoch 30/30 jigsaw : 0.194, class : 0.013, t_rotation : 0.180, entropy : 0.143 - acc jigsaw : 93.75, class : 83.59 [bs:128]
30/53 of epoch 30/30 jigsaw : 0.171, class : 0.064, t_rotation : 0.124, entropy : 0.167 - acc jigsaw : 92.97, class : 78.91 [bs:128]
Accuracies on val: jigsaw : 97.25, class : 95.02
--------------------------------------------------------
Accuracies on test: jigsaw : 99.79, class : 81.83
--------------------------------------------------------
2019-12-16 09:35:26
cartoon
['photo', 'sketch', 'art_painting']
unsupervised_task_weight: 0.8
bias_hole_image: 0.5
target_rotation_weight: 0.8
entropy_weight 0.1
only_classify the ordered image: True
Highest accuracy on validation set appears on epoch  tensor(29)
Highest accuracy on test set appears on epoch  tensor(18)
Accuracy on test set when the accuracy on validation set is highest:0.818
Highest accuracy on test set:0.822
It took 1281.89
--------------------------------------------------------
******************Start training**************************************
--------------------------------------------------------
Dataset size: training 6884, validation 763, testing 2344
--------------------------------------------------------
Namespace(TTA=False, batch_size=128, bias_whole_image=0.5, classify_only_ordered_images_or_not=True, domains_list=['photo', 'sketch', 'cartoon', 'art_painting'], entropy_loss_weight=0.1, epochs=30, folder_name='test', image_size=222, jitter=0.4, learning_rate=0.001, limit_source=None, limit_target=None, max_scale=1.0, min_scale=0.8, n_classes=7, nesterov=False, network='resnet18', ooo_weight=0, parameters_lists=[[0.8, 0.3, 0.8, 0.1], [0.8, 0.5, 0.8, 0.1], [0.8, 0.6, 0.8, 0.1]], random_horiz_flip=0.5, repeat_times=3, source=['photo', 'sketch', 'art_painting'], suffix='', target='cartoon', target_domain_list=['art_painting', 'cartoon', 'sketch', 'photo'], target_domain_unsupervised_task_loss_weight=0.8, tf_logger=True, tile_random_grayscale=0.1, train_all=True, unsupervised_task_weight=0.8, val_size=0.1)
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 0
New epoch - lr: 0.001
0/53 of epoch 1/30 jigsaw : 1.537, class : 2.220, t_rotation : 1.547, entropy : 1.748 - acc jigsaw : 17.97, class : 13.28 [bs:128]
30/53 of epoch 1/30 jigsaw : 0.918, class : 1.187, t_rotation : 0.893, entropy : 1.722 - acc jigsaw : 67.19, class : 50.78 [bs:128]
Accuracies on val: jigsaw : 98.30, class : 74.57
--------------------------------------------------------
Accuracies on test: jigsaw : 99.27, class : 56.61
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 1
New epoch - lr: 0.001
0/53 of epoch 2/30 jigsaw : 0.795, class : 0.880, t_rotation : 0.815, entropy : 1.448 - acc jigsaw : 65.62, class : 64.06 [bs:128]
30/53 of epoch 2/30 jigsaw : 0.568, class : 0.570, t_rotation : 0.673, entropy : 1.169 - acc jigsaw : 79.69, class : 75.78 [bs:128]
Accuracies on val: jigsaw : 95.81, class : 86.76
--------------------------------------------------------
Accuracies on test: jigsaw : 97.23, class : 69.67
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 2
New epoch - lr: 0.001
0/53 of epoch 3/30 jigsaw : 0.518, class : 0.380, t_rotation : 0.579, entropy : 0.967 - acc jigsaw : 80.47, class : 80.47 [bs:128]
30/53 of epoch 3/30 jigsaw : 0.528, class : 0.271, t_rotation : 0.465, entropy : 0.840 - acc jigsaw : 81.25, class : 79.69 [bs:128]
Accuracies on val: jigsaw : 96.59, class : 88.60
--------------------------------------------------------
Accuracies on test: jigsaw : 98.63, class : 75.38
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 3
New epoch - lr: 0.001
0/53 of epoch 4/30 jigsaw : 0.506, class : 0.228, t_rotation : 0.442, entropy : 0.698 - acc jigsaw : 78.91, class : 78.12 [bs:128]
30/53 of epoch 4/30 jigsaw : 0.379, class : 0.261, t_rotation : 0.402, entropy : 0.681 - acc jigsaw : 85.16, class : 76.56 [bs:128]
Accuracies on val: jigsaw : 97.12, class : 89.38
--------------------------------------------------------
Accuracies on test: jigsaw : 97.78, class : 76.83
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 4
New epoch - lr: 0.001
0/53 of epoch 5/30 jigsaw : 0.452, class : 0.257, t_rotation : 0.416, entropy : 0.710 - acc jigsaw : 81.25, class : 80.47 [bs:128]
30/53 of epoch 5/30 jigsaw : 0.405, class : 0.275, t_rotation : 0.376, entropy : 0.600 - acc jigsaw : 83.59, class : 70.31 [bs:128]
Accuracies on val: jigsaw : 95.94, class : 89.91
--------------------------------------------------------
Accuracies on test: jigsaw : 98.29, class : 78.58
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 5
New epoch - lr: 0.001
0/53 of epoch 6/30 jigsaw : 0.446, class : 0.147, t_rotation : 0.399, entropy : 0.595 - acc jigsaw : 78.91, class : 78.91 [bs:128]
30/53 of epoch 6/30 jigsaw : 0.393, class : 0.355, t_rotation : 0.303, entropy : 0.493 - acc jigsaw : 87.50, class : 68.75 [bs:128]
Accuracies on val: jigsaw : 97.77, class : 91.22
--------------------------------------------------------
Accuracies on test: jigsaw : 99.15, class : 78.75
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 6
New epoch - lr: 0.001
0/53 of epoch 7/30 jigsaw : 0.428, class : 0.175, t_rotation : 0.370, entropy : 0.529 - acc jigsaw : 80.47, class : 82.03 [bs:128]
30/53 of epoch 7/30 jigsaw : 0.396, class : 0.241, t_rotation : 0.280, entropy : 0.565 - acc jigsaw : 82.03, class : 75.78 [bs:128]
Accuracies on val: jigsaw : 96.85, class : 91.35
--------------------------------------------------------
Accuracies on test: jigsaw : 98.59, class : 79.78
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 7
New epoch - lr: 0.001
0/53 of epoch 8/30 jigsaw : 0.257, class : 0.113, t_rotation : 0.317, entropy : 0.584 - acc jigsaw : 92.19, class : 84.38 [bs:128]
30/53 of epoch 8/30 jigsaw : 0.262, class : 0.289, t_rotation : 0.233, entropy : 0.424 - acc jigsaw : 89.84, class : 71.88 [bs:128]
Accuracies on val: jigsaw : 95.81, class : 92.01
--------------------------------------------------------
Accuracies on test: jigsaw : 97.91, class : 79.56
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 8
New epoch - lr: 0.001
0/53 of epoch 9/30 jigsaw : 0.361, class : 0.248, t_rotation : 0.219, entropy : 0.413 - acc jigsaw : 83.59, class : 75.00 [bs:128]
30/53 of epoch 9/30 jigsaw : 0.284, class : 0.180, t_rotation : 0.181, entropy : 0.434 - acc jigsaw : 89.06, class : 84.38 [bs:128]
Accuracies on val: jigsaw : 97.38, class : 92.27
--------------------------------------------------------
Accuracies on test: jigsaw : 99.23, class : 80.16
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 9
New epoch - lr: 0.001
0/53 of epoch 10/30 jigsaw : 0.315, class : 0.076, t_rotation : 0.220, entropy : 0.337 - acc jigsaw : 89.84, class : 85.16 [bs:128]
30/53 of epoch 10/30 jigsaw : 0.183, class : 0.164, t_rotation : 0.140, entropy : 0.357 - acc jigsaw : 96.09, class : 72.66 [bs:128]
Accuracies on val: jigsaw : 97.25, class : 92.14
--------------------------------------------------------
Accuracies on test: jigsaw : 98.93, class : 81.40
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 10
New epoch - lr: 0.001
0/53 of epoch 11/30 jigsaw : 0.182, class : 0.127, t_rotation : 0.232, entropy : 0.298 - acc jigsaw : 95.31, class : 75.78 [bs:128]
30/53 of epoch 11/30 jigsaw : 0.302, class : 0.098, t_rotation : 0.186, entropy : 0.283 - acc jigsaw : 89.06, class : 83.59 [bs:128]
Accuracies on val: jigsaw : 96.99, class : 93.05
--------------------------------------------------------
Accuracies on test: jigsaw : 98.59, class : 79.86
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 11
New epoch - lr: 0.001
0/53 of epoch 12/30 jigsaw : 0.337, class : 0.136, t_rotation : 0.163, entropy : 0.346 - acc jigsaw : 86.72, class : 79.69 [bs:128]
30/53 of epoch 12/30 jigsaw : 0.275, class : 0.179, t_rotation : 0.145, entropy : 0.408 - acc jigsaw : 91.41, class : 84.38 [bs:128]
Accuracies on val: jigsaw : 96.59, class : 93.05
--------------------------------------------------------
Accuracies on test: jigsaw : 99.23, class : 80.84
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 12
New epoch - lr: 0.001
0/53 of epoch 13/30 jigsaw : 0.311, class : 0.076, t_rotation : 0.112, entropy : 0.325 - acc jigsaw : 88.28, class : 71.88 [bs:128]
30/53 of epoch 13/30 jigsaw : 0.237, class : 0.110, t_rotation : 0.155, entropy : 0.330 - acc jigsaw : 92.19, class : 75.78 [bs:128]
Accuracies on val: jigsaw : 97.25, class : 93.18
--------------------------------------------------------
Accuracies on test: jigsaw : 99.53, class : 81.70
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 13
New epoch - lr: 0.001
0/53 of epoch 14/30 jigsaw : 0.249, class : 0.155, t_rotation : 0.169, entropy : 0.310 - acc jigsaw : 91.41, class : 82.03 [bs:128]
30/53 of epoch 14/30 jigsaw : 0.301, class : 0.063, t_rotation : 0.102, entropy : 0.307 - acc jigsaw : 87.50, class : 83.59 [bs:128]
Accuracies on val: jigsaw : 96.85, class : 92.92
--------------------------------------------------------
Accuracies on test: jigsaw : 99.06, class : 81.02
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 14
New epoch - lr: 0.001
0/53 of epoch 15/30 jigsaw : 0.334, class : 0.106, t_rotation : 0.218, entropy : 0.325 - acc jigsaw : 86.72, class : 75.00 [bs:128]
30/53 of epoch 15/30 jigsaw : 0.262, class : 0.119, t_rotation : 0.101, entropy : 0.256 - acc jigsaw : 93.75, class : 69.53 [bs:128]
Accuracies on val: jigsaw : 96.85, class : 94.23
--------------------------------------------------------
Accuracies on test: jigsaw : 99.15, class : 81.95
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 15
New epoch - lr: 0.001
0/53 of epoch 16/30 jigsaw : 0.161, class : 0.104, t_rotation : 0.207, entropy : 0.273 - acc jigsaw : 94.53, class : 82.03 [bs:128]
30/53 of epoch 16/30 jigsaw : 0.258, class : 0.104, t_rotation : 0.095, entropy : 0.306 - acc jigsaw : 89.84, class : 81.25 [bs:128]
Accuracies on val: jigsaw : 97.12, class : 93.45
--------------------------------------------------------
Accuracies on test: jigsaw : 99.53, class : 80.93
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 16
New epoch - lr: 0.001
0/53 of epoch 17/30 jigsaw : 0.231, class : 0.078, t_rotation : 0.151, entropy : 0.259 - acc jigsaw : 90.62, class : 78.12 [bs:128]
30/53 of epoch 17/30 jigsaw : 0.304, class : 0.040, t_rotation : 0.103, entropy : 0.248 - acc jigsaw : 91.41, class : 87.50 [bs:128]
Accuracies on val: jigsaw : 95.94, class : 92.79
--------------------------------------------------------
Accuracies on test: jigsaw : 99.36, class : 81.87
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 17
New epoch - lr: 0.001
0/53 of epoch 18/30 jigsaw : 0.225, class : 0.134, t_rotation : 0.109, entropy : 0.270 - acc jigsaw : 91.41, class : 73.44 [bs:128]
30/53 of epoch 18/30 jigsaw : 0.181, class : 0.038, t_rotation : 0.136, entropy : 0.201 - acc jigsaw : 94.53, class : 78.91 [bs:128]
Accuracies on val: jigsaw : 96.72, class : 93.58
--------------------------------------------------------
Accuracies on test: jigsaw : 99.23, class : 81.66
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 18
New epoch - lr: 0.001
0/53 of epoch 19/30 jigsaw : 0.133, class : 0.077, t_rotation : 0.162, entropy : 0.269 - acc jigsaw : 95.31, class : 77.34 [bs:128]
30/53 of epoch 19/30 jigsaw : 0.199, class : 0.085, t_rotation : 0.110, entropy : 0.314 - acc jigsaw : 94.53, class : 85.94 [bs:128]
Accuracies on val: jigsaw : 97.90, class : 93.71
--------------------------------------------------------
Accuracies on test: jigsaw : 99.45, class : 81.87
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 19
New epoch - lr: 0.001
0/53 of epoch 20/30 jigsaw : 0.142, class : 0.046, t_rotation : 0.149, entropy : 0.231 - acc jigsaw : 96.09, class : 77.34 [bs:128]
30/53 of epoch 20/30 jigsaw : 0.266, class : 0.150, t_rotation : 0.117, entropy : 0.170 - acc jigsaw : 90.62, class : 80.47 [bs:128]
Accuracies on val: jigsaw : 97.51, class : 93.05
--------------------------------------------------------
Accuracies on test: jigsaw : 99.66, class : 82.55
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 20
New epoch - lr: 0.001
0/53 of epoch 21/30 jigsaw : 0.179, class : 0.072, t_rotation : 0.096, entropy : 0.268 - acc jigsaw : 93.75, class : 80.47 [bs:128]
30/53 of epoch 21/30 jigsaw : 0.165, class : 0.056, t_rotation : 0.088, entropy : 0.190 - acc jigsaw : 93.75, class : 81.25 [bs:128]
Accuracies on val: jigsaw : 96.99, class : 93.18
--------------------------------------------------------
Accuracies on test: jigsaw : 99.45, class : 82.42
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 21
New epoch - lr: 0.001
0/53 of epoch 22/30 jigsaw : 0.193, class : 0.066, t_rotation : 0.078, entropy : 0.244 - acc jigsaw : 91.41, class : 78.91 [bs:128]
30/53 of epoch 22/30 jigsaw : 0.152, class : 0.061, t_rotation : 0.123, entropy : 0.258 - acc jigsaw : 93.75, class : 84.38 [bs:128]
Accuracies on val: jigsaw : 96.46, class : 93.32
--------------------------------------------------------
Accuracies on test: jigsaw : 99.40, class : 82.51
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 22
New epoch - lr: 0.001
0/53 of epoch 23/30 jigsaw : 0.344, class : 0.094, t_rotation : 0.120, entropy : 0.219 - acc jigsaw : 85.16, class : 77.34 [bs:128]
30/53 of epoch 23/30 jigsaw : 0.259, class : 0.056, t_rotation : 0.076, entropy : 0.244 - acc jigsaw : 91.41, class : 80.47 [bs:128]
Accuracies on val: jigsaw : 96.59, class : 93.32
--------------------------------------------------------
Accuracies on test: jigsaw : 99.66, class : 82.25
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 23
New epoch - lr: 0.0001
0/53 of epoch 24/30 jigsaw : 0.383, class : 0.073, t_rotation : 0.109, entropy : 0.214 - acc jigsaw : 86.72, class : 79.69 [bs:128]
30/53 of epoch 24/30 jigsaw : 0.154, class : 0.031, t_rotation : 0.121, entropy : 0.252 - acc jigsaw : 95.31, class : 79.69 [bs:128]
Accuracies on val: jigsaw : 96.99, class : 93.05
--------------------------------------------------------
Accuracies on test: jigsaw : 99.66, class : 82.38
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 24
New epoch - lr: 0.0001
0/53 of epoch 25/30 jigsaw : 0.140, class : 0.020, t_rotation : 0.091, entropy : 0.162 - acc jigsaw : 96.88, class : 80.47 [bs:128]
30/53 of epoch 25/30 jigsaw : 0.135, class : 0.011, t_rotation : 0.098, entropy : 0.231 - acc jigsaw : 96.09, class : 83.59 [bs:128]
Accuracies on val: jigsaw : 96.72, class : 93.32
--------------------------------------------------------
Accuracies on test: jigsaw : 99.66, class : 82.64
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 25
New epoch - lr: 0.0001
0/53 of epoch 26/30 jigsaw : 0.168, class : 0.036, t_rotation : 0.110, entropy : 0.213 - acc jigsaw : 93.75, class : 79.69 [bs:128]
30/53 of epoch 26/30 jigsaw : 0.172, class : 0.042, t_rotation : 0.118, entropy : 0.154 - acc jigsaw : 93.75, class : 82.03 [bs:128]
Accuracies on val: jigsaw : 97.12, class : 93.32
--------------------------------------------------------
Accuracies on test: jigsaw : 99.70, class : 82.68
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 26
New epoch - lr: 0.0001
0/53 of epoch 27/30 jigsaw : 0.210, class : 0.019, t_rotation : 0.129, entropy : 0.203 - acc jigsaw : 94.53, class : 82.81 [bs:128]
30/53 of epoch 27/30 jigsaw : 0.225, class : 0.085, t_rotation : 0.077, entropy : 0.256 - acc jigsaw : 92.19, class : 78.91 [bs:128]
Accuracies on val: jigsaw : 96.85, class : 93.05
--------------------------------------------------------
Accuracies on test: jigsaw : 99.70, class : 82.34
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 27
New epoch - lr: 0.0001
0/53 of epoch 28/30 jigsaw : 0.158, class : 0.036, t_rotation : 0.096, entropy : 0.223 - acc jigsaw : 94.53, class : 83.59 [bs:128]
30/53 of epoch 28/30 jigsaw : 0.151, class : 0.027, t_rotation : 0.066, entropy : 0.155 - acc jigsaw : 93.75, class : 82.03 [bs:128]
Accuracies on val: jigsaw : 97.12, class : 93.05
--------------------------------------------------------
Accuracies on test: jigsaw : 99.74, class : 82.85
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 28
New epoch - lr: 0.0001
0/53 of epoch 29/30 jigsaw : 0.276, class : 0.076, t_rotation : 0.105, entropy : 0.206 - acc jigsaw : 87.50, class : 89.06 [bs:128]
30/53 of epoch 29/30 jigsaw : 0.223, class : 0.050, t_rotation : 0.109, entropy : 0.138 - acc jigsaw : 92.19, class : 80.47 [bs:128]
Accuracies on val: jigsaw : 97.12, class : 93.45
--------------------------------------------------------
Accuracies on test: jigsaw : 99.70, class : 83.02
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 29
New epoch - lr: 0.0001
0/53 of epoch 30/30 jigsaw : 0.154, class : 0.021, t_rotation : 0.115, entropy : 0.187 - acc jigsaw : 93.75, class : 84.38 [bs:128]
30/53 of epoch 30/30 jigsaw : 0.200, class : 0.040, t_rotation : 0.140, entropy : 0.149 - acc jigsaw : 92.97, class : 83.59 [bs:128]
Accuracies on val: jigsaw : 96.72, class : 93.18
--------------------------------------------------------
Accuracies on test: jigsaw : 99.70, class : 82.72
--------------------------------------------------------
2019-12-16 09:56:49
cartoon
['photo', 'sketch', 'art_painting']
unsupervised_task_weight: 0.8
bias_hole_image: 0.5
target_rotation_weight: 0.8
entropy_weight 0.1
only_classify the ordered image: True
Highest accuracy on validation set appears on epoch  tensor(14)
Highest accuracy on test set appears on epoch  tensor(28)
Accuracy on test set when the accuracy on validation set is highest:0.820
Highest accuracy on test set:0.830
It took 1282.44
--------------------------------------------------------
******************Start training**************************************
--------------------------------------------------------
Dataset size: training 5457, validation 605, testing 3929
--------------------------------------------------------
Namespace(TTA=False, batch_size=128, bias_whole_image=0.5, classify_only_ordered_images_or_not=True, domains_list=['photo', 'sketch', 'cartoon', 'art_painting'], entropy_loss_weight=0.1, epochs=30, folder_name='test', image_size=222, jitter=0.4, learning_rate=0.001, limit_source=None, limit_target=None, max_scale=1.0, min_scale=0.8, n_classes=7, nesterov=False, network='resnet18', ooo_weight=0, parameters_lists=[[0.8, 0.3, 0.8, 0.1], [0.8, 0.5, 0.8, 0.1], [0.8, 0.6, 0.8, 0.1]], random_horiz_flip=0.5, repeat_times=3, source=['photo', 'cartoon', 'art_painting'], suffix='', target='sketch', target_domain_list=['art_painting', 'cartoon', 'sketch', 'photo'], target_domain_unsupervised_task_loss_weight=0.8, tf_logger=True, tile_random_grayscale=0.1, train_all=True, unsupervised_task_weight=0.8, val_size=0.1)
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 0
New epoch - lr: 0.001
0/42 of epoch 1/30 jigsaw : 1.827, class : 1.990, t_rotation : 1.877, entropy : 1.864 - acc jigsaw : 16.41, class : 17.19 [bs:128]
30/42 of epoch 1/30 jigsaw : 0.937, class : 1.054, t_rotation : 0.710, entropy : 1.795 - acc jigsaw : 62.50, class : 59.38 [bs:128]
Accuracies on val: jigsaw : 96.69, class : 64.63
--------------------------------------------------------
Accuracies on test: jigsaw : 97.07, class : 37.19
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 1
New epoch - lr: 0.001
0/42 of epoch 2/30 jigsaw : 0.790, class : 0.867, t_rotation : 0.553, entropy : 1.707 - acc jigsaw : 71.88, class : 71.09 [bs:128]
30/42 of epoch 2/30 jigsaw : 0.733, class : 0.574, t_rotation : 0.441, entropy : 1.430 - acc jigsaw : 67.97, class : 77.34 [bs:128]
Accuracies on val: jigsaw : 95.37, class : 80.00
--------------------------------------------------------
Accuracies on test: jigsaw : 96.33, class : 60.07
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 2
New epoch - lr: 0.001
0/42 of epoch 3/30 jigsaw : 0.661, class : 0.491, t_rotation : 0.488, entropy : 1.165 - acc jigsaw : 74.22, class : 78.12 [bs:128]
30/42 of epoch 3/30 jigsaw : 0.702, class : 0.524, t_rotation : 0.461, entropy : 0.956 - acc jigsaw : 71.09, class : 73.44 [bs:128]
Accuracies on val: jigsaw : 96.20, class : 86.28
--------------------------------------------------------
Accuracies on test: jigsaw : 97.38, class : 68.39
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 3
New epoch - lr: 0.001
0/42 of epoch 4/30 jigsaw : 0.549, class : 0.395, t_rotation : 0.379, entropy : 1.030 - acc jigsaw : 77.34, class : 75.00 [bs:128]
30/42 of epoch 4/30 jigsaw : 0.571, class : 0.328, t_rotation : 0.331, entropy : 0.911 - acc jigsaw : 76.56, class : 81.25 [bs:128]
Accuracies on val: jigsaw : 95.87, class : 86.45
--------------------------------------------------------
Accuracies on test: jigsaw : 96.36, class : 73.33
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 4
New epoch - lr: 0.001
0/42 of epoch 5/30 jigsaw : 0.555, class : 0.186, t_rotation : 0.366, entropy : 0.776 - acc jigsaw : 77.34, class : 84.38 [bs:128]
30/42 of epoch 5/30 jigsaw : 0.516, class : 0.151, t_rotation : 0.336, entropy : 0.689 - acc jigsaw : 83.59, class : 77.34 [bs:128]
Accuracies on val: jigsaw : 96.53, class : 87.44
--------------------------------------------------------
Accuracies on test: jigsaw : 96.59, class : 76.33
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 5
New epoch - lr: 0.001
0/42 of epoch 6/30 jigsaw : 0.436, class : 0.290, t_rotation : 0.346, entropy : 0.656 - acc jigsaw : 85.94, class : 82.03 [bs:128]
30/42 of epoch 6/30 jigsaw : 0.442, class : 0.322, t_rotation : 0.341, entropy : 0.581 - acc jigsaw : 85.94, class : 77.34 [bs:128]
Accuracies on val: jigsaw : 95.21, class : 88.26
--------------------------------------------------------
Accuracies on test: jigsaw : 96.21, class : 77.91
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 6
New epoch - lr: 0.001
0/42 of epoch 7/30 jigsaw : 0.359, class : 0.265, t_rotation : 0.295, entropy : 0.570 - acc jigsaw : 87.50, class : 76.56 [bs:128]
30/42 of epoch 7/30 jigsaw : 0.486, class : 0.215, t_rotation : 0.246, entropy : 0.539 - acc jigsaw : 77.34, class : 80.47 [bs:128]
Accuracies on val: jigsaw : 96.03, class : 88.60
--------------------------------------------------------
Accuracies on test: jigsaw : 97.40, class : 77.65
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 7
New epoch - lr: 0.001
0/42 of epoch 8/30 jigsaw : 0.386, class : 0.143, t_rotation : 0.282, entropy : 0.581 - acc jigsaw : 87.50, class : 79.69 [bs:128]
30/42 of epoch 8/30 jigsaw : 0.444, class : 0.151, t_rotation : 0.260, entropy : 0.516 - acc jigsaw : 82.03, class : 78.91 [bs:128]
Accuracies on val: jigsaw : 96.20, class : 90.58
--------------------------------------------------------
Accuracies on test: jigsaw : 96.69, class : 79.49
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 8
New epoch - lr: 0.001
0/42 of epoch 9/30 jigsaw : 0.439, class : 0.142, t_rotation : 0.300, entropy : 0.510 - acc jigsaw : 84.38, class : 81.25 [bs:128]
30/42 of epoch 9/30 jigsaw : 0.343, class : 0.207, t_rotation : 0.269, entropy : 0.469 - acc jigsaw : 88.28, class : 84.38 [bs:128]
Accuracies on val: jigsaw : 96.53, class : 91.07
--------------------------------------------------------
Accuracies on test: jigsaw : 97.91, class : 77.91
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 9
New epoch - lr: 0.001
0/42 of epoch 10/30 jigsaw : 0.292, class : 0.090, t_rotation : 0.249, entropy : 0.398 - acc jigsaw : 89.06, class : 78.91 [bs:128]
30/42 of epoch 10/30 jigsaw : 0.395, class : 0.101, t_rotation : 0.192, entropy : 0.378 - acc jigsaw : 83.59, class : 77.34 [bs:128]
Accuracies on val: jigsaw : 95.87, class : 90.58
--------------------------------------------------------
Accuracies on test: jigsaw : 97.61, class : 78.90
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 10
New epoch - lr: 0.001
0/42 of epoch 11/30 jigsaw : 0.308, class : 0.088, t_rotation : 0.230, entropy : 0.446 - acc jigsaw : 86.72, class : 87.50 [bs:128]
30/42 of epoch 11/30 jigsaw : 0.352, class : 0.117, t_rotation : 0.189, entropy : 0.395 - acc jigsaw : 87.50, class : 82.81 [bs:128]
Accuracies on val: jigsaw : 96.86, class : 91.57
--------------------------------------------------------
Accuracies on test: jigsaw : 98.32, class : 78.93
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 11
New epoch - lr: 0.001
0/42 of epoch 12/30 jigsaw : 0.342, class : 0.191, t_rotation : 0.145, entropy : 0.354 - acc jigsaw : 86.72, class : 78.91 [bs:128]
30/42 of epoch 12/30 jigsaw : 0.227, class : 0.171, t_rotation : 0.129, entropy : 0.321 - acc jigsaw : 94.53, class : 83.59 [bs:128]
Accuracies on val: jigsaw : 96.03, class : 91.74
--------------------------------------------------------
Accuracies on test: jigsaw : 96.79, class : 79.13
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 12
New epoch - lr: 0.001
0/42 of epoch 13/30 jigsaw : 0.381, class : 0.098, t_rotation : 0.184, entropy : 0.310 - acc jigsaw : 85.16, class : 80.47 [bs:128]
30/42 of epoch 13/30 jigsaw : 0.390, class : 0.082, t_rotation : 0.160, entropy : 0.298 - acc jigsaw : 82.81, class : 82.81 [bs:128]
Accuracies on val: jigsaw : 96.36, class : 91.90
--------------------------------------------------------
Accuracies on test: jigsaw : 97.81, class : 79.16
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 13
New epoch - lr: 0.001
0/42 of epoch 14/30 jigsaw : 0.244, class : 0.123, t_rotation : 0.278, entropy : 0.301 - acc jigsaw : 92.19, class : 80.47 [bs:128]
30/42 of epoch 14/30 jigsaw : 0.268, class : 0.123, t_rotation : 0.234, entropy : 0.286 - acc jigsaw : 91.41, class : 78.91 [bs:128]
Accuracies on val: jigsaw : 96.20, class : 92.73
--------------------------------------------------------
Accuracies on test: jigsaw : 97.40, class : 81.14
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 14
New epoch - lr: 0.001
0/42 of epoch 15/30 jigsaw : 0.288, class : 0.117, t_rotation : 0.213, entropy : 0.338 - acc jigsaw : 89.84, class : 79.69 [bs:128]
30/42 of epoch 15/30 jigsaw : 0.259, class : 0.140, t_rotation : 0.185, entropy : 0.334 - acc jigsaw : 92.19, class : 80.47 [bs:128]
Accuracies on val: jigsaw : 95.87, class : 90.58
--------------------------------------------------------
Accuracies on test: jigsaw : 96.79, class : 82.23
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 15
New epoch - lr: 0.001
0/42 of epoch 16/30 jigsaw : 0.206, class : 0.117, t_rotation : 0.151, entropy : 0.243 - acc jigsaw : 95.31, class : 84.38 [bs:128]
30/42 of epoch 16/30 jigsaw : 0.221, class : 0.061, t_rotation : 0.122, entropy : 0.224 - acc jigsaw : 92.19, class : 85.16 [bs:128]
Accuracies on val: jigsaw : 96.36, class : 91.57
--------------------------------------------------------
Accuracies on test: jigsaw : 98.35, class : 81.45
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 16
New epoch - lr: 0.001
0/42 of epoch 17/30 jigsaw : 0.268, class : 0.055, t_rotation : 0.089, entropy : 0.248 - acc jigsaw : 90.62, class : 78.12 [bs:128]
30/42 of epoch 17/30 jigsaw : 0.238, class : 0.082, t_rotation : 0.084, entropy : 0.231 - acc jigsaw : 92.19, class : 81.25 [bs:128]
Accuracies on val: jigsaw : 96.53, class : 92.73
--------------------------------------------------------
Accuracies on test: jigsaw : 98.63, class : 80.91
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 17
New epoch - lr: 0.001
0/42 of epoch 18/30 jigsaw : 0.251, class : 0.061, t_rotation : 0.117, entropy : 0.285 - acc jigsaw : 89.84, class : 80.47 [bs:128]
30/42 of epoch 18/30 jigsaw : 0.257, class : 0.103, t_rotation : 0.100, entropy : 0.267 - acc jigsaw : 91.41, class : 85.94 [bs:128]
Accuracies on val: jigsaw : 97.36, class : 92.73
--------------------------------------------------------
Accuracies on test: jigsaw : 98.27, class : 81.55
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 18
New epoch - lr: 0.001
0/42 of epoch 19/30 jigsaw : 0.219, class : 0.078, t_rotation : 0.136, entropy : 0.249 - acc jigsaw : 89.06, class : 80.47 [bs:128]
30/42 of epoch 19/30 jigsaw : 0.189, class : 0.079, t_rotation : 0.130, entropy : 0.235 - acc jigsaw : 93.75, class : 85.94 [bs:128]
Accuracies on val: jigsaw : 95.37, class : 94.38
--------------------------------------------------------
Accuracies on test: jigsaw : 98.37, class : 80.35
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 19
New epoch - lr: 0.001
0/42 of epoch 20/30 jigsaw : 0.205, class : 0.064, t_rotation : 0.155, entropy : 0.219 - acc jigsaw : 93.75, class : 89.06 [bs:128]
30/42 of epoch 20/30 jigsaw : 0.226, class : 0.094, t_rotation : 0.139, entropy : 0.234 - acc jigsaw : 91.41, class : 82.03 [bs:128]
Accuracies on val: jigsaw : 97.02, class : 93.88
--------------------------------------------------------
Accuracies on test: jigsaw : 98.65, class : 81.32
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 20
New epoch - lr: 0.001
0/42 of epoch 21/30 jigsaw : 0.137, class : 0.034, t_rotation : 0.103, entropy : 0.284 - acc jigsaw : 96.09, class : 83.59 [bs:128]
30/42 of epoch 21/30 jigsaw : 0.288, class : 0.045, t_rotation : 0.087, entropy : 0.259 - acc jigsaw : 88.28, class : 79.69 [bs:128]
Accuracies on val: jigsaw : 96.86, class : 93.88
--------------------------------------------------------
Accuracies on test: jigsaw : 99.24, class : 81.73
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 21
New epoch - lr: 0.001
0/42 of epoch 22/30 jigsaw : 0.178, class : 0.064, t_rotation : 0.073, entropy : 0.202 - acc jigsaw : 92.19, class : 83.59 [bs:128]
30/42 of epoch 22/30 jigsaw : 0.297, class : 0.028, t_rotation : 0.060, entropy : 0.195 - acc jigsaw : 91.41, class : 85.94 [bs:128]
Accuracies on val: jigsaw : 96.86, class : 94.71
--------------------------------------------------------
Accuracies on test: jigsaw : 98.93, class : 83.30
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 22
New epoch - lr: 0.001
0/42 of epoch 23/30 jigsaw : 0.239, class : 0.058, t_rotation : 0.203, entropy : 0.186 - acc jigsaw : 91.41, class : 83.59 [bs:128]
30/42 of epoch 23/30 jigsaw : 0.263, class : 0.084, t_rotation : 0.173, entropy : 0.177 - acc jigsaw : 89.84, class : 84.38 [bs:128]
Accuracies on val: jigsaw : 93.06, class : 93.72
--------------------------------------------------------
Accuracies on test: jigsaw : 97.71, class : 82.06
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 23
New epoch - lr: 0.0001
0/42 of epoch 24/30 jigsaw : 0.165, class : 0.042, t_rotation : 0.113, entropy : 0.203 - acc jigsaw : 93.75, class : 83.59 [bs:128]
30/42 of epoch 24/30 jigsaw : 0.258, class : 0.033, t_rotation : 0.108, entropy : 0.201 - acc jigsaw : 92.97, class : 85.16 [bs:128]
Accuracies on val: jigsaw : 95.21, class : 94.05
--------------------------------------------------------
Accuracies on test: jigsaw : 98.35, class : 82.06
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 24
New epoch - lr: 0.0001
0/42 of epoch 25/30 jigsaw : 0.288, class : 0.055, t_rotation : 0.135, entropy : 0.234 - acc jigsaw : 90.62, class : 81.25 [bs:128]
30/42 of epoch 25/30 jigsaw : 0.304, class : 0.024, t_rotation : 0.130, entropy : 0.231 - acc jigsaw : 86.72, class : 85.94 [bs:128]
Accuracies on val: jigsaw : 95.87, class : 93.88
--------------------------------------------------------
Accuracies on test: jigsaw : 98.42, class : 82.49
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 25
New epoch - lr: 0.0001
0/42 of epoch 26/30 jigsaw : 0.211, class : 0.054, t_rotation : 0.112, entropy : 0.242 - acc jigsaw : 92.97, class : 82.03 [bs:128]
30/42 of epoch 26/30 jigsaw : 0.169, class : 0.038, t_rotation : 0.109, entropy : 0.240 - acc jigsaw : 96.88, class : 84.38 [bs:128]
Accuracies on val: jigsaw : 96.20, class : 94.05
--------------------------------------------------------
Accuracies on test: jigsaw : 98.50, class : 82.46
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 26
New epoch - lr: 0.0001
0/42 of epoch 27/30 jigsaw : 0.253, class : 0.072, t_rotation : 0.146, entropy : 0.195 - acc jigsaw : 93.75, class : 78.12 [bs:128]
30/42 of epoch 27/30 jigsaw : 0.305, class : 0.052, t_rotation : 0.141, entropy : 0.192 - acc jigsaw : 88.28, class : 86.72 [bs:128]
Accuracies on val: jigsaw : 95.87, class : 94.05
--------------------------------------------------------
Accuracies on test: jigsaw : 98.50, class : 82.64
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 27
New epoch - lr: 0.0001
0/42 of epoch 28/30 jigsaw : 0.140, class : 0.033, t_rotation : 0.105, entropy : 0.179 - acc jigsaw : 94.53, class : 87.50 [bs:128]
30/42 of epoch 28/30 jigsaw : 0.187, class : 0.056, t_rotation : 0.102, entropy : 0.177 - acc jigsaw : 94.53, class : 79.69 [bs:128]
Accuracies on val: jigsaw : 95.70, class : 94.05
--------------------------------------------------------
Accuracies on test: jigsaw : 98.68, class : 82.41
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 28
New epoch - lr: 0.0001
0/42 of epoch 29/30 jigsaw : 0.166, class : 0.083, t_rotation : 0.152, entropy : 0.226 - acc jigsaw : 93.75, class : 78.12 [bs:128]
30/42 of epoch 29/30 jigsaw : 0.296, class : 0.067, t_rotation : 0.147, entropy : 0.225 - acc jigsaw : 88.28, class : 87.50 [bs:128]
Accuracies on val: jigsaw : 96.20, class : 94.38
--------------------------------------------------------
Accuracies on test: jigsaw : 98.98, class : 82.21
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 29
New epoch - lr: 0.0001
0/42 of epoch 30/30 jigsaw : 0.201, class : 0.090, t_rotation : 0.091, entropy : 0.164 - acc jigsaw : 93.75, class : 80.47 [bs:128]
30/42 of epoch 30/30 jigsaw : 0.209, class : 0.073, t_rotation : 0.089, entropy : 0.161 - acc jigsaw : 92.19, class : 79.69 [bs:128]
Accuracies on val: jigsaw : 96.36, class : 94.38
--------------------------------------------------------
Accuracies on test: jigsaw : 98.80, class : 82.49
--------------------------------------------------------
2019-12-16 10:15:03
sketch
['photo', 'cartoon', 'art_painting']
unsupervised_task_weight: 0.8
bias_hole_image: 0.5
target_rotation_weight: 0.8
entropy_weight 0.1
only_classify the ordered image: True
Highest accuracy on validation set appears on epoch  tensor(21)
Highest accuracy on test set appears on epoch  tensor(21)
Accuracy on test set when the accuracy on validation set is highest:0.833
Highest accuracy on test set:0.833
It took 1094.16
--------------------------------------------------------
******************Start training**************************************
--------------------------------------------------------
Dataset size: training 5457, validation 605, testing 3929
--------------------------------------------------------
Namespace(TTA=False, batch_size=128, bias_whole_image=0.5, classify_only_ordered_images_or_not=True, domains_list=['photo', 'sketch', 'cartoon', 'art_painting'], entropy_loss_weight=0.1, epochs=30, folder_name='test', image_size=222, jitter=0.4, learning_rate=0.001, limit_source=None, limit_target=None, max_scale=1.0, min_scale=0.8, n_classes=7, nesterov=False, network='resnet18', ooo_weight=0, parameters_lists=[[0.8, 0.3, 0.8, 0.1], [0.8, 0.5, 0.8, 0.1], [0.8, 0.6, 0.8, 0.1]], random_horiz_flip=0.5, repeat_times=3, source=['photo', 'cartoon', 'art_painting'], suffix='', target='sketch', target_domain_list=['art_painting', 'cartoon', 'sketch', 'photo'], target_domain_unsupervised_task_loss_weight=0.8, tf_logger=True, tile_random_grayscale=0.1, train_all=True, unsupervised_task_weight=0.8, val_size=0.1)
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 0
New epoch - lr: 0.001
0/42 of epoch 1/30 jigsaw : 1.297, class : 2.071, t_rotation : 1.344, entropy : 1.779 - acc jigsaw : 41.41, class : 14.84 [bs:128]
30/42 of epoch 1/30 jigsaw : 1.046, class : 1.251, t_rotation : 0.762, entropy : 1.713 - acc jigsaw : 57.03, class : 55.47 [bs:128]
Accuracies on val: jigsaw : 99.01, class : 73.39
--------------------------------------------------------
Accuracies on test: jigsaw : 99.80, class : 54.24
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 1
New epoch - lr: 0.001
0/42 of epoch 2/30 jigsaw : 0.830, class : 0.795, t_rotation : 0.902, entropy : 1.699 - acc jigsaw : 66.41, class : 71.09 [bs:128]
30/42 of epoch 2/30 jigsaw : 0.822, class : 0.545, t_rotation : 0.750, entropy : 1.404 - acc jigsaw : 66.41, class : 75.78 [bs:128]
Accuracies on val: jigsaw : 98.35, class : 84.63
--------------------------------------------------------
Accuracies on test: jigsaw : 99.39, class : 62.79
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 2
New epoch - lr: 0.001
0/42 of epoch 3/30 jigsaw : 0.646, class : 0.532, t_rotation : 0.504, entropy : 1.318 - acc jigsaw : 75.78, class : 81.25 [bs:128]
30/42 of epoch 3/30 jigsaw : 0.643, class : 0.297, t_rotation : 0.415, entropy : 1.061 - acc jigsaw : 74.22, class : 82.03 [bs:128]
Accuracies on val: jigsaw : 96.53, class : 86.78
--------------------------------------------------------
Accuracies on test: jigsaw : 98.45, class : 67.60
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 3
New epoch - lr: 0.001
0/42 of epoch 4/30 jigsaw : 0.726, class : 0.499, t_rotation : 0.505, entropy : 1.002 - acc jigsaw : 70.31, class : 74.22 [bs:128]
30/42 of epoch 4/30 jigsaw : 0.564, class : 0.264, t_rotation : 0.419, entropy : 0.828 - acc jigsaw : 75.00, class : 80.47 [bs:128]
Accuracies on val: jigsaw : 96.20, class : 89.09
--------------------------------------------------------
Accuracies on test: jigsaw : 98.93, class : 72.28
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 4
New epoch - lr: 0.001
0/42 of epoch 5/30 jigsaw : 0.535, class : 0.273, t_rotation : 0.366, entropy : 0.759 - acc jigsaw : 78.12, class : 80.47 [bs:128]
30/42 of epoch 5/30 jigsaw : 0.456, class : 0.293, t_rotation : 0.312, entropy : 0.663 - acc jigsaw : 81.25, class : 79.69 [bs:128]
Accuracies on val: jigsaw : 94.88, class : 90.74
--------------------------------------------------------
Accuracies on test: jigsaw : 98.35, class : 73.73
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 5
New epoch - lr: 0.001
0/42 of epoch 6/30 jigsaw : 0.577, class : 0.192, t_rotation : 0.320, entropy : 0.769 - acc jigsaw : 77.34, class : 85.94 [bs:128]
30/42 of epoch 6/30 jigsaw : 0.474, class : 0.232, t_rotation : 0.298, entropy : 0.686 - acc jigsaw : 82.81, class : 86.72 [bs:128]
Accuracies on val: jigsaw : 96.86, class : 90.91
--------------------------------------------------------
Accuracies on test: jigsaw : 98.83, class : 74.45
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 6
New epoch - lr: 0.001
0/42 of epoch 7/30 jigsaw : 0.516, class : 0.175, t_rotation : 0.325, entropy : 0.586 - acc jigsaw : 78.91, class : 85.94 [bs:128]
30/42 of epoch 7/30 jigsaw : 0.586, class : 0.304, t_rotation : 0.295, entropy : 0.549 - acc jigsaw : 78.91, class : 77.34 [bs:128]
Accuracies on val: jigsaw : 97.36, class : 92.07
--------------------------------------------------------
Accuracies on test: jigsaw : 98.57, class : 75.11
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 7
New epoch - lr: 0.001
0/42 of epoch 8/30 jigsaw : 0.422, class : 0.121, t_rotation : 0.241, entropy : 0.518 - acc jigsaw : 85.16, class : 87.50 [bs:128]
30/42 of epoch 8/30 jigsaw : 0.477, class : 0.236, t_rotation : 0.205, entropy : 0.457 - acc jigsaw : 84.38, class : 76.56 [bs:128]
Accuracies on val: jigsaw : 95.87, class : 91.57
--------------------------------------------------------
Accuracies on test: jigsaw : 99.24, class : 77.65
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 8
New epoch - lr: 0.001
0/42 of epoch 9/30 jigsaw : 0.415, class : 0.145, t_rotation : 0.215, entropy : 0.433 - acc jigsaw : 86.72, class : 80.47 [bs:128]
30/42 of epoch 9/30 jigsaw : 0.335, class : 0.240, t_rotation : 0.194, entropy : 0.402 - acc jigsaw : 87.50, class : 76.56 [bs:128]
Accuracies on val: jigsaw : 96.20, class : 92.40
--------------------------------------------------------
Accuracies on test: jigsaw : 98.96, class : 77.45
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 9
New epoch - lr: 0.001
0/42 of epoch 10/30 jigsaw : 0.374, class : 0.101, t_rotation : 0.204, entropy : 0.342 - acc jigsaw : 83.59, class : 82.81 [bs:128]
30/42 of epoch 10/30 jigsaw : 0.406, class : 0.251, t_rotation : 0.188, entropy : 0.330 - acc jigsaw : 86.72, class : 78.12 [bs:128]
Accuracies on val: jigsaw : 96.20, class : 92.56
--------------------------------------------------------
Accuracies on test: jigsaw : 98.93, class : 76.74
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 10
New epoch - lr: 0.001
0/42 of epoch 11/30 jigsaw : 0.300, class : 0.141, t_rotation : 0.182, entropy : 0.378 - acc jigsaw : 89.06, class : 80.47 [bs:128]
30/42 of epoch 11/30 jigsaw : 0.271, class : 0.158, t_rotation : 0.161, entropy : 0.356 - acc jigsaw : 92.19, class : 82.03 [bs:128]
Accuracies on val: jigsaw : 96.69, class : 93.72
--------------------------------------------------------
Accuracies on test: jigsaw : 99.24, class : 78.04
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 11
New epoch - lr: 0.001
0/42 of epoch 12/30 jigsaw : 0.373, class : 0.169, t_rotation : 0.160, entropy : 0.290 - acc jigsaw : 88.28, class : 85.94 [bs:128]
30/42 of epoch 12/30 jigsaw : 0.289, class : 0.193, t_rotation : 0.139, entropy : 0.289 - acc jigsaw : 91.41, class : 72.66 [bs:128]
Accuracies on val: jigsaw : 97.02, class : 93.72
--------------------------------------------------------
Accuracies on test: jigsaw : 99.11, class : 77.40
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 12
New epoch - lr: 0.001
0/42 of epoch 13/30 jigsaw : 0.266, class : 0.085, t_rotation : 0.189, entropy : 0.357 - acc jigsaw : 89.84, class : 82.03 [bs:128]
30/42 of epoch 13/30 jigsaw : 0.394, class : 0.118, t_rotation : 0.166, entropy : 0.347 - acc jigsaw : 88.28, class : 80.47 [bs:128]
Accuracies on val: jigsaw : 96.53, class : 93.88
--------------------------------------------------------
Accuracies on test: jigsaw : 99.19, class : 78.60
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 13
New epoch - lr: 0.001
0/42 of epoch 14/30 jigsaw : 0.226, class : 0.166, t_rotation : 0.201, entropy : 0.261 - acc jigsaw : 92.19, class : 83.59 [bs:128]
30/42 of epoch 14/30 jigsaw : 0.335, class : 0.095, t_rotation : 0.166, entropy : 0.250 - acc jigsaw : 88.28, class : 87.50 [bs:128]
Accuracies on val: jigsaw : 97.52, class : 93.39
--------------------------------------------------------
Accuracies on test: jigsaw : 99.31, class : 77.98
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 14
New epoch - lr: 0.001
0/42 of epoch 15/30 jigsaw : 0.289, class : 0.102, t_rotation : 0.170, entropy : 0.309 - acc jigsaw : 88.28, class : 84.38 [bs:128]
30/42 of epoch 15/30 jigsaw : 0.304, class : 0.098, t_rotation : 0.163, entropy : 0.278 - acc jigsaw : 89.84, class : 76.56 [bs:128]
Accuracies on val: jigsaw : 98.02, class : 94.38
--------------------------------------------------------
Accuracies on test: jigsaw : 99.49, class : 78.75
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 15
New epoch - lr: 0.001
0/42 of epoch 16/30 jigsaw : 0.340, class : 0.099, t_rotation : 0.129, entropy : 0.266 - acc jigsaw : 88.28, class : 82.03 [bs:128]
30/42 of epoch 16/30 jigsaw : 0.239, class : 0.141, t_rotation : 0.128, entropy : 0.239 - acc jigsaw : 90.62, class : 85.94 [bs:128]
Accuracies on val: jigsaw : 97.69, class : 94.05
--------------------------------------------------------
Accuracies on test: jigsaw : 99.16, class : 80.58
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 16
New epoch - lr: 0.001
0/42 of epoch 17/30 jigsaw : 0.209, class : 0.179, t_rotation : 0.111, entropy : 0.284 - acc jigsaw : 92.19, class : 77.34 [bs:128]
30/42 of epoch 17/30 jigsaw : 0.213, class : 0.150, t_rotation : 0.102, entropy : 0.278 - acc jigsaw : 92.97, class : 86.72 [bs:128]
Accuracies on val: jigsaw : 95.87, class : 93.72
--------------------------------------------------------
Accuracies on test: jigsaw : 99.26, class : 79.69
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 17
New epoch - lr: 0.001
0/42 of epoch 18/30 jigsaw : 0.231, class : 0.049, t_rotation : 0.160, entropy : 0.250 - acc jigsaw : 89.84, class : 82.81 [bs:128]
30/42 of epoch 18/30 jigsaw : 0.266, class : 0.109, t_rotation : 0.136, entropy : 0.239 - acc jigsaw : 90.62, class : 85.16 [bs:128]
Accuracies on val: jigsaw : 96.86, class : 94.21
--------------------------------------------------------
Accuracies on test: jigsaw : 99.39, class : 79.38
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 18
New epoch - lr: 0.001
0/42 of epoch 19/30 jigsaw : 0.250, class : 0.111, t_rotation : 0.143, entropy : 0.278 - acc jigsaw : 92.19, class : 87.50 [bs:128]
30/42 of epoch 19/30 jigsaw : 0.290, class : 0.076, t_rotation : 0.128, entropy : 0.267 - acc jigsaw : 90.62, class : 83.59 [bs:128]
Accuracies on val: jigsaw : 96.20, class : 94.55
--------------------------------------------------------
Accuracies on test: jigsaw : 99.57, class : 80.20
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 19
New epoch - lr: 0.001
0/42 of epoch 20/30 jigsaw : 0.337, class : 0.069, t_rotation : 0.177, entropy : 0.322 - acc jigsaw : 89.84, class : 78.12 [bs:128]
30/42 of epoch 20/30 jigsaw : 0.185, class : 0.081, t_rotation : 0.147, entropy : 0.299 - acc jigsaw : 96.09, class : 85.94 [bs:128]
Accuracies on val: jigsaw : 96.36, class : 94.38
--------------------------------------------------------
Accuracies on test: jigsaw : 99.29, class : 80.07
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 20
New epoch - lr: 0.001
0/42 of epoch 21/30 jigsaw : 0.230, class : 0.093, t_rotation : 0.069, entropy : 0.147 - acc jigsaw : 92.19, class : 79.69 [bs:128]
30/42 of epoch 21/30 jigsaw : 0.324, class : 0.075, t_rotation : 0.071, entropy : 0.132 - acc jigsaw : 87.50, class : 83.59 [bs:128]
Accuracies on val: jigsaw : 96.20, class : 94.05
--------------------------------------------------------
Accuracies on test: jigsaw : 99.62, class : 81.24
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 21
New epoch - lr: 0.001
0/42 of epoch 22/30 jigsaw : 0.324, class : 0.031, t_rotation : 0.204, entropy : 0.216 - acc jigsaw : 86.72, class : 86.72 [bs:128]
30/42 of epoch 22/30 jigsaw : 0.227, class : 0.061, t_rotation : 0.166, entropy : 0.199 - acc jigsaw : 92.19, class : 85.16 [bs:128]
Accuracies on val: jigsaw : 95.21, class : 93.88
--------------------------------------------------------
Accuracies on test: jigsaw : 99.21, class : 81.11
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 22
New epoch - lr: 0.001
0/42 of epoch 23/30 jigsaw : 0.253, class : 0.092, t_rotation : 0.062, entropy : 0.192 - acc jigsaw : 91.41, class : 82.03 [bs:128]
30/42 of epoch 23/30 jigsaw : 0.185, class : 0.062, t_rotation : 0.059, entropy : 0.190 - acc jigsaw : 94.53, class : 83.59 [bs:128]
Accuracies on val: jigsaw : 96.20, class : 94.05
--------------------------------------------------------
Accuracies on test: jigsaw : 99.44, class : 81.27
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 23
New epoch - lr: 0.0001
0/42 of epoch 24/30 jigsaw : 0.185, class : 0.056, t_rotation : 0.176, entropy : 0.187 - acc jigsaw : 92.97, class : 84.38 [bs:128]
30/42 of epoch 24/30 jigsaw : 0.285, class : 0.028, t_rotation : 0.170, entropy : 0.183 - acc jigsaw : 89.06, class : 77.34 [bs:128]
Accuracies on val: jigsaw : 96.03, class : 94.21
--------------------------------------------------------
Accuracies on test: jigsaw : 99.26, class : 81.67
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 24
New epoch - lr: 0.0001
0/42 of epoch 25/30 jigsaw : 0.273, class : 0.104, t_rotation : 0.105, entropy : 0.162 - acc jigsaw : 89.06, class : 76.56 [bs:128]
30/42 of epoch 25/30 jigsaw : 0.158, class : 0.099, t_rotation : 0.101, entropy : 0.160 - acc jigsaw : 96.09, class : 83.59 [bs:128]
Accuracies on val: jigsaw : 96.53, class : 94.21
--------------------------------------------------------
Accuracies on test: jigsaw : 99.36, class : 81.70
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 25
New epoch - lr: 0.0001
0/42 of epoch 26/30 jigsaw : 0.189, class : 0.085, t_rotation : 0.079, entropy : 0.207 - acc jigsaw : 96.09, class : 84.38 [bs:128]
30/42 of epoch 26/30 jigsaw : 0.173, class : 0.148, t_rotation : 0.078, entropy : 0.205 - acc jigsaw : 93.75, class : 80.47 [bs:128]
Accuracies on val: jigsaw : 96.03, class : 94.55
--------------------------------------------------------
Accuracies on test: jigsaw : 99.34, class : 81.42
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 26
New epoch - lr: 0.0001
0/42 of epoch 27/30 jigsaw : 0.316, class : 0.048, t_rotation : 0.096, entropy : 0.196 - acc jigsaw : 89.84, class : 81.25 [bs:128]
30/42 of epoch 27/30 jigsaw : 0.252, class : 0.069, t_rotation : 0.092, entropy : 0.196 - acc jigsaw : 89.06, class : 76.56 [bs:128]
Accuracies on val: jigsaw : 95.87, class : 94.05
--------------------------------------------------------
Accuracies on test: jigsaw : 99.34, class : 81.80
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 27
New epoch - lr: 0.0001
0/42 of epoch 28/30 jigsaw : 0.285, class : 0.097, t_rotation : 0.145, entropy : 0.224 - acc jigsaw : 89.06, class : 82.03 [bs:128]
30/42 of epoch 28/30 jigsaw : 0.178, class : 0.089, t_rotation : 0.139, entropy : 0.225 - acc jigsaw : 93.75, class : 83.59 [bs:128]
Accuracies on val: jigsaw : 96.36, class : 94.71
--------------------------------------------------------
Accuracies on test: jigsaw : 99.34, class : 81.95
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 28
New epoch - lr: 0.0001
0/42 of epoch 29/30 jigsaw : 0.238, class : 0.072, t_rotation : 0.129, entropy : 0.276 - acc jigsaw : 90.62, class : 85.94 [bs:128]
30/42 of epoch 29/30 jigsaw : 0.152, class : 0.067, t_rotation : 0.124, entropy : 0.275 - acc jigsaw : 93.75, class : 84.38 [bs:128]
Accuracies on val: jigsaw : 96.36, class : 94.38
--------------------------------------------------------
Accuracies on test: jigsaw : 99.59, class : 81.60
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 29
New epoch - lr: 0.0001
0/42 of epoch 30/30 jigsaw : 0.200, class : 0.046, t_rotation : 0.131, entropy : 0.207 - acc jigsaw : 95.31, class : 76.56 [bs:128]
30/42 of epoch 30/30 jigsaw : 0.212, class : 0.092, t_rotation : 0.129, entropy : 0.206 - acc jigsaw : 92.97, class : 77.34 [bs:128]
Accuracies on val: jigsaw : 96.20, class : 94.55
--------------------------------------------------------
Accuracies on test: jigsaw : 99.47, class : 81.37
--------------------------------------------------------
2019-12-16 10:33:20
sketch
['photo', 'cartoon', 'art_painting']
unsupervised_task_weight: 0.8
bias_hole_image: 0.5
target_rotation_weight: 0.8
entropy_weight 0.1
only_classify the ordered image: True
Highest accuracy on validation set appears on epoch  tensor(27)
Highest accuracy on test set appears on epoch  tensor(27)
Accuracy on test set when the accuracy on validation set is highest:0.820
Highest accuracy on test set:0.820
It took 1096.96
--------------------------------------------------------
******************Start training**************************************
--------------------------------------------------------
Dataset size: training 5457, validation 605, testing 3929
--------------------------------------------------------
Namespace(TTA=False, batch_size=128, bias_whole_image=0.5, classify_only_ordered_images_or_not=True, domains_list=['photo', 'sketch', 'cartoon', 'art_painting'], entropy_loss_weight=0.1, epochs=30, folder_name='test', image_size=222, jitter=0.4, learning_rate=0.001, limit_source=None, limit_target=None, max_scale=1.0, min_scale=0.8, n_classes=7, nesterov=False, network='resnet18', ooo_weight=0, parameters_lists=[[0.8, 0.3, 0.8, 0.1], [0.8, 0.5, 0.8, 0.1], [0.8, 0.6, 0.8, 0.1]], random_horiz_flip=0.5, repeat_times=3, source=['photo', 'cartoon', 'art_painting'], suffix='', target='sketch', target_domain_list=['art_painting', 'cartoon', 'sketch', 'photo'], target_domain_unsupervised_task_loss_weight=0.8, tf_logger=True, tile_random_grayscale=0.1, train_all=True, unsupervised_task_weight=0.8, val_size=0.1)
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 0
New epoch - lr: 0.001
0/42 of epoch 1/30 jigsaw : 1.717, class : 2.081, t_rotation : 1.750, entropy : 1.835 - acc jigsaw : 11.72, class : 18.75 [bs:128]
30/42 of epoch 1/30 jigsaw : 0.967, class : 1.023, t_rotation : 0.826, entropy : 1.782 - acc jigsaw : 62.50, class : 63.28 [bs:128]
Accuracies on val: jigsaw : 98.68, class : 68.26
--------------------------------------------------------
Accuracies on test: jigsaw : 96.67, class : 46.96
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 1
New epoch - lr: 0.001
0/42 of epoch 2/30 jigsaw : 0.942, class : 0.887, t_rotation : 0.666, entropy : 1.670 - acc jigsaw : 60.16, class : 64.84 [bs:128]
30/42 of epoch 2/30 jigsaw : 0.670, class : 0.543, t_rotation : 0.508, entropy : 1.335 - acc jigsaw : 70.31, class : 78.91 [bs:128]
Accuracies on val: jigsaw : 98.02, class : 83.14
--------------------------------------------------------
Accuracies on test: jigsaw : 96.72, class : 62.99
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 2
New epoch - lr: 0.001
0/42 of epoch 3/30 jigsaw : 0.689, class : 0.521, t_rotation : 0.511, entropy : 1.245 - acc jigsaw : 74.22, class : 74.22 [bs:128]
30/42 of epoch 3/30 jigsaw : 0.554, class : 0.431, t_rotation : 0.415, entropy : 1.002 - acc jigsaw : 78.91, class : 80.47 [bs:128]
Accuracies on val: jigsaw : 98.02, class : 88.60
--------------------------------------------------------
Accuracies on test: jigsaw : 97.05, class : 70.20
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 3
New epoch - lr: 0.001
0/42 of epoch 4/30 jigsaw : 0.633, class : 0.369, t_rotation : 0.359, entropy : 0.965 - acc jigsaw : 69.53, class : 84.38 [bs:128]
30/42 of epoch 4/30 jigsaw : 0.667, class : 0.232, t_rotation : 0.291, entropy : 0.826 - acc jigsaw : 73.44, class : 78.91 [bs:128]
Accuracies on val: jigsaw : 97.52, class : 87.93
--------------------------------------------------------
Accuracies on test: jigsaw : 97.58, class : 72.56
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 4
New epoch - lr: 0.001
0/42 of epoch 5/30 jigsaw : 0.554, class : 0.252, t_rotation : 0.373, entropy : 0.719 - acc jigsaw : 76.56, class : 78.91 [bs:128]
30/42 of epoch 5/30 jigsaw : 0.441, class : 0.241, t_rotation : 0.338, entropy : 0.586 - acc jigsaw : 83.59, class : 79.69 [bs:128]
Accuracies on val: jigsaw : 97.69, class : 89.09
--------------------------------------------------------
Accuracies on test: jigsaw : 98.24, class : 73.45
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 5
New epoch - lr: 0.001
0/42 of epoch 6/30 jigsaw : 0.515, class : 0.302, t_rotation : 0.350, entropy : 0.607 - acc jigsaw : 78.91, class : 75.00 [bs:128]
30/42 of epoch 6/30 jigsaw : 0.462, class : 0.164, t_rotation : 0.334, entropy : 0.530 - acc jigsaw : 80.47, class : 82.81 [bs:128]
Accuracies on val: jigsaw : 96.69, class : 89.75
--------------------------------------------------------
Accuracies on test: jigsaw : 96.95, class : 76.05
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 6
New epoch - lr: 0.001
0/42 of epoch 7/30 jigsaw : 0.463, class : 0.182, t_rotation : 0.375, entropy : 0.614 - acc jigsaw : 81.25, class : 78.12 [bs:128]
30/42 of epoch 7/30 jigsaw : 0.493, class : 0.306, t_rotation : 0.315, entropy : 0.514 - acc jigsaw : 84.38, class : 75.00 [bs:128]
Accuracies on val: jigsaw : 96.36, class : 89.92
--------------------------------------------------------
Accuracies on test: jigsaw : 97.00, class : 76.15
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 7
New epoch - lr: 0.001
0/42 of epoch 8/30 jigsaw : 0.470, class : 0.213, t_rotation : 0.212, entropy : 0.446 - acc jigsaw : 82.03, class : 78.91 [bs:128]
30/42 of epoch 8/30 jigsaw : 0.314, class : 0.141, t_rotation : 0.198, entropy : 0.407 - acc jigsaw : 90.62, class : 85.16 [bs:128]
Accuracies on val: jigsaw : 96.53, class : 91.40
--------------------------------------------------------
Accuracies on test: jigsaw : 98.55, class : 76.36
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 8
New epoch - lr: 0.001
0/42 of epoch 9/30 jigsaw : 0.532, class : 0.194, t_rotation : 0.196, entropy : 0.418 - acc jigsaw : 81.25, class : 76.56 [bs:128]
30/42 of epoch 9/30 jigsaw : 0.314, class : 0.079, t_rotation : 0.196, entropy : 0.409 - acc jigsaw : 88.28, class : 83.59 [bs:128]
Accuracies on val: jigsaw : 96.69, class : 91.90
--------------------------------------------------------
Accuracies on test: jigsaw : 99.16, class : 77.42
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 9
New epoch - lr: 0.001
0/42 of epoch 10/30 jigsaw : 0.460, class : 0.181, t_rotation : 0.280, entropy : 0.408 - acc jigsaw : 78.12, class : 79.69 [bs:128]
30/42 of epoch 10/30 jigsaw : 0.264, class : 0.267, t_rotation : 0.262, entropy : 0.397 - acc jigsaw : 89.84, class : 82.03 [bs:128]
Accuracies on val: jigsaw : 96.03, class : 92.56
--------------------------------------------------------
Accuracies on test: jigsaw : 98.63, class : 77.60
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 10
New epoch - lr: 0.001
0/42 of epoch 11/30 jigsaw : 0.451, class : 0.198, t_rotation : 0.227, entropy : 0.469 - acc jigsaw : 85.94, class : 80.47 [bs:128]
30/42 of epoch 11/30 jigsaw : 0.444, class : 0.151, t_rotation : 0.181, entropy : 0.468 - acc jigsaw : 81.25, class : 85.16 [bs:128]
Accuracies on val: jigsaw : 95.70, class : 91.90
--------------------------------------------------------
Accuracies on test: jigsaw : 98.29, class : 78.67
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 11
New epoch - lr: 0.001
0/42 of epoch 12/30 jigsaw : 0.296, class : 0.114, t_rotation : 0.217, entropy : 0.386 - acc jigsaw : 89.06, class : 80.47 [bs:128]
30/42 of epoch 12/30 jigsaw : 0.331, class : 0.120, t_rotation : 0.177, entropy : 0.351 - acc jigsaw : 88.28, class : 84.38 [bs:128]
Accuracies on val: jigsaw : 97.19, class : 92.56
--------------------------------------------------------
Accuracies on test: jigsaw : 99.21, class : 77.35
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 12
New epoch - lr: 0.001
0/42 of epoch 13/30 jigsaw : 0.416, class : 0.181, t_rotation : 0.146, entropy : 0.323 - acc jigsaw : 87.50, class : 79.69 [bs:128]
30/42 of epoch 13/30 jigsaw : 0.345, class : 0.074, t_rotation : 0.112, entropy : 0.286 - acc jigsaw : 86.72, class : 80.47 [bs:128]
Accuracies on val: jigsaw : 96.03, class : 92.73
--------------------------------------------------------
Accuracies on test: jigsaw : 98.60, class : 77.20
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 13
New epoch - lr: 0.001
0/42 of epoch 14/30 jigsaw : 0.336, class : 0.132, t_rotation : 0.257, entropy : 0.338 - acc jigsaw : 88.28, class : 80.47 [bs:128]
30/42 of epoch 14/30 jigsaw : 0.250, class : 0.097, t_rotation : 0.207, entropy : 0.324 - acc jigsaw : 89.84, class : 82.03 [bs:128]
Accuracies on val: jigsaw : 95.87, class : 92.23
--------------------------------------------------------
Accuracies on test: jigsaw : 99.24, class : 78.39
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 14
New epoch - lr: 0.001
0/42 of epoch 15/30 jigsaw : 0.340, class : 0.055, t_rotation : 0.191, entropy : 0.316 - acc jigsaw : 86.72, class : 89.84 [bs:128]
30/42 of epoch 15/30 jigsaw : 0.237, class : 0.042, t_rotation : 0.174, entropy : 0.281 - acc jigsaw : 91.41, class : 86.72 [bs:128]
Accuracies on val: jigsaw : 96.86, class : 92.56
--------------------------------------------------------
Accuracies on test: jigsaw : 99.47, class : 78.42
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 15
New epoch - lr: 0.001
0/42 of epoch 16/30 jigsaw : 0.299, class : 0.111, t_rotation : 0.132, entropy : 0.262 - acc jigsaw : 89.84, class : 78.12 [bs:128]
30/42 of epoch 16/30 jigsaw : 0.352, class : 0.115, t_rotation : 0.118, entropy : 0.257 - acc jigsaw : 88.28, class : 85.94 [bs:128]
Accuracies on val: jigsaw : 96.36, class : 93.06
--------------------------------------------------------
Accuracies on test: jigsaw : 99.36, class : 79.82
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 16
New epoch - lr: 0.001
0/42 of epoch 17/30 jigsaw : 0.321, class : 0.089, t_rotation : 0.128, entropy : 0.260 - acc jigsaw : 89.06, class : 80.47 [bs:128]
30/42 of epoch 17/30 jigsaw : 0.265, class : 0.132, t_rotation : 0.120, entropy : 0.238 - acc jigsaw : 93.75, class : 78.12 [bs:128]
Accuracies on val: jigsaw : 96.69, class : 93.22
--------------------------------------------------------
Accuracies on test: jigsaw : 99.11, class : 80.10
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 17
New epoch - lr: 0.001
0/42 of epoch 18/30 jigsaw : 0.242, class : 0.093, t_rotation : 0.138, entropy : 0.256 - acc jigsaw : 91.41, class : 76.56 [bs:128]
30/42 of epoch 18/30 jigsaw : 0.213, class : 0.048, t_rotation : 0.132, entropy : 0.239 - acc jigsaw : 92.19, class : 85.16 [bs:128]
Accuracies on val: jigsaw : 96.36, class : 93.72
--------------------------------------------------------
Accuracies on test: jigsaw : 99.01, class : 80.12
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 18
New epoch - lr: 0.001
0/42 of epoch 19/30 jigsaw : 0.254, class : 0.036, t_rotation : 0.115, entropy : 0.236 - acc jigsaw : 90.62, class : 85.16 [bs:128]
30/42 of epoch 19/30 jigsaw : 0.273, class : 0.199, t_rotation : 0.112, entropy : 0.238 - acc jigsaw : 88.28, class : 78.12 [bs:128]
Accuracies on val: jigsaw : 96.86, class : 94.55
--------------------------------------------------------
Accuracies on test: jigsaw : 99.13, class : 79.89
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 19
New epoch - lr: 0.001
0/42 of epoch 20/30 jigsaw : 0.262, class : 0.097, t_rotation : 0.137, entropy : 0.196 - acc jigsaw : 90.62, class : 82.03 [bs:128]
30/42 of epoch 20/30 jigsaw : 0.304, class : 0.096, t_rotation : 0.108, entropy : 0.188 - acc jigsaw : 89.06, class : 85.94 [bs:128]
Accuracies on val: jigsaw : 96.69, class : 93.22
--------------------------------------------------------
Accuracies on test: jigsaw : 99.39, class : 80.45
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 20
New epoch - lr: 0.001
0/42 of epoch 21/30 jigsaw : 0.287, class : 0.049, t_rotation : 0.118, entropy : 0.236 - acc jigsaw : 89.84, class : 83.59 [bs:128]
30/42 of epoch 21/30 jigsaw : 0.199, class : 0.076, t_rotation : 0.083, entropy : 0.223 - acc jigsaw : 91.41, class : 88.28 [bs:128]
Accuracies on val: jigsaw : 96.86, class : 93.72
--------------------------------------------------------
Accuracies on test: jigsaw : 99.39, class : 80.71
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 21
New epoch - lr: 0.001
0/42 of epoch 22/30 jigsaw : 0.265, class : 0.052, t_rotation : 0.129, entropy : 0.260 - acc jigsaw : 92.97, class : 77.34 [bs:128]
30/42 of epoch 22/30 jigsaw : 0.175, class : 0.075, t_rotation : 0.094, entropy : 0.248 - acc jigsaw : 93.75, class : 82.81 [bs:128]
Accuracies on val: jigsaw : 96.53, class : 94.21
--------------------------------------------------------
Accuracies on test: jigsaw : 99.24, class : 80.81
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 22
New epoch - lr: 0.001
0/42 of epoch 23/30 jigsaw : 0.189, class : 0.012, t_rotation : 0.128, entropy : 0.237 - acc jigsaw : 92.19, class : 78.91 [bs:128]
30/42 of epoch 23/30 jigsaw : 0.214, class : 0.062, t_rotation : 0.089, entropy : 0.221 - acc jigsaw : 91.41, class : 81.25 [bs:128]
Accuracies on val: jigsaw : 96.20, class : 93.88
--------------------------------------------------------
Accuracies on test: jigsaw : 99.62, class : 80.86
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 23
New epoch - lr: 0.0001
0/42 of epoch 24/30 jigsaw : 0.230, class : 0.039, t_rotation : 0.102, entropy : 0.168 - acc jigsaw : 92.97, class : 82.81 [bs:128]
30/42 of epoch 24/30 jigsaw : 0.213, class : 0.067, t_rotation : 0.101, entropy : 0.167 - acc jigsaw : 92.19, class : 81.25 [bs:128]
Accuracies on val: jigsaw : 95.37, class : 93.55
--------------------------------------------------------
Accuracies on test: jigsaw : 99.52, class : 81.42
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 24
New epoch - lr: 0.0001
0/42 of epoch 25/30 jigsaw : 0.289, class : 0.037, t_rotation : 0.209, entropy : 0.209 - acc jigsaw : 90.62, class : 88.28 [bs:128]
30/42 of epoch 25/30 jigsaw : 0.183, class : 0.091, t_rotation : 0.202, entropy : 0.207 - acc jigsaw : 92.19, class : 85.94 [bs:128]
Accuracies on val: jigsaw : 96.20, class : 94.55
--------------------------------------------------------
Accuracies on test: jigsaw : 99.52, class : 81.06
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 25
New epoch - lr: 0.0001
0/42 of epoch 26/30 jigsaw : 0.238, class : 0.092, t_rotation : 0.077, entropy : 0.212 - acc jigsaw : 90.62, class : 82.81 [bs:128]
30/42 of epoch 26/30 jigsaw : 0.194, class : 0.041, t_rotation : 0.074, entropy : 0.210 - acc jigsaw : 93.75, class : 79.69 [bs:128]
Accuracies on val: jigsaw : 95.70, class : 94.38
--------------------------------------------------------
Accuracies on test: jigsaw : 99.47, class : 80.83
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 26
New epoch - lr: 0.0001
0/42 of epoch 27/30 jigsaw : 0.225, class : 0.094, t_rotation : 0.097, entropy : 0.251 - acc jigsaw : 93.75, class : 72.66 [bs:128]
30/42 of epoch 27/30 jigsaw : 0.190, class : 0.028, t_rotation : 0.094, entropy : 0.250 - acc jigsaw : 90.62, class : 88.28 [bs:128]
Accuracies on val: jigsaw : 95.54, class : 94.55
--------------------------------------------------------
Accuracies on test: jigsaw : 99.47, class : 81.27
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 27
New epoch - lr: 0.0001
0/42 of epoch 28/30 jigsaw : 0.214, class : 0.056, t_rotation : 0.132, entropy : 0.158 - acc jigsaw : 91.41, class : 80.47 [bs:128]
30/42 of epoch 28/30 jigsaw : 0.152, class : 0.034, t_rotation : 0.128, entropy : 0.157 - acc jigsaw : 96.09, class : 85.16 [bs:128]
Accuracies on val: jigsaw : 96.20, class : 94.38
--------------------------------------------------------
Accuracies on test: jigsaw : 99.49, class : 80.96
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 28
New epoch - lr: 0.0001
0/42 of epoch 29/30 jigsaw : 0.327, class : 0.026, t_rotation : 0.085, entropy : 0.181 - acc jigsaw : 86.72, class : 82.03 [bs:128]
30/42 of epoch 29/30 jigsaw : 0.209, class : 0.036, t_rotation : 0.080, entropy : 0.179 - acc jigsaw : 92.19, class : 81.25 [bs:128]
Accuracies on val: jigsaw : 96.20, class : 94.55
--------------------------------------------------------
Accuracies on test: jigsaw : 99.54, class : 81.29
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 29
New epoch - lr: 0.0001
0/42 of epoch 30/30 jigsaw : 0.223, class : 0.032, t_rotation : 0.081, entropy : 0.209 - acc jigsaw : 91.41, class : 78.12 [bs:128]
30/42 of epoch 30/30 jigsaw : 0.239, class : 0.025, t_rotation : 0.078, entropy : 0.207 - acc jigsaw : 92.19, class : 78.12 [bs:128]
Accuracies on val: jigsaw : 96.03, class : 94.55
--------------------------------------------------------
Accuracies on test: jigsaw : 99.49, class : 81.01
--------------------------------------------------------
2019-12-16 10:51:37
sketch
['photo', 'cartoon', 'art_painting']
unsupervised_task_weight: 0.8
bias_hole_image: 0.5
target_rotation_weight: 0.8
entropy_weight 0.1
only_classify the ordered image: True
Highest accuracy on validation set appears on epoch  tensor(29)
Highest accuracy on test set appears on epoch  tensor(23)
Accuracy on test set when the accuracy on validation set is highest:0.810
Highest accuracy on test set:0.814
It took 1095.78
--------------------------------------------------------
******************Start training**************************************
--------------------------------------------------------
Dataset size: training 7491, validation 830, testing 1670
--------------------------------------------------------
Namespace(TTA=False, batch_size=128, bias_whole_image=0.5, classify_only_ordered_images_or_not=True, domains_list=['photo', 'sketch', 'cartoon', 'art_painting'], entropy_loss_weight=0.1, epochs=30, folder_name='test', image_size=222, jitter=0.4, learning_rate=0.001, limit_source=None, limit_target=None, max_scale=1.0, min_scale=0.8, n_classes=7, nesterov=False, network='resnet18', ooo_weight=0, parameters_lists=[[0.8, 0.3, 0.8, 0.1], [0.8, 0.5, 0.8, 0.1], [0.8, 0.6, 0.8, 0.1]], random_horiz_flip=0.5, repeat_times=3, source=['sketch', 'cartoon', 'art_painting'], suffix='', target='photo', target_domain_list=['art_painting', 'cartoon', 'sketch', 'photo'], target_domain_unsupervised_task_loss_weight=0.8, tf_logger=True, tile_random_grayscale=0.1, train_all=True, unsupervised_task_weight=0.8, val_size=0.1)
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 0
New epoch - lr: 0.001
0/58 of epoch 1/30 jigsaw : 1.796, class : 2.085, t_rotation : 1.785, entropy : 1.805 - acc jigsaw : 14.06, class : 14.06 [bs:128]
30/58 of epoch 1/30 jigsaw : 0.924, class : 1.427, t_rotation : 0.674, entropy : 1.736 - acc jigsaw : 69.53, class : 46.09 [bs:128]
Accuracies on val: jigsaw : 94.94, class : 68.31
--------------------------------------------------------
Accuracies on test: jigsaw : 98.44, class : 85.87
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 1
New epoch - lr: 0.001
0/58 of epoch 2/30 jigsaw : 0.795, class : 0.870, t_rotation : 0.530, entropy : 1.353 - acc jigsaw : 65.62, class : 62.50 [bs:128]
30/58 of epoch 2/30 jigsaw : 0.695, class : 0.657, t_rotation : 0.396, entropy : 0.833 - acc jigsaw : 71.88, class : 72.66 [bs:128]
Accuracies on val: jigsaw : 94.70, class : 81.08
--------------------------------------------------------
Accuracies on test: jigsaw : 98.14, class : 95.51
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 2
New epoch - lr: 0.001
0/58 of epoch 3/30 jigsaw : 0.618, class : 0.372, t_rotation : 0.360, entropy : 0.510 - acc jigsaw : 73.44, class : 78.12 [bs:128]
30/58 of epoch 3/30 jigsaw : 0.535, class : 0.401, t_rotation : 0.378, entropy : 0.371 - acc jigsaw : 76.56, class : 72.66 [bs:128]
Accuracies on val: jigsaw : 94.70, class : 81.93
--------------------------------------------------------
Accuracies on test: jigsaw : 98.74, class : 96.47
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 3
New epoch - lr: 0.001
0/58 of epoch 4/30 jigsaw : 0.601, class : 0.294, t_rotation : 0.331, entropy : 0.334 - acc jigsaw : 82.81, class : 70.31 [bs:128]
30/58 of epoch 4/30 jigsaw : 0.395, class : 0.308, t_rotation : 0.270, entropy : 0.296 - acc jigsaw : 85.16, class : 72.66 [bs:128]
Accuracies on val: jigsaw : 92.89, class : 81.93
--------------------------------------------------------
Accuracies on test: jigsaw : 98.38, class : 96.77
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 4
New epoch - lr: 0.001
0/58 of epoch 5/30 jigsaw : 0.456, class : 0.263, t_rotation : 0.248, entropy : 0.327 - acc jigsaw : 82.81, class : 81.25 [bs:128]
30/58 of epoch 5/30 jigsaw : 0.356, class : 0.292, t_rotation : 0.225, entropy : 0.196 - acc jigsaw : 89.06, class : 78.12 [bs:128]
Accuracies on val: jigsaw : 93.37, class : 83.25
--------------------------------------------------------
Accuracies on test: jigsaw : 98.32, class : 97.13
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 5
New epoch - lr: 0.001
0/58 of epoch 6/30 jigsaw : 0.383, class : 0.254, t_rotation : 0.267, entropy : 0.169 - acc jigsaw : 84.38, class : 76.56 [bs:128]
30/58 of epoch 6/30 jigsaw : 0.338, class : 0.228, t_rotation : 0.166, entropy : 0.176 - acc jigsaw : 90.62, class : 77.34 [bs:128]
Accuracies on val: jigsaw : 95.06, class : 84.70
--------------------------------------------------------
Accuracies on test: jigsaw : 99.10, class : 97.54
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 6
New epoch - lr: 0.001
0/58 of epoch 7/30 jigsaw : 0.389, class : 0.211, t_rotation : 0.311, entropy : 0.167 - acc jigsaw : 83.59, class : 81.25 [bs:128]
30/58 of epoch 7/30 jigsaw : 0.305, class : 0.186, t_rotation : 0.148, entropy : 0.236 - acc jigsaw : 88.28, class : 81.25 [bs:128]
Accuracies on val: jigsaw : 94.46, class : 86.99
--------------------------------------------------------
Accuracies on test: jigsaw : 98.80, class : 97.54
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 7
New epoch - lr: 0.001
0/58 of epoch 8/30 jigsaw : 0.288, class : 0.174, t_rotation : 0.209, entropy : 0.155 - acc jigsaw : 91.41, class : 78.12 [bs:128]
30/58 of epoch 8/30 jigsaw : 0.237, class : 0.251, t_rotation : 0.171, entropy : 0.152 - acc jigsaw : 91.41, class : 74.22 [bs:128]
Accuracies on val: jigsaw : 95.06, class : 87.11
--------------------------------------------------------
Accuracies on test: jigsaw : 99.16, class : 97.49
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 8
New epoch - lr: 0.001
0/58 of epoch 9/30 jigsaw : 0.333, class : 0.246, t_rotation : 0.147, entropy : 0.149 - acc jigsaw : 89.06, class : 75.78 [bs:128]
30/58 of epoch 9/30 jigsaw : 0.259, class : 0.111, t_rotation : 0.084, entropy : 0.167 - acc jigsaw : 93.75, class : 74.22 [bs:128]
Accuracies on val: jigsaw : 92.17, class : 87.23
--------------------------------------------------------
Accuracies on test: jigsaw : 98.86, class : 97.54
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 9
New epoch - lr: 0.001
0/58 of epoch 10/30 jigsaw : 0.244, class : 0.204, t_rotation : 0.137, entropy : 0.159 - acc jigsaw : 93.75, class : 75.78 [bs:128]
30/58 of epoch 10/30 jigsaw : 0.299, class : 0.138, t_rotation : 0.146, entropy : 0.141 - acc jigsaw : 89.84, class : 85.94 [bs:128]
Accuracies on val: jigsaw : 94.94, class : 89.16
--------------------------------------------------------
Accuracies on test: jigsaw : 98.98, class : 97.60
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 10
New epoch - lr: 0.001
0/58 of epoch 11/30 jigsaw : 0.291, class : 0.118, t_rotation : 0.132, entropy : 0.112 - acc jigsaw : 85.94, class : 77.34 [bs:128]
30/58 of epoch 11/30 jigsaw : 0.343, class : 0.134, t_rotation : 0.073, entropy : 0.120 - acc jigsaw : 87.50, class : 75.78 [bs:128]
Accuracies on val: jigsaw : 94.70, class : 87.95
--------------------------------------------------------
Accuracies on test: jigsaw : 99.16, class : 97.31
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 11
New epoch - lr: 0.001
0/58 of epoch 12/30 jigsaw : 0.287, class : 0.155, t_rotation : 0.106, entropy : 0.141 - acc jigsaw : 90.62, class : 73.44 [bs:128]
30/58 of epoch 12/30 jigsaw : 0.365, class : 0.119, t_rotation : 0.105, entropy : 0.153 - acc jigsaw : 86.72, class : 77.34 [bs:128]
Accuracies on val: jigsaw : 94.82, class : 88.19
--------------------------------------------------------
Accuracies on test: jigsaw : 99.28, class : 97.90
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 12
New epoch - lr: 0.001
0/58 of epoch 13/30 jigsaw : 0.300, class : 0.195, t_rotation : 0.214, entropy : 0.102 - acc jigsaw : 87.50, class : 75.00 [bs:128]
30/58 of epoch 13/30 jigsaw : 0.288, class : 0.165, t_rotation : 0.094, entropy : 0.123 - acc jigsaw : 89.06, class : 71.88 [bs:128]
Accuracies on val: jigsaw : 94.46, class : 89.28
--------------------------------------------------------
Accuracies on test: jigsaw : 99.22, class : 97.84
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 13
New epoch - lr: 0.001
0/58 of epoch 14/30 jigsaw : 0.246, class : 0.093, t_rotation : 0.119, entropy : 0.142 - acc jigsaw : 89.84, class : 77.34 [bs:128]
30/58 of epoch 14/30 jigsaw : 0.217, class : 0.126, t_rotation : 0.116, entropy : 0.060 - acc jigsaw : 91.41, class : 76.56 [bs:128]
Accuracies on val: jigsaw : 94.82, class : 89.28
--------------------------------------------------------
Accuracies on test: jigsaw : 99.16, class : 97.54
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 14
New epoch - lr: 0.001
0/58 of epoch 15/30 jigsaw : 0.251, class : 0.041, t_rotation : 0.208, entropy : 0.129 - acc jigsaw : 93.75, class : 82.03 [bs:128]
30/58 of epoch 15/30 jigsaw : 0.220, class : 0.095, t_rotation : 0.108, entropy : 0.089 - acc jigsaw : 92.19, class : 85.94 [bs:128]
Accuracies on val: jigsaw : 93.13, class : 87.83
--------------------------------------------------------
Accuracies on test: jigsaw : 99.04, class : 97.54
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 15
New epoch - lr: 0.001
0/58 of epoch 16/30 jigsaw : 0.208, class : 0.091, t_rotation : 0.151, entropy : 0.104 - acc jigsaw : 92.97, class : 78.12 [bs:128]
30/58 of epoch 16/30 jigsaw : 0.213, class : 0.065, t_rotation : 0.082, entropy : 0.053 - acc jigsaw : 92.97, class : 78.91 [bs:128]
Accuracies on val: jigsaw : 93.73, class : 89.04
--------------------------------------------------------
Accuracies on test: jigsaw : 99.16, class : 97.60
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 16
New epoch - lr: 0.001
0/58 of epoch 17/30 jigsaw : 0.257, class : 0.051, t_rotation : 0.176, entropy : 0.089 - acc jigsaw : 92.19, class : 84.38 [bs:128]
30/58 of epoch 17/30 jigsaw : 0.372, class : 0.080, t_rotation : 0.071, entropy : 0.057 - acc jigsaw : 85.16, class : 78.12 [bs:128]
Accuracies on val: jigsaw : 94.22, class : 89.64
--------------------------------------------------------
Accuracies on test: jigsaw : 99.16, class : 97.78
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 17
New epoch - lr: 0.001
0/58 of epoch 18/30 jigsaw : 0.175, class : 0.065, t_rotation : 0.149, entropy : 0.074 - acc jigsaw : 93.75, class : 79.69 [bs:128]
30/58 of epoch 18/30 jigsaw : 0.248, class : 0.119, t_rotation : 0.099, entropy : 0.049 - acc jigsaw : 90.62, class : 83.59 [bs:128]
Accuracies on val: jigsaw : 93.01, class : 89.40
--------------------------------------------------------
Accuracies on test: jigsaw : 99.04, class : 98.08
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 18
New epoch - lr: 0.001
0/58 of epoch 19/30 jigsaw : 0.266, class : 0.080, t_rotation : 0.108, entropy : 0.071 - acc jigsaw : 89.84, class : 79.69 [bs:128]
30/58 of epoch 19/30 jigsaw : 0.206, class : 0.131, t_rotation : 0.082, entropy : 0.070 - acc jigsaw : 92.97, class : 82.03 [bs:128]
Accuracies on val: jigsaw : 94.10, class : 90.36
--------------------------------------------------------
Accuracies on test: jigsaw : 99.52, class : 97.90
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 19
New epoch - lr: 0.001
0/58 of epoch 20/30 jigsaw : 0.222, class : 0.111, t_rotation : 0.173, entropy : 0.068 - acc jigsaw : 92.19, class : 75.00 [bs:128]
30/58 of epoch 20/30 jigsaw : 0.223, class : 0.096, t_rotation : 0.064, entropy : 0.091 - acc jigsaw : 92.97, class : 85.94 [bs:128]
Accuracies on val: jigsaw : 93.86, class : 90.12
--------------------------------------------------------
Accuracies on test: jigsaw : 99.58, class : 97.90
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 20
New epoch - lr: 0.001
0/58 of epoch 21/30 jigsaw : 0.138, class : 0.113, t_rotation : 0.103, entropy : 0.079 - acc jigsaw : 96.88, class : 82.03 [bs:128]
30/58 of epoch 21/30 jigsaw : 0.202, class : 0.102, t_rotation : 0.064, entropy : 0.040 - acc jigsaw : 91.41, class : 81.25 [bs:128]
Accuracies on val: jigsaw : 94.46, class : 90.00
--------------------------------------------------------
Accuracies on test: jigsaw : 99.40, class : 98.08
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 21
New epoch - lr: 0.001
0/58 of epoch 22/30 jigsaw : 0.309, class : 0.058, t_rotation : 0.081, entropy : 0.062 - acc jigsaw : 89.84, class : 80.47 [bs:128]
30/58 of epoch 22/30 jigsaw : 0.293, class : 0.073, t_rotation : 0.061, entropy : 0.054 - acc jigsaw : 89.06, class : 85.16 [bs:128]
Accuracies on val: jigsaw : 94.34, class : 91.20
--------------------------------------------------------
Accuracies on test: jigsaw : 98.80, class : 97.90
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 22
New epoch - lr: 0.001
0/58 of epoch 23/30 jigsaw : 0.197, class : 0.058, t_rotation : 0.112, entropy : 0.052 - acc jigsaw : 92.97, class : 80.47 [bs:128]
30/58 of epoch 23/30 jigsaw : 0.245, class : 0.016, t_rotation : 0.096, entropy : 0.072 - acc jigsaw : 91.41, class : 80.47 [bs:128]
Accuracies on val: jigsaw : 95.30, class : 91.57
--------------------------------------------------------
Accuracies on test: jigsaw : 99.58, class : 98.14
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 23
New epoch - lr: 0.0001
0/58 of epoch 24/30 jigsaw : 0.179, class : 0.098, t_rotation : 0.147, entropy : 0.093 - acc jigsaw : 95.31, class : 82.81 [bs:128]
30/58 of epoch 24/30 jigsaw : 0.218, class : 0.094, t_rotation : 0.100, entropy : 0.075 - acc jigsaw : 92.19, class : 75.78 [bs:128]
Accuracies on val: jigsaw : 93.98, class : 91.08
--------------------------------------------------------
Accuracies on test: jigsaw : 99.46, class : 98.02
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 24
New epoch - lr: 0.0001
0/58 of epoch 25/30 jigsaw : 0.238, class : 0.034, t_rotation : 0.078, entropy : 0.121 - acc jigsaw : 92.19, class : 82.03 [bs:128]
30/58 of epoch 25/30 jigsaw : 0.129, class : 0.047, t_rotation : 0.064, entropy : 0.068 - acc jigsaw : 95.31, class : 85.94 [bs:128]
Accuracies on val: jigsaw : 95.06, class : 91.20
--------------------------------------------------------
Accuracies on test: jigsaw : 99.52, class : 97.96
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 25
New epoch - lr: 0.0001
0/58 of epoch 26/30 jigsaw : 0.174, class : 0.010, t_rotation : 0.074, entropy : 0.069 - acc jigsaw : 95.31, class : 81.25 [bs:128]
30/58 of epoch 26/30 jigsaw : 0.171, class : 0.038, t_rotation : 0.064, entropy : 0.048 - acc jigsaw : 92.19, class : 80.47 [bs:128]
Accuracies on val: jigsaw : 94.58, class : 91.08
--------------------------------------------------------
Accuracies on test: jigsaw : 99.52, class : 97.90
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 26
New epoch - lr: 0.0001
0/58 of epoch 27/30 jigsaw : 0.163, class : 0.029, t_rotation : 0.128, entropy : 0.082 - acc jigsaw : 93.75, class : 83.59 [bs:128]
30/58 of epoch 27/30 jigsaw : 0.171, class : 0.064, t_rotation : 0.125, entropy : 0.096 - acc jigsaw : 95.31, class : 80.47 [bs:128]
Accuracies on val: jigsaw : 94.46, class : 91.45
--------------------------------------------------------
Accuracies on test: jigsaw : 99.46, class : 98.02
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 27
New epoch - lr: 0.0001
0/58 of epoch 28/30 jigsaw : 0.189, class : 0.133, t_rotation : 0.079, entropy : 0.040 - acc jigsaw : 94.53, class : 78.91 [bs:128]
30/58 of epoch 28/30 jigsaw : 0.087, class : 0.047, t_rotation : 0.082, entropy : 0.060 - acc jigsaw : 97.66, class : 82.03 [bs:128]
Accuracies on val: jigsaw : 95.06, class : 91.08
--------------------------------------------------------
Accuracies on test: jigsaw : 99.52, class : 98.02
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 28
New epoch - lr: 0.0001
0/58 of epoch 29/30 jigsaw : 0.125, class : 0.059, t_rotation : 0.096, entropy : 0.019 - acc jigsaw : 96.09, class : 81.25 [bs:128]
30/58 of epoch 29/30 jigsaw : 0.222, class : 0.033, t_rotation : 0.111, entropy : 0.066 - acc jigsaw : 92.19, class : 84.38 [bs:128]
Accuracies on val: jigsaw : 95.30, class : 91.20
--------------------------------------------------------
Accuracies on test: jigsaw : 99.46, class : 98.02
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 29
New epoch - lr: 0.0001
0/58 of epoch 30/30 jigsaw : 0.154, class : 0.052, t_rotation : 0.100, entropy : 0.037 - acc jigsaw : 95.31, class : 85.16 [bs:128]
30/58 of epoch 30/30 jigsaw : 0.203, class : 0.035, t_rotation : 0.127, entropy : 0.077 - acc jigsaw : 90.62, class : 82.81 [bs:128]
Accuracies on val: jigsaw : 94.58, class : 91.45
--------------------------------------------------------
Accuracies on test: jigsaw : 99.52, class : 98.02
--------------------------------------------------------
2019-12-16 11:14:43
photo
['sketch', 'cartoon', 'art_painting']
unsupervised_task_weight: 0.8
bias_hole_image: 0.5
target_rotation_weight: 0.8
entropy_weight 0.1
only_classify the ordered image: True
Highest accuracy on validation set appears on epoch  tensor(22)
Highest accuracy on test set appears on epoch  tensor(22)
Accuracy on test set when the accuracy on validation set is highest:0.981
Highest accuracy on test set:0.981
It took 1386.16
--------------------------------------------------------
******************Start training**************************************
--------------------------------------------------------
Dataset size: training 7491, validation 830, testing 1670
--------------------------------------------------------
Namespace(TTA=False, batch_size=128, bias_whole_image=0.5, classify_only_ordered_images_or_not=True, domains_list=['photo', 'sketch', 'cartoon', 'art_painting'], entropy_loss_weight=0.1, epochs=30, folder_name='test', image_size=222, jitter=0.4, learning_rate=0.001, limit_source=None, limit_target=None, max_scale=1.0, min_scale=0.8, n_classes=7, nesterov=False, network='resnet18', ooo_weight=0, parameters_lists=[[0.8, 0.3, 0.8, 0.1], [0.8, 0.5, 0.8, 0.1], [0.8, 0.6, 0.8, 0.1]], random_horiz_flip=0.5, repeat_times=3, source=['sketch', 'cartoon', 'art_painting'], suffix='', target='photo', target_domain_list=['art_painting', 'cartoon', 'sketch', 'photo'], target_domain_unsupervised_task_loss_weight=0.8, tf_logger=True, tile_random_grayscale=0.1, train_all=True, unsupervised_task_weight=0.8, val_size=0.1)
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 0
New epoch - lr: 0.001
0/58 of epoch 1/30 jigsaw : 1.498, class : 2.329, t_rotation : 1.470, entropy : 1.770 - acc jigsaw : 25.00, class : 7.81 [bs:128]
30/58 of epoch 1/30 jigsaw : 0.931, class : 1.238, t_rotation : 0.743, entropy : 1.715 - acc jigsaw : 67.97, class : 58.59 [bs:128]
Accuracies on val: jigsaw : 92.89, class : 67.59
--------------------------------------------------------
Accuracies on test: jigsaw : 98.26, class : 78.14
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 1
New epoch - lr: 0.001
0/58 of epoch 2/30 jigsaw : 0.720, class : 0.925, t_rotation : 0.554, entropy : 1.343 - acc jigsaw : 71.09, class : 57.03 [bs:128]
30/58 of epoch 2/30 jigsaw : 0.690, class : 0.643, t_rotation : 0.489, entropy : 1.015 - acc jigsaw : 71.88, class : 70.31 [bs:128]
Accuracies on val: jigsaw : 92.77, class : 83.49
--------------------------------------------------------
Accuracies on test: jigsaw : 98.80, class : 92.34
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 2
New epoch - lr: 0.001
0/58 of epoch 3/30 jigsaw : 0.607, class : 0.491, t_rotation : 0.455, entropy : 0.812 - acc jigsaw : 76.56, class : 66.41 [bs:128]
30/58 of epoch 3/30 jigsaw : 0.573, class : 0.342, t_rotation : 0.268, entropy : 0.542 - acc jigsaw : 76.56, class : 78.91 [bs:128]
Accuracies on val: jigsaw : 95.66, class : 86.75
--------------------------------------------------------
Accuracies on test: jigsaw : 98.86, class : 95.33
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 3
New epoch - lr: 0.001
0/58 of epoch 4/30 jigsaw : 0.553, class : 0.527, t_rotation : 0.371, entropy : 0.454 - acc jigsaw : 82.81, class : 71.88 [bs:128]
30/58 of epoch 4/30 jigsaw : 0.465, class : 0.357, t_rotation : 0.247, entropy : 0.315 - acc jigsaw : 88.28, class : 77.34 [bs:128]
Accuracies on val: jigsaw : 94.58, class : 85.66
--------------------------------------------------------
Accuracies on test: jigsaw : 98.56, class : 96.83
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 4
New epoch - lr: 0.001
0/58 of epoch 5/30 jigsaw : 0.338, class : 0.283, t_rotation : 0.248, entropy : 0.335 - acc jigsaw : 92.97, class : 81.25 [bs:128]
30/58 of epoch 5/30 jigsaw : 0.439, class : 0.231, t_rotation : 0.288, entropy : 0.214 - acc jigsaw : 85.94, class : 79.69 [bs:128]
Accuracies on val: jigsaw : 93.25, class : 86.51
--------------------------------------------------------
Accuracies on test: jigsaw : 98.74, class : 96.95
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 5
New epoch - lr: 0.001
0/58 of epoch 6/30 jigsaw : 0.357, class : 0.283, t_rotation : 0.272, entropy : 0.208 - acc jigsaw : 85.16, class : 75.78 [bs:128]
30/58 of epoch 6/30 jigsaw : 0.375, class : 0.254, t_rotation : 0.181, entropy : 0.205 - acc jigsaw : 86.72, class : 71.09 [bs:128]
Accuracies on val: jigsaw : 95.30, class : 87.71
--------------------------------------------------------
Accuracies on test: jigsaw : 98.74, class : 97.66
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 6
New epoch - lr: 0.001
0/58 of epoch 7/30 jigsaw : 0.335, class : 0.144, t_rotation : 0.155, entropy : 0.146 - acc jigsaw : 89.84, class : 78.12 [bs:128]
30/58 of epoch 7/30 jigsaw : 0.345, class : 0.228, t_rotation : 0.255, entropy : 0.156 - acc jigsaw : 89.84, class : 78.91 [bs:128]
