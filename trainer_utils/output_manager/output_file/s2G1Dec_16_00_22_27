display-im6.q16: unable to open X server `' @ error/display.c/DisplayImageCommand/432.
******************Start training**************************************
--------------------------------------------------------
Dataset size: training 7150, validation 793, testing 2048
--------------------------------------------------------
Namespace(TTA=False, batch_size=128, bias_whole_image=0.4, classify_only_ordered_images_or_not=True, domains_list=['photo', 'sketch', 'cartoon', 'art_painting'], entropy_loss_weight=0.2, epochs=30, folder_name='test', image_size=222, jitter=0.4, learning_rate=0.001, limit_source=None, limit_target=None, max_scale=1.0, min_scale=0.8, n_classes=7, nesterov=False, network='resnet18', ooo_weight=0, parameters_lists=[[0.8, 0.4, 0.8, 0.2], [0.8, 0.4, 0.8, 0.3], [0.8, 0.4, 0.8, 0.4]], random_horiz_flip=0.5, repeat_times=3, source=['photo', 'sketch', 'cartoon'], suffix='', target='art_painting', target_domain_list=['art_painting', 'cartoon', 'sketch', 'photo'], target_domain_unsupervised_task_loss_weight=0.8, tf_logger=True, tile_random_grayscale=0.1, train_all=True, unsupervised_task_weight=0.8, val_size=0.1)
--------------------------------------------------------
/home/giorgio/Files/pycharm_project/pytorch_interpreter/lib/python3.7/site-packages/torch/optim/lr_scheduler.py:100: UserWarning: Detected call of `lr_scheduler.step()` before `optimizer.step()`. In PyTorch 1.1.0 and later, you should call them in the opposite order: `optimizer.step()` before `lr_scheduler.step()`.  Failure to do this will result in PyTorch skipping the first value of the learning rate schedule.See more details at https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate
  "https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate", UserWarning)
--------------------------------------------------------
current epoch:%d 0
New epoch - lr: 0.001
0/55 of epoch 1/30 jigsaw : 1.451, class : 2.083, t_rotation : 1.539, entropy : 1.821 - acc jigsaw : 22.66, class : 17.19 [bs:128]
30/55 of epoch 1/30 jigsaw : 0.965, class : 1.192, t_rotation : 1.041, entropy : 1.727 - acc jigsaw : 65.62, class : 47.66 [bs:128]
Accuracies on val: jigsaw : 95.84, class : 70.24
--------------------------------------------------------
Accuracies on test: jigsaw : 94.43, class : 62.99
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 1
New epoch - lr: 0.001
0/55 of epoch 2/30 jigsaw : 0.860, class : 0.739, t_rotation : 0.858, entropy : 1.531 - acc jigsaw : 65.62, class : 67.97 [bs:128]
30/55 of epoch 2/30 jigsaw : 0.616, class : 0.501, t_rotation : 0.739, entropy : 1.036 - acc jigsaw : 78.12, class : 68.75 [bs:128]
Accuracies on val: jigsaw : 95.96, class : 80.08
--------------------------------------------------------
Accuracies on test: jigsaw : 92.29, class : 77.98
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 2
New epoch - lr: 0.001
0/55 of epoch 3/30 jigsaw : 0.644, class : 0.419, t_rotation : 0.700, entropy : 0.935 - acc jigsaw : 74.22, class : 72.66 [bs:128]
30/55 of epoch 3/30 jigsaw : 0.587, class : 0.387, t_rotation : 0.610, entropy : 0.761 - acc jigsaw : 80.47, class : 71.88 [bs:128]
Accuracies on val: jigsaw : 96.09, class : 82.09
--------------------------------------------------------
Accuracies on test: jigsaw : 93.02, class : 82.18
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 3
New epoch - lr: 0.001
0/55 of epoch 4/30 jigsaw : 0.562, class : 0.335, t_rotation : 0.645, entropy : 0.625 - acc jigsaw : 79.69, class : 71.88 [bs:128]
30/55 of epoch 4/30 jigsaw : 0.441, class : 0.156, t_rotation : 0.563, entropy : 0.539 - acc jigsaw : 85.16, class : 74.22 [bs:128]
Accuracies on val: jigsaw : 96.85, class : 85.25
--------------------------------------------------------
Accuracies on test: jigsaw : 93.90, class : 85.01
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 4
New epoch - lr: 0.001
0/55 of epoch 5/30 jigsaw : 0.480, class : 0.214, t_rotation : 0.501, entropy : 0.547 - acc jigsaw : 82.81, class : 79.69 [bs:128]
30/55 of epoch 5/30 jigsaw : 0.324, class : 0.196, t_rotation : 0.454, entropy : 0.432 - acc jigsaw : 91.41, class : 73.44 [bs:128]
Accuracies on val: jigsaw : 97.35, class : 87.01
--------------------------------------------------------
Accuracies on test: jigsaw : 94.43, class : 85.89
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 5
New epoch - lr: 0.001
0/55 of epoch 6/30 jigsaw : 0.331, class : 0.186, t_rotation : 0.500, entropy : 0.389 - acc jigsaw : 87.50, class : 78.91 [bs:128]
30/55 of epoch 6/30 jigsaw : 0.453, class : 0.245, t_rotation : 0.376, entropy : 0.398 - acc jigsaw : 84.38, class : 64.84 [bs:128]
Accuracies on val: jigsaw : 97.48, class : 87.26
--------------------------------------------------------
Accuracies on test: jigsaw : 94.87, class : 87.70
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 6
New epoch - lr: 0.001
0/55 of epoch 7/30 jigsaw : 0.256, class : 0.115, t_rotation : 0.502, entropy : 0.389 - acc jigsaw : 92.19, class : 80.47 [bs:128]
30/55 of epoch 7/30 jigsaw : 0.455, class : 0.301, t_rotation : 0.284, entropy : 0.348 - acc jigsaw : 84.38, class : 67.97 [bs:128]
Accuracies on val: jigsaw : 96.72, class : 86.38
--------------------------------------------------------
Accuracies on test: jigsaw : 94.09, class : 87.99
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 7
New epoch - lr: 0.001
0/55 of epoch 8/30 jigsaw : 0.349, class : 0.167, t_rotation : 0.309, entropy : 0.291 - acc jigsaw : 86.72, class : 71.09 [bs:128]
30/55 of epoch 8/30 jigsaw : 0.246, class : 0.210, t_rotation : 0.300, entropy : 0.279 - acc jigsaw : 92.19, class : 70.31 [bs:128]
Accuracies on val: jigsaw : 96.85, class : 88.27
--------------------------------------------------------
Accuracies on test: jigsaw : 93.46, class : 87.94
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 8
New epoch - lr: 0.001
0/55 of epoch 9/30 jigsaw : 0.298, class : 0.112, t_rotation : 0.335, entropy : 0.372 - acc jigsaw : 92.19, class : 75.00 [bs:128]
30/55 of epoch 9/30 jigsaw : 0.292, class : 0.147, t_rotation : 0.342, entropy : 0.304 - acc jigsaw : 89.06, class : 75.78 [bs:128]
Accuracies on val: jigsaw : 96.72, class : 88.15
--------------------------------------------------------
Accuracies on test: jigsaw : 94.58, class : 88.43
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 9
New epoch - lr: 0.001
0/55 of epoch 10/30 jigsaw : 0.284, class : 0.148, t_rotation : 0.382, entropy : 0.285 - acc jigsaw : 88.28, class : 84.38 [bs:128]
30/55 of epoch 10/30 jigsaw : 0.301, class : 0.174, t_rotation : 0.222, entropy : 0.194 - acc jigsaw : 88.28, class : 75.00 [bs:128]
Accuracies on val: jigsaw : 97.23, class : 89.03
--------------------------------------------------------
Accuracies on test: jigsaw : 96.53, class : 89.50
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 10
New epoch - lr: 0.001
0/55 of epoch 11/30 jigsaw : 0.250, class : 0.086, t_rotation : 0.331, entropy : 0.217 - acc jigsaw : 89.06, class : 75.00 [bs:128]
30/55 of epoch 11/30 jigsaw : 0.409, class : 0.127, t_rotation : 0.192, entropy : 0.128 - acc jigsaw : 84.38, class : 71.09 [bs:128]
Accuracies on val: jigsaw : 97.23, class : 89.53
--------------------------------------------------------
Accuracies on test: jigsaw : 95.80, class : 89.84
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 11
New epoch - lr: 0.001
0/55 of epoch 12/30 jigsaw : 0.232, class : 0.200, t_rotation : 0.415, entropy : 0.233 - acc jigsaw : 90.62, class : 75.00 [bs:128]
30/55 of epoch 12/30 jigsaw : 0.247, class : 0.105, t_rotation : 0.152, entropy : 0.255 - acc jigsaw : 92.97, class : 71.09 [bs:128]
Accuracies on val: jigsaw : 96.72, class : 90.16
--------------------------------------------------------
Accuracies on test: jigsaw : 96.53, class : 90.04
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 12
New epoch - lr: 0.001
0/55 of epoch 13/30 jigsaw : 0.179, class : 0.146, t_rotation : 0.379, entropy : 0.298 - acc jigsaw : 94.53, class : 73.44 [bs:128]
30/55 of epoch 13/30 jigsaw : 0.230, class : 0.126, t_rotation : 0.232, entropy : 0.174 - acc jigsaw : 90.62, class : 78.12 [bs:128]
Accuracies on val: jigsaw : 97.10, class : 89.91
--------------------------------------------------------
Accuracies on test: jigsaw : 96.68, class : 90.23
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 13
New epoch - lr: 0.001
0/55 of epoch 14/30 jigsaw : 0.223, class : 0.095, t_rotation : 0.359, entropy : 0.203 - acc jigsaw : 92.19, class : 81.25 [bs:128]
30/55 of epoch 14/30 jigsaw : 0.161, class : 0.054, t_rotation : 0.211, entropy : 0.199 - acc jigsaw : 94.53, class : 77.34 [bs:128]
Accuracies on val: jigsaw : 96.72, class : 90.42
--------------------------------------------------------
Accuracies on test: jigsaw : 95.46, class : 90.09
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 14
New epoch - lr: 0.001
0/55 of epoch 15/30 jigsaw : 0.279, class : 0.089, t_rotation : 0.263, entropy : 0.218 - acc jigsaw : 92.19, class : 73.44 [bs:128]
30/55 of epoch 15/30 jigsaw : 0.193, class : 0.065, t_rotation : 0.221, entropy : 0.202 - acc jigsaw : 93.75, class : 74.22 [bs:128]
Accuracies on val: jigsaw : 96.97, class : 91.68
--------------------------------------------------------
Accuracies on test: jigsaw : 97.07, class : 89.70
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 15
New epoch - lr: 0.001
0/55 of epoch 16/30 jigsaw : 0.158, class : 0.057, t_rotation : 0.331, entropy : 0.130 - acc jigsaw : 92.19, class : 75.00 [bs:128]
30/55 of epoch 16/30 jigsaw : 0.241, class : 0.063, t_rotation : 0.206, entropy : 0.173 - acc jigsaw : 87.50, class : 77.34 [bs:128]
Accuracies on val: jigsaw : 96.34, class : 90.16
--------------------------------------------------------
Accuracies on test: jigsaw : 95.95, class : 91.16
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 16
New epoch - lr: 0.001
0/55 of epoch 17/30 jigsaw : 0.174, class : 0.039, t_rotation : 0.332, entropy : 0.198 - acc jigsaw : 94.53, class : 74.22 [bs:128]
30/55 of epoch 17/30 jigsaw : 0.177, class : 0.064, t_rotation : 0.125, entropy : 0.138 - acc jigsaw : 94.53, class : 75.78 [bs:128]
Accuracies on val: jigsaw : 96.22, class : 92.06
--------------------------------------------------------
Accuracies on test: jigsaw : 97.07, class : 91.46
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 17
New epoch - lr: 0.001
0/55 of epoch 18/30 jigsaw : 0.222, class : 0.066, t_rotation : 0.350, entropy : 0.207 - acc jigsaw : 89.84, class : 74.22 [bs:128]
30/55 of epoch 18/30 jigsaw : 0.093, class : 0.023, t_rotation : 0.113, entropy : 0.175 - acc jigsaw : 96.09, class : 82.81 [bs:128]
Accuracies on val: jigsaw : 96.47, class : 92.43
--------------------------------------------------------
Accuracies on test: jigsaw : 97.75, class : 90.77
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 18
New epoch - lr: 0.001
0/55 of epoch 19/30 jigsaw : 0.132, class : 0.083, t_rotation : 0.247, entropy : 0.129 - acc jigsaw : 92.97, class : 71.88 [bs:128]
30/55 of epoch 19/30 jigsaw : 0.235, class : 0.108, t_rotation : 0.169, entropy : 0.224 - acc jigsaw : 92.19, class : 74.22 [bs:128]
Accuracies on val: jigsaw : 96.34, class : 91.55
--------------------------------------------------------
Accuracies on test: jigsaw : 97.27, class : 90.53
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 19
New epoch - lr: 0.001
0/55 of epoch 20/30 jigsaw : 0.212, class : 0.134, t_rotation : 0.209, entropy : 0.152 - acc jigsaw : 93.75, class : 79.69 [bs:128]
30/55 of epoch 20/30 jigsaw : 0.098, class : 0.054, t_rotation : 0.134, entropy : 0.134 - acc jigsaw : 96.88, class : 77.34 [bs:128]
Accuracies on val: jigsaw : 96.85, class : 91.30
--------------------------------------------------------
Accuracies on test: jigsaw : 97.90, class : 90.92
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 20
New epoch - lr: 0.001
0/55 of epoch 21/30 jigsaw : 0.157, class : 0.077, t_rotation : 0.277, entropy : 0.151 - acc jigsaw : 93.75, class : 80.47 [bs:128]
30/55 of epoch 21/30 jigsaw : 0.253, class : 0.048, t_rotation : 0.227, entropy : 0.153 - acc jigsaw : 90.62, class : 82.81 [bs:128]
Accuracies on val: jigsaw : 97.23, class : 91.42
--------------------------------------------------------
Accuracies on test: jigsaw : 97.75, class : 90.28
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 21
New epoch - lr: 0.001
0/55 of epoch 22/30 jigsaw : 0.180, class : 0.032, t_rotation : 0.191, entropy : 0.125 - acc jigsaw : 93.75, class : 76.56 [bs:128]
30/55 of epoch 22/30 jigsaw : 0.122, class : 0.054, t_rotation : 0.131, entropy : 0.191 - acc jigsaw : 96.09, class : 71.09 [bs:128]
Accuracies on val: jigsaw : 95.96, class : 92.81
--------------------------------------------------------
Accuracies on test: jigsaw : 97.75, class : 90.58
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 22
New epoch - lr: 0.001
0/55 of epoch 23/30 jigsaw : 0.104, class : 0.073, t_rotation : 0.291, entropy : 0.122 - acc jigsaw : 96.88, class : 74.22 [bs:128]
30/55 of epoch 23/30 jigsaw : 0.128, class : 0.085, t_rotation : 0.117, entropy : 0.101 - acc jigsaw : 96.88, class : 79.69 [bs:128]
Accuracies on val: jigsaw : 96.60, class : 92.81
--------------------------------------------------------
Accuracies on test: jigsaw : 98.14, class : 90.97
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 23
New epoch - lr: 0.0001
0/55 of epoch 24/30 jigsaw : 0.151, class : 0.076, t_rotation : 0.244, entropy : 0.187 - acc jigsaw : 96.09, class : 71.09 [bs:128]
30/55 of epoch 24/30 jigsaw : 0.244, class : 0.047, t_rotation : 0.203, entropy : 0.090 - acc jigsaw : 89.84, class : 80.47 [bs:128]
Accuracies on val: jigsaw : 97.35, class : 92.69
--------------------------------------------------------
Accuracies on test: jigsaw : 98.63, class : 91.36
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 24
New epoch - lr: 0.0001
0/55 of epoch 25/30 jigsaw : 0.263, class : 0.015, t_rotation : 0.128, entropy : 0.119 - acc jigsaw : 89.84, class : 79.69 [bs:128]
30/55 of epoch 25/30 jigsaw : 0.269, class : 0.069, t_rotation : 0.267, entropy : 0.074 - acc jigsaw : 89.84, class : 78.91 [bs:128]
Accuracies on val: jigsaw : 96.85, class : 92.43
--------------------------------------------------------
Accuracies on test: jigsaw : 97.95, class : 91.31
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 25
New epoch - lr: 0.0001
0/55 of epoch 26/30 jigsaw : 0.132, class : 0.023, t_rotation : 0.182, entropy : 0.097 - acc jigsaw : 95.31, class : 78.91 [bs:128]
30/55 of epoch 26/30 jigsaw : 0.165, class : 0.098, t_rotation : 0.235, entropy : 0.126 - acc jigsaw : 95.31, class : 69.53 [bs:128]
Accuracies on val: jigsaw : 97.10, class : 93.32
--------------------------------------------------------
Accuracies on test: jigsaw : 98.39, class : 91.21
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 26
New epoch - lr: 0.0001
0/55 of epoch 27/30 jigsaw : 0.176, class : 0.068, t_rotation : 0.198, entropy : 0.070 - acc jigsaw : 92.19, class : 78.12 [bs:128]
30/55 of epoch 27/30 jigsaw : 0.127, class : 0.025, t_rotation : 0.100, entropy : 0.136 - acc jigsaw : 96.09, class : 71.88 [bs:128]
Accuracies on val: jigsaw : 97.35, class : 92.43
--------------------------------------------------------
Accuracies on test: jigsaw : 98.97, class : 91.21
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 27
New epoch - lr: 0.0001
0/55 of epoch 28/30 jigsaw : 0.156, class : 0.020, t_rotation : 0.143, entropy : 0.131 - acc jigsaw : 94.53, class : 82.03 [bs:128]
30/55 of epoch 28/30 jigsaw : 0.107, class : 0.022, t_rotation : 0.217, entropy : 0.169 - acc jigsaw : 96.88, class : 78.12 [bs:128]
Accuracies on val: jigsaw : 96.97, class : 93.06
--------------------------------------------------------
Accuracies on test: jigsaw : 98.29, class : 91.41
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 28
New epoch - lr: 0.0001
0/55 of epoch 29/30 jigsaw : 0.174, class : 0.035, t_rotation : 0.169, entropy : 0.112 - acc jigsaw : 93.75, class : 75.00 [bs:128]
30/55 of epoch 29/30 jigsaw : 0.110, class : 0.043, t_rotation : 0.239, entropy : 0.096 - acc jigsaw : 96.09, class : 79.69 [bs:128]
Accuracies on val: jigsaw : 96.97, class : 92.43
--------------------------------------------------------
Accuracies on test: jigsaw : 98.00, class : 91.21
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 29
New epoch - lr: 0.0001
0/55 of epoch 30/30 jigsaw : 0.085, class : 0.062, t_rotation : 0.182, entropy : 0.158 - acc jigsaw : 98.44, class : 80.47 [bs:128]
30/55 of epoch 30/30 jigsaw : 0.205, class : 0.039, t_rotation : 0.118, entropy : 0.116 - acc jigsaw : 92.19, class : 72.66 [bs:128]
Accuracies on val: jigsaw : 97.10, class : 92.69
--------------------------------------------------------
Accuracies on test: jigsaw : 98.29, class : 91.02
--------------------------------------------------------
2019-12-16 04:31:51
art_painting
['photo', 'sketch', 'cartoon']
unsupervised_task_weight: 0.8
bias_hole_image: 0.4
target_rotation_weight: 0.8
entropy_weight 0.2
only_classify the ordered image: True
Highest accuracy on validation set appears on epoch  tensor(25)
Highest accuracy on test set appears on epoch  tensor(16)
Accuracy on test set when the accuracy on validation set is highest:0.912
Highest accuracy on test set:0.915
It took 1901.58
--------------------------------------------------------
******************Start training**************************************
--------------------------------------------------------
Dataset size: training 7150, validation 793, testing 2048
--------------------------------------------------------
Namespace(TTA=False, batch_size=128, bias_whole_image=0.4, classify_only_ordered_images_or_not=True, domains_list=['photo', 'sketch', 'cartoon', 'art_painting'], entropy_loss_weight=0.2, epochs=30, folder_name='test', image_size=222, jitter=0.4, learning_rate=0.001, limit_source=None, limit_target=None, max_scale=1.0, min_scale=0.8, n_classes=7, nesterov=False, network='resnet18', ooo_weight=0, parameters_lists=[[0.8, 0.4, 0.8, 0.2], [0.8, 0.4, 0.8, 0.3], [0.8, 0.4, 0.8, 0.4]], random_horiz_flip=0.5, repeat_times=3, source=['photo', 'sketch', 'cartoon'], suffix='', target='art_painting', target_domain_list=['art_painting', 'cartoon', 'sketch', 'photo'], target_domain_unsupervised_task_loss_weight=0.8, tf_logger=True, tile_random_grayscale=0.1, train_all=True, unsupervised_task_weight=0.8, val_size=0.1)
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 0
New epoch - lr: 0.001
0/55 of epoch 1/30 jigsaw : 1.538, class : 1.985, t_rotation : 1.479, entropy : 1.851 - acc jigsaw : 15.62, class : 15.62 [bs:128]
30/55 of epoch 1/30 jigsaw : 1.013, class : 1.165, t_rotation : 0.967, entropy : 1.710 - acc jigsaw : 58.59, class : 55.47 [bs:128]
Accuracies on val: jigsaw : 95.21, class : 73.14
--------------------------------------------------------
Accuracies on test: jigsaw : 93.12, class : 64.55
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 1
New epoch - lr: 0.001
0/55 of epoch 2/30 jigsaw : 0.870, class : 0.871, t_rotation : 0.799, entropy : 1.503 - acc jigsaw : 63.28, class : 58.59 [bs:128]
30/55 of epoch 2/30 jigsaw : 0.677, class : 0.466, t_rotation : 0.788, entropy : 1.164 - acc jigsaw : 75.00, class : 75.78 [bs:128]
Accuracies on val: jigsaw : 94.83, class : 87.52
--------------------------------------------------------
Accuracies on test: jigsaw : 91.75, class : 77.83
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 2
New epoch - lr: 0.001
0/55 of epoch 3/30 jigsaw : 0.556, class : 0.471, t_rotation : 0.766, entropy : 1.042 - acc jigsaw : 78.91, class : 73.44 [bs:128]
30/55 of epoch 3/30 jigsaw : 0.594, class : 0.331, t_rotation : 0.570, entropy : 0.708 - acc jigsaw : 79.69, class : 74.22 [bs:128]
Accuracies on val: jigsaw : 94.45, class : 88.52
--------------------------------------------------------
Accuracies on test: jigsaw : 90.97, class : 82.28
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 3
New epoch - lr: 0.001
0/55 of epoch 4/30 jigsaw : 0.511, class : 0.252, t_rotation : 0.765, entropy : 0.607 - acc jigsaw : 82.81, class : 75.00 [bs:128]
30/55 of epoch 4/30 jigsaw : 0.520, class : 0.281, t_rotation : 0.483, entropy : 0.540 - acc jigsaw : 80.47, class : 72.66 [bs:128]
Accuracies on val: jigsaw : 94.58, class : 91.30
--------------------------------------------------------
Accuracies on test: jigsaw : 92.33, class : 83.64
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 4
New epoch - lr: 0.001
0/55 of epoch 5/30 jigsaw : 0.461, class : 0.177, t_rotation : 0.557, entropy : 0.485 - acc jigsaw : 85.16, class : 66.41 [bs:128]
30/55 of epoch 5/30 jigsaw : 0.336, class : 0.345, t_rotation : 0.351, entropy : 0.439 - acc jigsaw : 89.06, class : 64.84 [bs:128]
Accuracies on val: jigsaw : 94.70, class : 92.06
--------------------------------------------------------
Accuracies on test: jigsaw : 94.09, class : 85.74
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 5
New epoch - lr: 0.001
0/55 of epoch 6/30 jigsaw : 0.427, class : 0.402, t_rotation : 0.491, entropy : 0.405 - acc jigsaw : 84.38, class : 72.66 [bs:128]
30/55 of epoch 6/30 jigsaw : 0.385, class : 0.167, t_rotation : 0.396, entropy : 0.437 - acc jigsaw : 87.50, class : 74.22 [bs:128]
Accuracies on val: jigsaw : 95.84, class : 92.06
--------------------------------------------------------
Accuracies on test: jigsaw : 95.61, class : 86.47
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 6
New epoch - lr: 0.001
0/55 of epoch 7/30 jigsaw : 0.388, class : 0.162, t_rotation : 0.331, entropy : 0.364 - acc jigsaw : 84.38, class : 71.09 [bs:128]
30/55 of epoch 7/30 jigsaw : 0.292, class : 0.150, t_rotation : 0.353, entropy : 0.324 - acc jigsaw : 89.06, class : 72.66 [bs:128]
Accuracies on val: jigsaw : 94.70, class : 90.92
--------------------------------------------------------
Accuracies on test: jigsaw : 95.61, class : 87.50
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 7
New epoch - lr: 0.001
0/55 of epoch 8/30 jigsaw : 0.329, class : 0.146, t_rotation : 0.477, entropy : 0.299 - acc jigsaw : 89.84, class : 71.09 [bs:128]
30/55 of epoch 8/30 jigsaw : 0.281, class : 0.178, t_rotation : 0.393, entropy : 0.295 - acc jigsaw : 89.84, class : 76.56 [bs:128]
Accuracies on val: jigsaw : 95.71, class : 91.17
--------------------------------------------------------
Accuracies on test: jigsaw : 95.46, class : 87.21
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 8
New epoch - lr: 0.001
0/55 of epoch 9/30 jigsaw : 0.281, class : 0.139, t_rotation : 0.427, entropy : 0.324 - acc jigsaw : 90.62, class : 70.31 [bs:128]
30/55 of epoch 9/30 jigsaw : 0.245, class : 0.134, t_rotation : 0.278, entropy : 0.222 - acc jigsaw : 92.97, class : 77.34 [bs:128]
Accuracies on val: jigsaw : 95.84, class : 92.69
--------------------------------------------------------
Accuracies on test: jigsaw : 96.14, class : 88.23
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 9
New epoch - lr: 0.001
0/55 of epoch 10/30 jigsaw : 0.200, class : 0.101, t_rotation : 0.367, entropy : 0.308 - acc jigsaw : 93.75, class : 78.12 [bs:128]
30/55 of epoch 10/30 jigsaw : 0.243, class : 0.118, t_rotation : 0.210, entropy : 0.197 - acc jigsaw : 90.62, class : 71.09 [bs:128]
Accuracies on val: jigsaw : 95.96, class : 92.81
--------------------------------------------------------
Accuracies on test: jigsaw : 95.65, class : 89.16
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 10
New epoch - lr: 0.001
0/55 of epoch 11/30 jigsaw : 0.276, class : 0.103, t_rotation : 0.313, entropy : 0.251 - acc jigsaw : 88.28, class : 79.69 [bs:128]
30/55 of epoch 11/30 jigsaw : 0.274, class : 0.067, t_rotation : 0.237, entropy : 0.266 - acc jigsaw : 91.41, class : 74.22 [bs:128]
Accuracies on val: jigsaw : 96.60, class : 92.94
--------------------------------------------------------
Accuracies on test: jigsaw : 95.07, class : 89.40
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 11
New epoch - lr: 0.001
0/55 of epoch 12/30 jigsaw : 0.243, class : 0.075, t_rotation : 0.420, entropy : 0.222 - acc jigsaw : 93.75, class : 71.88 [bs:128]
30/55 of epoch 12/30 jigsaw : 0.271, class : 0.179, t_rotation : 0.256, entropy : 0.254 - acc jigsaw : 90.62, class : 72.66 [bs:128]
Accuracies on val: jigsaw : 95.84, class : 93.44
--------------------------------------------------------
Accuracies on test: jigsaw : 95.41, class : 89.60
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 12
New epoch - lr: 0.001
0/55 of epoch 13/30 jigsaw : 0.242, class : 0.022, t_rotation : 0.340, entropy : 0.294 - acc jigsaw : 89.84, class : 75.00 [bs:128]
30/55 of epoch 13/30 jigsaw : 0.218, class : 0.107, t_rotation : 0.174, entropy : 0.205 - acc jigsaw : 92.97, class : 68.75 [bs:128]
Accuracies on val: jigsaw : 94.33, class : 92.69
--------------------------------------------------------
Accuracies on test: jigsaw : 95.70, class : 90.14
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 13
New epoch - lr: 0.001
0/55 of epoch 14/30 jigsaw : 0.176, class : 0.066, t_rotation : 0.193, entropy : 0.256 - acc jigsaw : 92.97, class : 67.97 [bs:128]
30/55 of epoch 14/30 jigsaw : 0.222, class : 0.059, t_rotation : 0.119, entropy : 0.200 - acc jigsaw : 89.84, class : 76.56 [bs:128]
Accuracies on val: jigsaw : 95.33, class : 91.42
--------------------------------------------------------
Accuracies on test: jigsaw : 96.53, class : 90.19
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 14
New epoch - lr: 0.001
0/55 of epoch 15/30 jigsaw : 0.129, class : 0.081, t_rotation : 0.362, entropy : 0.234 - acc jigsaw : 95.31, class : 75.78 [bs:128]
30/55 of epoch 15/30 jigsaw : 0.163, class : 0.166, t_rotation : 0.135, entropy : 0.168 - acc jigsaw : 95.31, class : 75.78 [bs:128]
Accuracies on val: jigsaw : 94.96, class : 93.44
--------------------------------------------------------
Accuracies on test: jigsaw : 96.19, class : 90.48
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 15
New epoch - lr: 0.001
0/55 of epoch 16/30 jigsaw : 0.168, class : 0.120, t_rotation : 0.340, entropy : 0.162 - acc jigsaw : 95.31, class : 75.00 [bs:128]
30/55 of epoch 16/30 jigsaw : 0.248, class : 0.111, t_rotation : 0.198, entropy : 0.138 - acc jigsaw : 92.19, class : 69.53 [bs:128]
Accuracies on val: jigsaw : 96.60, class : 92.69
--------------------------------------------------------
Accuracies on test: jigsaw : 97.80, class : 90.87
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 16
New epoch - lr: 0.001
0/55 of epoch 17/30 jigsaw : 0.214, class : 0.034, t_rotation : 0.187, entropy : 0.199 - acc jigsaw : 92.19, class : 74.22 [bs:128]
30/55 of epoch 17/30 jigsaw : 0.134, class : 0.074, t_rotation : 0.184, entropy : 0.133 - acc jigsaw : 93.75, class : 74.22 [bs:128]
Accuracies on val: jigsaw : 95.71, class : 93.19
--------------------------------------------------------
Accuracies on test: jigsaw : 97.46, class : 90.23
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 17
New epoch - lr: 0.001
0/55 of epoch 18/30 jigsaw : 0.302, class : 0.058, t_rotation : 0.229, entropy : 0.198 - acc jigsaw : 86.72, class : 78.91 [bs:128]
30/55 of epoch 18/30 jigsaw : 0.232, class : 0.056, t_rotation : 0.142, entropy : 0.205 - acc jigsaw : 88.28, class : 79.69 [bs:128]
Accuracies on val: jigsaw : 95.84, class : 93.06
--------------------------------------------------------
Accuracies on test: jigsaw : 96.58, class : 90.28
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 18
New epoch - lr: 0.001
0/55 of epoch 19/30 jigsaw : 0.234, class : 0.091, t_rotation : 0.276, entropy : 0.170 - acc jigsaw : 92.19, class : 75.00 [bs:128]
30/55 of epoch 19/30 jigsaw : 0.200, class : 0.117, t_rotation : 0.097, entropy : 0.113 - acc jigsaw : 94.53, class : 75.00 [bs:128]
Accuracies on val: jigsaw : 95.84, class : 94.20
--------------------------------------------------------
Accuracies on test: jigsaw : 97.71, class : 90.19
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 19
New epoch - lr: 0.001
0/55 of epoch 20/30 jigsaw : 0.281, class : 0.063, t_rotation : 0.285, entropy : 0.168 - acc jigsaw : 92.19, class : 67.19 [bs:128]
30/55 of epoch 20/30 jigsaw : 0.156, class : 0.125, t_rotation : 0.157, entropy : 0.133 - acc jigsaw : 92.97, class : 68.75 [bs:128]
Accuracies on val: jigsaw : 96.34, class : 94.70
--------------------------------------------------------
Accuracies on test: jigsaw : 97.17, class : 90.82
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 20
New epoch - lr: 0.001
0/55 of epoch 21/30 jigsaw : 0.164, class : 0.123, t_rotation : 0.238, entropy : 0.166 - acc jigsaw : 92.97, class : 71.88 [bs:128]
30/55 of epoch 21/30 jigsaw : 0.102, class : 0.061, t_rotation : 0.147, entropy : 0.194 - acc jigsaw : 96.88, class : 80.47 [bs:128]
Accuracies on val: jigsaw : 94.96, class : 94.20
--------------------------------------------------------
Accuracies on test: jigsaw : 97.75, class : 91.06
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 21
New epoch - lr: 0.001
0/55 of epoch 22/30 jigsaw : 0.149, class : 0.070, t_rotation : 0.261, entropy : 0.230 - acc jigsaw : 93.75, class : 75.78 [bs:128]
30/55 of epoch 22/30 jigsaw : 0.213, class : 0.055, t_rotation : 0.118, entropy : 0.126 - acc jigsaw : 92.97, class : 78.12 [bs:128]
Accuracies on val: jigsaw : 95.96, class : 94.20
--------------------------------------------------------
Accuracies on test: jigsaw : 98.05, class : 90.72
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 22
New epoch - lr: 0.001
0/55 of epoch 23/30 jigsaw : 0.114, class : 0.041, t_rotation : 0.191, entropy : 0.122 - acc jigsaw : 95.31, class : 71.88 [bs:128]
30/55 of epoch 23/30 jigsaw : 0.128, class : 0.110, t_rotation : 0.100, entropy : 0.122 - acc jigsaw : 95.31, class : 75.78 [bs:128]
Accuracies on val: jigsaw : 96.85, class : 94.20
--------------------------------------------------------
Accuracies on test: jigsaw : 98.39, class : 91.11
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 23
New epoch - lr: 0.0001
0/55 of epoch 24/30 jigsaw : 0.097, class : 0.049, t_rotation : 0.135, entropy : 0.134 - acc jigsaw : 96.09, class : 76.56 [bs:128]
30/55 of epoch 24/30 jigsaw : 0.217, class : 0.076, t_rotation : 0.213, entropy : 0.136 - acc jigsaw : 91.41, class : 82.03 [bs:128]
Accuracies on val: jigsaw : 96.72, class : 94.07
--------------------------------------------------------
Accuracies on test: jigsaw : 98.24, class : 90.82
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 24
New epoch - lr: 0.0001
0/55 of epoch 25/30 jigsaw : 0.184, class : 0.069, t_rotation : 0.146, entropy : 0.090 - acc jigsaw : 92.97, class : 75.00 [bs:128]
30/55 of epoch 25/30 jigsaw : 0.204, class : 0.040, t_rotation : 0.137, entropy : 0.067 - acc jigsaw : 93.75, class : 74.22 [bs:128]
Accuracies on val: jigsaw : 96.72, class : 94.07
--------------------------------------------------------
Accuracies on test: jigsaw : 98.29, class : 91.36
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 25
New epoch - lr: 0.0001
0/55 of epoch 26/30 jigsaw : 0.275, class : 0.022, t_rotation : 0.173, entropy : 0.091 - acc jigsaw : 89.84, class : 78.12 [bs:128]
30/55 of epoch 26/30 jigsaw : 0.102, class : 0.070, t_rotation : 0.135, entropy : 0.081 - acc jigsaw : 97.66, class : 75.78 [bs:128]
Accuracies on val: jigsaw : 96.72, class : 94.07
--------------------------------------------------------
Accuracies on test: jigsaw : 98.54, class : 91.06
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 26
New epoch - lr: 0.0001
0/55 of epoch 27/30 jigsaw : 0.142, class : 0.025, t_rotation : 0.259, entropy : 0.132 - acc jigsaw : 95.31, class : 78.91 [bs:128]
30/55 of epoch 27/30 jigsaw : 0.173, class : 0.072, t_rotation : 0.134, entropy : 0.114 - acc jigsaw : 93.75, class : 80.47 [bs:128]
Accuracies on val: jigsaw : 96.34, class : 93.95
--------------------------------------------------------
Accuracies on test: jigsaw : 98.19, class : 91.46
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 27
New epoch - lr: 0.0001
0/55 of epoch 28/30 jigsaw : 0.202, class : 0.007, t_rotation : 0.117, entropy : 0.131 - acc jigsaw : 94.53, class : 73.44 [bs:128]
30/55 of epoch 28/30 jigsaw : 0.197, class : 0.019, t_rotation : 0.073, entropy : 0.111 - acc jigsaw : 92.97, class : 79.69 [bs:128]
Accuracies on val: jigsaw : 96.85, class : 94.33
--------------------------------------------------------
Accuracies on test: jigsaw : 98.68, class : 91.55
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 28
New epoch - lr: 0.0001
0/55 of epoch 29/30 jigsaw : 0.106, class : 0.057, t_rotation : 0.150, entropy : 0.089 - acc jigsaw : 97.66, class : 80.47 [bs:128]
30/55 of epoch 29/30 jigsaw : 0.124, class : 0.045, t_rotation : 0.177, entropy : 0.094 - acc jigsaw : 96.88, class : 71.88 [bs:128]
Accuracies on val: jigsaw : 96.47, class : 94.20
--------------------------------------------------------
Accuracies on test: jigsaw : 98.39, class : 91.65
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 29
New epoch - lr: 0.0001
0/55 of epoch 30/30 jigsaw : 0.155, class : 0.020, t_rotation : 0.140, entropy : 0.142 - acc jigsaw : 95.31, class : 70.31 [bs:128]
30/55 of epoch 30/30 jigsaw : 0.084, class : 0.032, t_rotation : 0.194, entropy : 0.143 - acc jigsaw : 97.66, class : 78.12 [bs:128]
Accuracies on val: jigsaw : 96.72, class : 94.33
--------------------------------------------------------
Accuracies on test: jigsaw : 98.19, class : 91.31
--------------------------------------------------------
2019-12-16 05:03:09
art_painting
['photo', 'sketch', 'cartoon']
unsupervised_task_weight: 0.8
bias_hole_image: 0.4
target_rotation_weight: 0.8
entropy_weight 0.2
only_classify the ordered image: True
Highest accuracy on validation set appears on epoch  tensor(19)
Highest accuracy on test set appears on epoch  tensor(28)
Accuracy on test set when the accuracy on validation set is highest:0.908
Highest accuracy on test set:0.917
It took 1878.04
--------------------------------------------------------
******************Start training**************************************
--------------------------------------------------------
Dataset size: training 7150, validation 793, testing 2048
--------------------------------------------------------
Namespace(TTA=False, batch_size=128, bias_whole_image=0.4, classify_only_ordered_images_or_not=True, domains_list=['photo', 'sketch', 'cartoon', 'art_painting'], entropy_loss_weight=0.2, epochs=30, folder_name='test', image_size=222, jitter=0.4, learning_rate=0.001, limit_source=None, limit_target=None, max_scale=1.0, min_scale=0.8, n_classes=7, nesterov=False, network='resnet18', ooo_weight=0, parameters_lists=[[0.8, 0.4, 0.8, 0.2], [0.8, 0.4, 0.8, 0.3], [0.8, 0.4, 0.8, 0.4]], random_horiz_flip=0.5, repeat_times=3, source=['photo', 'sketch', 'cartoon'], suffix='', target='art_painting', target_domain_list=['art_painting', 'cartoon', 'sketch', 'photo'], target_domain_unsupervised_task_loss_weight=0.8, tf_logger=True, tile_random_grayscale=0.1, train_all=True, unsupervised_task_weight=0.8, val_size=0.1)
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 0
New epoch - lr: 0.001
0/55 of epoch 1/30 jigsaw : 1.842, class : 2.179, t_rotation : 1.887, entropy : 1.725 - acc jigsaw : 14.84, class : 19.53 [bs:128]
30/55 of epoch 1/30 jigsaw : 0.951, class : 1.287, t_rotation : 0.987, entropy : 1.747 - acc jigsaw : 64.06, class : 46.09 [bs:128]
Accuracies on val: jigsaw : 94.07, class : 69.48
--------------------------------------------------------
Accuracies on test: jigsaw : 89.94, class : 63.53
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 1
New epoch - lr: 0.001
0/55 of epoch 2/30 jigsaw : 0.753, class : 0.768, t_rotation : 0.928, entropy : 1.497 - acc jigsaw : 65.62, class : 64.06 [bs:128]
30/55 of epoch 2/30 jigsaw : 0.688, class : 0.558, t_rotation : 0.764, entropy : 1.122 - acc jigsaw : 72.66, class : 71.09 [bs:128]
Accuracies on val: jigsaw : 93.95, class : 81.08
--------------------------------------------------------
Accuracies on test: jigsaw : 89.99, class : 73.78
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 2
New epoch - lr: 0.001
0/55 of epoch 3/30 jigsaw : 0.635, class : 0.455, t_rotation : 0.602, entropy : 0.872 - acc jigsaw : 79.69, class : 69.53 [bs:128]
30/55 of epoch 3/30 jigsaw : 0.469, class : 0.460, t_rotation : 0.580, entropy : 0.665 - acc jigsaw : 83.59, class : 71.09 [bs:128]
Accuracies on val: jigsaw : 95.21, class : 86.13
--------------------------------------------------------
Accuracies on test: jigsaw : 93.85, class : 78.86
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 3
New epoch - lr: 0.001
0/55 of epoch 4/30 jigsaw : 0.467, class : 0.315, t_rotation : 0.673, entropy : 0.786 - acc jigsaw : 85.16, class : 68.75 [bs:128]
30/55 of epoch 4/30 jigsaw : 0.460, class : 0.226, t_rotation : 0.542, entropy : 0.511 - acc jigsaw : 82.03, class : 79.69 [bs:128]
Accuracies on val: jigsaw : 96.09, class : 84.99
--------------------------------------------------------
Accuracies on test: jigsaw : 94.04, class : 82.76
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 4
New epoch - lr: 0.001
0/55 of epoch 5/30 jigsaw : 0.407, class : 0.402, t_rotation : 0.564, entropy : 0.584 - acc jigsaw : 85.94, class : 74.22 [bs:128]
30/55 of epoch 5/30 jigsaw : 0.450, class : 0.261, t_rotation : 0.423, entropy : 0.521 - acc jigsaw : 85.16, class : 69.53 [bs:128]
Accuracies on val: jigsaw : 95.96, class : 87.39
--------------------------------------------------------
Accuracies on test: jigsaw : 92.82, class : 84.18
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 5
New epoch - lr: 0.001
0/55 of epoch 6/30 jigsaw : 0.387, class : 0.164, t_rotation : 0.487, entropy : 0.415 - acc jigsaw : 87.50, class : 78.91 [bs:128]
30/55 of epoch 6/30 jigsaw : 0.363, class : 0.255, t_rotation : 0.360, entropy : 0.458 - acc jigsaw : 89.06, class : 71.88 [bs:128]
Accuracies on val: jigsaw : 96.09, class : 88.40
--------------------------------------------------------
Accuracies on test: jigsaw : 93.80, class : 86.08
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 6
New epoch - lr: 0.001
0/55 of epoch 7/30 jigsaw : 0.405, class : 0.130, t_rotation : 0.446, entropy : 0.340 - acc jigsaw : 88.28, class : 83.59 [bs:128]
30/55 of epoch 7/30 jigsaw : 0.374, class : 0.173, t_rotation : 0.356, entropy : 0.320 - acc jigsaw : 86.72, class : 71.09 [bs:128]
Accuracies on val: jigsaw : 96.97, class : 90.04
--------------------------------------------------------
Accuracies on test: jigsaw : 95.21, class : 87.89
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 7
New epoch - lr: 0.001
0/55 of epoch 8/30 jigsaw : 0.231, class : 0.099, t_rotation : 0.449, entropy : 0.401 - acc jigsaw : 94.53, class : 73.44 [bs:128]
30/55 of epoch 8/30 jigsaw : 0.323, class : 0.196, t_rotation : 0.298, entropy : 0.376 - acc jigsaw : 88.28, class : 71.88 [bs:128]
Accuracies on val: jigsaw : 96.47, class : 90.54
--------------------------------------------------------
Accuracies on test: jigsaw : 94.68, class : 87.70
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 8
New epoch - lr: 0.001
0/55 of epoch 9/30 jigsaw : 0.288, class : 0.289, t_rotation : 0.410, entropy : 0.266 - acc jigsaw : 87.50, class : 71.88 [bs:128]
30/55 of epoch 9/30 jigsaw : 0.318, class : 0.209, t_rotation : 0.334, entropy : 0.329 - acc jigsaw : 86.72, class : 73.44 [bs:128]
Accuracies on val: jigsaw : 96.97, class : 90.54
--------------------------------------------------------
Accuracies on test: jigsaw : 96.34, class : 88.18
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 9
New epoch - lr: 0.001
0/55 of epoch 10/30 jigsaw : 0.248, class : 0.083, t_rotation : 0.332, entropy : 0.338 - acc jigsaw : 92.97, class : 73.44 [bs:128]
30/55 of epoch 10/30 jigsaw : 0.201, class : 0.105, t_rotation : 0.255, entropy : 0.214 - acc jigsaw : 93.75, class : 71.09 [bs:128]
Accuracies on val: jigsaw : 95.96, class : 91.17
--------------------------------------------------------
Accuracies on test: jigsaw : 95.07, class : 87.94
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 10
New epoch - lr: 0.001
0/55 of epoch 11/30 jigsaw : 0.262, class : 0.118, t_rotation : 0.417, entropy : 0.271 - acc jigsaw : 89.84, class : 81.25 [bs:128]
30/55 of epoch 11/30 jigsaw : 0.287, class : 0.084, t_rotation : 0.275, entropy : 0.217 - acc jigsaw : 89.84, class : 78.12 [bs:128]
Accuracies on val: jigsaw : 96.72, class : 91.55
--------------------------------------------------------
Accuracies on test: jigsaw : 96.53, class : 88.38
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 11
New epoch - lr: 0.001
0/55 of epoch 12/30 jigsaw : 0.163, class : 0.129, t_rotation : 0.303, entropy : 0.204 - acc jigsaw : 93.75, class : 78.91 [bs:128]
30/55 of epoch 12/30 jigsaw : 0.253, class : 0.145, t_rotation : 0.237, entropy : 0.195 - acc jigsaw : 92.19, class : 78.12 [bs:128]
Accuracies on val: jigsaw : 95.08, class : 91.30
--------------------------------------------------------
Accuracies on test: jigsaw : 96.39, class : 89.50
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 12
New epoch - lr: 0.001
0/55 of epoch 13/30 jigsaw : 0.282, class : 0.094, t_rotation : 0.399, entropy : 0.246 - acc jigsaw : 90.62, class : 79.69 [bs:128]
30/55 of epoch 13/30 jigsaw : 0.200, class : 0.104, t_rotation : 0.204, entropy : 0.192 - acc jigsaw : 93.75, class : 72.66 [bs:128]
Accuracies on val: jigsaw : 96.47, class : 90.42
--------------------------------------------------------
Accuracies on test: jigsaw : 96.24, class : 89.26
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 13
New epoch - lr: 0.001
0/55 of epoch 14/30 jigsaw : 0.163, class : 0.101, t_rotation : 0.272, entropy : 0.195 - acc jigsaw : 94.53, class : 67.19 [bs:128]
30/55 of epoch 14/30 jigsaw : 0.318, class : 0.102, t_rotation : 0.220, entropy : 0.162 - acc jigsaw : 86.72, class : 77.34 [bs:128]
Accuracies on val: jigsaw : 95.21, class : 91.68
--------------------------------------------------------
Accuracies on test: jigsaw : 96.24, class : 89.70
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 14
New epoch - lr: 0.001
0/55 of epoch 15/30 jigsaw : 0.309, class : 0.123, t_rotation : 0.445, entropy : 0.318 - acc jigsaw : 89.06, class : 69.53 [bs:128]
30/55 of epoch 15/30 jigsaw : 0.128, class : 0.090, t_rotation : 0.155, entropy : 0.158 - acc jigsaw : 96.09, class : 78.12 [bs:128]
Accuracies on val: jigsaw : 96.60, class : 91.55
--------------------------------------------------------
Accuracies on test: jigsaw : 97.36, class : 89.84
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 15
New epoch - lr: 0.001
0/55 of epoch 16/30 jigsaw : 0.223, class : 0.095, t_rotation : 0.254, entropy : 0.200 - acc jigsaw : 90.62, class : 81.25 [bs:128]
30/55 of epoch 16/30 jigsaw : 0.246, class : 0.160, t_rotation : 0.203, entropy : 0.111 - acc jigsaw : 92.97, class : 77.34 [bs:128]
Accuracies on val: jigsaw : 95.59, class : 92.06
--------------------------------------------------------
Accuracies on test: jigsaw : 97.71, class : 89.45
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 16
New epoch - lr: 0.001
0/55 of epoch 17/30 jigsaw : 0.200, class : 0.142, t_rotation : 0.183, entropy : 0.191 - acc jigsaw : 93.75, class : 70.31 [bs:128]
30/55 of epoch 17/30 jigsaw : 0.237, class : 0.048, t_rotation : 0.145, entropy : 0.206 - acc jigsaw : 91.41, class : 81.25 [bs:128]
Accuracies on val: jigsaw : 96.09, class : 91.93
--------------------------------------------------------
Accuracies on test: jigsaw : 96.92, class : 89.31
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 17
New epoch - lr: 0.001
0/55 of epoch 18/30 jigsaw : 0.295, class : 0.103, t_rotation : 0.271, entropy : 0.213 - acc jigsaw : 89.84, class : 70.31 [bs:128]
30/55 of epoch 18/30 jigsaw : 0.181, class : 0.096, t_rotation : 0.102, entropy : 0.152 - acc jigsaw : 92.19, class : 77.34 [bs:128]
Accuracies on val: jigsaw : 96.22, class : 92.69
--------------------------------------------------------
Accuracies on test: jigsaw : 97.80, class : 89.70
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 18
New epoch - lr: 0.001
0/55 of epoch 19/30 jigsaw : 0.187, class : 0.105, t_rotation : 0.266, entropy : 0.150 - acc jigsaw : 92.97, class : 78.91 [bs:128]
30/55 of epoch 19/30 jigsaw : 0.169, class : 0.046, t_rotation : 0.096, entropy : 0.143 - acc jigsaw : 93.75, class : 75.78 [bs:128]
Accuracies on val: jigsaw : 96.34, class : 93.06
--------------------------------------------------------
Accuracies on test: jigsaw : 97.41, class : 90.14
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 19
New epoch - lr: 0.001
0/55 of epoch 20/30 jigsaw : 0.182, class : 0.042, t_rotation : 0.245, entropy : 0.160 - acc jigsaw : 94.53, class : 76.56 [bs:128]
30/55 of epoch 20/30 jigsaw : 0.198, class : 0.016, t_rotation : 0.191, entropy : 0.117 - acc jigsaw : 92.97, class : 75.78 [bs:128]
Accuracies on val: jigsaw : 95.71, class : 93.57
--------------------------------------------------------
Accuracies on test: jigsaw : 97.71, class : 89.75
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 20
New epoch - lr: 0.001
0/55 of epoch 21/30 jigsaw : 0.126, class : 0.038, t_rotation : 0.219, entropy : 0.143 - acc jigsaw : 96.88, class : 77.34 [bs:128]
30/55 of epoch 21/30 jigsaw : 0.187, class : 0.170, t_rotation : 0.116, entropy : 0.102 - acc jigsaw : 92.19, class : 75.00 [bs:128]
Accuracies on val: jigsaw : 95.59, class : 93.69
--------------------------------------------------------
Accuracies on test: jigsaw : 97.17, class : 90.04
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 21
New epoch - lr: 0.001
0/55 of epoch 22/30 jigsaw : 0.158, class : 0.071, t_rotation : 0.123, entropy : 0.138 - acc jigsaw : 96.09, class : 77.34 [bs:128]
30/55 of epoch 22/30 jigsaw : 0.161, class : 0.060, t_rotation : 0.165, entropy : 0.118 - acc jigsaw : 95.31, class : 77.34 [bs:128]
Accuracies on val: jigsaw : 96.09, class : 93.57
--------------------------------------------------------
Accuracies on test: jigsaw : 97.61, class : 90.43
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 22
New epoch - lr: 0.001
0/55 of epoch 23/30 jigsaw : 0.151, class : 0.048, t_rotation : 0.227, entropy : 0.176 - acc jigsaw : 92.97, class : 79.69 [bs:128]
30/55 of epoch 23/30 jigsaw : 0.184, class : 0.109, t_rotation : 0.151, entropy : 0.120 - acc jigsaw : 92.97, class : 72.66 [bs:128]
Accuracies on val: jigsaw : 95.08, class : 93.82
--------------------------------------------------------
Accuracies on test: jigsaw : 96.92, class : 90.09
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 23
New epoch - lr: 0.0001
0/55 of epoch 24/30 jigsaw : 0.138, class : 0.109, t_rotation : 0.250, entropy : 0.120 - acc jigsaw : 94.53, class : 74.22 [bs:128]
30/55 of epoch 24/30 jigsaw : 0.242, class : 0.063, t_rotation : 0.125, entropy : 0.141 - acc jigsaw : 90.62, class : 79.69 [bs:128]
Accuracies on val: jigsaw : 95.46, class : 93.57
--------------------------------------------------------
Accuracies on test: jigsaw : 97.75, class : 90.19
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 24
New epoch - lr: 0.0001
0/55 of epoch 25/30 jigsaw : 0.207, class : 0.015, t_rotation : 0.260, entropy : 0.141 - acc jigsaw : 95.31, class : 81.25 [bs:128]
30/55 of epoch 25/30 jigsaw : 0.251, class : 0.054, t_rotation : 0.166, entropy : 0.110 - acc jigsaw : 92.97, class : 78.12 [bs:128]
Accuracies on val: jigsaw : 96.72, class : 93.57
--------------------------------------------------------
Accuracies on test: jigsaw : 98.19, class : 90.23
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 25
New epoch - lr: 0.0001
0/55 of epoch 26/30 jigsaw : 0.254, class : 0.114, t_rotation : 0.293, entropy : 0.101 - acc jigsaw : 92.19, class : 71.88 [bs:128]
30/55 of epoch 26/30 jigsaw : 0.114, class : 0.029, t_rotation : 0.185, entropy : 0.111 - acc jigsaw : 96.09, class : 72.66 [bs:128]
Accuracies on val: jigsaw : 96.60, class : 93.69
--------------------------------------------------------
Accuracies on test: jigsaw : 97.90, class : 90.23
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 26
New epoch - lr: 0.0001
0/55 of epoch 27/30 jigsaw : 0.193, class : 0.037, t_rotation : 0.154, entropy : 0.080 - acc jigsaw : 94.53, class : 67.97 [bs:128]
30/55 of epoch 27/30 jigsaw : 0.181, class : 0.028, t_rotation : 0.187, entropy : 0.094 - acc jigsaw : 92.97, class : 75.78 [bs:128]
Accuracies on val: jigsaw : 96.60, class : 94.20
--------------------------------------------------------
Accuracies on test: jigsaw : 98.05, class : 90.62
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 27
New epoch - lr: 0.0001
0/55 of epoch 28/30 jigsaw : 0.188, class : 0.040, t_rotation : 0.286, entropy : 0.130 - acc jigsaw : 94.53, class : 80.47 [bs:128]
30/55 of epoch 28/30 jigsaw : 0.111, class : 0.054, t_rotation : 0.173, entropy : 0.134 - acc jigsaw : 95.31, class : 75.78 [bs:128]
Accuracies on val: jigsaw : 96.72, class : 93.57
--------------------------------------------------------
Accuracies on test: jigsaw : 98.14, class : 90.43
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 28
New epoch - lr: 0.0001
0/55 of epoch 29/30 jigsaw : 0.099, class : 0.073, t_rotation : 0.162, entropy : 0.115 - acc jigsaw : 96.88, class : 70.31 [bs:128]
30/55 of epoch 29/30 jigsaw : 0.186, class : 0.039, t_rotation : 0.070, entropy : 0.139 - acc jigsaw : 92.97, class : 83.59 [bs:128]
Accuracies on val: jigsaw : 95.96, class : 93.95
--------------------------------------------------------
Accuracies on test: jigsaw : 98.00, class : 90.53
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 29
New epoch - lr: 0.0001
0/55 of epoch 30/30 jigsaw : 0.187, class : 0.026, t_rotation : 0.278, entropy : 0.128 - acc jigsaw : 92.19, class : 78.12 [bs:128]
30/55 of epoch 30/30 jigsaw : 0.148, class : 0.052, t_rotation : 0.154, entropy : 0.096 - acc jigsaw : 94.53, class : 82.81 [bs:128]
Accuracies on val: jigsaw : 96.34, class : 94.07
--------------------------------------------------------
Accuracies on test: jigsaw : 98.00, class : 90.53
--------------------------------------------------------
2019-12-16 05:34:00
art_painting
['photo', 'sketch', 'cartoon']
unsupervised_task_weight: 0.8
bias_hole_image: 0.4
target_rotation_weight: 0.8
entropy_weight 0.2
only_classify the ordered image: True
Highest accuracy on validation set appears on epoch  tensor(26)
Highest accuracy on test set appears on epoch  tensor(26)
Accuracy on test set when the accuracy on validation set is highest:0.906
Highest accuracy on test set:0.906
It took 1850.54
--------------------------------------------------------
******************Start training**************************************
--------------------------------------------------------
Dataset size: training 6884, validation 763, testing 2344
--------------------------------------------------------
Namespace(TTA=False, batch_size=128, bias_whole_image=0.4, classify_only_ordered_images_or_not=True, domains_list=['photo', 'sketch', 'cartoon', 'art_painting'], entropy_loss_weight=0.2, epochs=30, folder_name='test', image_size=222, jitter=0.4, learning_rate=0.001, limit_source=None, limit_target=None, max_scale=1.0, min_scale=0.8, n_classes=7, nesterov=False, network='resnet18', ooo_weight=0, parameters_lists=[[0.8, 0.4, 0.8, 0.2], [0.8, 0.4, 0.8, 0.3], [0.8, 0.4, 0.8, 0.4]], random_horiz_flip=0.5, repeat_times=3, source=['photo', 'sketch', 'art_painting'], suffix='', target='cartoon', target_domain_list=['art_painting', 'cartoon', 'sketch', 'photo'], target_domain_unsupervised_task_loss_weight=0.8, tf_logger=True, tile_random_grayscale=0.1, train_all=True, unsupervised_task_weight=0.8, val_size=0.1)
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 0
New epoch - lr: 0.001
0/53 of epoch 1/30 jigsaw : 1.528, class : 2.200, t_rotation : 1.461, entropy : 1.766 - acc jigsaw : 22.66, class : 9.38 [bs:128]
30/53 of epoch 1/30 jigsaw : 1.042, class : 1.209, t_rotation : 0.969, entropy : 1.703 - acc jigsaw : 57.03, class : 50.00 [bs:128]
Accuracies on val: jigsaw : 93.97, class : 77.98
--------------------------------------------------------
Accuracies on test: jigsaw : 95.56, class : 56.14
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 1
New epoch - lr: 0.001
0/53 of epoch 2/30 jigsaw : 0.863, class : 0.839, t_rotation : 0.854, entropy : 1.410 - acc jigsaw : 65.62, class : 62.50 [bs:128]
30/53 of epoch 2/30 jigsaw : 0.613, class : 0.527, t_rotation : 0.673, entropy : 1.122 - acc jigsaw : 76.56, class : 67.97 [bs:128]
Accuracies on val: jigsaw : 92.53, class : 87.29
--------------------------------------------------------
Accuracies on test: jigsaw : 97.18, class : 71.20
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 2
New epoch - lr: 0.001
0/53 of epoch 3/30 jigsaw : 0.683, class : 0.397, t_rotation : 0.516, entropy : 0.861 - acc jigsaw : 71.88, class : 63.28 [bs:128]
30/53 of epoch 3/30 jigsaw : 0.510, class : 0.307, t_rotation : 0.546, entropy : 0.760 - acc jigsaw : 85.94, class : 72.66 [bs:128]
Accuracies on val: jigsaw : 94.89, class : 89.38
--------------------------------------------------------
Accuracies on test: jigsaw : 97.70, class : 74.40
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 3
New epoch - lr: 0.001
0/53 of epoch 4/30 jigsaw : 0.505, class : 0.232, t_rotation : 0.493, entropy : 0.626 - acc jigsaw : 81.25, class : 71.09 [bs:128]
30/53 of epoch 4/30 jigsaw : 0.652, class : 0.239, t_rotation : 0.397, entropy : 0.563 - acc jigsaw : 71.88, class : 75.78 [bs:128]
Accuracies on val: jigsaw : 94.23, class : 90.69
--------------------------------------------------------
Accuracies on test: jigsaw : 97.65, class : 78.46
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 4
New epoch - lr: 0.001
0/53 of epoch 5/30 jigsaw : 0.478, class : 0.237, t_rotation : 0.408, entropy : 0.390 - acc jigsaw : 80.47, class : 67.97 [bs:128]
30/53 of epoch 5/30 jigsaw : 0.485, class : 0.294, t_rotation : 0.357, entropy : 0.588 - acc jigsaw : 78.91, class : 77.34 [bs:128]
Accuracies on val: jigsaw : 93.18, class : 90.69
--------------------------------------------------------
Accuracies on test: jigsaw : 97.35, class : 77.82
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 5
New epoch - lr: 0.001
0/53 of epoch 6/30 jigsaw : 0.479, class : 0.161, t_rotation : 0.373, entropy : 0.410 - acc jigsaw : 81.25, class : 76.56 [bs:128]
30/53 of epoch 6/30 jigsaw : 0.499, class : 0.147, t_rotation : 0.268, entropy : 0.360 - acc jigsaw : 79.69, class : 75.78 [bs:128]
Accuracies on val: jigsaw : 94.50, class : 90.96
--------------------------------------------------------
Accuracies on test: jigsaw : 97.99, class : 80.42
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 6
New epoch - lr: 0.001
0/53 of epoch 7/30 jigsaw : 0.394, class : 0.164, t_rotation : 0.300, entropy : 0.364 - acc jigsaw : 85.94, class : 73.44 [bs:128]
30/53 of epoch 7/30 jigsaw : 0.377, class : 0.147, t_rotation : 0.310, entropy : 0.302 - acc jigsaw : 84.38, class : 76.56 [bs:128]
Accuracies on val: jigsaw : 93.18, class : 92.01
--------------------------------------------------------
Accuracies on test: jigsaw : 98.21, class : 80.08
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 7
New epoch - lr: 0.001
0/53 of epoch 8/30 jigsaw : 0.409, class : 0.222, t_rotation : 0.205, entropy : 0.358 - acc jigsaw : 86.72, class : 72.66 [bs:128]
30/53 of epoch 8/30 jigsaw : 0.337, class : 0.134, t_rotation : 0.223, entropy : 0.349 - acc jigsaw : 87.50, class : 68.75 [bs:128]
Accuracies on val: jigsaw : 92.66, class : 92.27
--------------------------------------------------------
Accuracies on test: jigsaw : 97.65, class : 81.57
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 8
New epoch - lr: 0.001
0/53 of epoch 9/30 jigsaw : 0.389, class : 0.205, t_rotation : 0.223, entropy : 0.413 - acc jigsaw : 85.16, class : 72.66 [bs:128]
30/53 of epoch 9/30 jigsaw : 0.307, class : 0.182, t_rotation : 0.220, entropy : 0.299 - acc jigsaw : 90.62, class : 71.88 [bs:128]
Accuracies on val: jigsaw : 93.45, class : 93.18
--------------------------------------------------------
Accuracies on test: jigsaw : 98.42, class : 81.19
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 9
New epoch - lr: 0.001
0/53 of epoch 10/30 jigsaw : 0.305, class : 0.124, t_rotation : 0.275, entropy : 0.244 - acc jigsaw : 90.62, class : 73.44 [bs:128]
30/53 of epoch 10/30 jigsaw : 0.351, class : 0.071, t_rotation : 0.216, entropy : 0.208 - acc jigsaw : 86.72, class : 80.47 [bs:128]
Accuracies on val: jigsaw : 92.92, class : 93.97
--------------------------------------------------------
Accuracies on test: jigsaw : 97.57, class : 79.82
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 10
New epoch - lr: 0.001
0/53 of epoch 11/30 jigsaw : 0.216, class : 0.133, t_rotation : 0.220, entropy : 0.282 - acc jigsaw : 95.31, class : 76.56 [bs:128]
30/53 of epoch 11/30 jigsaw : 0.304, class : 0.155, t_rotation : 0.147, entropy : 0.237 - acc jigsaw : 88.28, class : 74.22 [bs:128]
Accuracies on val: jigsaw : 94.10, class : 93.97
--------------------------------------------------------
Accuracies on test: jigsaw : 98.81, class : 81.44
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 11
New epoch - lr: 0.001
0/53 of epoch 12/30 jigsaw : 0.248, class : 0.156, t_rotation : 0.154, entropy : 0.232 - acc jigsaw : 90.62, class : 68.75 [bs:128]
30/53 of epoch 12/30 jigsaw : 0.277, class : 0.258, t_rotation : 0.137, entropy : 0.187 - acc jigsaw : 91.41, class : 75.00 [bs:128]
Accuracies on val: jigsaw : 94.50, class : 93.32
--------------------------------------------------------
Accuracies on test: jigsaw : 98.59, class : 81.10
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 12
New epoch - lr: 0.001
0/53 of epoch 13/30 jigsaw : 0.297, class : 0.070, t_rotation : 0.148, entropy : 0.172 - acc jigsaw : 89.84, class : 75.78 [bs:128]
30/53 of epoch 13/30 jigsaw : 0.262, class : 0.083, t_rotation : 0.165, entropy : 0.160 - acc jigsaw : 89.06, class : 75.00 [bs:128]
Accuracies on val: jigsaw : 94.50, class : 93.71
--------------------------------------------------------
Accuracies on test: jigsaw : 98.72, class : 80.50
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 13
New epoch - lr: 0.001
0/53 of epoch 14/30 jigsaw : 0.265, class : 0.118, t_rotation : 0.168, entropy : 0.220 - acc jigsaw : 90.62, class : 75.00 [bs:128]
30/53 of epoch 14/30 jigsaw : 0.141, class : 0.044, t_rotation : 0.142, entropy : 0.221 - acc jigsaw : 93.75, class : 78.91 [bs:128]
Accuracies on val: jigsaw : 93.97, class : 93.45
--------------------------------------------------------
Accuracies on test: jigsaw : 98.55, class : 81.95
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 14
New epoch - lr: 0.001
0/53 of epoch 15/30 jigsaw : 0.276, class : 0.075, t_rotation : 0.123, entropy : 0.295 - acc jigsaw : 91.41, class : 70.31 [bs:128]
30/53 of epoch 15/30 jigsaw : 0.304, class : 0.047, t_rotation : 0.095, entropy : 0.179 - acc jigsaw : 89.06, class : 78.12 [bs:128]
Accuracies on val: jigsaw : 94.10, class : 94.23
--------------------------------------------------------
Accuracies on test: jigsaw : 99.19, class : 81.48
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 15
New epoch - lr: 0.001
0/53 of epoch 16/30 jigsaw : 0.260, class : 0.128, t_rotation : 0.135, entropy : 0.173 - acc jigsaw : 92.97, class : 64.06 [bs:128]
30/53 of epoch 16/30 jigsaw : 0.245, class : 0.128, t_rotation : 0.071, entropy : 0.257 - acc jigsaw : 91.41, class : 76.56 [bs:128]
Accuracies on val: jigsaw : 94.63, class : 94.76
--------------------------------------------------------
Accuracies on test: jigsaw : 99.06, class : 81.87
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 16
New epoch - lr: 0.001
0/53 of epoch 17/30 jigsaw : 0.217, class : 0.134, t_rotation : 0.101, entropy : 0.177 - acc jigsaw : 93.75, class : 78.12 [bs:128]
30/53 of epoch 17/30 jigsaw : 0.315, class : 0.080, t_rotation : 0.086, entropy : 0.128 - acc jigsaw : 86.72, class : 81.25 [bs:128]
Accuracies on val: jigsaw : 96.07, class : 94.10
--------------------------------------------------------
Accuracies on test: jigsaw : 99.36, class : 83.19
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 17
New epoch - lr: 0.001
0/53 of epoch 18/30 jigsaw : 0.232, class : 0.058, t_rotation : 0.174, entropy : 0.199 - acc jigsaw : 90.62, class : 76.56 [bs:128]
30/53 of epoch 18/30 jigsaw : 0.238, class : 0.025, t_rotation : 0.082, entropy : 0.188 - acc jigsaw : 88.28, class : 81.25 [bs:128]
Accuracies on val: jigsaw : 95.28, class : 95.28
--------------------------------------------------------
Accuracies on test: jigsaw : 99.02, class : 81.19
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 18
New epoch - lr: 0.001
0/53 of epoch 19/30 jigsaw : 0.220, class : 0.098, t_rotation : 0.157, entropy : 0.116 - acc jigsaw : 92.19, class : 75.00 [bs:128]
30/53 of epoch 19/30 jigsaw : 0.230, class : 0.045, t_rotation : 0.098, entropy : 0.082 - acc jigsaw : 93.75, class : 72.66 [bs:128]
Accuracies on val: jigsaw : 95.02, class : 94.63
--------------------------------------------------------
Accuracies on test: jigsaw : 98.98, class : 82.81
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 19
New epoch - lr: 0.001
0/53 of epoch 20/30 jigsaw : 0.222, class : 0.028, t_rotation : 0.176, entropy : 0.217 - acc jigsaw : 91.41, class : 72.66 [bs:128]
30/53 of epoch 20/30 jigsaw : 0.220, class : 0.068, t_rotation : 0.078, entropy : 0.147 - acc jigsaw : 92.97, class : 82.03 [bs:128]
Accuracies on val: jigsaw : 94.63, class : 95.15
--------------------------------------------------------
Accuracies on test: jigsaw : 99.10, class : 81.14
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 20
New epoch - lr: 0.001
0/53 of epoch 21/30 jigsaw : 0.189, class : 0.039, t_rotation : 0.174, entropy : 0.166 - acc jigsaw : 93.75, class : 78.12 [bs:128]
30/53 of epoch 21/30 jigsaw : 0.138, class : 0.026, t_rotation : 0.112, entropy : 0.104 - acc jigsaw : 96.88, class : 86.72 [bs:128]
Accuracies on val: jigsaw : 94.89, class : 94.63
--------------------------------------------------------
Accuracies on test: jigsaw : 99.15, class : 81.87
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 21
New epoch - lr: 0.001
0/53 of epoch 22/30 jigsaw : 0.214, class : 0.029, t_rotation : 0.099, entropy : 0.142 - acc jigsaw : 91.41, class : 78.91 [bs:128]
30/53 of epoch 22/30 jigsaw : 0.195, class : 0.015, t_rotation : 0.093, entropy : 0.163 - acc jigsaw : 92.97, class : 77.34 [bs:128]
Accuracies on val: jigsaw : 95.15, class : 94.76
--------------------------------------------------------
Accuracies on test: jigsaw : 99.19, class : 82.25
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 22
New epoch - lr: 0.001
0/53 of epoch 23/30 jigsaw : 0.226, class : 0.048, t_rotation : 0.097, entropy : 0.162 - acc jigsaw : 91.41, class : 71.09 [bs:128]
30/53 of epoch 23/30 jigsaw : 0.204, class : 0.098, t_rotation : 0.104, entropy : 0.061 - acc jigsaw : 92.97, class : 77.34 [bs:128]
Accuracies on val: jigsaw : 95.28, class : 94.10
--------------------------------------------------------
Accuracies on test: jigsaw : 99.49, class : 81.61
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 23
New epoch - lr: 0.0001
0/53 of epoch 24/30 jigsaw : 0.170, class : 0.049, t_rotation : 0.170, entropy : 0.128 - acc jigsaw : 94.53, class : 75.78 [bs:128]
30/53 of epoch 24/30 jigsaw : 0.094, class : 0.060, t_rotation : 0.115, entropy : 0.156 - acc jigsaw : 95.31, class : 77.34 [bs:128]
Accuracies on val: jigsaw : 93.97, class : 95.02
--------------------------------------------------------
Accuracies on test: jigsaw : 99.36, class : 81.10
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 24
New epoch - lr: 0.0001
0/53 of epoch 25/30 jigsaw : 0.187, class : 0.030, t_rotation : 0.104, entropy : 0.090 - acc jigsaw : 90.62, class : 81.25 [bs:128]
30/53 of epoch 25/30 jigsaw : 0.232, class : 0.014, t_rotation : 0.075, entropy : 0.157 - acc jigsaw : 88.28, class : 70.31 [bs:128]
Accuracies on val: jigsaw : 94.76, class : 94.89
--------------------------------------------------------
Accuracies on test: jigsaw : 99.57, class : 81.66
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 25
New epoch - lr: 0.0001
0/53 of epoch 26/30 jigsaw : 0.221, class : 0.031, t_rotation : 0.128, entropy : 0.186 - acc jigsaw : 90.62, class : 76.56 [bs:128]
30/53 of epoch 26/30 jigsaw : 0.156, class : 0.041, t_rotation : 0.072, entropy : 0.138 - acc jigsaw : 93.75, class : 71.09 [bs:128]
Accuracies on val: jigsaw : 95.54, class : 95.02
--------------------------------------------------------
Accuracies on test: jigsaw : 99.57, class : 81.61
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 26
New epoch - lr: 0.0001
0/53 of epoch 27/30 jigsaw : 0.223, class : 0.037, t_rotation : 0.081, entropy : 0.145 - acc jigsaw : 90.62, class : 78.12 [bs:128]
30/53 of epoch 27/30 jigsaw : 0.235, class : 0.050, t_rotation : 0.108, entropy : 0.230 - acc jigsaw : 91.41, class : 83.59 [bs:128]
Accuracies on val: jigsaw : 95.28, class : 94.89
--------------------------------------------------------
Accuracies on test: jigsaw : 99.53, class : 81.78
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 27
New epoch - lr: 0.0001
0/53 of epoch 28/30 jigsaw : 0.223, class : 0.020, t_rotation : 0.167, entropy : 0.111 - acc jigsaw : 91.41, class : 78.12 [bs:128]
30/53 of epoch 28/30 jigsaw : 0.189, class : 0.008, t_rotation : 0.148, entropy : 0.132 - acc jigsaw : 91.41, class : 76.56 [bs:128]
Accuracies on val: jigsaw : 95.81, class : 95.02
--------------------------------------------------------
Accuracies on test: jigsaw : 99.57, class : 81.74
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 28
New epoch - lr: 0.0001
0/53 of epoch 29/30 jigsaw : 0.255, class : 0.030, t_rotation : 0.120, entropy : 0.082 - acc jigsaw : 91.41, class : 80.47 [bs:128]
30/53 of epoch 29/30 jigsaw : 0.152, class : 0.022, t_rotation : 0.157, entropy : 0.104 - acc jigsaw : 94.53, class : 76.56 [bs:128]
Accuracies on val: jigsaw : 95.15, class : 94.63
--------------------------------------------------------
Accuracies on test: jigsaw : 99.45, class : 82.08
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 29
New epoch - lr: 0.0001
0/53 of epoch 30/30 jigsaw : 0.140, class : 0.048, t_rotation : 0.161, entropy : 0.147 - acc jigsaw : 94.53, class : 78.91 [bs:128]
30/53 of epoch 30/30 jigsaw : 0.086, class : 0.014, t_rotation : 0.051, entropy : 0.081 - acc jigsaw : 98.44, class : 75.78 [bs:128]
Accuracies on val: jigsaw : 95.54, class : 94.50
--------------------------------------------------------
Accuracies on test: jigsaw : 99.57, class : 82.00
--------------------------------------------------------
2019-12-16 05:57:00
cartoon
['photo', 'sketch', 'art_painting']
unsupervised_task_weight: 0.8
bias_hole_image: 0.4
target_rotation_weight: 0.8
entropy_weight 0.2
only_classify the ordered image: True
Highest accuracy on validation set appears on epoch  tensor(17)
Highest accuracy on test set appears on epoch  tensor(16)
Accuracy on test set when the accuracy on validation set is highest:0.812
Highest accuracy on test set:0.832
It took 1379.36
--------------------------------------------------------
******************Start training**************************************
--------------------------------------------------------
Dataset size: training 6884, validation 763, testing 2344
--------------------------------------------------------
Namespace(TTA=False, batch_size=128, bias_whole_image=0.4, classify_only_ordered_images_or_not=True, domains_list=['photo', 'sketch', 'cartoon', 'art_painting'], entropy_loss_weight=0.2, epochs=30, folder_name='test', image_size=222, jitter=0.4, learning_rate=0.001, limit_source=None, limit_target=None, max_scale=1.0, min_scale=0.8, n_classes=7, nesterov=False, network='resnet18', ooo_weight=0, parameters_lists=[[0.8, 0.4, 0.8, 0.2], [0.8, 0.4, 0.8, 0.3], [0.8, 0.4, 0.8, 0.4]], random_horiz_flip=0.5, repeat_times=3, source=['photo', 'sketch', 'art_painting'], suffix='', target='cartoon', target_domain_list=['art_painting', 'cartoon', 'sketch', 'photo'], target_domain_unsupervised_task_loss_weight=0.8, tf_logger=True, tile_random_grayscale=0.1, train_all=True, unsupervised_task_weight=0.8, val_size=0.1)
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 0
New epoch - lr: 0.001
0/53 of epoch 1/30 jigsaw : 1.691, class : 2.234, t_rotation : 1.640, entropy : 1.738 - acc jigsaw : 11.72, class : 14.84 [bs:128]
30/53 of epoch 1/30 jigsaw : 1.076, class : 1.259, t_rotation : 1.013, entropy : 1.695 - acc jigsaw : 53.91, class : 54.69 [bs:128]
Accuracies on val: jigsaw : 97.12, class : 76.15
--------------------------------------------------------
Accuracies on test: jigsaw : 96.80, class : 56.27
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 1
New epoch - lr: 0.001
0/53 of epoch 2/30 jigsaw : 0.854, class : 0.827, t_rotation : 0.986, entropy : 1.450 - acc jigsaw : 62.50, class : 56.25 [bs:128]
30/53 of epoch 2/30 jigsaw : 0.739, class : 0.623, t_rotation : 0.647, entropy : 1.158 - acc jigsaw : 71.09, class : 60.94 [bs:128]
Accuracies on val: jigsaw : 93.84, class : 83.22
--------------------------------------------------------
Accuracies on test: jigsaw : 96.29, class : 68.43
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 2
New epoch - lr: 0.001
0/53 of epoch 3/30 jigsaw : 0.694, class : 0.386, t_rotation : 0.703, entropy : 0.868 - acc jigsaw : 73.44, class : 67.97 [bs:128]
30/53 of epoch 3/30 jigsaw : 0.644, class : 0.282, t_rotation : 0.535, entropy : 0.825 - acc jigsaw : 75.78, class : 71.88 [bs:128]
Accuracies on val: jigsaw : 93.18, class : 87.81
--------------------------------------------------------
Accuracies on test: jigsaw : 96.03, class : 71.84
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 3
New epoch - lr: 0.001
0/53 of epoch 4/30 jigsaw : 0.588, class : 0.247, t_rotation : 0.471, entropy : 0.601 - acc jigsaw : 75.78, class : 76.56 [bs:128]
30/53 of epoch 4/30 jigsaw : 0.534, class : 0.274, t_rotation : 0.374, entropy : 0.440 - acc jigsaw : 79.69, class : 70.31 [bs:128]
Accuracies on val: jigsaw : 94.23, class : 89.91
--------------------------------------------------------
Accuracies on test: jigsaw : 97.10, class : 76.37
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 4
New epoch - lr: 0.001
0/53 of epoch 5/30 jigsaw : 0.472, class : 0.399, t_rotation : 0.397, entropy : 0.517 - acc jigsaw : 78.91, class : 71.09 [bs:128]
30/53 of epoch 5/30 jigsaw : 0.359, class : 0.391, t_rotation : 0.255, entropy : 0.364 - acc jigsaw : 86.72, class : 66.41 [bs:128]
Accuracies on val: jigsaw : 94.63, class : 89.25
--------------------------------------------------------
Accuracies on test: jigsaw : 97.48, class : 77.77
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 5
New epoch - lr: 0.001
0/53 of epoch 6/30 jigsaw : 0.477, class : 0.174, t_rotation : 0.352, entropy : 0.337 - acc jigsaw : 82.81, class : 75.78 [bs:128]
30/53 of epoch 6/30 jigsaw : 0.394, class : 0.212, t_rotation : 0.271, entropy : 0.402 - acc jigsaw : 87.50, class : 73.44 [bs:128]
Accuracies on val: jigsaw : 95.54, class : 90.17
--------------------------------------------------------
Accuracies on test: jigsaw : 98.98, class : 79.74
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 6
New epoch - lr: 0.001
0/53 of epoch 7/30 jigsaw : 0.402, class : 0.170, t_rotation : 0.330, entropy : 0.329 - acc jigsaw : 85.94, class : 79.69 [bs:128]
30/53 of epoch 7/30 jigsaw : 0.301, class : 0.277, t_rotation : 0.287, entropy : 0.369 - acc jigsaw : 90.62, class : 69.53 [bs:128]
Accuracies on val: jigsaw : 94.23, class : 90.83
--------------------------------------------------------
Accuracies on test: jigsaw : 98.17, class : 80.46
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 7
New epoch - lr: 0.001
0/53 of epoch 8/30 jigsaw : 0.319, class : 0.152, t_rotation : 0.248, entropy : 0.278 - acc jigsaw : 89.06, class : 76.56 [bs:128]
30/53 of epoch 8/30 jigsaw : 0.272, class : 0.168, t_rotation : 0.265, entropy : 0.229 - acc jigsaw : 89.84, class : 80.47 [bs:128]
Accuracies on val: jigsaw : 93.58, class : 91.61
--------------------------------------------------------
Accuracies on test: jigsaw : 97.74, class : 79.91
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 8
New epoch - lr: 0.001
0/53 of epoch 9/30 jigsaw : 0.178, class : 0.078, t_rotation : 0.282, entropy : 0.278 - acc jigsaw : 95.31, class : 73.44 [bs:128]
30/53 of epoch 9/30 jigsaw : 0.319, class : 0.148, t_rotation : 0.222, entropy : 0.306 - acc jigsaw : 89.06, class : 75.78 [bs:128]
Accuracies on val: jigsaw : 95.54, class : 90.43
--------------------------------------------------------
Accuracies on test: jigsaw : 98.89, class : 81.02
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 9
New epoch - lr: 0.001
0/53 of epoch 10/30 jigsaw : 0.335, class : 0.179, t_rotation : 0.297, entropy : 0.235 - acc jigsaw : 87.50, class : 68.75 [bs:128]
30/53 of epoch 10/30 jigsaw : 0.244, class : 0.051, t_rotation : 0.247, entropy : 0.250 - acc jigsaw : 91.41, class : 77.34 [bs:128]
Accuracies on val: jigsaw : 94.76, class : 91.48
--------------------------------------------------------
Accuracies on test: jigsaw : 98.81, class : 80.63
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 10
New epoch - lr: 0.001
0/53 of epoch 11/30 jigsaw : 0.267, class : 0.127, t_rotation : 0.179, entropy : 0.266 - acc jigsaw : 91.41, class : 76.56 [bs:128]
30/53 of epoch 11/30 jigsaw : 0.315, class : 0.144, t_rotation : 0.177, entropy : 0.258 - acc jigsaw : 89.06, class : 75.78 [bs:128]
Accuracies on val: jigsaw : 94.76, class : 92.40
--------------------------------------------------------
Accuracies on test: jigsaw : 98.59, class : 80.59
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 11
New epoch - lr: 0.001
0/53 of epoch 12/30 jigsaw : 0.256, class : 0.093, t_rotation : 0.280, entropy : 0.215 - acc jigsaw : 89.84, class : 71.88 [bs:128]
30/53 of epoch 12/30 jigsaw : 0.195, class : 0.132, t_rotation : 0.167, entropy : 0.180 - acc jigsaw : 92.97, class : 76.56 [bs:128]
Accuracies on val: jigsaw : 95.41, class : 92.53
--------------------------------------------------------
Accuracies on test: jigsaw : 98.76, class : 80.12
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 12
New epoch - lr: 0.001
0/53 of epoch 13/30 jigsaw : 0.294, class : 0.038, t_rotation : 0.195, entropy : 0.272 - acc jigsaw : 91.41, class : 73.44 [bs:128]
30/53 of epoch 13/30 jigsaw : 0.300, class : 0.047, t_rotation : 0.121, entropy : 0.185 - acc jigsaw : 91.41, class : 77.34 [bs:128]
Accuracies on val: jigsaw : 95.67, class : 92.66
--------------------------------------------------------
Accuracies on test: jigsaw : 99.36, class : 81.83
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 13
New epoch - lr: 0.001
0/53 of epoch 14/30 jigsaw : 0.408, class : 0.089, t_rotation : 0.104, entropy : 0.207 - acc jigsaw : 88.28, class : 77.34 [bs:128]
30/53 of epoch 14/30 jigsaw : 0.207, class : 0.053, t_rotation : 0.133, entropy : 0.165 - acc jigsaw : 93.75, class : 78.12 [bs:128]
Accuracies on val: jigsaw : 95.81, class : 92.79
--------------------------------------------------------
Accuracies on test: jigsaw : 99.02, class : 82.25
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 14
New epoch - lr: 0.001
0/53 of epoch 15/30 jigsaw : 0.254, class : 0.033, t_rotation : 0.165, entropy : 0.223 - acc jigsaw : 89.06, class : 71.88 [bs:128]
30/53 of epoch 15/30 jigsaw : 0.251, class : 0.092, t_rotation : 0.067, entropy : 0.162 - acc jigsaw : 90.62, class : 78.91 [bs:128]
Accuracies on val: jigsaw : 95.02, class : 93.05
--------------------------------------------------------
Accuracies on test: jigsaw : 99.32, class : 82.12
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 15
New epoch - lr: 0.001
0/53 of epoch 16/30 jigsaw : 0.228, class : 0.047, t_rotation : 0.144, entropy : 0.242 - acc jigsaw : 92.97, class : 73.44 [bs:128]
30/53 of epoch 16/30 jigsaw : 0.241, class : 0.089, t_rotation : 0.153, entropy : 0.171 - acc jigsaw : 90.62, class : 78.12 [bs:128]
Accuracies on val: jigsaw : 95.02, class : 92.66
--------------------------------------------------------
Accuracies on test: jigsaw : 98.93, class : 81.36
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 16
New epoch - lr: 0.001
0/53 of epoch 17/30 jigsaw : 0.278, class : 0.053, t_rotation : 0.188, entropy : 0.185 - acc jigsaw : 89.06, class : 76.56 [bs:128]
30/53 of epoch 17/30 jigsaw : 0.244, class : 0.057, t_rotation : 0.122, entropy : 0.221 - acc jigsaw : 90.62, class : 71.09 [bs:128]
Accuracies on val: jigsaw : 95.02, class : 93.32
--------------------------------------------------------
Accuracies on test: jigsaw : 99.19, class : 80.93
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 17
New epoch - lr: 0.001
0/53 of epoch 18/30 jigsaw : 0.248, class : 0.127, t_rotation : 0.120, entropy : 0.182 - acc jigsaw : 89.84, class : 75.78 [bs:128]
30/53 of epoch 18/30 jigsaw : 0.381, class : 0.084, t_rotation : 0.091, entropy : 0.135 - acc jigsaw : 85.16, class : 76.56 [bs:128]
Accuracies on val: jigsaw : 95.54, class : 92.01
--------------------------------------------------------
Accuracies on test: jigsaw : 99.53, class : 82.04
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 18
New epoch - lr: 0.001
0/53 of epoch 19/30 jigsaw : 0.252, class : 0.102, t_rotation : 0.155, entropy : 0.190 - acc jigsaw : 91.41, class : 69.53 [bs:128]
30/53 of epoch 19/30 jigsaw : 0.231, class : 0.034, t_rotation : 0.074, entropy : 0.200 - acc jigsaw : 92.97, class : 75.78 [bs:128]
Accuracies on val: jigsaw : 95.41, class : 93.97
--------------------------------------------------------
Accuracies on test: jigsaw : 99.19, class : 79.78
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 19
New epoch - lr: 0.001
0/53 of epoch 20/30 jigsaw : 0.210, class : 0.067, t_rotation : 0.159, entropy : 0.173 - acc jigsaw : 92.19, class : 67.19 [bs:128]
30/53 of epoch 20/30 jigsaw : 0.175, class : 0.038, t_rotation : 0.183, entropy : 0.182 - acc jigsaw : 94.53, class : 76.56 [bs:128]
Accuracies on val: jigsaw : 95.54, class : 93.18
--------------------------------------------------------
Accuracies on test: jigsaw : 99.40, class : 82.72
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 20
New epoch - lr: 0.001
0/53 of epoch 21/30 jigsaw : 0.191, class : 0.190, t_rotation : 0.125, entropy : 0.196 - acc jigsaw : 92.97, class : 70.31 [bs:128]
30/53 of epoch 21/30 jigsaw : 0.280, class : 0.055, t_rotation : 0.128, entropy : 0.135 - acc jigsaw : 91.41, class : 76.56 [bs:128]
Accuracies on val: jigsaw : 95.67, class : 93.05
--------------------------------------------------------
Accuracies on test: jigsaw : 99.10, class : 82.12
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 21
New epoch - lr: 0.001
0/53 of epoch 22/30 jigsaw : 0.115, class : 0.082, t_rotation : 0.155, entropy : 0.121 - acc jigsaw : 95.31, class : 74.22 [bs:128]
30/53 of epoch 22/30 jigsaw : 0.186, class : 0.104, t_rotation : 0.072, entropy : 0.129 - acc jigsaw : 92.97, class : 76.56 [bs:128]
Accuracies on val: jigsaw : 93.71, class : 92.92
--------------------------------------------------------
Accuracies on test: jigsaw : 98.72, class : 82.38
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 22
New epoch - lr: 0.001
0/53 of epoch 23/30 jigsaw : 0.275, class : 0.031, t_rotation : 0.113, entropy : 0.160 - acc jigsaw : 91.41, class : 77.34 [bs:128]
30/53 of epoch 23/30 jigsaw : 0.231, class : 0.046, t_rotation : 0.096, entropy : 0.131 - acc jigsaw : 90.62, class : 75.78 [bs:128]
Accuracies on val: jigsaw : 94.23, class : 93.45
--------------------------------------------------------
Accuracies on test: jigsaw : 99.02, class : 82.81
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 23
New epoch - lr: 0.0001
0/53 of epoch 24/30 jigsaw : 0.172, class : 0.113, t_rotation : 0.129, entropy : 0.087 - acc jigsaw : 93.75, class : 71.88 [bs:128]
30/53 of epoch 24/30 jigsaw : 0.201, class : 0.005, t_rotation : 0.125, entropy : 0.166 - acc jigsaw : 92.97, class : 81.25 [bs:128]
Accuracies on val: jigsaw : 95.67, class : 92.92
--------------------------------------------------------
Accuracies on test: jigsaw : 99.27, class : 83.02
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 24
New epoch - lr: 0.0001
0/53 of epoch 25/30 jigsaw : 0.186, class : 0.026, t_rotation : 0.195, entropy : 0.162 - acc jigsaw : 92.97, class : 79.69 [bs:128]
30/53 of epoch 25/30 jigsaw : 0.245, class : 0.021, t_rotation : 0.086, entropy : 0.152 - acc jigsaw : 93.75, class : 83.59 [bs:128]
Accuracies on val: jigsaw : 95.67, class : 94.23
--------------------------------------------------------
Accuracies on test: jigsaw : 99.36, class : 82.64
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 25
New epoch - lr: 0.0001
0/53 of epoch 26/30 jigsaw : 0.159, class : 0.018, t_rotation : 0.085, entropy : 0.162 - acc jigsaw : 96.09, class : 75.78 [bs:128]
30/53 of epoch 26/30 jigsaw : 0.193, class : 0.016, t_rotation : 0.151, entropy : 0.136 - acc jigsaw : 92.19, class : 75.78 [bs:128]
Accuracies on val: jigsaw : 95.54, class : 94.10
--------------------------------------------------------
Accuracies on test: jigsaw : 99.32, class : 82.85
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 26
New epoch - lr: 0.0001
0/53 of epoch 27/30 jigsaw : 0.223, class : 0.041, t_rotation : 0.139, entropy : 0.161 - acc jigsaw : 91.41, class : 76.56 [bs:128]
30/53 of epoch 27/30 jigsaw : 0.182, class : 0.018, t_rotation : 0.137, entropy : 0.106 - acc jigsaw : 95.31, class : 75.78 [bs:128]
Accuracies on val: jigsaw : 95.15, class : 93.58
--------------------------------------------------------
Accuracies on test: jigsaw : 99.27, class : 82.42
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 27
New epoch - lr: 0.0001
0/53 of epoch 28/30 jigsaw : 0.158, class : 0.060, t_rotation : 0.127, entropy : 0.107 - acc jigsaw : 95.31, class : 73.44 [bs:128]
30/53 of epoch 28/30 jigsaw : 0.167, class : 0.051, t_rotation : 0.076, entropy : 0.141 - acc jigsaw : 95.31, class : 81.25 [bs:128]
Accuracies on val: jigsaw : 95.81, class : 93.71
--------------------------------------------------------
Accuracies on test: jigsaw : 99.49, class : 82.89
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 28
New epoch - lr: 0.0001
0/53 of epoch 29/30 jigsaw : 0.171, class : 0.068, t_rotation : 0.083, entropy : 0.122 - acc jigsaw : 93.75, class : 72.66 [bs:128]
30/53 of epoch 29/30 jigsaw : 0.137, class : 0.027, t_rotation : 0.114, entropy : 0.154 - acc jigsaw : 95.31, class : 75.78 [bs:128]
Accuracies on val: jigsaw : 95.41, class : 93.71
--------------------------------------------------------
Accuracies on test: jigsaw : 99.40, class : 82.94
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 29
New epoch - lr: 0.0001
0/53 of epoch 30/30 jigsaw : 0.190, class : 0.083, t_rotation : 0.114, entropy : 0.118 - acc jigsaw : 93.75, class : 80.47 [bs:128]
30/53 of epoch 30/30 jigsaw : 0.266, class : 0.067, t_rotation : 0.069, entropy : 0.122 - acc jigsaw : 89.06, class : 77.34 [bs:128]
Accuracies on val: jigsaw : 95.54, class : 93.71
--------------------------------------------------------
Accuracies on test: jigsaw : 99.36, class : 82.59
--------------------------------------------------------
2019-12-16 06:17:46
cartoon
['photo', 'sketch', 'art_painting']
unsupervised_task_weight: 0.8
bias_hole_image: 0.4
target_rotation_weight: 0.8
entropy_weight 0.2
only_classify the ordered image: True
Highest accuracy on validation set appears on epoch  tensor(24)
Highest accuracy on test set appears on epoch  tensor(23)
Accuracy on test set when the accuracy on validation set is highest:0.826
Highest accuracy on test set:0.830
It took 1246.04
--------------------------------------------------------
******************Start training**************************************
--------------------------------------------------------
Dataset size: training 6884, validation 763, testing 2344
--------------------------------------------------------
Namespace(TTA=False, batch_size=128, bias_whole_image=0.4, classify_only_ordered_images_or_not=True, domains_list=['photo', 'sketch', 'cartoon', 'art_painting'], entropy_loss_weight=0.2, epochs=30, folder_name='test', image_size=222, jitter=0.4, learning_rate=0.001, limit_source=None, limit_target=None, max_scale=1.0, min_scale=0.8, n_classes=7, nesterov=False, network='resnet18', ooo_weight=0, parameters_lists=[[0.8, 0.4, 0.8, 0.2], [0.8, 0.4, 0.8, 0.3], [0.8, 0.4, 0.8, 0.4]], random_horiz_flip=0.5, repeat_times=3, source=['photo', 'sketch', 'art_painting'], suffix='', target='cartoon', target_domain_list=['art_painting', 'cartoon', 'sketch', 'photo'], target_domain_unsupervised_task_loss_weight=0.8, tf_logger=True, tile_random_grayscale=0.1, train_all=True, unsupervised_task_weight=0.8, val_size=0.1)
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 0
New epoch - lr: 0.001
0/53 of epoch 1/30 jigsaw : 1.810, class : 2.165, t_rotation : 1.693, entropy : 1.843 - acc jigsaw : 10.94, class : 12.50 [bs:128]
30/53 of epoch 1/30 jigsaw : 1.024, class : 1.241, t_rotation : 0.949, entropy : 1.707 - acc jigsaw : 61.72, class : 54.69 [bs:128]
Accuracies on val: jigsaw : 94.10, class : 74.71
--------------------------------------------------------
Accuracies on test: jigsaw : 94.50, class : 57.89
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 1
New epoch - lr: 0.001
0/53 of epoch 2/30 jigsaw : 0.825, class : 0.884, t_rotation : 0.819, entropy : 1.361 - acc jigsaw : 70.31, class : 57.03 [bs:128]
30/53 of epoch 2/30 jigsaw : 0.618, class : 0.487, t_rotation : 0.634, entropy : 1.056 - acc jigsaw : 78.12, class : 74.22 [bs:128]
Accuracies on val: jigsaw : 92.01, class : 83.75
--------------------------------------------------------
Accuracies on test: jigsaw : 94.07, class : 72.70
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 2
New epoch - lr: 0.001
0/53 of epoch 3/30 jigsaw : 0.629, class : 0.346, t_rotation : 0.649, entropy : 0.862 - acc jigsaw : 80.47, class : 74.22 [bs:128]
30/53 of epoch 3/30 jigsaw : 0.554, class : 0.285, t_rotation : 0.493, entropy : 0.747 - acc jigsaw : 80.47, class : 75.00 [bs:128]
Accuracies on val: jigsaw : 93.84, class : 88.20
--------------------------------------------------------
Accuracies on test: jigsaw : 95.82, class : 75.68
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 3
New epoch - lr: 0.001
0/53 of epoch 4/30 jigsaw : 0.548, class : 0.372, t_rotation : 0.555, entropy : 0.737 - acc jigsaw : 78.91, class : 73.44 [bs:128]
30/53 of epoch 4/30 jigsaw : 0.436, class : 0.306, t_rotation : 0.319, entropy : 0.614 - acc jigsaw : 85.16, class : 68.75 [bs:128]
Accuracies on val: jigsaw : 95.02, class : 90.04
--------------------------------------------------------
Accuracies on test: jigsaw : 96.89, class : 75.30
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 4
New epoch - lr: 0.001
0/53 of epoch 5/30 jigsaw : 0.530, class : 0.305, t_rotation : 0.343, entropy : 0.473 - acc jigsaw : 82.03, class : 67.97 [bs:128]
30/53 of epoch 5/30 jigsaw : 0.470, class : 0.216, t_rotation : 0.317, entropy : 0.494 - acc jigsaw : 82.03, class : 75.00 [bs:128]
Accuracies on val: jigsaw : 94.50, class : 91.09
--------------------------------------------------------
Accuracies on test: jigsaw : 97.70, class : 78.80
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 5
New epoch - lr: 0.001
0/53 of epoch 6/30 jigsaw : 0.420, class : 0.291, t_rotation : 0.424, entropy : 0.551 - acc jigsaw : 87.50, class : 72.66 [bs:128]
30/53 of epoch 6/30 jigsaw : 0.382, class : 0.113, t_rotation : 0.329, entropy : 0.409 - acc jigsaw : 85.94, class : 80.47 [bs:128]
Accuracies on val: jigsaw : 95.41, class : 92.01
--------------------------------------------------------
Accuracies on test: jigsaw : 97.44, class : 77.18
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 6
New epoch - lr: 0.001
0/53 of epoch 7/30 jigsaw : 0.433, class : 0.152, t_rotation : 0.294, entropy : 0.394 - acc jigsaw : 88.28, class : 71.09 [bs:128]
30/53 of epoch 7/30 jigsaw : 0.393, class : 0.311, t_rotation : 0.289, entropy : 0.419 - acc jigsaw : 83.59, class : 67.97 [bs:128]
Accuracies on val: jigsaw : 94.23, class : 92.27
--------------------------------------------------------
Accuracies on test: jigsaw : 96.42, class : 78.97
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 7
New epoch - lr: 0.001
0/53 of epoch 8/30 jigsaw : 0.332, class : 0.115, t_rotation : 0.261, entropy : 0.357 - acc jigsaw : 89.06, class : 71.09 [bs:128]
30/53 of epoch 8/30 jigsaw : 0.341, class : 0.192, t_rotation : 0.173, entropy : 0.404 - acc jigsaw : 87.50, class : 71.88 [bs:128]
Accuracies on val: jigsaw : 94.89, class : 92.92
--------------------------------------------------------
Accuracies on test: jigsaw : 97.91, class : 79.44
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 8
New epoch - lr: 0.001
0/53 of epoch 9/30 jigsaw : 0.309, class : 0.082, t_rotation : 0.330, entropy : 0.369 - acc jigsaw : 86.72, class : 74.22 [bs:128]
30/53 of epoch 9/30 jigsaw : 0.332, class : 0.163, t_rotation : 0.160, entropy : 0.291 - acc jigsaw : 89.06, class : 75.78 [bs:128]
Accuracies on val: jigsaw : 94.63, class : 92.79
--------------------------------------------------------
Accuracies on test: jigsaw : 98.04, class : 80.42
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 9
New epoch - lr: 0.001
0/53 of epoch 10/30 jigsaw : 0.365, class : 0.148, t_rotation : 0.259, entropy : 0.301 - acc jigsaw : 85.94, class : 71.88 [bs:128]
30/53 of epoch 10/30 jigsaw : 0.233, class : 0.133, t_rotation : 0.213, entropy : 0.301 - acc jigsaw : 89.84, class : 71.09 [bs:128]
Accuracies on val: jigsaw : 95.28, class : 93.97
--------------------------------------------------------
Accuracies on test: jigsaw : 98.85, class : 80.93
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 10
New epoch - lr: 0.001
0/53 of epoch 11/30 jigsaw : 0.322, class : 0.053, t_rotation : 0.208, entropy : 0.304 - acc jigsaw : 87.50, class : 74.22 [bs:128]
30/53 of epoch 11/30 jigsaw : 0.230, class : 0.064, t_rotation : 0.159, entropy : 0.252 - acc jigsaw : 92.97, class : 80.47 [bs:128]
Accuracies on val: jigsaw : 95.81, class : 93.32
--------------------------------------------------------
Accuracies on test: jigsaw : 98.85, class : 82.42
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 11
New epoch - lr: 0.001
0/53 of epoch 12/30 jigsaw : 0.292, class : 0.053, t_rotation : 0.215, entropy : 0.321 - acc jigsaw : 89.84, class : 73.44 [bs:128]
30/53 of epoch 12/30 jigsaw : 0.446, class : 0.182, t_rotation : 0.133, entropy : 0.229 - acc jigsaw : 85.94, class : 78.12 [bs:128]
Accuracies on val: jigsaw : 95.67, class : 94.63
--------------------------------------------------------
Accuracies on test: jigsaw : 98.89, class : 81.23
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 12
New epoch - lr: 0.001
0/53 of epoch 13/30 jigsaw : 0.302, class : 0.111, t_rotation : 0.193, entropy : 0.271 - acc jigsaw : 89.06, class : 73.44 [bs:128]
30/53 of epoch 13/30 jigsaw : 0.198, class : 0.074, t_rotation : 0.149, entropy : 0.219 - acc jigsaw : 93.75, class : 76.56 [bs:128]
Accuracies on val: jigsaw : 95.67, class : 93.18
--------------------------------------------------------
Accuracies on test: jigsaw : 98.81, class : 80.84
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 13
New epoch - lr: 0.001
0/53 of epoch 14/30 jigsaw : 0.165, class : 0.049, t_rotation : 0.284, entropy : 0.268 - acc jigsaw : 93.75, class : 72.66 [bs:128]
30/53 of epoch 14/30 jigsaw : 0.245, class : 0.061, t_rotation : 0.167, entropy : 0.190 - acc jigsaw : 92.19, class : 80.47 [bs:128]
Accuracies on val: jigsaw : 95.81, class : 93.97
--------------------------------------------------------
Accuracies on test: jigsaw : 99.10, class : 81.31
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 14
New epoch - lr: 0.001
0/53 of epoch 15/30 jigsaw : 0.306, class : 0.054, t_rotation : 0.124, entropy : 0.235 - acc jigsaw : 88.28, class : 79.69 [bs:128]
30/53 of epoch 15/30 jigsaw : 0.276, class : 0.082, t_rotation : 0.101, entropy : 0.186 - acc jigsaw : 88.28, class : 75.78 [bs:128]
Accuracies on val: jigsaw : 96.20, class : 94.10
--------------------------------------------------------
Accuracies on test: jigsaw : 98.93, class : 80.46
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 15
New epoch - lr: 0.001
0/53 of epoch 16/30 jigsaw : 0.221, class : 0.102, t_rotation : 0.127, entropy : 0.208 - acc jigsaw : 90.62, class : 73.44 [bs:128]
30/53 of epoch 16/30 jigsaw : 0.366, class : 0.072, t_rotation : 0.141, entropy : 0.160 - acc jigsaw : 89.84, class : 81.25 [bs:128]
Accuracies on val: jigsaw : 95.94, class : 93.58
--------------------------------------------------------
Accuracies on test: jigsaw : 98.85, class : 81.74
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 16
New epoch - lr: 0.001
0/53 of epoch 17/30 jigsaw : 0.200, class : 0.082, t_rotation : 0.155, entropy : 0.176 - acc jigsaw : 96.09, class : 78.12 [bs:128]
30/53 of epoch 17/30 jigsaw : 0.210, class : 0.048, t_rotation : 0.149, entropy : 0.188 - acc jigsaw : 92.19, class : 76.56 [bs:128]
Accuracies on val: jigsaw : 95.54, class : 93.58
--------------------------------------------------------
Accuracies on test: jigsaw : 99.23, class : 81.48
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 17
New epoch - lr: 0.001
0/53 of epoch 18/30 jigsaw : 0.165, class : 0.075, t_rotation : 0.120, entropy : 0.194 - acc jigsaw : 93.75, class : 75.00 [bs:128]
30/53 of epoch 18/30 jigsaw : 0.278, class : 0.021, t_rotation : 0.117, entropy : 0.176 - acc jigsaw : 90.62, class : 80.47 [bs:128]
Accuracies on val: jigsaw : 95.94, class : 93.58
--------------------------------------------------------
Accuracies on test: jigsaw : 99.23, class : 81.27
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 18
New epoch - lr: 0.001
0/53 of epoch 19/30 jigsaw : 0.285, class : 0.112, t_rotation : 0.132, entropy : 0.205 - acc jigsaw : 91.41, class : 74.22 [bs:128]
30/53 of epoch 19/30 jigsaw : 0.174, class : 0.081, t_rotation : 0.130, entropy : 0.163 - acc jigsaw : 93.75, class : 71.88 [bs:128]
Accuracies on val: jigsaw : 96.07, class : 94.76
--------------------------------------------------------
Accuracies on test: jigsaw : 99.02, class : 80.80
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 19
New epoch - lr: 0.001
0/53 of epoch 20/30 jigsaw : 0.287, class : 0.066, t_rotation : 0.141, entropy : 0.196 - acc jigsaw : 88.28, class : 78.12 [bs:128]
30/53 of epoch 20/30 jigsaw : 0.291, class : 0.009, t_rotation : 0.137, entropy : 0.160 - acc jigsaw : 92.97, class : 77.34 [bs:128]
Accuracies on val: jigsaw : 97.12, class : 94.23
--------------------------------------------------------
Accuracies on test: jigsaw : 99.62, class : 80.93
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 20
New epoch - lr: 0.001
0/53 of epoch 21/30 jigsaw : 0.247, class : 0.042, t_rotation : 0.080, entropy : 0.106 - acc jigsaw : 89.06, class : 75.00 [bs:128]
30/53 of epoch 21/30 jigsaw : 0.165, class : 0.086, t_rotation : 0.068, entropy : 0.130 - acc jigsaw : 93.75, class : 76.56 [bs:128]
Accuracies on val: jigsaw : 95.28, class : 94.10
--------------------------------------------------------
Accuracies on test: jigsaw : 99.36, class : 81.87
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 21
New epoch - lr: 0.001
0/53 of epoch 22/30 jigsaw : 0.193, class : 0.067, t_rotation : 0.154, entropy : 0.159 - acc jigsaw : 90.62, class : 75.00 [bs:128]
30/53 of epoch 22/30 jigsaw : 0.344, class : 0.143, t_rotation : 0.087, entropy : 0.199 - acc jigsaw : 87.50, class : 75.78 [bs:128]
Accuracies on val: jigsaw : 96.72, class : 94.63
--------------------------------------------------------
Accuracies on test: jigsaw : 99.62, class : 81.14
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 22
New epoch - lr: 0.001
0/53 of epoch 23/30 jigsaw : 0.328, class : 0.033, t_rotation : 0.128, entropy : 0.151 - acc jigsaw : 87.50, class : 83.59 [bs:128]
30/53 of epoch 23/30 jigsaw : 0.134, class : 0.029, t_rotation : 0.077, entropy : 0.103 - acc jigsaw : 96.09, class : 75.78 [bs:128]
Accuracies on val: jigsaw : 96.59, class : 94.23
--------------------------------------------------------
Accuracies on test: jigsaw : 99.49, class : 81.36
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 23
New epoch - lr: 0.0001
0/53 of epoch 24/30 jigsaw : 0.136, class : 0.094, t_rotation : 0.049, entropy : 0.135 - acc jigsaw : 95.31, class : 69.53 [bs:128]
30/53 of epoch 24/30 jigsaw : 0.252, class : 0.078, t_rotation : 0.118, entropy : 0.103 - acc jigsaw : 88.28, class : 75.00 [bs:128]
Accuracies on val: jigsaw : 96.59, class : 94.76
--------------------------------------------------------
Accuracies on test: jigsaw : 99.45, class : 81.78
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 24
New epoch - lr: 0.0001
0/53 of epoch 25/30 jigsaw : 0.139, class : 0.032, t_rotation : 0.120, entropy : 0.159 - acc jigsaw : 94.53, class : 72.66 [bs:128]
30/53 of epoch 25/30 jigsaw : 0.133, class : 0.070, t_rotation : 0.154, entropy : 0.114 - acc jigsaw : 94.53, class : 76.56 [bs:128]
Accuracies on val: jigsaw : 96.20, class : 94.50
--------------------------------------------------------
Accuracies on test: jigsaw : 99.49, class : 81.74
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 25
New epoch - lr: 0.0001
0/53 of epoch 26/30 jigsaw : 0.238, class : 0.010, t_rotation : 0.118, entropy : 0.213 - acc jigsaw : 92.97, class : 79.69 [bs:128]
30/53 of epoch 26/30 jigsaw : 0.197, class : 0.029, t_rotation : 0.128, entropy : 0.131 - acc jigsaw : 92.19, class : 71.88 [bs:128]
Accuracies on val: jigsaw : 96.20, class : 94.63
--------------------------------------------------------
Accuracies on test: jigsaw : 99.53, class : 81.40
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 26
New epoch - lr: 0.0001
0/53 of epoch 27/30 jigsaw : 0.238, class : 0.024, t_rotation : 0.082, entropy : 0.162 - acc jigsaw : 91.41, class : 71.88 [bs:128]
30/53 of epoch 27/30 jigsaw : 0.176, class : 0.026, t_rotation : 0.086, entropy : 0.115 - acc jigsaw : 92.97, class : 76.56 [bs:128]
Accuracies on val: jigsaw : 95.94, class : 94.76
--------------------------------------------------------
Accuracies on test: jigsaw : 99.45, class : 81.06
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 27
New epoch - lr: 0.0001
0/53 of epoch 28/30 jigsaw : 0.186, class : 0.018, t_rotation : 0.159, entropy : 0.212 - acc jigsaw : 91.41, class : 76.56 [bs:128]
30/53 of epoch 28/30 jigsaw : 0.180, class : 0.034, t_rotation : 0.137, entropy : 0.127 - acc jigsaw : 95.31, class : 77.34 [bs:128]
Accuracies on val: jigsaw : 95.81, class : 94.76
--------------------------------------------------------
Accuracies on test: jigsaw : 99.49, class : 81.66
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 28
New epoch - lr: 0.0001
0/53 of epoch 29/30 jigsaw : 0.137, class : 0.082, t_rotation : 0.125, entropy : 0.083 - acc jigsaw : 94.53, class : 69.53 [bs:128]
30/53 of epoch 29/30 jigsaw : 0.141, class : 0.041, t_rotation : 0.092, entropy : 0.142 - acc jigsaw : 94.53, class : 75.78 [bs:128]
Accuracies on val: jigsaw : 96.07, class : 94.76
--------------------------------------------------------
Accuracies on test: jigsaw : 99.45, class : 81.27
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 29
New epoch - lr: 0.0001
0/53 of epoch 30/30 jigsaw : 0.180, class : 0.073, t_rotation : 0.144, entropy : 0.140 - acc jigsaw : 93.75, class : 75.78 [bs:128]
30/53 of epoch 30/30 jigsaw : 0.197, class : 0.052, t_rotation : 0.108, entropy : 0.125 - acc jigsaw : 92.97, class : 76.56 [bs:128]
Accuracies on val: jigsaw : 96.33, class : 94.76
--------------------------------------------------------
Accuracies on test: jigsaw : 99.53, class : 81.70
--------------------------------------------------------
2019-12-16 06:38:34
cartoon
['photo', 'sketch', 'art_painting']
unsupervised_task_weight: 0.8
bias_hole_image: 0.4
target_rotation_weight: 0.8
entropy_weight 0.2
only_classify the ordered image: True
Highest accuracy on validation set appears on epoch  tensor(29)
Highest accuracy on test set appears on epoch  tensor(10)
Accuracy on test set when the accuracy on validation set is highest:0.817
Highest accuracy on test set:0.824
It took 1247.48
--------------------------------------------------------
******************Start training**************************************
--------------------------------------------------------
Dataset size: training 5457, validation 605, testing 3929
--------------------------------------------------------
Namespace(TTA=False, batch_size=128, bias_whole_image=0.4, classify_only_ordered_images_or_not=True, domains_list=['photo', 'sketch', 'cartoon', 'art_painting'], entropy_loss_weight=0.2, epochs=30, folder_name='test', image_size=222, jitter=0.4, learning_rate=0.001, limit_source=None, limit_target=None, max_scale=1.0, min_scale=0.8, n_classes=7, nesterov=False, network='resnet18', ooo_weight=0, parameters_lists=[[0.8, 0.4, 0.8, 0.2], [0.8, 0.4, 0.8, 0.3], [0.8, 0.4, 0.8, 0.4]], random_horiz_flip=0.5, repeat_times=3, source=['photo', 'cartoon', 'art_painting'], suffix='', target='sketch', target_domain_list=['art_painting', 'cartoon', 'sketch', 'photo'], target_domain_unsupervised_task_loss_weight=0.8, tf_logger=True, tile_random_grayscale=0.1, train_all=True, unsupervised_task_weight=0.8, val_size=0.1)
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 0
New epoch - lr: 0.001
0/42 of epoch 1/30 jigsaw : 1.723, class : 2.178, t_rotation : 1.645, entropy : 1.736 - acc jigsaw : 9.38, class : 14.84 [bs:128]
30/42 of epoch 1/30 jigsaw : 0.962, class : 1.094, t_rotation : 0.877, entropy : 1.771 - acc jigsaw : 58.59, class : 59.38 [bs:128]
Accuracies on val: jigsaw : 97.36, class : 72.73
--------------------------------------------------------
Accuracies on test: jigsaw : 96.69, class : 38.61
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 1
New epoch - lr: 0.001
0/42 of epoch 2/30 jigsaw : 0.985, class : 0.725, t_rotation : 0.783, entropy : 1.633 - acc jigsaw : 54.69, class : 62.50 [bs:128]
30/42 of epoch 2/30 jigsaw : 0.782, class : 0.563, t_rotation : 0.615, entropy : 1.244 - acc jigsaw : 65.62, class : 64.06 [bs:128]
Accuracies on val: jigsaw : 97.19, class : 83.14
--------------------------------------------------------
Accuracies on test: jigsaw : 97.58, class : 67.04
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 2
New epoch - lr: 0.001
0/42 of epoch 3/30 jigsaw : 0.740, class : 0.587, t_rotation : 0.536, entropy : 1.157 - acc jigsaw : 68.75, class : 68.75 [bs:128]
30/42 of epoch 3/30 jigsaw : 0.677, class : 0.399, t_rotation : 0.452, entropy : 0.848 - acc jigsaw : 72.66, class : 73.44 [bs:128]
Accuracies on val: jigsaw : 94.55, class : 87.11
--------------------------------------------------------
Accuracies on test: jigsaw : 93.38, class : 71.88
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 3
New epoch - lr: 0.001
0/42 of epoch 4/30 jigsaw : 0.693, class : 0.249, t_rotation : 0.506, entropy : 0.728 - acc jigsaw : 71.09, class : 74.22 [bs:128]
30/42 of epoch 4/30 jigsaw : 0.638, class : 0.255, t_rotation : 0.425, entropy : 0.605 - acc jigsaw : 75.78, class : 81.25 [bs:128]
Accuracies on val: jigsaw : 93.72, class : 87.27
--------------------------------------------------------
Accuracies on test: jigsaw : 95.75, class : 75.90
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 4
New epoch - lr: 0.001
0/42 of epoch 5/30 jigsaw : 0.706, class : 0.288, t_rotation : 0.370, entropy : 0.645 - acc jigsaw : 71.09, class : 74.22 [bs:128]
30/42 of epoch 5/30 jigsaw : 0.442, class : 0.161, t_rotation : 0.297, entropy : 0.536 - acc jigsaw : 83.59, class : 78.12 [bs:128]
Accuracies on val: jigsaw : 94.38, class : 88.93
--------------------------------------------------------
Accuracies on test: jigsaw : 96.84, class : 77.58
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 5
New epoch - lr: 0.001
0/42 of epoch 6/30 jigsaw : 0.592, class : 0.240, t_rotation : 0.415, entropy : 0.497 - acc jigsaw : 75.00, class : 77.34 [bs:128]
30/42 of epoch 6/30 jigsaw : 0.514, class : 0.325, t_rotation : 0.367, entropy : 0.416 - acc jigsaw : 77.34, class : 78.12 [bs:128]
Accuracies on val: jigsaw : 94.21, class : 89.75
--------------------------------------------------------
Accuracies on test: jigsaw : 95.78, class : 78.19
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 6
New epoch - lr: 0.001
0/42 of epoch 7/30 jigsaw : 0.491, class : 0.187, t_rotation : 0.202, entropy : 0.455 - acc jigsaw : 80.47, class : 83.59 [bs:128]
30/42 of epoch 7/30 jigsaw : 0.554, class : 0.219, t_rotation : 0.139, entropy : 0.407 - acc jigsaw : 74.22, class : 75.78 [bs:128]
Accuracies on val: jigsaw : 92.89, class : 88.76
--------------------------------------------------------
Accuracies on test: jigsaw : 96.82, class : 77.37
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 7
New epoch - lr: 0.001
0/42 of epoch 8/30 jigsaw : 0.430, class : 0.190, t_rotation : 0.235, entropy : 0.332 - acc jigsaw : 83.59, class : 80.47 [bs:128]
30/42 of epoch 8/30 jigsaw : 0.332, class : 0.115, t_rotation : 0.184, entropy : 0.292 - acc jigsaw : 89.84, class : 76.56 [bs:128]
Accuracies on val: jigsaw : 93.39, class : 88.93
--------------------------------------------------------
Accuracies on test: jigsaw : 97.02, class : 79.26
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 8
New epoch - lr: 0.001
0/42 of epoch 9/30 jigsaw : 0.517, class : 0.175, t_rotation : 0.314, entropy : 0.240 - acc jigsaw : 82.03, class : 72.66 [bs:128]
30/42 of epoch 9/30 jigsaw : 0.405, class : 0.111, t_rotation : 0.294, entropy : 0.198 - acc jigsaw : 85.16, class : 77.34 [bs:128]
Accuracies on val: jigsaw : 95.87, class : 91.40
--------------------------------------------------------
Accuracies on test: jigsaw : 97.43, class : 79.84
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 9
New epoch - lr: 0.001
0/42 of epoch 10/30 jigsaw : 0.480, class : 0.219, t_rotation : 0.206, entropy : 0.370 - acc jigsaw : 85.16, class : 75.78 [bs:128]
30/42 of epoch 10/30 jigsaw : 0.317, class : 0.143, t_rotation : 0.162, entropy : 0.343 - acc jigsaw : 89.06, class : 82.03 [bs:128]
Accuracies on val: jigsaw : 92.89, class : 90.91
--------------------------------------------------------
Accuracies on test: jigsaw : 97.10, class : 80.55
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 10
New epoch - lr: 0.001
0/42 of epoch 11/30 jigsaw : 0.274, class : 0.158, t_rotation : 0.268, entropy : 0.290 - acc jigsaw : 91.41, class : 78.12 [bs:128]
30/42 of epoch 11/30 jigsaw : 0.332, class : 0.226, t_rotation : 0.206, entropy : 0.277 - acc jigsaw : 87.50, class : 75.00 [bs:128]
Accuracies on val: jigsaw : 95.54, class : 91.74
--------------------------------------------------------
Accuracies on test: jigsaw : 97.20, class : 79.94
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 11
New epoch - lr: 0.001
0/42 of epoch 12/30 jigsaw : 0.303, class : 0.117, t_rotation : 0.237, entropy : 0.297 - acc jigsaw : 88.28, class : 73.44 [bs:128]
30/42 of epoch 12/30 jigsaw : 0.394, class : 0.147, t_rotation : 0.164, entropy : 0.271 - acc jigsaw : 89.06, class : 83.59 [bs:128]
Accuracies on val: jigsaw : 95.87, class : 91.24
--------------------------------------------------------
Accuracies on test: jigsaw : 98.47, class : 80.78
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 12
New epoch - lr: 0.001
0/42 of epoch 13/30 jigsaw : 0.324, class : 0.081, t_rotation : 0.191, entropy : 0.216 - acc jigsaw : 89.06, class : 76.56 [bs:128]
30/42 of epoch 13/30 jigsaw : 0.387, class : 0.105, t_rotation : 0.151, entropy : 0.201 - acc jigsaw : 85.94, class : 75.00 [bs:128]
Accuracies on val: jigsaw : 95.70, class : 91.24
--------------------------------------------------------
Accuracies on test: jigsaw : 97.94, class : 81.32
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 13
New epoch - lr: 0.001
0/42 of epoch 14/30 jigsaw : 0.396, class : 0.119, t_rotation : 0.231, entropy : 0.226 - acc jigsaw : 85.94, class : 73.44 [bs:128]
30/42 of epoch 14/30 jigsaw : 0.280, class : 0.120, t_rotation : 0.211, entropy : 0.204 - acc jigsaw : 87.50, class : 76.56 [bs:128]
Accuracies on val: jigsaw : 94.55, class : 90.58
--------------------------------------------------------
Accuracies on test: jigsaw : 97.51, class : 81.75
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 14
New epoch - lr: 0.001
0/42 of epoch 15/30 jigsaw : 0.496, class : 0.087, t_rotation : 0.175, entropy : 0.183 - acc jigsaw : 82.03, class : 71.88 [bs:128]
30/42 of epoch 15/30 jigsaw : 0.251, class : 0.106, t_rotation : 0.135, entropy : 0.158 - acc jigsaw : 91.41, class : 75.78 [bs:128]
Accuracies on val: jigsaw : 97.19, class : 92.07
--------------------------------------------------------
Accuracies on test: jigsaw : 98.63, class : 82.79
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 15
New epoch - lr: 0.001
0/42 of epoch 16/30 jigsaw : 0.228, class : 0.077, t_rotation : 0.163, entropy : 0.157 - acc jigsaw : 92.97, class : 78.12 [bs:128]
30/42 of epoch 16/30 jigsaw : 0.398, class : 0.070, t_rotation : 0.137, entropy : 0.153 - acc jigsaw : 87.50, class : 75.00 [bs:128]
Accuracies on val: jigsaw : 96.20, class : 92.23
--------------------------------------------------------
Accuracies on test: jigsaw : 98.55, class : 83.28
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 16
New epoch - lr: 0.001
0/42 of epoch 17/30 jigsaw : 0.256, class : 0.103, t_rotation : 0.144, entropy : 0.266 - acc jigsaw : 91.41, class : 75.78 [bs:128]
30/42 of epoch 17/30 jigsaw : 0.253, class : 0.106, t_rotation : 0.102, entropy : 0.255 - acc jigsaw : 90.62, class : 78.91 [bs:128]
Accuracies on val: jigsaw : 95.70, class : 90.58
--------------------------------------------------------
Accuracies on test: jigsaw : 98.37, class : 82.95
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 17
New epoch - lr: 0.001
0/42 of epoch 18/30 jigsaw : 0.289, class : 0.053, t_rotation : 0.120, entropy : 0.174 - acc jigsaw : 89.84, class : 76.56 [bs:128]
30/42 of epoch 18/30 jigsaw : 0.300, class : 0.076, t_rotation : 0.099, entropy : 0.164 - acc jigsaw : 89.84, class : 77.34 [bs:128]
Accuracies on val: jigsaw : 96.03, class : 92.73
--------------------------------------------------------
Accuracies on test: jigsaw : 98.32, class : 83.56
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 18
New epoch - lr: 0.001
0/42 of epoch 19/30 jigsaw : 0.235, class : 0.097, t_rotation : 0.167, entropy : 0.260 - acc jigsaw : 92.97, class : 78.91 [bs:128]
30/42 of epoch 19/30 jigsaw : 0.264, class : 0.081, t_rotation : 0.123, entropy : 0.230 - acc jigsaw : 92.19, class : 77.34 [bs:128]
Accuracies on val: jigsaw : 95.70, class : 91.74
--------------------------------------------------------
Accuracies on test: jigsaw : 98.40, class : 83.63
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 19
New epoch - lr: 0.001
0/42 of epoch 20/30 jigsaw : 0.281, class : 0.054, t_rotation : 0.172, entropy : 0.149 - acc jigsaw : 88.28, class : 78.12 [bs:128]
30/42 of epoch 20/30 jigsaw : 0.356, class : 0.027, t_rotation : 0.154, entropy : 0.131 - acc jigsaw : 85.94, class : 78.12 [bs:128]
Accuracies on val: jigsaw : 96.53, class : 92.40
--------------------------------------------------------
Accuracies on test: jigsaw : 98.75, class : 83.10
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 20
New epoch - lr: 0.001
0/42 of epoch 21/30 jigsaw : 0.218, class : 0.061, t_rotation : 0.203, entropy : 0.123 - acc jigsaw : 91.41, class : 81.25 [bs:128]
30/42 of epoch 21/30 jigsaw : 0.317, class : 0.068, t_rotation : 0.166, entropy : 0.110 - acc jigsaw : 88.28, class : 74.22 [bs:128]
Accuracies on val: jigsaw : 96.03, class : 92.40
--------------------------------------------------------
Accuracies on test: jigsaw : 98.68, class : 82.95
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 21
New epoch - lr: 0.001
0/42 of epoch 22/30 jigsaw : 0.224, class : 0.076, t_rotation : 0.151, entropy : 0.163 - acc jigsaw : 92.97, class : 74.22 [bs:128]
30/42 of epoch 22/30 jigsaw : 0.237, class : 0.078, t_rotation : 0.088, entropy : 0.151 - acc jigsaw : 91.41, class : 72.66 [bs:128]
Accuracies on val: jigsaw : 96.36, class : 93.06
--------------------------------------------------------
Accuracies on test: jigsaw : 98.32, class : 83.23
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 22
New epoch - lr: 0.001
0/42 of epoch 23/30 jigsaw : 0.195, class : 0.039, t_rotation : 0.117, entropy : 0.145 - acc jigsaw : 91.41, class : 77.34 [bs:128]
30/42 of epoch 23/30 jigsaw : 0.171, class : 0.106, t_rotation : 0.093, entropy : 0.126 - acc jigsaw : 92.97, class : 78.91 [bs:128]
Accuracies on val: jigsaw : 96.20, class : 91.90
--------------------------------------------------------
Accuracies on test: jigsaw : 98.42, class : 84.07
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 23
New epoch - lr: 0.0001
0/42 of epoch 24/30 jigsaw : 0.346, class : 0.048, t_rotation : 0.149, entropy : 0.136 - acc jigsaw : 84.38, class : 74.22 [bs:128]
30/42 of epoch 24/30 jigsaw : 0.241, class : 0.066, t_rotation : 0.142, entropy : 0.136 - acc jigsaw : 94.53, class : 85.16 [bs:128]
Accuracies on val: jigsaw : 96.86, class : 92.40
--------------------------------------------------------
Accuracies on test: jigsaw : 98.57, class : 83.41
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 24
New epoch - lr: 0.0001
0/42 of epoch 25/30 jigsaw : 0.274, class : 0.020, t_rotation : 0.172, entropy : 0.160 - acc jigsaw : 89.84, class : 82.81 [bs:128]
30/42 of epoch 25/30 jigsaw : 0.288, class : 0.042, t_rotation : 0.166, entropy : 0.155 - acc jigsaw : 87.50, class : 81.25 [bs:128]
Accuracies on val: jigsaw : 96.86, class : 92.56
--------------------------------------------------------
Accuracies on test: jigsaw : 98.73, class : 83.53
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 25
New epoch - lr: 0.0001
0/42 of epoch 26/30 jigsaw : 0.270, class : 0.033, t_rotation : 0.162, entropy : 0.119 - acc jigsaw : 87.50, class : 78.91 [bs:128]
30/42 of epoch 26/30 jigsaw : 0.202, class : 0.057, t_rotation : 0.155, entropy : 0.118 - acc jigsaw : 92.19, class : 76.56 [bs:128]
Accuracies on val: jigsaw : 96.69, class : 92.23
--------------------------------------------------------
Accuracies on test: jigsaw : 98.68, class : 83.84
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 26
New epoch - lr: 0.0001
0/42 of epoch 27/30 jigsaw : 0.395, class : 0.086, t_rotation : 0.106, entropy : 0.145 - acc jigsaw : 85.94, class : 74.22 [bs:128]
30/42 of epoch 27/30 jigsaw : 0.199, class : 0.044, t_rotation : 0.102, entropy : 0.143 - acc jigsaw : 93.75, class : 79.69 [bs:128]
Accuracies on val: jigsaw : 96.53, class : 92.40
--------------------------------------------------------
Accuracies on test: jigsaw : 98.55, class : 83.66
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 27
New epoch - lr: 0.0001
0/42 of epoch 28/30 jigsaw : 0.407, class : 0.093, t_rotation : 0.167, entropy : 0.202 - acc jigsaw : 84.38, class : 75.78 [bs:128]
30/42 of epoch 28/30 jigsaw : 0.167, class : 0.037, t_rotation : 0.158, entropy : 0.198 - acc jigsaw : 93.75, class : 81.25 [bs:128]
Accuracies on val: jigsaw : 96.36, class : 92.07
--------------------------------------------------------
Accuracies on test: jigsaw : 98.42, class : 83.84
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 28
New epoch - lr: 0.0001
0/42 of epoch 29/30 jigsaw : 0.235, class : 0.092, t_rotation : 0.131, entropy : 0.184 - acc jigsaw : 89.84, class : 77.34 [bs:128]
30/42 of epoch 29/30 jigsaw : 0.310, class : 0.028, t_rotation : 0.126, entropy : 0.182 - acc jigsaw : 87.50, class : 76.56 [bs:128]
Accuracies on val: jigsaw : 96.03, class : 92.23
--------------------------------------------------------
Accuracies on test: jigsaw : 98.42, class : 84.02
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 29
New epoch - lr: 0.0001
0/42 of epoch 30/30 jigsaw : 0.207, class : 0.046, t_rotation : 0.159, entropy : 0.145 - acc jigsaw : 92.97, class : 82.81 [bs:128]
30/42 of epoch 30/30 jigsaw : 0.270, class : 0.037, t_rotation : 0.153, entropy : 0.144 - acc jigsaw : 90.62, class : 71.09 [bs:128]
Accuracies on val: jigsaw : 96.36, class : 92.73
--------------------------------------------------------
Accuracies on test: jigsaw : 98.65, class : 83.91
--------------------------------------------------------
2019-12-16 06:56:13
sketch
['photo', 'cartoon', 'art_painting']
unsupervised_task_weight: 0.8
bias_hole_image: 0.4
target_rotation_weight: 0.8
entropy_weight 0.2
only_classify the ordered image: True
Highest accuracy on validation set appears on epoch  tensor(21)
Highest accuracy on test set appears on epoch  tensor(22)
Accuracy on test set when the accuracy on validation set is highest:0.832
Highest accuracy on test set:0.841
It took 1058.76
--------------------------------------------------------
******************Start training**************************************
--------------------------------------------------------
Dataset size: training 5457, validation 605, testing 3929
--------------------------------------------------------
Namespace(TTA=False, batch_size=128, bias_whole_image=0.4, classify_only_ordered_images_or_not=True, domains_list=['photo', 'sketch', 'cartoon', 'art_painting'], entropy_loss_weight=0.2, epochs=30, folder_name='test', image_size=222, jitter=0.4, learning_rate=0.001, limit_source=None, limit_target=None, max_scale=1.0, min_scale=0.8, n_classes=7, nesterov=False, network='resnet18', ooo_weight=0, parameters_lists=[[0.8, 0.4, 0.8, 0.2], [0.8, 0.4, 0.8, 0.3], [0.8, 0.4, 0.8, 0.4]], random_horiz_flip=0.5, repeat_times=3, source=['photo', 'cartoon', 'art_painting'], suffix='', target='sketch', target_domain_list=['art_painting', 'cartoon', 'sketch', 'photo'], target_domain_unsupervised_task_loss_weight=0.8, tf_logger=True, tile_random_grayscale=0.1, train_all=True, unsupervised_task_weight=0.8, val_size=0.1)
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 0
New epoch - lr: 0.001
0/42 of epoch 1/30 jigsaw : 1.484, class : 2.033, t_rotation : 1.363, entropy : 1.864 - acc jigsaw : 26.56, class : 14.84 [bs:128]
30/42 of epoch 1/30 jigsaw : 1.007, class : 0.936, t_rotation : 0.715, entropy : 1.768 - acc jigsaw : 60.94, class : 69.53 [bs:128]
Accuracies on val: jigsaw : 93.06, class : 73.22
--------------------------------------------------------
Accuracies on test: jigsaw : 95.78, class : 45.56
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 1
New epoch - lr: 0.001
0/42 of epoch 2/30 jigsaw : 0.897, class : 0.935, t_rotation : 0.791, entropy : 1.660 - acc jigsaw : 64.84, class : 57.03 [bs:128]
30/42 of epoch 2/30 jigsaw : 0.787, class : 0.482, t_rotation : 0.601, entropy : 1.201 - acc jigsaw : 65.62, class : 80.47 [bs:128]
Accuracies on val: jigsaw : 98.02, class : 82.15
--------------------------------------------------------
Accuracies on test: jigsaw : 96.72, class : 66.51
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 2
New epoch - lr: 0.001
0/42 of epoch 3/30 jigsaw : 0.804, class : 0.408, t_rotation : 0.561, entropy : 1.068 - acc jigsaw : 65.62, class : 73.44 [bs:128]
30/42 of epoch 3/30 jigsaw : 0.720, class : 0.469, t_rotation : 0.482, entropy : 0.770 - acc jigsaw : 75.78, class : 70.31 [bs:128]
Accuracies on val: jigsaw : 94.05, class : 86.94
--------------------------------------------------------
Accuracies on test: jigsaw : 95.04, class : 70.65
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 3
New epoch - lr: 0.001
0/42 of epoch 4/30 jigsaw : 0.738, class : 0.299, t_rotation : 0.394, entropy : 0.707 - acc jigsaw : 73.44, class : 74.22 [bs:128]
30/42 of epoch 4/30 jigsaw : 0.573, class : 0.330, t_rotation : 0.332, entropy : 0.560 - acc jigsaw : 77.34, class : 76.56 [bs:128]
Accuracies on val: jigsaw : 94.55, class : 89.75
--------------------------------------------------------
Accuracies on test: jigsaw : 95.39, class : 74.83
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 4
New epoch - lr: 0.001
0/42 of epoch 5/30 jigsaw : 0.573, class : 0.339, t_rotation : 0.370, entropy : 0.553 - acc jigsaw : 82.03, class : 75.00 [bs:128]
30/42 of epoch 5/30 jigsaw : 0.480, class : 0.280, t_rotation : 0.317, entropy : 0.468 - acc jigsaw : 81.25, class : 77.34 [bs:128]
Accuracies on val: jigsaw : 90.08, class : 89.26
--------------------------------------------------------
Accuracies on test: jigsaw : 92.42, class : 73.66
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 5
New epoch - lr: 0.001
0/42 of epoch 6/30 jigsaw : 0.604, class : 0.279, t_rotation : 0.435, entropy : 0.484 - acc jigsaw : 73.44, class : 72.66 [bs:128]
30/42 of epoch 6/30 jigsaw : 0.486, class : 0.284, t_rotation : 0.346, entropy : 0.423 - acc jigsaw : 82.03, class : 76.56 [bs:128]
Accuracies on val: jigsaw : 92.40, class : 91.40
--------------------------------------------------------
Accuracies on test: jigsaw : 95.98, class : 77.98
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 6
New epoch - lr: 0.001
0/42 of epoch 7/30 jigsaw : 0.519, class : 0.251, t_rotation : 0.320, entropy : 0.363 - acc jigsaw : 84.38, class : 78.91 [bs:128]
30/42 of epoch 7/30 jigsaw : 0.533, class : 0.248, t_rotation : 0.252, entropy : 0.293 - acc jigsaw : 82.81, class : 69.53 [bs:128]
Accuracies on val: jigsaw : 94.38, class : 90.58
--------------------------------------------------------
Accuracies on test: jigsaw : 98.22, class : 79.28
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 7
New epoch - lr: 0.001
0/42 of epoch 8/30 jigsaw : 0.466, class : 0.177, t_rotation : 0.290, entropy : 0.320 - acc jigsaw : 83.59, class : 77.34 [bs:128]
30/42 of epoch 8/30 jigsaw : 0.514, class : 0.184, t_rotation : 0.235, entropy : 0.274 - acc jigsaw : 79.69, class : 73.44 [bs:128]
Accuracies on val: jigsaw : 94.88, class : 90.91
--------------------------------------------------------
Accuracies on test: jigsaw : 96.95, class : 78.29
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 8
New epoch - lr: 0.001
0/42 of epoch 9/30 jigsaw : 0.441, class : 0.287, t_rotation : 0.196, entropy : 0.264 - acc jigsaw : 82.81, class : 71.88 [bs:128]
30/42 of epoch 9/30 jigsaw : 0.451, class : 0.267, t_rotation : 0.170, entropy : 0.266 - acc jigsaw : 84.38, class : 82.81 [bs:128]
Accuracies on val: jigsaw : 95.87, class : 91.90
--------------------------------------------------------
Accuracies on test: jigsaw : 98.65, class : 79.21
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 9
New epoch - lr: 0.001
0/42 of epoch 10/30 jigsaw : 0.361, class : 0.183, t_rotation : 0.257, entropy : 0.325 - acc jigsaw : 85.16, class : 75.78 [bs:128]
30/42 of epoch 10/30 jigsaw : 0.440, class : 0.205, t_rotation : 0.216, entropy : 0.303 - acc jigsaw : 82.81, class : 71.88 [bs:128]
Accuracies on val: jigsaw : 93.72, class : 90.74
--------------------------------------------------------
Accuracies on test: jigsaw : 96.95, class : 81.32
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 10
New epoch - lr: 0.001
0/42 of epoch 11/30 jigsaw : 0.308, class : 0.137, t_rotation : 0.236, entropy : 0.316 - acc jigsaw : 89.06, class : 78.91 [bs:128]
30/42 of epoch 11/30 jigsaw : 0.330, class : 0.092, t_rotation : 0.169, entropy : 0.282 - acc jigsaw : 89.84, class : 74.22 [bs:128]
Accuracies on val: jigsaw : 94.55, class : 92.40
--------------------------------------------------------
Accuracies on test: jigsaw : 99.13, class : 80.89
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 11
New epoch - lr: 0.001
0/42 of epoch 12/30 jigsaw : 0.412, class : 0.147, t_rotation : 0.196, entropy : 0.194 - acc jigsaw : 86.72, class : 71.88 [bs:128]
30/42 of epoch 12/30 jigsaw : 0.276, class : 0.144, t_rotation : 0.158, entropy : 0.183 - acc jigsaw : 91.41, class : 76.56 [bs:128]
Accuracies on val: jigsaw : 93.55, class : 92.73
--------------------------------------------------------
Accuracies on test: jigsaw : 97.96, class : 80.48
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 12
New epoch - lr: 0.001
0/42 of epoch 13/30 jigsaw : 0.236, class : 0.146, t_rotation : 0.166, entropy : 0.189 - acc jigsaw : 90.62, class : 75.00 [bs:128]
30/42 of epoch 13/30 jigsaw : 0.255, class : 0.105, t_rotation : 0.125, entropy : 0.178 - acc jigsaw : 92.19, class : 78.12 [bs:128]
Accuracies on val: jigsaw : 92.73, class : 92.56
--------------------------------------------------------
Accuracies on test: jigsaw : 98.29, class : 82.06
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 13
New epoch - lr: 0.001
0/42 of epoch 14/30 jigsaw : 0.239, class : 0.128, t_rotation : 0.238, entropy : 0.205 - acc jigsaw : 88.28, class : 71.88 [bs:128]
30/42 of epoch 14/30 jigsaw : 0.237, class : 0.119, t_rotation : 0.192, entropy : 0.193 - acc jigsaw : 92.19, class : 74.22 [bs:128]
Accuracies on val: jigsaw : 92.89, class : 93.88
--------------------------------------------------------
Accuracies on test: jigsaw : 98.60, class : 80.71
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 14
New epoch - lr: 0.001
0/42 of epoch 15/30 jigsaw : 0.380, class : 0.143, t_rotation : 0.202, entropy : 0.156 - acc jigsaw : 88.28, class : 71.09 [bs:128]
30/42 of epoch 15/30 jigsaw : 0.325, class : 0.086, t_rotation : 0.153, entropy : 0.137 - acc jigsaw : 87.50, class : 83.59 [bs:128]
Accuracies on val: jigsaw : 95.54, class : 92.89
--------------------------------------------------------
Accuracies on test: jigsaw : 98.91, class : 81.75
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 15
New epoch - lr: 0.001
0/42 of epoch 16/30 jigsaw : 0.230, class : 0.175, t_rotation : 0.167, entropy : 0.142 - acc jigsaw : 91.41, class : 78.91 [bs:128]
30/42 of epoch 16/30 jigsaw : 0.238, class : 0.098, t_rotation : 0.118, entropy : 0.143 - acc jigsaw : 89.84, class : 80.47 [bs:128]
Accuracies on val: jigsaw : 95.54, class : 92.89
--------------------------------------------------------
Accuracies on test: jigsaw : 98.37, class : 83.81
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 16
New epoch - lr: 0.001
0/42 of epoch 17/30 jigsaw : 0.264, class : 0.099, t_rotation : 0.187, entropy : 0.187 - acc jigsaw : 89.84, class : 74.22 [bs:128]
30/42 of epoch 17/30 jigsaw : 0.246, class : 0.072, t_rotation : 0.151, entropy : 0.164 - acc jigsaw : 90.62, class : 77.34 [bs:128]
Accuracies on val: jigsaw : 94.88, class : 92.07
--------------------------------------------------------
Accuracies on test: jigsaw : 98.68, class : 83.05
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 17
New epoch - lr: 0.001
0/42 of epoch 18/30 jigsaw : 0.317, class : 0.087, t_rotation : 0.162, entropy : 0.162 - acc jigsaw : 86.72, class : 81.25 [bs:128]
30/42 of epoch 18/30 jigsaw : 0.299, class : 0.049, t_rotation : 0.125, entropy : 0.149 - acc jigsaw : 89.84, class : 82.81 [bs:128]
Accuracies on val: jigsaw : 95.70, class : 93.72
--------------------------------------------------------
Accuracies on test: jigsaw : 99.01, class : 82.59
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 18
New epoch - lr: 0.001
0/42 of epoch 19/30 jigsaw : 0.298, class : 0.117, t_rotation : 0.157, entropy : 0.241 - acc jigsaw : 89.06, class : 78.12 [bs:128]
30/42 of epoch 19/30 jigsaw : 0.259, class : 0.130, t_rotation : 0.105, entropy : 0.215 - acc jigsaw : 89.06, class : 76.56 [bs:128]
Accuracies on val: jigsaw : 95.54, class : 92.73
--------------------------------------------------------
Accuracies on test: jigsaw : 97.73, class : 84.81
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 19
New epoch - lr: 0.001
0/42 of epoch 20/30 jigsaw : 0.280, class : 0.070, t_rotation : 0.196, entropy : 0.145 - acc jigsaw : 89.06, class : 76.56 [bs:128]
30/42 of epoch 20/30 jigsaw : 0.203, class : 0.098, t_rotation : 0.158, entropy : 0.132 - acc jigsaw : 94.53, class : 79.69 [bs:128]
Accuracies on val: jigsaw : 94.55, class : 93.22
--------------------------------------------------------
Accuracies on test: jigsaw : 98.73, class : 85.26
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 20
New epoch - lr: 0.001
0/42 of epoch 21/30 jigsaw : 0.285, class : 0.069, t_rotation : 0.155, entropy : 0.176 - acc jigsaw : 91.41, class : 71.88 [bs:128]
30/42 of epoch 21/30 jigsaw : 0.307, class : 0.066, t_rotation : 0.131, entropy : 0.146 - acc jigsaw : 87.50, class : 78.12 [bs:128]
Accuracies on val: jigsaw : 96.36, class : 93.22
--------------------------------------------------------
Accuracies on test: jigsaw : 98.73, class : 84.09
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 21
New epoch - lr: 0.001
0/42 of epoch 22/30 jigsaw : 0.230, class : 0.028, t_rotation : 0.171, entropy : 0.166 - acc jigsaw : 92.19, class : 77.34 [bs:128]
30/42 of epoch 22/30 jigsaw : 0.233, class : 0.090, t_rotation : 0.165, entropy : 0.163 - acc jigsaw : 91.41, class : 81.25 [bs:128]
Accuracies on val: jigsaw : 95.54, class : 92.40
--------------------------------------------------------
Accuracies on test: jigsaw : 99.13, class : 84.40
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 22
New epoch - lr: 0.001
0/42 of epoch 23/30 jigsaw : 0.238, class : 0.065, t_rotation : 0.237, entropy : 0.141 - acc jigsaw : 92.97, class : 76.56 [bs:128]
30/42 of epoch 23/30 jigsaw : 0.230, class : 0.021, t_rotation : 0.194, entropy : 0.127 - acc jigsaw : 89.06, class : 81.25 [bs:128]
Accuracies on val: jigsaw : 95.54, class : 92.73
--------------------------------------------------------
Accuracies on test: jigsaw : 98.42, class : 84.17
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 23
New epoch - lr: 0.0001
0/42 of epoch 24/30 jigsaw : 0.219, class : 0.103, t_rotation : 0.157, entropy : 0.173 - acc jigsaw : 91.41, class : 79.69 [bs:128]
30/42 of epoch 24/30 jigsaw : 0.304, class : 0.047, t_rotation : 0.153, entropy : 0.170 - acc jigsaw : 92.19, class : 80.47 [bs:128]
Accuracies on val: jigsaw : 94.88, class : 92.73
--------------------------------------------------------
Accuracies on test: jigsaw : 98.50, class : 83.79
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 24
New epoch - lr: 0.0001
0/42 of epoch 25/30 jigsaw : 0.216, class : 0.018, t_rotation : 0.127, entropy : 0.091 - acc jigsaw : 92.97, class : 84.38 [bs:128]
30/42 of epoch 25/30 jigsaw : 0.287, class : 0.069, t_rotation : 0.124, entropy : 0.089 - acc jigsaw : 90.62, class : 83.59 [bs:128]
Accuracies on val: jigsaw : 96.03, class : 92.73
--------------------------------------------------------
Accuracies on test: jigsaw : 98.85, class : 84.04
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 25
New epoch - lr: 0.0001
0/42 of epoch 26/30 jigsaw : 0.225, class : 0.043, t_rotation : 0.103, entropy : 0.115 - acc jigsaw : 92.97, class : 75.00 [bs:128]
30/42 of epoch 26/30 jigsaw : 0.240, class : 0.045, t_rotation : 0.099, entropy : 0.114 - acc jigsaw : 89.06, class : 79.69 [bs:128]
Accuracies on val: jigsaw : 95.70, class : 92.73
--------------------------------------------------------
Accuracies on test: jigsaw : 98.83, class : 84.32
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 26
New epoch - lr: 0.0001
0/42 of epoch 27/30 jigsaw : 0.292, class : 0.060, t_rotation : 0.138, entropy : 0.153 - acc jigsaw : 91.41, class : 70.31 [bs:128]
30/42 of epoch 27/30 jigsaw : 0.270, class : 0.084, t_rotation : 0.132, entropy : 0.149 - acc jigsaw : 89.06, class : 76.56 [bs:128]
Accuracies on val: jigsaw : 95.70, class : 92.89
--------------------------------------------------------
Accuracies on test: jigsaw : 98.83, class : 84.02
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 27
New epoch - lr: 0.0001
0/42 of epoch 28/30 jigsaw : 0.371, class : 0.034, t_rotation : 0.181, entropy : 0.153 - acc jigsaw : 85.16, class : 74.22 [bs:128]
30/42 of epoch 28/30 jigsaw : 0.167, class : 0.012, t_rotation : 0.175, entropy : 0.149 - acc jigsaw : 92.97, class : 81.25 [bs:128]
Accuracies on val: jigsaw : 95.54, class : 92.73
--------------------------------------------------------
Accuracies on test: jigsaw : 98.88, class : 84.02
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 28
New epoch - lr: 0.0001
0/42 of epoch 29/30 jigsaw : 0.183, class : 0.024, t_rotation : 0.164, entropy : 0.101 - acc jigsaw : 96.09, class : 80.47 [bs:128]
30/42 of epoch 29/30 jigsaw : 0.237, class : 0.085, t_rotation : 0.158, entropy : 0.099 - acc jigsaw : 91.41, class : 78.91 [bs:128]
Accuracies on val: jigsaw : 96.20, class : 92.73
--------------------------------------------------------
Accuracies on test: jigsaw : 99.03, class : 84.09
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 29
New epoch - lr: 0.0001
0/42 of epoch 30/30 jigsaw : 0.190, class : 0.041, t_rotation : 0.130, entropy : 0.133 - acc jigsaw : 94.53, class : 78.12 [bs:128]
30/42 of epoch 30/30 jigsaw : 0.315, class : 0.038, t_rotation : 0.125, entropy : 0.130 - acc jigsaw : 90.62, class : 82.03 [bs:128]
Accuracies on val: jigsaw : 94.71, class : 92.73
--------------------------------------------------------
Accuracies on test: jigsaw : 98.93, class : 84.17
--------------------------------------------------------
2019-12-16 07:13:50
sketch
['photo', 'cartoon', 'art_painting']
unsupervised_task_weight: 0.8
bias_hole_image: 0.4
target_rotation_weight: 0.8
entropy_weight 0.2
only_classify the ordered image: True
Highest accuracy on validation set appears on epoch  tensor(13)
Highest accuracy on test set appears on epoch  tensor(19)
Accuracy on test set when the accuracy on validation set is highest:0.807
Highest accuracy on test set:0.853
It took 1056.95
--------------------------------------------------------
******************Start training**************************************
--------------------------------------------------------
Dataset size: training 5457, validation 605, testing 3929
--------------------------------------------------------
Namespace(TTA=False, batch_size=128, bias_whole_image=0.4, classify_only_ordered_images_or_not=True, domains_list=['photo', 'sketch', 'cartoon', 'art_painting'], entropy_loss_weight=0.2, epochs=30, folder_name='test', image_size=222, jitter=0.4, learning_rate=0.001, limit_source=None, limit_target=None, max_scale=1.0, min_scale=0.8, n_classes=7, nesterov=False, network='resnet18', ooo_weight=0, parameters_lists=[[0.8, 0.4, 0.8, 0.2], [0.8, 0.4, 0.8, 0.3], [0.8, 0.4, 0.8, 0.4]], random_horiz_flip=0.5, repeat_times=3, source=['photo', 'cartoon', 'art_painting'], suffix='', target='sketch', target_domain_list=['art_painting', 'cartoon', 'sketch', 'photo'], target_domain_unsupervised_task_loss_weight=0.8, tf_logger=True, tile_random_grayscale=0.1, train_all=True, unsupervised_task_weight=0.8, val_size=0.1)
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 0
New epoch - lr: 0.001
0/42 of epoch 1/30 jigsaw : 1.857, class : 2.232, t_rotation : 1.888, entropy : 1.772 - acc jigsaw : 16.41, class : 14.06 [bs:128]
30/42 of epoch 1/30 jigsaw : 1.166, class : 1.105, t_rotation : 0.932, entropy : 1.797 - acc jigsaw : 49.22, class : 55.47 [bs:128]
Accuracies on val: jigsaw : 96.03, class : 72.73
--------------------------------------------------------
Accuracies on test: jigsaw : 95.37, class : 45.46
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 1
New epoch - lr: 0.001
0/42 of epoch 2/30 jigsaw : 0.901, class : 0.838, t_rotation : 0.761, entropy : 1.646 - acc jigsaw : 64.06, class : 61.72 [bs:128]
30/42 of epoch 2/30 jigsaw : 0.802, class : 0.492, t_rotation : 0.586, entropy : 1.279 - acc jigsaw : 71.09, class : 76.56 [bs:128]
Accuracies on val: jigsaw : 95.37, class : 83.80
--------------------------------------------------------
Accuracies on test: jigsaw : 95.34, class : 61.34
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 2
New epoch - lr: 0.001
0/42 of epoch 3/30 jigsaw : 0.802, class : 0.408, t_rotation : 0.608, entropy : 1.016 - acc jigsaw : 66.41, class : 76.56 [bs:128]
30/42 of epoch 3/30 jigsaw : 0.636, class : 0.390, t_rotation : 0.496, entropy : 0.755 - acc jigsaw : 76.56, class : 79.69 [bs:128]
Accuracies on val: jigsaw : 96.53, class : 84.96
--------------------------------------------------------
Accuracies on test: jigsaw : 97.45, class : 66.61
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 3
New epoch - lr: 0.001
0/42 of epoch 4/30 jigsaw : 0.739, class : 0.407, t_rotation : 0.389, entropy : 0.734 - acc jigsaw : 67.19, class : 76.56 [bs:128]
30/42 of epoch 4/30 jigsaw : 0.583, class : 0.443, t_rotation : 0.319, entropy : 0.586 - acc jigsaw : 75.78, class : 74.22 [bs:128]
Accuracies on val: jigsaw : 95.37, class : 86.45
--------------------------------------------------------
Accuracies on test: jigsaw : 96.21, class : 70.30
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 4
New epoch - lr: 0.001
0/42 of epoch 5/30 jigsaw : 0.575, class : 0.386, t_rotation : 0.484, entropy : 0.595 - acc jigsaw : 78.12, class : 68.75 [bs:128]
30/42 of epoch 5/30 jigsaw : 0.537, class : 0.191, t_rotation : 0.415, entropy : 0.503 - acc jigsaw : 80.47, class : 76.56 [bs:128]
Accuracies on val: jigsaw : 94.38, class : 87.77
--------------------------------------------------------
Accuracies on test: jigsaw : 96.95, class : 70.96
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 5
New epoch - lr: 0.001
0/42 of epoch 6/30 jigsaw : 0.546, class : 0.299, t_rotation : 0.362, entropy : 0.481 - acc jigsaw : 76.56, class : 78.12 [bs:128]
30/42 of epoch 6/30 jigsaw : 0.515, class : 0.168, t_rotation : 0.286, entropy : 0.400 - acc jigsaw : 78.91, class : 72.66 [bs:128]
Accuracies on val: jigsaw : 94.71, class : 88.93
--------------------------------------------------------
Accuracies on test: jigsaw : 96.39, class : 71.57
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 6
New epoch - lr: 0.001
0/42 of epoch 7/30 jigsaw : 0.599, class : 0.228, t_rotation : 0.324, entropy : 0.387 - acc jigsaw : 74.22, class : 74.22 [bs:128]
30/42 of epoch 7/30 jigsaw : 0.372, class : 0.105, t_rotation : 0.278, entropy : 0.331 - acc jigsaw : 87.50, class : 77.34 [bs:128]
Accuracies on val: jigsaw : 93.88, class : 89.92
--------------------------------------------------------
Accuracies on test: jigsaw : 98.14, class : 71.39
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 7
New epoch - lr: 0.001
0/42 of epoch 8/30 jigsaw : 0.393, class : 0.286, t_rotation : 0.281, entropy : 0.424 - acc jigsaw : 86.72, class : 73.44 [bs:128]
30/42 of epoch 8/30 jigsaw : 0.375, class : 0.136, t_rotation : 0.210, entropy : 0.389 - acc jigsaw : 86.72, class : 77.34 [bs:128]
Accuracies on val: jigsaw : 93.55, class : 89.59
--------------------------------------------------------
Accuracies on test: jigsaw : 96.84, class : 73.48
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 8
New epoch - lr: 0.001
0/42 of epoch 9/30 jigsaw : 0.420, class : 0.177, t_rotation : 0.310, entropy : 0.331 - acc jigsaw : 84.38, class : 80.47 [bs:128]
30/42 of epoch 9/30 jigsaw : 0.382, class : 0.168, t_rotation : 0.247, entropy : 0.293 - acc jigsaw : 85.16, class : 75.00 [bs:128]
Accuracies on val: jigsaw : 94.38, class : 90.74
--------------------------------------------------------
Accuracies on test: jigsaw : 97.89, class : 73.40
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 9
New epoch - lr: 0.001
0/42 of epoch 10/30 jigsaw : 0.427, class : 0.091, t_rotation : 0.222, entropy : 0.267 - acc jigsaw : 82.81, class : 76.56 [bs:128]
30/42 of epoch 10/30 jigsaw : 0.324, class : 0.261, t_rotation : 0.195, entropy : 0.254 - acc jigsaw : 89.84, class : 78.12 [bs:128]
Accuracies on val: jigsaw : 93.72, class : 89.75
--------------------------------------------------------
Accuracies on test: jigsaw : 97.89, class : 75.39
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 10
New epoch - lr: 0.001
0/42 of epoch 11/30 jigsaw : 0.318, class : 0.148, t_rotation : 0.239, entropy : 0.248 - acc jigsaw : 88.28, class : 75.00 [bs:128]
30/42 of epoch 11/30 jigsaw : 0.330, class : 0.140, t_rotation : 0.172, entropy : 0.209 - acc jigsaw : 86.72, class : 81.25 [bs:128]
Accuracies on val: jigsaw : 92.73, class : 90.25
--------------------------------------------------------
Accuracies on test: jigsaw : 97.23, class : 75.92
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 11
New epoch - lr: 0.001
0/42 of epoch 12/30 jigsaw : 0.388, class : 0.231, t_rotation : 0.197, entropy : 0.300 - acc jigsaw : 83.59, class : 78.12 [bs:128]
30/42 of epoch 12/30 jigsaw : 0.356, class : 0.068, t_rotation : 0.154, entropy : 0.268 - acc jigsaw : 85.94, class : 80.47 [bs:128]
Accuracies on val: jigsaw : 94.55, class : 90.58
--------------------------------------------------------
Accuracies on test: jigsaw : 96.95, class : 76.92
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 12
New epoch - lr: 0.001
0/42 of epoch 13/30 jigsaw : 0.342, class : 0.073, t_rotation : 0.195, entropy : 0.261 - acc jigsaw : 89.84, class : 75.78 [bs:128]
30/42 of epoch 13/30 jigsaw : 0.339, class : 0.120, t_rotation : 0.144, entropy : 0.242 - acc jigsaw : 88.28, class : 74.22 [bs:128]
Accuracies on val: jigsaw : 94.05, class : 90.41
--------------------------------------------------------
Accuracies on test: jigsaw : 97.84, class : 76.18
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 13
New epoch - lr: 0.001
0/42 of epoch 14/30 jigsaw : 0.434, class : 0.147, t_rotation : 0.207, entropy : 0.171 - acc jigsaw : 82.81, class : 74.22 [bs:128]
30/42 of epoch 14/30 jigsaw : 0.258, class : 0.245, t_rotation : 0.163, entropy : 0.148 - acc jigsaw : 93.75, class : 70.31 [bs:128]
Accuracies on val: jigsaw : 93.06, class : 91.40
--------------------------------------------------------
Accuracies on test: jigsaw : 97.68, class : 77.35
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 14
New epoch - lr: 0.001
0/42 of epoch 15/30 jigsaw : 0.272, class : 0.091, t_rotation : 0.159, entropy : 0.204 - acc jigsaw : 90.62, class : 80.47 [bs:128]
30/42 of epoch 15/30 jigsaw : 0.260, class : 0.191, t_rotation : 0.130, entropy : 0.178 - acc jigsaw : 88.28, class : 72.66 [bs:128]
Accuracies on val: jigsaw : 95.21, class : 91.40
--------------------------------------------------------
Accuracies on test: jigsaw : 98.93, class : 77.20
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 15
New epoch - lr: 0.001
0/42 of epoch 16/30 jigsaw : 0.321, class : 0.041, t_rotation : 0.097, entropy : 0.162 - acc jigsaw : 87.50, class : 83.59 [bs:128]
30/42 of epoch 16/30 jigsaw : 0.272, class : 0.073, t_rotation : 0.088, entropy : 0.132 - acc jigsaw : 92.19, class : 78.12 [bs:128]
Accuracies on val: jigsaw : 94.05, class : 92.40
--------------------------------------------------------
Accuracies on test: jigsaw : 98.40, class : 77.04
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 16
New epoch - lr: 0.001
0/42 of epoch 17/30 jigsaw : 0.330, class : 0.132, t_rotation : 0.128, entropy : 0.173 - acc jigsaw : 86.72, class : 76.56 [bs:128]
30/42 of epoch 17/30 jigsaw : 0.262, class : 0.107, t_rotation : 0.091, entropy : 0.174 - acc jigsaw : 89.06, class : 77.34 [bs:128]
Accuracies on val: jigsaw : 93.72, class : 92.07
--------------------------------------------------------
Accuracies on test: jigsaw : 98.50, class : 78.85
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 17
New epoch - lr: 0.001
0/42 of epoch 18/30 jigsaw : 0.325, class : 0.045, t_rotation : 0.189, entropy : 0.194 - acc jigsaw : 86.72, class : 83.59 [bs:128]
30/42 of epoch 18/30 jigsaw : 0.367, class : 0.102, t_rotation : 0.130, entropy : 0.174 - acc jigsaw : 83.59, class : 79.69 [bs:128]
Accuracies on val: jigsaw : 94.38, class : 91.57
--------------------------------------------------------
Accuracies on test: jigsaw : 97.94, class : 76.48
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 18
New epoch - lr: 0.001
0/42 of epoch 19/30 jigsaw : 0.330, class : 0.071, t_rotation : 0.086, entropy : 0.140 - acc jigsaw : 86.72, class : 81.25 [bs:128]
30/42 of epoch 19/30 jigsaw : 0.224, class : 0.156, t_rotation : 0.069, entropy : 0.146 - acc jigsaw : 92.19, class : 78.91 [bs:128]
Accuracies on val: jigsaw : 94.05, class : 90.74
--------------------------------------------------------
Accuracies on test: jigsaw : 98.75, class : 78.19
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 19
New epoch - lr: 0.001
0/42 of epoch 20/30 jigsaw : 0.308, class : 0.045, t_rotation : 0.123, entropy : 0.160 - acc jigsaw : 89.06, class : 78.12 [bs:128]
30/42 of epoch 20/30 jigsaw : 0.216, class : 0.047, t_rotation : 0.084, entropy : 0.134 - acc jigsaw : 92.97, class : 78.91 [bs:128]
Accuracies on val: jigsaw : 94.55, class : 91.57
--------------------------------------------------------
Accuracies on test: jigsaw : 99.26, class : 76.00
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 20
New epoch - lr: 0.001
0/42 of epoch 21/30 jigsaw : 0.327, class : 0.082, t_rotation : 0.085, entropy : 0.220 - acc jigsaw : 86.72, class : 75.00 [bs:128]
30/42 of epoch 21/30 jigsaw : 0.313, class : 0.034, t_rotation : 0.071, entropy : 0.203 - acc jigsaw : 87.50, class : 73.44 [bs:128]
Accuracies on val: jigsaw : 93.22, class : 91.74
--------------------------------------------------------
Accuracies on test: jigsaw : 98.63, class : 76.76
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 21
New epoch - lr: 0.001
0/42 of epoch 22/30 jigsaw : 0.298, class : 0.081, t_rotation : 0.137, entropy : 0.201 - acc jigsaw : 89.84, class : 77.34 [bs:128]
30/42 of epoch 22/30 jigsaw : 0.243, class : 0.111, t_rotation : 0.102, entropy : 0.176 - acc jigsaw : 92.19, class : 81.25 [bs:128]
Accuracies on val: jigsaw : 94.88, class : 91.57
--------------------------------------------------------
Accuracies on test: jigsaw : 99.11, class : 78.60
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 22
New epoch - lr: 0.001
0/42 of epoch 23/30 jigsaw : 0.336, class : 0.046, t_rotation : 0.133, entropy : 0.153 - acc jigsaw : 87.50, class : 73.44 [bs:128]
30/42 of epoch 23/30 jigsaw : 0.360, class : 0.096, t_rotation : 0.098, entropy : 0.146 - acc jigsaw : 89.06, class : 82.81 [bs:128]
Accuracies on val: jigsaw : 94.21, class : 92.07
--------------------------------------------------------
Accuracies on test: jigsaw : 98.63, class : 77.93
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 23
New epoch - lr: 0.0001
0/42 of epoch 24/30 jigsaw : 0.202, class : 0.072, t_rotation : 0.073, entropy : 0.108 - acc jigsaw : 92.97, class : 75.00 [bs:128]
30/42 of epoch 24/30 jigsaw : 0.354, class : 0.066, t_rotation : 0.071, entropy : 0.105 - acc jigsaw : 88.28, class : 83.59 [bs:128]
Accuracies on val: jigsaw : 95.87, class : 92.23
--------------------------------------------------------
Accuracies on test: jigsaw : 99.03, class : 78.16
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 24
New epoch - lr: 0.0001
0/42 of epoch 25/30 jigsaw : 0.218, class : 0.042, t_rotation : 0.103, entropy : 0.168 - acc jigsaw : 92.19, class : 78.91 [bs:128]
30/42 of epoch 25/30 jigsaw : 0.270, class : 0.064, t_rotation : 0.098, entropy : 0.164 - acc jigsaw : 89.84, class : 78.91 [bs:128]
Accuracies on val: jigsaw : 95.37, class : 92.56
--------------------------------------------------------
Accuracies on test: jigsaw : 98.93, class : 78.21
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 25
New epoch - lr: 0.0001
0/42 of epoch 26/30 jigsaw : 0.161, class : 0.039, t_rotation : 0.126, entropy : 0.154 - acc jigsaw : 93.75, class : 77.34 [bs:128]
30/42 of epoch 26/30 jigsaw : 0.227, class : 0.042, t_rotation : 0.123, entropy : 0.151 - acc jigsaw : 92.97, class : 83.59 [bs:128]
Accuracies on val: jigsaw : 94.71, class : 92.56
--------------------------------------------------------
Accuracies on test: jigsaw : 99.06, class : 78.42
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 26
New epoch - lr: 0.0001
0/42 of epoch 27/30 jigsaw : 0.186, class : 0.049, t_rotation : 0.125, entropy : 0.136 - acc jigsaw : 92.19, class : 81.25 [bs:128]
30/42 of epoch 27/30 jigsaw : 0.246, class : 0.177, t_rotation : 0.122, entropy : 0.135 - acc jigsaw : 89.84, class : 71.88 [bs:128]
Accuracies on val: jigsaw : 95.04, class : 92.40
--------------------------------------------------------
Accuracies on test: jigsaw : 99.21, class : 78.24
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 27
New epoch - lr: 0.0001
0/42 of epoch 28/30 jigsaw : 0.233, class : 0.080, t_rotation : 0.157, entropy : 0.115 - acc jigsaw : 91.41, class : 79.69 [bs:128]
30/42 of epoch 28/30 jigsaw : 0.184, class : 0.016, t_rotation : 0.153, entropy : 0.113 - acc jigsaw : 94.53, class : 85.94 [bs:128]
Accuracies on val: jigsaw : 95.54, class : 92.56
--------------------------------------------------------
Accuracies on test: jigsaw : 99.34, class : 78.09
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 28
New epoch - lr: 0.0001
0/42 of epoch 29/30 jigsaw : 0.174, class : 0.024, t_rotation : 0.154, entropy : 0.168 - acc jigsaw : 93.75, class : 73.44 [bs:128]
30/42 of epoch 29/30 jigsaw : 0.216, class : 0.027, t_rotation : 0.150, entropy : 0.166 - acc jigsaw : 91.41, class : 78.91 [bs:128]
Accuracies on val: jigsaw : 94.38, class : 92.40
--------------------------------------------------------
Accuracies on test: jigsaw : 98.96, class : 77.70
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 29
New epoch - lr: 0.0001
0/42 of epoch 30/30 jigsaw : 0.193, class : 0.013, t_rotation : 0.085, entropy : 0.192 - acc jigsaw : 89.84, class : 77.34 [bs:128]
30/42 of epoch 30/30 jigsaw : 0.238, class : 0.039, t_rotation : 0.082, entropy : 0.192 - acc jigsaw : 90.62, class : 76.56 [bs:128]
Accuracies on val: jigsaw : 95.37, class : 92.56
--------------------------------------------------------
Accuracies on test: jigsaw : 99.13, class : 77.81
--------------------------------------------------------
2019-12-16 07:31:27
sketch
['photo', 'cartoon', 'art_painting']
unsupervised_task_weight: 0.8
bias_hole_image: 0.4
target_rotation_weight: 0.8
entropy_weight 0.2
only_classify the ordered image: True
Highest accuracy on validation set appears on epoch  tensor(29)
Highest accuracy on test set appears on epoch  tensor(16)
Accuracy on test set when the accuracy on validation set is highest:0.778
Highest accuracy on test set:0.788
It took 1056.5
--------------------------------------------------------
******************Start training**************************************
--------------------------------------------------------
Dataset size: training 7491, validation 830, testing 1670
--------------------------------------------------------
Namespace(TTA=False, batch_size=128, bias_whole_image=0.4, classify_only_ordered_images_or_not=True, domains_list=['photo', 'sketch', 'cartoon', 'art_painting'], entropy_loss_weight=0.2, epochs=30, folder_name='test', image_size=222, jitter=0.4, learning_rate=0.001, limit_source=None, limit_target=None, max_scale=1.0, min_scale=0.8, n_classes=7, nesterov=False, network='resnet18', ooo_weight=0, parameters_lists=[[0.8, 0.4, 0.8, 0.2], [0.8, 0.4, 0.8, 0.3], [0.8, 0.4, 0.8, 0.4]], random_horiz_flip=0.5, repeat_times=3, source=['sketch', 'cartoon', 'art_painting'], suffix='', target='photo', target_domain_list=['art_painting', 'cartoon', 'sketch', 'photo'], target_domain_unsupervised_task_loss_weight=0.8, tf_logger=True, tile_random_grayscale=0.1, train_all=True, unsupervised_task_weight=0.8, val_size=0.1)
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 0
New epoch - lr: 0.001
0/58 of epoch 1/30 jigsaw : 1.839, class : 1.996, t_rotation : 1.780, entropy : 1.822 - acc jigsaw : 11.72, class : 13.28 [bs:128]
30/58 of epoch 1/30 jigsaw : 0.990, class : 1.370, t_rotation : 0.780, entropy : 1.644 - acc jigsaw : 60.94, class : 41.41 [bs:128]
Accuracies on val: jigsaw : 87.11, class : 70.12
--------------------------------------------------------
Accuracies on test: jigsaw : 97.31, class : 79.88
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 1
New epoch - lr: 0.001
0/58 of epoch 2/30 jigsaw : 0.875, class : 0.907, t_rotation : 0.633, entropy : 1.278 - acc jigsaw : 64.06, class : 62.50 [bs:128]
30/58 of epoch 2/30 jigsaw : 0.637, class : 0.609, t_rotation : 0.398, entropy : 0.661 - acc jigsaw : 70.31, class : 68.75 [bs:128]
Accuracies on val: jigsaw : 88.31, class : 81.69
--------------------------------------------------------
Accuracies on test: jigsaw : 97.84, class : 94.79
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 2
New epoch - lr: 0.001
0/58 of epoch 3/30 jigsaw : 0.737, class : 0.308, t_rotation : 0.468, entropy : 0.446 - acc jigsaw : 67.19, class : 71.09 [bs:128]
30/58 of epoch 3/30 jigsaw : 0.615, class : 0.496, t_rotation : 0.344, entropy : 0.293 - acc jigsaw : 80.47, class : 68.75 [bs:128]
Accuracies on val: jigsaw : 86.87, class : 82.65
--------------------------------------------------------
Accuracies on test: jigsaw : 97.25, class : 96.47
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 3
New epoch - lr: 0.001
0/58 of epoch 4/30 jigsaw : 0.660, class : 0.325, t_rotation : 0.408, entropy : 0.312 - acc jigsaw : 79.69, class : 70.31 [bs:128]
30/58 of epoch 4/30 jigsaw : 0.609, class : 0.387, t_rotation : 0.233, entropy : 0.231 - acc jigsaw : 82.03, class : 69.53 [bs:128]
Accuracies on val: jigsaw : 89.76, class : 83.86
--------------------------------------------------------
Accuracies on test: jigsaw : 98.08, class : 97.01
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 4
New epoch - lr: 0.001
0/58 of epoch 5/30 jigsaw : 0.509, class : 0.350, t_rotation : 0.388, entropy : 0.215 - acc jigsaw : 85.16, class : 71.88 [bs:128]
30/58 of epoch 5/30 jigsaw : 0.428, class : 0.331, t_rotation : 0.211, entropy : 0.152 - acc jigsaw : 83.59, class : 72.66 [bs:128]
Accuracies on val: jigsaw : 90.12, class : 85.30
--------------------------------------------------------
Accuracies on test: jigsaw : 97.90, class : 96.95
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 5
New epoch - lr: 0.001
0/58 of epoch 6/30 jigsaw : 0.446, class : 0.154, t_rotation : 0.281, entropy : 0.121 - acc jigsaw : 81.25, class : 75.00 [bs:128]
30/58 of epoch 6/30 jigsaw : 0.519, class : 0.161, t_rotation : 0.245, entropy : 0.096 - acc jigsaw : 81.25, class : 69.53 [bs:128]
Accuracies on val: jigsaw : 90.84, class : 88.31
--------------------------------------------------------
Accuracies on test: jigsaw : 98.32, class : 97.49
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 6
New epoch - lr: 0.001
0/58 of epoch 7/30 jigsaw : 0.308, class : 0.140, t_rotation : 0.170, entropy : 0.156 - acc jigsaw : 90.62, class : 68.75 [bs:128]
30/58 of epoch 7/30 jigsaw : 0.384, class : 0.326, t_rotation : 0.168, entropy : 0.107 - acc jigsaw : 86.72, class : 67.97 [bs:128]
Accuracies on val: jigsaw : 93.25, class : 87.83
--------------------------------------------------------
Accuracies on test: jigsaw : 98.74, class : 97.43
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 7
New epoch - lr: 0.001
0/58 of epoch 8/30 jigsaw : 0.304, class : 0.257, t_rotation : 0.236, entropy : 0.165 - acc jigsaw : 89.84, class : 75.00 [bs:128]
30/58 of epoch 8/30 jigsaw : 0.573, class : 0.176, t_rotation : 0.104, entropy : 0.108 - acc jigsaw : 78.91, class : 82.81 [bs:128]
Accuracies on val: jigsaw : 90.96, class : 89.28
--------------------------------------------------------
Accuracies on test: jigsaw : 98.86, class : 97.90
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 8
New epoch - lr: 0.001
0/58 of epoch 9/30 jigsaw : 0.243, class : 0.185, t_rotation : 0.164, entropy : 0.113 - acc jigsaw : 91.41, class : 76.56 [bs:128]
30/58 of epoch 9/30 jigsaw : 0.328, class : 0.233, t_rotation : 0.228, entropy : 0.151 - acc jigsaw : 87.50, class : 75.78 [bs:128]
Accuracies on val: jigsaw : 92.53, class : 87.95
--------------------------------------------------------
Accuracies on test: jigsaw : 99.16, class : 97.43
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 9
New epoch - lr: 0.001
0/58 of epoch 10/30 jigsaw : 0.324, class : 0.178, t_rotation : 0.150, entropy : 0.080 - acc jigsaw : 89.06, class : 75.78 [bs:128]
30/58 of epoch 10/30 jigsaw : 0.287, class : 0.082, t_rotation : 0.133, entropy : 0.049 - acc jigsaw : 89.84, class : 71.09 [bs:128]
Accuracies on val: jigsaw : 90.48, class : 89.04
--------------------------------------------------------
Accuracies on test: jigsaw : 98.74, class : 97.37
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 10
New epoch - lr: 0.001
0/58 of epoch 11/30 jigsaw : 0.309, class : 0.141, t_rotation : 0.175, entropy : 0.103 - acc jigsaw : 88.28, class : 75.00 [bs:128]
30/58 of epoch 11/30 jigsaw : 0.251, class : 0.086, t_rotation : 0.099, entropy : 0.081 - acc jigsaw : 90.62, class : 67.97 [bs:128]
Accuracies on val: jigsaw : 89.28, class : 89.28
--------------------------------------------------------
Accuracies on test: jigsaw : 99.22, class : 97.60
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 11
New epoch - lr: 0.001
0/58 of epoch 12/30 jigsaw : 0.328, class : 0.153, t_rotation : 0.136, entropy : 0.102 - acc jigsaw : 87.50, class : 73.44 [bs:128]
30/58 of epoch 12/30 jigsaw : 0.245, class : 0.108, t_rotation : 0.137, entropy : 0.098 - acc jigsaw : 91.41, class : 78.91 [bs:128]
Accuracies on val: jigsaw : 92.05, class : 89.28
--------------------------------------------------------
Accuracies on test: jigsaw : 99.16, class : 97.72
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 12
New epoch - lr: 0.001
0/58 of epoch 13/30 jigsaw : 0.297, class : 0.245, t_rotation : 0.149, entropy : 0.068 - acc jigsaw : 88.28, class : 74.22 [bs:128]
30/58 of epoch 13/30 jigsaw : 0.150, class : 0.184, t_rotation : 0.165, entropy : 0.114 - acc jigsaw : 95.31, class : 70.31 [bs:128]
Accuracies on val: jigsaw : 92.65, class : 90.12
--------------------------------------------------------
Accuracies on test: jigsaw : 99.28, class : 97.66
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 13
New epoch - lr: 0.001
0/58 of epoch 14/30 jigsaw : 0.248, class : 0.083, t_rotation : 0.090, entropy : 0.099 - acc jigsaw : 91.41, class : 74.22 [bs:128]
30/58 of epoch 14/30 jigsaw : 0.266, class : 0.114, t_rotation : 0.090, entropy : 0.049 - acc jigsaw : 88.28, class : 77.34 [bs:128]
Accuracies on val: jigsaw : 92.17, class : 90.12
--------------------------------------------------------
Accuracies on test: jigsaw : 99.40, class : 97.49
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 14
New epoch - lr: 0.001
0/58 of epoch 15/30 jigsaw : 0.215, class : 0.097, t_rotation : 0.180, entropy : 0.077 - acc jigsaw : 92.19, class : 74.22 [bs:128]
30/58 of epoch 15/30 jigsaw : 0.182, class : 0.092, t_rotation : 0.092, entropy : 0.066 - acc jigsaw : 94.53, class : 80.47 [bs:128]
Accuracies on val: jigsaw : 91.69, class : 91.33
--------------------------------------------------------
Accuracies on test: jigsaw : 99.16, class : 97.78
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 15
New epoch - lr: 0.001
0/58 of epoch 16/30 jigsaw : 0.229, class : 0.100, t_rotation : 0.077, entropy : 0.058 - acc jigsaw : 92.19, class : 72.66 [bs:128]
30/58 of epoch 16/30 jigsaw : 0.283, class : 0.129, t_rotation : 0.093, entropy : 0.052 - acc jigsaw : 89.84, class : 79.69 [bs:128]
Accuracies on val: jigsaw : 93.01, class : 91.93
--------------------------------------------------------
Accuracies on test: jigsaw : 99.34, class : 97.84
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 16
New epoch - lr: 0.001
0/58 of epoch 17/30 jigsaw : 0.275, class : 0.144, t_rotation : 0.146, entropy : 0.044 - acc jigsaw : 88.28, class : 79.69 [bs:128]
30/58 of epoch 17/30 jigsaw : 0.242, class : 0.079, t_rotation : 0.060, entropy : 0.040 - acc jigsaw : 89.84, class : 72.66 [bs:128]
Accuracies on val: jigsaw : 92.65, class : 92.41
--------------------------------------------------------
Accuracies on test: jigsaw : 99.46, class : 97.90
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 17
New epoch - lr: 0.001
0/58 of epoch 18/30 jigsaw : 0.240, class : 0.061, t_rotation : 0.122, entropy : 0.048 - acc jigsaw : 91.41, class : 76.56 [bs:128]
30/58 of epoch 18/30 jigsaw : 0.238, class : 0.046, t_rotation : 0.081, entropy : 0.057 - acc jigsaw : 92.19, class : 75.78 [bs:128]
Accuracies on val: jigsaw : 91.57, class : 91.81
--------------------------------------------------------
Accuracies on test: jigsaw : 99.22, class : 97.96
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 18
New epoch - lr: 0.001
0/58 of epoch 19/30 jigsaw : 0.160, class : 0.158, t_rotation : 0.053, entropy : 0.068 - acc jigsaw : 94.53, class : 71.88 [bs:128]
30/58 of epoch 19/30 jigsaw : 0.210, class : 0.054, t_rotation : 0.140, entropy : 0.056 - acc jigsaw : 93.75, class : 77.34 [bs:128]
Accuracies on val: jigsaw : 93.13, class : 91.08
--------------------------------------------------------
Accuracies on test: jigsaw : 99.34, class : 97.66
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 19
New epoch - lr: 0.001
0/58 of epoch 20/30 jigsaw : 0.161, class : 0.075, t_rotation : 0.076, entropy : 0.057 - acc jigsaw : 95.31, class : 73.44 [bs:128]
30/58 of epoch 20/30 jigsaw : 0.193, class : 0.084, t_rotation : 0.085, entropy : 0.029 - acc jigsaw : 92.19, class : 76.56 [bs:128]
Accuracies on val: jigsaw : 91.33, class : 91.33
--------------------------------------------------------
Accuracies on test: jigsaw : 99.46, class : 97.84
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 20
New epoch - lr: 0.001
0/58 of epoch 21/30 jigsaw : 0.225, class : 0.075, t_rotation : 0.105, entropy : 0.095 - acc jigsaw : 91.41, class : 71.09 [bs:128]
30/58 of epoch 21/30 jigsaw : 0.323, class : 0.089, t_rotation : 0.062, entropy : 0.079 - acc jigsaw : 87.50, class : 76.56 [bs:128]
Accuracies on val: jigsaw : 92.77, class : 91.93
--------------------------------------------------------
Accuracies on test: jigsaw : 99.46, class : 97.66
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 21
New epoch - lr: 0.001
0/58 of epoch 22/30 jigsaw : 0.134, class : 0.033, t_rotation : 0.113, entropy : 0.063 - acc jigsaw : 95.31, class : 82.81 [bs:128]
30/58 of epoch 22/30 jigsaw : 0.238, class : 0.056, t_rotation : 0.034, entropy : 0.090 - acc jigsaw : 92.19, class : 78.12 [bs:128]
Accuracies on val: jigsaw : 93.98, class : 91.57
--------------------------------------------------------
Accuracies on test: jigsaw : 99.52, class : 97.90
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 22
New epoch - lr: 0.001
0/58 of epoch 23/30 jigsaw : 0.140, class : 0.082, t_rotation : 0.147, entropy : 0.028 - acc jigsaw : 96.09, class : 73.44 [bs:128]
30/58 of epoch 23/30 jigsaw : 0.197, class : 0.051, t_rotation : 0.109, entropy : 0.035 - acc jigsaw : 92.19, class : 78.12 [bs:128]
Accuracies on val: jigsaw : 93.01, class : 91.81
--------------------------------------------------------
Accuracies on test: jigsaw : 99.28, class : 97.84
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 23
New epoch - lr: 0.0001
0/58 of epoch 24/30 jigsaw : 0.150, class : 0.085, t_rotation : 0.091, entropy : 0.037 - acc jigsaw : 93.75, class : 78.12 [bs:128]
30/58 of epoch 24/30 jigsaw : 0.227, class : 0.046, t_rotation : 0.085, entropy : 0.018 - acc jigsaw : 91.41, class : 71.09 [bs:128]
Accuracies on val: jigsaw : 94.22, class : 91.69
--------------------------------------------------------
Accuracies on test: jigsaw : 99.52, class : 97.90
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 24
New epoch - lr: 0.0001
0/58 of epoch 25/30 jigsaw : 0.241, class : 0.033, t_rotation : 0.053, entropy : 0.027 - acc jigsaw : 90.62, class : 78.91 [bs:128]
30/58 of epoch 25/30 jigsaw : 0.183, class : 0.027, t_rotation : 0.100, entropy : 0.044 - acc jigsaw : 92.19, class : 79.69 [bs:128]
Accuracies on val: jigsaw : 94.46, class : 91.81
--------------------------------------------------------
Accuracies on test: jigsaw : 99.52, class : 97.84
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 25
New epoch - lr: 0.0001
0/58 of epoch 26/30 jigsaw : 0.217, class : 0.069, t_rotation : 0.060, entropy : 0.067 - acc jigsaw : 91.41, class : 78.91 [bs:128]
30/58 of epoch 26/30 jigsaw : 0.252, class : 0.095, t_rotation : 0.116, entropy : 0.061 - acc jigsaw : 92.19, class : 73.44 [bs:128]
Accuracies on val: jigsaw : 93.61, class : 91.93
--------------------------------------------------------
Accuracies on test: jigsaw : 99.46, class : 97.90
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 26
New epoch - lr: 0.0001
0/58 of epoch 27/30 jigsaw : 0.158, class : 0.050, t_rotation : 0.174, entropy : 0.033 - acc jigsaw : 93.75, class : 75.00 [bs:128]
30/58 of epoch 27/30 jigsaw : 0.215, class : 0.031, t_rotation : 0.076, entropy : 0.023 - acc jigsaw : 92.97, class : 85.94 [bs:128]
Accuracies on val: jigsaw : 94.22, class : 91.81
--------------------------------------------------------
Accuracies on test: jigsaw : 99.52, class : 97.84
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 27
New epoch - lr: 0.0001
0/58 of epoch 28/30 jigsaw : 0.249, class : 0.039, t_rotation : 0.087, entropy : 0.053 - acc jigsaw : 89.84, class : 82.81 [bs:128]
30/58 of epoch 28/30 jigsaw : 0.200, class : 0.085, t_rotation : 0.105, entropy : 0.030 - acc jigsaw : 93.75, class : 75.78 [bs:128]
Accuracies on val: jigsaw : 93.61, class : 91.69
--------------------------------------------------------
Accuracies on test: jigsaw : 99.58, class : 97.96
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 28
New epoch - lr: 0.0001
0/58 of epoch 29/30 jigsaw : 0.157, class : 0.067, t_rotation : 0.123, entropy : 0.035 - acc jigsaw : 94.53, class : 75.00 [bs:128]
30/58 of epoch 29/30 jigsaw : 0.181, class : 0.040, t_rotation : 0.089, entropy : 0.027 - acc jigsaw : 92.19, class : 82.81 [bs:128]
Accuracies on val: jigsaw : 94.10, class : 91.57
--------------------------------------------------------
Accuracies on test: jigsaw : 99.58, class : 98.02
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 29
New epoch - lr: 0.0001
0/58 of epoch 30/30 jigsaw : 0.265, class : 0.061, t_rotation : 0.044, entropy : 0.031 - acc jigsaw : 92.19, class : 71.09 [bs:128]
30/58 of epoch 30/30 jigsaw : 0.177, class : 0.043, t_rotation : 0.106, entropy : 0.050 - acc jigsaw : 93.75, class : 82.81 [bs:128]
Accuracies on val: jigsaw : 93.98, class : 92.41
--------------------------------------------------------
Accuracies on test: jigsaw : 99.52, class : 97.90
--------------------------------------------------------
2019-12-16 07:53:44
photo
['sketch', 'cartoon', 'art_painting']
unsupervised_task_weight: 0.8
bias_hole_image: 0.4
target_rotation_weight: 0.8
entropy_weight 0.2
only_classify the ordered image: True
Highest accuracy on validation set appears on epoch  tensor(29)
Highest accuracy on test set appears on epoch  tensor(28)
Accuracy on test set when the accuracy on validation set is highest:0.979
Highest accuracy on test set:0.980
It took 1336.85
--------------------------------------------------------
******************Start training**************************************
--------------------------------------------------------
Dataset size: training 7491, validation 830, testing 1670
--------------------------------------------------------
Namespace(TTA=False, batch_size=128, bias_whole_image=0.4, classify_only_ordered_images_or_not=True, domains_list=['photo', 'sketch', 'cartoon', 'art_painting'], entropy_loss_weight=0.2, epochs=30, folder_name='test', image_size=222, jitter=0.4, learning_rate=0.001, limit_source=None, limit_target=None, max_scale=1.0, min_scale=0.8, n_classes=7, nesterov=False, network='resnet18', ooo_weight=0, parameters_lists=[[0.8, 0.4, 0.8, 0.2], [0.8, 0.4, 0.8, 0.3], [0.8, 0.4, 0.8, 0.4]], random_horiz_flip=0.5, repeat_times=3, source=['sketch', 'cartoon', 'art_painting'], suffix='', target='photo', target_domain_list=['art_painting', 'cartoon', 'sketch', 'photo'], target_domain_unsupervised_task_loss_weight=0.8, tf_logger=True, tile_random_grayscale=0.1, train_all=True, unsupervised_task_weight=0.8, val_size=0.1)
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 0
New epoch - lr: 0.001
0/58 of epoch 1/30 jigsaw : 1.397, class : 2.163, t_rotation : 1.459, entropy : 1.816 - acc jigsaw : 28.91, class : 15.62 [bs:128]
30/58 of epoch 1/30 jigsaw : 0.994, class : 1.381, t_rotation : 0.737, entropy : 1.693 - acc jigsaw : 62.50, class : 41.41 [bs:128]
Accuracies on val: jigsaw : 90.36, class : 69.64
--------------------------------------------------------
Accuracies on test: jigsaw : 96.89, class : 86.65
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 1
New epoch - lr: 0.001
0/58 of epoch 2/30 jigsaw : 0.850, class : 0.916, t_rotation : 0.701, entropy : 1.245 - acc jigsaw : 64.84, class : 53.12 [bs:128]
30/58 of epoch 2/30 jigsaw : 0.671, class : 0.600, t_rotation : 0.408, entropy : 0.685 - acc jigsaw : 68.75, class : 69.53 [bs:128]
Accuracies on val: jigsaw : 90.84, class : 78.07
--------------------------------------------------------
Accuracies on test: jigsaw : 97.54, class : 95.69
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 2
New epoch - lr: 0.001
0/58 of epoch 3/30 jigsaw : 0.569, class : 0.425, t_rotation : 0.400, entropy : 0.475 - acc jigsaw : 77.34, class : 73.44 [bs:128]
30/58 of epoch 3/30 jigsaw : 0.531, class : 0.313, t_rotation : 0.271, entropy : 0.363 - acc jigsaw : 79.69, class : 71.88 [bs:128]
Accuracies on val: jigsaw : 90.96, class : 83.25
--------------------------------------------------------
Accuracies on test: jigsaw : 97.66, class : 96.65
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 3
New epoch - lr: 0.001
0/58 of epoch 4/30 jigsaw : 0.499, class : 0.360, t_rotation : 0.416, entropy : 0.262 - acc jigsaw : 79.69, class : 71.88 [bs:128]
30/58 of epoch 4/30 jigsaw : 0.520, class : 0.385, t_rotation : 0.228, entropy : 0.230 - acc jigsaw : 80.47, class : 78.12 [bs:128]
Accuracies on val: jigsaw : 92.89, class : 86.27
--------------------------------------------------------
Accuracies on test: jigsaw : 98.02, class : 96.95
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 4
New epoch - lr: 0.001
0/58 of epoch 5/30 jigsaw : 0.383, class : 0.424, t_rotation : 0.304, entropy : 0.174 - acc jigsaw : 87.50, class : 71.88 [bs:128]
30/58 of epoch 5/30 jigsaw : 0.441, class : 0.244, t_rotation : 0.189, entropy : 0.176 - acc jigsaw : 82.03, class : 77.34 [bs:128]
Accuracies on val: jigsaw : 93.25, class : 83.01
--------------------------------------------------------
Accuracies on test: jigsaw : 98.14, class : 97.43
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 5
New epoch - lr: 0.001
0/58 of epoch 6/30 jigsaw : 0.455, class : 0.290, t_rotation : 0.222, entropy : 0.220 - acc jigsaw : 83.59, class : 71.09 [bs:128]
30/58 of epoch 6/30 jigsaw : 0.472, class : 0.292, t_rotation : 0.238, entropy : 0.231 - acc jigsaw : 81.25, class : 75.00 [bs:128]
Accuracies on val: jigsaw : 92.77, class : 87.71
--------------------------------------------------------
Accuracies on test: jigsaw : 98.62, class : 97.31
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 6
New epoch - lr: 0.001
0/58 of epoch 7/30 jigsaw : 0.449, class : 0.206, t_rotation : 0.270, entropy : 0.103 - acc jigsaw : 81.25, class : 69.53 [bs:128]
30/58 of epoch 7/30 jigsaw : 0.405, class : 0.318, t_rotation : 0.139, entropy : 0.134 - acc jigsaw : 82.81, class : 68.75 [bs:128]
Accuracies on val: jigsaw : 93.13, class : 89.64
--------------------------------------------------------
Accuracies on test: jigsaw : 98.26, class : 97.66
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 7
New epoch - lr: 0.001
0/58 of epoch 8/30 jigsaw : 0.399, class : 0.223, t_rotation : 0.216, entropy : 0.094 - acc jigsaw : 85.94, class : 71.09 [bs:128]
30/58 of epoch 8/30 jigsaw : 0.274, class : 0.339, t_rotation : 0.154, entropy : 0.099 - acc jigsaw : 91.41, class : 71.09 [bs:128]
Accuracies on val: jigsaw : 91.81, class : 89.28
--------------------------------------------------------
Accuracies on test: jigsaw : 98.08, class : 97.66
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 8
New epoch - lr: 0.001
0/58 of epoch 9/30 jigsaw : 0.373, class : 0.130, t_rotation : 0.203, entropy : 0.112 - acc jigsaw : 88.28, class : 70.31 [bs:128]
30/58 of epoch 9/30 jigsaw : 0.431, class : 0.136, t_rotation : 0.151, entropy : 0.121 - acc jigsaw : 85.94, class : 85.16 [bs:128]
Accuracies on val: jigsaw : 92.17, class : 90.00
--------------------------------------------------------
Accuracies on test: jigsaw : 98.98, class : 97.72
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 9
New epoch - lr: 0.001
0/58 of epoch 10/30 jigsaw : 0.256, class : 0.151, t_rotation : 0.132, entropy : 0.111 - acc jigsaw : 92.97, class : 72.66 [bs:128]
30/58 of epoch 10/30 jigsaw : 0.229, class : 0.278, t_rotation : 0.221, entropy : 0.085 - acc jigsaw : 90.62, class : 67.97 [bs:128]
Accuracies on val: jigsaw : 91.20, class : 88.19
--------------------------------------------------------
Accuracies on test: jigsaw : 98.44, class : 97.90
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 10
New epoch - lr: 0.001
0/58 of epoch 11/30 jigsaw : 0.344, class : 0.215, t_rotation : 0.284, entropy : 0.074 - acc jigsaw : 87.50, class : 68.75 [bs:128]
30/58 of epoch 11/30 jigsaw : 0.310, class : 0.193, t_rotation : 0.083, entropy : 0.050 - acc jigsaw : 89.84, class : 78.12 [bs:128]
Accuracies on val: jigsaw : 95.54, class : 90.00
--------------------------------------------------------
Accuracies on test: jigsaw : 99.16, class : 97.72
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 11
New epoch - lr: 0.001
0/58 of epoch 12/30 jigsaw : 0.316, class : 0.173, t_rotation : 0.101, entropy : 0.052 - acc jigsaw : 85.94, class : 73.44 [bs:128]
30/58 of epoch 12/30 jigsaw : 0.261, class : 0.102, t_rotation : 0.096, entropy : 0.108 - acc jigsaw : 90.62, class : 75.00 [bs:128]
Accuracies on val: jigsaw : 93.25, class : 90.00
--------------------------------------------------------
Accuracies on test: jigsaw : 98.86, class : 98.20
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 12
New epoch - lr: 0.001
0/58 of epoch 13/30 jigsaw : 0.307, class : 0.181, t_rotation : 0.145, entropy : 0.075 - acc jigsaw : 88.28, class : 75.00 [bs:128]
30/58 of epoch 13/30 jigsaw : 0.197, class : 0.087, t_rotation : 0.116, entropy : 0.060 - acc jigsaw : 95.31, class : 74.22 [bs:128]
Accuracies on val: jigsaw : 92.05, class : 91.69
--------------------------------------------------------
Accuracies on test: jigsaw : 98.92, class : 98.14
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 13
New epoch - lr: 0.001
0/58 of epoch 14/30 jigsaw : 0.174, class : 0.143, t_rotation : 0.151, entropy : 0.046 - acc jigsaw : 95.31, class : 72.66 [bs:128]
30/58 of epoch 14/30 jigsaw : 0.268, class : 0.102, t_rotation : 0.069, entropy : 0.051 - acc jigsaw : 89.06, class : 74.22 [bs:128]
Accuracies on val: jigsaw : 92.65, class : 91.45
--------------------------------------------------------
Accuracies on test: jigsaw : 99.22, class : 98.32
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 14
New epoch - lr: 0.001
0/58 of epoch 15/30 jigsaw : 0.218, class : 0.085, t_rotation : 0.125, entropy : 0.099 - acc jigsaw : 90.62, class : 71.88 [bs:128]
30/58 of epoch 15/30 jigsaw : 0.315, class : 0.076, t_rotation : 0.096, entropy : 0.093 - acc jigsaw : 89.06, class : 73.44 [bs:128]
Accuracies on val: jigsaw : 94.34, class : 91.69
--------------------------------------------------------
Accuracies on test: jigsaw : 99.04, class : 98.26
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 15
New epoch - lr: 0.001
0/58 of epoch 16/30 jigsaw : 0.250, class : 0.040, t_rotation : 0.143, entropy : 0.035 - acc jigsaw : 90.62, class : 75.00 [bs:128]
30/58 of epoch 16/30 jigsaw : 0.303, class : 0.066, t_rotation : 0.108, entropy : 0.082 - acc jigsaw : 89.84, class : 77.34 [bs:128]
Accuracies on val: jigsaw : 94.46, class : 90.36
--------------------------------------------------------
Accuracies on test: jigsaw : 98.98, class : 98.32
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 16
New epoch - lr: 0.001
0/58 of epoch 17/30 jigsaw : 0.230, class : 0.136, t_rotation : 0.170, entropy : 0.085 - acc jigsaw : 91.41, class : 71.88 [bs:128]
30/58 of epoch 17/30 jigsaw : 0.182, class : 0.048, t_rotation : 0.130, entropy : 0.064 - acc jigsaw : 92.97, class : 76.56 [bs:128]
Accuracies on val: jigsaw : 92.65, class : 90.72
--------------------------------------------------------
Accuracies on test: jigsaw : 98.74, class : 98.08
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 17
New epoch - lr: 0.001
0/58 of epoch 18/30 jigsaw : 0.213, class : 0.052, t_rotation : 0.075, entropy : 0.074 - acc jigsaw : 91.41, class : 84.38 [bs:128]
30/58 of epoch 18/30 jigsaw : 0.276, class : 0.114, t_rotation : 0.058, entropy : 0.046 - acc jigsaw : 89.06, class : 75.00 [bs:128]
Accuracies on val: jigsaw : 95.30, class : 91.93
--------------------------------------------------------
Accuracies on test: jigsaw : 99.52, class : 98.38
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 18
New epoch - lr: 0.001
0/58 of epoch 19/30 jigsaw : 0.286, class : 0.048, t_rotation : 0.181, entropy : 0.052 - acc jigsaw : 89.84, class : 76.56 [bs:128]
30/58 of epoch 19/30 jigsaw : 0.166, class : 0.115, t_rotation : 0.116, entropy : 0.033 - acc jigsaw : 93.75, class : 85.16 [bs:128]
Accuracies on val: jigsaw : 93.98, class : 91.69
--------------------------------------------------------
Accuracies on test: jigsaw : 98.92, class : 98.32
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 19
New epoch - lr: 0.001
0/58 of epoch 20/30 jigsaw : 0.182, class : 0.089, t_rotation : 0.138, entropy : 0.035 - acc jigsaw : 91.41, class : 78.12 [bs:128]
30/58 of epoch 20/30 jigsaw : 0.145, class : 0.027, t_rotation : 0.067, entropy : 0.046 - acc jigsaw : 92.97, class : 74.22 [bs:128]
Accuracies on val: jigsaw : 92.29, class : 91.57
--------------------------------------------------------
Accuracies on test: jigsaw : 99.70, class : 98.26
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 20
New epoch - lr: 0.001
0/58 of epoch 21/30 jigsaw : 0.213, class : 0.048, t_rotation : 0.093, entropy : 0.053 - acc jigsaw : 91.41, class : 81.25 [bs:128]
30/58 of epoch 21/30 jigsaw : 0.297, class : 0.060, t_rotation : 0.057, entropy : 0.033 - acc jigsaw : 89.84, class : 73.44 [bs:128]
Accuracies on val: jigsaw : 94.46, class : 91.45
--------------------------------------------------------
Accuracies on test: jigsaw : 99.70, class : 98.14
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 21
New epoch - lr: 0.001
0/58 of epoch 22/30 jigsaw : 0.280, class : 0.089, t_rotation : 0.171, entropy : 0.019 - acc jigsaw : 91.41, class : 71.09 [bs:128]
30/58 of epoch 22/30 jigsaw : 0.142, class : 0.021, t_rotation : 0.049, entropy : 0.044 - acc jigsaw : 96.09, class : 67.97 [bs:128]
Accuracies on val: jigsaw : 92.65, class : 92.17
--------------------------------------------------------
Accuracies on test: jigsaw : 99.46, class : 97.84
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 22
New epoch - lr: 0.001
0/58 of epoch 23/30 jigsaw : 0.268, class : 0.026, t_rotation : 0.085, entropy : 0.037 - acc jigsaw : 90.62, class : 79.69 [bs:128]
30/58 of epoch 23/30 jigsaw : 0.232, class : 0.016, t_rotation : 0.056, entropy : 0.028 - acc jigsaw : 92.19, class : 77.34 [bs:128]
Accuracies on val: jigsaw : 95.66, class : 91.93
--------------------------------------------------------
Accuracies on test: jigsaw : 99.70, class : 98.14
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 23
New epoch - lr: 0.0001
0/58 of epoch 24/30 jigsaw : 0.216, class : 0.078, t_rotation : 0.109, entropy : 0.047 - acc jigsaw : 92.19, class : 67.97 [bs:128]
30/58 of epoch 24/30 jigsaw : 0.186, class : 0.030, t_rotation : 0.110, entropy : 0.030 - acc jigsaw : 92.97, class : 78.91 [bs:128]
Accuracies on val: jigsaw : 95.54, class : 92.41
--------------------------------------------------------
Accuracies on test: jigsaw : 99.70, class : 98.08
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 24
New epoch - lr: 0.0001
0/58 of epoch 25/30 jigsaw : 0.176, class : 0.020, t_rotation : 0.110, entropy : 0.021 - acc jigsaw : 92.97, class : 78.12 [bs:128]
30/58 of epoch 25/30 jigsaw : 0.205, class : 0.092, t_rotation : 0.049, entropy : 0.058 - acc jigsaw : 91.41, class : 75.78 [bs:128]
Accuracies on val: jigsaw : 93.61, class : 92.65
--------------------------------------------------------
Accuracies on test: jigsaw : 99.58, class : 98.08
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 25
New epoch - lr: 0.0001
0/58 of epoch 26/30 jigsaw : 0.118, class : 0.050, t_rotation : 0.060, entropy : 0.046 - acc jigsaw : 96.88, class : 70.31 [bs:128]
30/58 of epoch 26/30 jigsaw : 0.146, class : 0.035, t_rotation : 0.088, entropy : 0.074 - acc jigsaw : 95.31, class : 80.47 [bs:128]
Accuracies on val: jigsaw : 95.90, class : 92.29
--------------------------------------------------------
Accuracies on test: jigsaw : 99.70, class : 98.14
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 26
New epoch - lr: 0.0001
0/58 of epoch 27/30 jigsaw : 0.121, class : 0.099, t_rotation : 0.163, entropy : 0.044 - acc jigsaw : 94.53, class : 72.66 [bs:128]
30/58 of epoch 27/30 jigsaw : 0.156, class : 0.044, t_rotation : 0.065, entropy : 0.034 - acc jigsaw : 92.97, class : 78.12 [bs:128]
Accuracies on val: jigsaw : 94.70, class : 92.89
--------------------------------------------------------
Accuracies on test: jigsaw : 99.64, class : 98.08
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 27
New epoch - lr: 0.0001
0/58 of epoch 28/30 jigsaw : 0.226, class : 0.065, t_rotation : 0.110, entropy : 0.042 - acc jigsaw : 92.19, class : 80.47 [bs:128]
30/58 of epoch 28/30 jigsaw : 0.193, class : 0.058, t_rotation : 0.070, entropy : 0.060 - acc jigsaw : 93.75, class : 75.78 [bs:128]
Accuracies on val: jigsaw : 94.10, class : 92.65
--------------------------------------------------------
Accuracies on test: jigsaw : 99.58, class : 98.08
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 28
New epoch - lr: 0.0001
0/58 of epoch 29/30 jigsaw : 0.185, class : 0.032, t_rotation : 0.083, entropy : 0.046 - acc jigsaw : 94.53, class : 75.78 [bs:128]
30/58 of epoch 29/30 jigsaw : 0.150, class : 0.034, t_rotation : 0.060, entropy : 0.047 - acc jigsaw : 94.53, class : 78.12 [bs:128]
Accuracies on val: jigsaw : 95.18, class : 93.01
--------------------------------------------------------
Accuracies on test: jigsaw : 99.58, class : 98.02
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 29
New epoch - lr: 0.0001
0/58 of epoch 30/30 jigsaw : 0.126, class : 0.024, t_rotation : 0.094, entropy : 0.047 - acc jigsaw : 96.09, class : 77.34 [bs:128]
30/58 of epoch 30/30 jigsaw : 0.315, class : 0.041, t_rotation : 0.081, entropy : 0.093 - acc jigsaw : 92.19, class : 78.91 [bs:128]
Accuracies on val: jigsaw : 95.18, class : 93.25
--------------------------------------------------------
Accuracies on test: jigsaw : 99.64, class : 98.02
--------------------------------------------------------
2019-12-16 08:15:53
photo
['sketch', 'cartoon', 'art_painting']
unsupervised_task_weight: 0.8
bias_hole_image: 0.4
target_rotation_weight: 0.8
entropy_weight 0.2
only_classify the ordered image: True
Highest accuracy on validation set appears on epoch  tensor(29)
Highest accuracy on test set appears on epoch  tensor(17)
Accuracy on test set when the accuracy on validation set is highest:0.980
Highest accuracy on test set:0.984
It took 1328.58
--------------------------------------------------------
******************Start training**************************************
--------------------------------------------------------
Dataset size: training 7491, validation 830, testing 1670
--------------------------------------------------------
Namespace(TTA=False, batch_size=128, bias_whole_image=0.4, classify_only_ordered_images_or_not=True, domains_list=['photo', 'sketch', 'cartoon', 'art_painting'], entropy_loss_weight=0.2, epochs=30, folder_name='test', image_size=222, jitter=0.4, learning_rate=0.001, limit_source=None, limit_target=None, max_scale=1.0, min_scale=0.8, n_classes=7, nesterov=False, network='resnet18', ooo_weight=0, parameters_lists=[[0.8, 0.4, 0.8, 0.2], [0.8, 0.4, 0.8, 0.3], [0.8, 0.4, 0.8, 0.4]], random_horiz_flip=0.5, repeat_times=3, source=['sketch', 'cartoon', 'art_painting'], suffix='', target='photo', target_domain_list=['art_painting', 'cartoon', 'sketch', 'photo'], target_domain_unsupervised_task_loss_weight=0.8, tf_logger=True, tile_random_grayscale=0.1, train_all=True, unsupervised_task_weight=0.8, val_size=0.1)
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 0
New epoch - lr: 0.001
0/58 of epoch 1/30 jigsaw : 1.399, class : 2.081, t_rotation : 1.430, entropy : 1.827 - acc jigsaw : 25.00, class : 11.72 [bs:128]
30/58 of epoch 1/30 jigsaw : 0.990, class : 1.243, t_rotation : 0.716, entropy : 1.739 - acc jigsaw : 57.03, class : 50.78 [bs:128]
Accuracies on val: jigsaw : 88.31, class : 70.72
--------------------------------------------------------
Accuracies on test: jigsaw : 97.54, class : 90.54
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 1
New epoch - lr: 0.001
0/58 of epoch 2/30 jigsaw : 0.853, class : 0.881, t_rotation : 0.610, entropy : 1.409 - acc jigsaw : 64.84, class : 57.03 [bs:128]
30/58 of epoch 2/30 jigsaw : 0.728, class : 0.492, t_rotation : 0.381, entropy : 0.649 - acc jigsaw : 64.06, class : 72.66 [bs:128]
Accuracies on val: jigsaw : 89.16, class : 75.78
--------------------------------------------------------
Accuracies on test: jigsaw : 97.96, class : 95.51
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 2
New epoch - lr: 0.001
0/58 of epoch 3/30 jigsaw : 0.607, class : 0.453, t_rotation : 0.454, entropy : 0.407 - acc jigsaw : 71.88, class : 66.41 [bs:128]
30/58 of epoch 3/30 jigsaw : 0.535, class : 0.465, t_rotation : 0.345, entropy : 0.286 - acc jigsaw : 78.12, class : 71.09 [bs:128]
Accuracies on val: jigsaw : 90.00, class : 81.20
--------------------------------------------------------
Accuracies on test: jigsaw : 98.02, class : 96.71
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 3
New epoch - lr: 0.001
0/58 of epoch 4/30 jigsaw : 0.596, class : 0.303, t_rotation : 0.349, entropy : 0.272 - acc jigsaw : 79.69, class : 74.22 [bs:128]
30/58 of epoch 4/30 jigsaw : 0.648, class : 0.566, t_rotation : 0.187, entropy : 0.272 - acc jigsaw : 75.78, class : 66.41 [bs:128]
Accuracies on val: jigsaw : 88.19, class : 81.08
--------------------------------------------------------
Accuracies on test: jigsaw : 97.60, class : 97.49
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 4
New epoch - lr: 0.001
0/58 of epoch 5/30 jigsaw : 0.496, class : 0.407, t_rotation : 0.358, entropy : 0.166 - acc jigsaw : 82.03, class : 73.44 [bs:128]
30/58 of epoch 5/30 jigsaw : 0.411, class : 0.408, t_rotation : 0.282, entropy : 0.191 - acc jigsaw : 86.72, class : 72.66 [bs:128]
Accuracies on val: jigsaw : 89.76, class : 83.61
--------------------------------------------------------
Accuracies on test: jigsaw : 98.50, class : 97.66
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 5
New epoch - lr: 0.001
0/58 of epoch 6/30 jigsaw : 0.387, class : 0.366, t_rotation : 0.249, entropy : 0.173 - acc jigsaw : 86.72, class : 71.88 [bs:128]
30/58 of epoch 6/30 jigsaw : 0.327, class : 0.173, t_rotation : 0.248, entropy : 0.102 - acc jigsaw : 90.62, class : 71.88 [bs:128]
Accuracies on val: jigsaw : 92.77, class : 88.43
--------------------------------------------------------
Accuracies on test: jigsaw : 98.86, class : 97.54
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 6
New epoch - lr: 0.001
0/58 of epoch 7/30 jigsaw : 0.334, class : 0.203, t_rotation : 0.200, entropy : 0.144 - acc jigsaw : 90.62, class : 70.31 [bs:128]
30/58 of epoch 7/30 jigsaw : 0.492, class : 0.180, t_rotation : 0.136, entropy : 0.100 - acc jigsaw : 82.03, class : 74.22 [bs:128]
Accuracies on val: jigsaw : 91.20, class : 85.78
--------------------------------------------------------
Accuracies on test: jigsaw : 98.38, class : 97.90
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 7
New epoch - lr: 0.001
0/58 of epoch 8/30 jigsaw : 0.437, class : 0.188, t_rotation : 0.151, entropy : 0.104 - acc jigsaw : 86.72, class : 77.34 [bs:128]
30/58 of epoch 8/30 jigsaw : 0.311, class : 0.154, t_rotation : 0.157, entropy : 0.170 - acc jigsaw : 85.94, class : 74.22 [bs:128]
Accuracies on val: jigsaw : 89.64, class : 86.02
--------------------------------------------------------
Accuracies on test: jigsaw : 98.26, class : 98.14
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 8
New epoch - lr: 0.001
0/58 of epoch 9/30 jigsaw : 0.313, class : 0.225, t_rotation : 0.175, entropy : 0.039 - acc jigsaw : 87.50, class : 68.75 [bs:128]
30/58 of epoch 9/30 jigsaw : 0.338, class : 0.190, t_rotation : 0.201, entropy : 0.107 - acc jigsaw : 87.50, class : 75.78 [bs:128]
Accuracies on val: jigsaw : 92.53, class : 88.31
--------------------------------------------------------
Accuracies on test: jigsaw : 99.04, class : 98.02
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 9
New epoch - lr: 0.001
0/58 of epoch 10/30 jigsaw : 0.463, class : 0.127, t_rotation : 0.243, entropy : 0.117 - acc jigsaw : 84.38, class : 78.91 [bs:128]
30/58 of epoch 10/30 jigsaw : 0.411, class : 0.091, t_rotation : 0.105, entropy : 0.093 - acc jigsaw : 82.81, class : 79.69 [bs:128]
Accuracies on val: jigsaw : 91.08, class : 88.43
--------------------------------------------------------
Accuracies on test: jigsaw : 98.20, class : 98.26
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 10
New epoch - lr: 0.001
0/58 of epoch 11/30 jigsaw : 0.362, class : 0.064, t_rotation : 0.175, entropy : 0.061 - acc jigsaw : 85.16, class : 75.78 [bs:128]
30/58 of epoch 11/30 jigsaw : 0.245, class : 0.077, t_rotation : 0.117, entropy : 0.077 - acc jigsaw : 90.62, class : 75.78 [bs:128]
Accuracies on val: jigsaw : 89.16, class : 86.63
--------------------------------------------------------
Accuracies on test: jigsaw : 98.56, class : 98.08
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 11
New epoch - lr: 0.001
0/58 of epoch 12/30 jigsaw : 0.286, class : 0.104, t_rotation : 0.142, entropy : 0.065 - acc jigsaw : 89.84, class : 75.00 [bs:128]
30/58 of epoch 12/30 jigsaw : 0.261, class : 0.160, t_rotation : 0.090, entropy : 0.097 - acc jigsaw : 89.84, class : 75.78 [bs:128]
Accuracies on val: jigsaw : 88.80, class : 88.67
--------------------------------------------------------
Accuracies on test: jigsaw : 98.26, class : 98.08
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 12
New epoch - lr: 0.001
0/58 of epoch 13/30 jigsaw : 0.265, class : 0.137, t_rotation : 0.151, entropy : 0.075 - acc jigsaw : 90.62, class : 73.44 [bs:128]
30/58 of epoch 13/30 jigsaw : 0.182, class : 0.225, t_rotation : 0.074, entropy : 0.082 - acc jigsaw : 91.41, class : 68.75 [bs:128]
Accuracies on val: jigsaw : 90.84, class : 89.28
--------------------------------------------------------
Accuracies on test: jigsaw : 99.34, class : 98.14
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 13
New epoch - lr: 0.001
0/58 of epoch 14/30 jigsaw : 0.183, class : 0.048, t_rotation : 0.137, entropy : 0.046 - acc jigsaw : 93.75, class : 74.22 [bs:128]
30/58 of epoch 14/30 jigsaw : 0.145, class : 0.098, t_rotation : 0.096, entropy : 0.067 - acc jigsaw : 94.53, class : 81.25 [bs:128]
Accuracies on val: jigsaw : 90.60, class : 90.00
--------------------------------------------------------
Accuracies on test: jigsaw : 98.98, class : 98.02
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 14
New epoch - lr: 0.001
0/58 of epoch 15/30 jigsaw : 0.214, class : 0.076, t_rotation : 0.099, entropy : 0.047 - acc jigsaw : 93.75, class : 75.78 [bs:128]
30/58 of epoch 15/30 jigsaw : 0.353, class : 0.033, t_rotation : 0.168, entropy : 0.072 - acc jigsaw : 87.50, class : 78.12 [bs:128]
Accuracies on val: jigsaw : 90.48, class : 90.24
--------------------------------------------------------
Accuracies on test: jigsaw : 98.26, class : 98.02
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 15
New epoch - lr: 0.001
0/58 of epoch 16/30 jigsaw : 0.196, class : 0.082, t_rotation : 0.160, entropy : 0.057 - acc jigsaw : 93.75, class : 71.09 [bs:128]
30/58 of epoch 16/30 jigsaw : 0.224, class : 0.118, t_rotation : 0.089, entropy : 0.068 - acc jigsaw : 92.97, class : 73.44 [bs:128]
Accuracies on val: jigsaw : 91.93, class : 91.08
--------------------------------------------------------
Accuracies on test: jigsaw : 99.16, class : 97.96
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 16
New epoch - lr: 0.001
0/58 of epoch 17/30 jigsaw : 0.218, class : 0.078, t_rotation : 0.145, entropy : 0.062 - acc jigsaw : 93.75, class : 75.00 [bs:128]
30/58 of epoch 17/30 jigsaw : 0.289, class : 0.083, t_rotation : 0.075, entropy : 0.052 - acc jigsaw : 92.19, class : 77.34 [bs:128]
Accuracies on val: jigsaw : 91.33, class : 89.76
--------------------------------------------------------
Accuracies on test: jigsaw : 99.04, class : 98.08
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 17
New epoch - lr: 0.001
0/58 of epoch 18/30 jigsaw : 0.189, class : 0.076, t_rotation : 0.213, entropy : 0.057 - acc jigsaw : 93.75, class : 79.69 [bs:128]
30/58 of epoch 18/30 jigsaw : 0.305, class : 0.090, t_rotation : 0.112, entropy : 0.053 - acc jigsaw : 90.62, class : 74.22 [bs:128]
Accuracies on val: jigsaw : 92.53, class : 90.00
--------------------------------------------------------
Accuracies on test: jigsaw : 98.92, class : 98.08
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 18
New epoch - lr: 0.001
0/58 of epoch 19/30 jigsaw : 0.257, class : 0.054, t_rotation : 0.112, entropy : 0.085 - acc jigsaw : 91.41, class : 79.69 [bs:128]
30/58 of epoch 19/30 jigsaw : 0.178, class : 0.141, t_rotation : 0.072, entropy : 0.072 - acc jigsaw : 92.19, class : 75.00 [bs:128]
Accuracies on val: jigsaw : 92.29, class : 88.43
--------------------------------------------------------
Accuracies on test: jigsaw : 99.28, class : 98.26
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 19
New epoch - lr: 0.001
0/58 of epoch 20/30 jigsaw : 0.220, class : 0.078, t_rotation : 0.146, entropy : 0.076 - acc jigsaw : 93.75, class : 80.47 [bs:128]
30/58 of epoch 20/30 jigsaw : 0.189, class : 0.046, t_rotation : 0.045, entropy : 0.050 - acc jigsaw : 95.31, class : 75.00 [bs:128]
Accuracies on val: jigsaw : 93.13, class : 90.24
--------------------------------------------------------
Accuracies on test: jigsaw : 99.76, class : 98.32
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 20
New epoch - lr: 0.001
0/58 of epoch 21/30 jigsaw : 0.270, class : 0.109, t_rotation : 0.157, entropy : 0.034 - acc jigsaw : 89.84, class : 79.69 [bs:128]
30/58 of epoch 21/30 jigsaw : 0.220, class : 0.050, t_rotation : 0.085, entropy : 0.069 - acc jigsaw : 92.19, class : 77.34 [bs:128]
Accuracies on val: jigsaw : 93.61, class : 90.96
--------------------------------------------------------
Accuracies on test: jigsaw : 99.76, class : 98.32
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 21
New epoch - lr: 0.001
0/58 of epoch 22/30 jigsaw : 0.230, class : 0.051, t_rotation : 0.084, entropy : 0.034 - acc jigsaw : 92.19, class : 78.91 [bs:128]
30/58 of epoch 22/30 jigsaw : 0.190, class : 0.114, t_rotation : 0.051, entropy : 0.049 - acc jigsaw : 92.97, class : 74.22 [bs:128]
Accuracies on val: jigsaw : 92.17, class : 90.84
--------------------------------------------------------
Accuracies on test: jigsaw : 99.22, class : 98.14
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 22
New epoch - lr: 0.001
0/58 of epoch 23/30 jigsaw : 0.187, class : 0.061, t_rotation : 0.104, entropy : 0.038 - acc jigsaw : 94.53, class : 72.66 [bs:128]
30/58 of epoch 23/30 jigsaw : 0.266, class : 0.095, t_rotation : 0.037, entropy : 0.031 - acc jigsaw : 89.84, class : 75.00 [bs:128]
Accuracies on val: jigsaw : 94.70, class : 90.12
--------------------------------------------------------
Accuracies on test: jigsaw : 99.16, class : 98.38
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 23
New epoch - lr: 0.0001
0/58 of epoch 24/30 jigsaw : 0.175, class : 0.055, t_rotation : 0.100, entropy : 0.040 - acc jigsaw : 93.75, class : 72.66 [bs:128]
30/58 of epoch 24/30 jigsaw : 0.150, class : 0.069, t_rotation : 0.111, entropy : 0.061 - acc jigsaw : 93.75, class : 79.69 [bs:128]
Accuracies on val: jigsaw : 93.98, class : 90.84
--------------------------------------------------------
Accuracies on test: jigsaw : 99.88, class : 98.26
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 24
New epoch - lr: 0.0001
0/58 of epoch 25/30 jigsaw : 0.124, class : 0.071, t_rotation : 0.128, entropy : 0.048 - acc jigsaw : 92.97, class : 78.91 [bs:128]
30/58 of epoch 25/30 jigsaw : 0.191, class : 0.024, t_rotation : 0.035, entropy : 0.022 - acc jigsaw : 92.19, class : 78.91 [bs:128]
Accuracies on val: jigsaw : 93.37, class : 91.08
--------------------------------------------------------
Accuracies on test: jigsaw : 99.70, class : 98.32
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 25
New epoch - lr: 0.0001
0/58 of epoch 26/30 jigsaw : 0.216, class : 0.075, t_rotation : 0.121, entropy : 0.033 - acc jigsaw : 92.97, class : 82.03 [bs:128]
30/58 of epoch 26/30 jigsaw : 0.171, class : 0.105, t_rotation : 0.088, entropy : 0.044 - acc jigsaw : 92.97, class : 68.75 [bs:128]
Accuracies on val: jigsaw : 93.37, class : 91.20
--------------------------------------------------------
Accuracies on test: jigsaw : 99.70, class : 98.20
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 26
New epoch - lr: 0.0001
0/58 of epoch 27/30 jigsaw : 0.235, class : 0.054, t_rotation : 0.104, entropy : 0.048 - acc jigsaw : 90.62, class : 80.47 [bs:128]
30/58 of epoch 27/30 jigsaw : 0.106, class : 0.046, t_rotation : 0.077, entropy : 0.032 - acc jigsaw : 96.09, class : 79.69 [bs:128]
Accuracies on val: jigsaw : 92.17, class : 91.33
--------------------------------------------------------
Accuracies on test: jigsaw : 99.64, class : 98.32
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 27
New epoch - lr: 0.0001
0/58 of epoch 28/30 jigsaw : 0.238, class : 0.064, t_rotation : 0.146, entropy : 0.044 - acc jigsaw : 91.41, class : 75.00 [bs:128]
30/58 of epoch 28/30 jigsaw : 0.143, class : 0.098, t_rotation : 0.118, entropy : 0.046 - acc jigsaw : 96.09, class : 77.34 [bs:128]
Accuracies on val: jigsaw : 92.17, class : 91.93
--------------------------------------------------------
Accuracies on test: jigsaw : 99.76, class : 98.26
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 28
New epoch - lr: 0.0001
0/58 of epoch 29/30 jigsaw : 0.208, class : 0.066, t_rotation : 0.114, entropy : 0.045 - acc jigsaw : 92.19, class : 75.78 [bs:128]
30/58 of epoch 29/30 jigsaw : 0.252, class : 0.054, t_rotation : 0.078, entropy : 0.039 - acc jigsaw : 91.41, class : 69.53 [bs:128]
Accuracies on val: jigsaw : 93.25, class : 91.33
--------------------------------------------------------
Accuracies on test: jigsaw : 99.82, class : 98.20
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 29
New epoch - lr: 0.0001
0/58 of epoch 30/30 jigsaw : 0.156, class : 0.052, t_rotation : 0.086, entropy : 0.069 - acc jigsaw : 92.97, class : 72.66 [bs:128]
30/58 of epoch 30/30 jigsaw : 0.166, class : 0.024, t_rotation : 0.226, entropy : 0.034 - acc jigsaw : 94.53, class : 80.47 [bs:128]
Accuracies on val: jigsaw : 93.49, class : 91.69
--------------------------------------------------------
Accuracies on test: jigsaw : 99.82, class : 98.26
--------------------------------------------------------
2019-12-16 08:37:57
photo
['sketch', 'cartoon', 'art_painting']
unsupervised_task_weight: 0.8
bias_hole_image: 0.4
target_rotation_weight: 0.8
entropy_weight 0.2
only_classify the ordered image: True
Highest accuracy on validation set appears on epoch  tensor(27)
Highest accuracy on test set appears on epoch  tensor(22)
Accuracy on test set when the accuracy on validation set is highest:0.983
Highest accuracy on test set:0.984
It took 1323.27
--------------------------------------------------------
******************Start training**************************************
--------------------------------------------------------
Dataset size: training 7150, validation 793, testing 2048
--------------------------------------------------------
Namespace(TTA=False, batch_size=128, bias_whole_image=0.4, classify_only_ordered_images_or_not=True, domains_list=['photo', 'sketch', 'cartoon', 'art_painting'], entropy_loss_weight=0.3, epochs=30, folder_name='test', image_size=222, jitter=0.4, learning_rate=0.001, limit_source=None, limit_target=None, max_scale=1.0, min_scale=0.8, n_classes=7, nesterov=False, network='resnet18', ooo_weight=0, parameters_lists=[[0.8, 0.4, 0.8, 0.2], [0.8, 0.4, 0.8, 0.3], [0.8, 0.4, 0.8, 0.4]], random_horiz_flip=0.5, repeat_times=3, source=['photo', 'sketch', 'cartoon'], suffix='', target='art_painting', target_domain_list=['art_painting', 'cartoon', 'sketch', 'photo'], target_domain_unsupervised_task_loss_weight=0.8, tf_logger=True, tile_random_grayscale=0.1, train_all=True, unsupervised_task_weight=0.8, val_size=0.1)
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 0
New epoch - lr: 0.001
0/55 of epoch 1/30 jigsaw : 1.411, class : 2.073, t_rotation : 1.421, entropy : 1.811 - acc jigsaw : 30.47, class : 18.75 [bs:128]
30/55 of epoch 1/30 jigsaw : 1.022, class : 1.197, t_rotation : 1.111, entropy : 1.702 - acc jigsaw : 59.38, class : 56.25 [bs:128]
Accuracies on val: jigsaw : 97.35, class : 71.75
--------------------------------------------------------
Accuracies on test: jigsaw : 92.92, class : 61.04
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 1
New epoch - lr: 0.001
0/55 of epoch 2/30 jigsaw : 0.853, class : 0.745, t_rotation : 1.169, entropy : 1.452 - acc jigsaw : 64.84, class : 67.97 [bs:128]
30/55 of epoch 2/30 jigsaw : 0.628, class : 0.443, t_rotation : 0.814, entropy : 1.130 - acc jigsaw : 72.66, class : 65.62 [bs:128]
Accuracies on val: jigsaw : 96.22, class : 79.70
--------------------------------------------------------
Accuracies on test: jigsaw : 92.33, class : 75.24
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 2
New epoch - lr: 0.001
0/55 of epoch 3/30 jigsaw : 0.624, class : 0.431, t_rotation : 0.708, entropy : 0.926 - acc jigsaw : 78.91, class : 74.22 [bs:128]
30/55 of epoch 3/30 jigsaw : 0.629, class : 0.427, t_rotation : 0.592, entropy : 0.608 - acc jigsaw : 75.78, class : 72.66 [bs:128]
Accuracies on val: jigsaw : 94.70, class : 81.34
--------------------------------------------------------
Accuracies on test: jigsaw : 91.36, class : 82.32
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 3
New epoch - lr: 0.001
0/55 of epoch 4/30 jigsaw : 0.645, class : 0.348, t_rotation : 0.577, entropy : 0.566 - acc jigsaw : 72.66, class : 74.22 [bs:128]
30/55 of epoch 4/30 jigsaw : 0.477, class : 0.346, t_rotation : 0.462, entropy : 0.487 - acc jigsaw : 82.03, class : 74.22 [bs:128]
Accuracies on val: jigsaw : 96.22, class : 85.25
--------------------------------------------------------
Accuracies on test: jigsaw : 93.41, class : 84.96
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 4
New epoch - lr: 0.001
0/55 of epoch 5/30 jigsaw : 0.551, class : 0.302, t_rotation : 0.712, entropy : 0.373 - acc jigsaw : 81.25, class : 65.62 [bs:128]
30/55 of epoch 5/30 jigsaw : 0.503, class : 0.198, t_rotation : 0.553, entropy : 0.355 - acc jigsaw : 80.47, class : 75.78 [bs:128]
Accuracies on val: jigsaw : 96.09, class : 87.01
--------------------------------------------------------
Accuracies on test: jigsaw : 94.19, class : 84.62
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 5
New epoch - lr: 0.001
0/55 of epoch 6/30 jigsaw : 0.407, class : 0.356, t_rotation : 0.585, entropy : 0.374 - acc jigsaw : 83.59, class : 69.53 [bs:128]
30/55 of epoch 6/30 jigsaw : 0.380, class : 0.255, t_rotation : 0.337, entropy : 0.341 - acc jigsaw : 88.28, class : 67.19 [bs:128]
Accuracies on val: jigsaw : 96.34, class : 91.93
--------------------------------------------------------
Accuracies on test: jigsaw : 93.95, class : 86.62
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 6
New epoch - lr: 0.001
0/55 of epoch 7/30 jigsaw : 0.448, class : 0.239, t_rotation : 0.439, entropy : 0.340 - acc jigsaw : 87.50, class : 70.31 [bs:128]
30/55 of epoch 7/30 jigsaw : 0.206, class : 0.142, t_rotation : 0.406, entropy : 0.234 - acc jigsaw : 92.97, class : 77.34 [bs:128]
Accuracies on val: jigsaw : 95.08, class : 90.54
--------------------------------------------------------
Accuracies on test: jigsaw : 95.12, class : 88.04
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 7
New epoch - lr: 0.001
0/55 of epoch 8/30 jigsaw : 0.299, class : 0.170, t_rotation : 0.419, entropy : 0.163 - acc jigsaw : 88.28, class : 75.78 [bs:128]
30/55 of epoch 8/30 jigsaw : 0.349, class : 0.151, t_rotation : 0.402, entropy : 0.285 - acc jigsaw : 87.50, class : 68.75 [bs:128]
Accuracies on val: jigsaw : 96.22, class : 89.53
--------------------------------------------------------
Accuracies on test: jigsaw : 95.36, class : 88.09
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 8
New epoch - lr: 0.001
0/55 of epoch 9/30 jigsaw : 0.309, class : 0.206, t_rotation : 0.430, entropy : 0.173 - acc jigsaw : 87.50, class : 74.22 [bs:128]
30/55 of epoch 9/30 jigsaw : 0.258, class : 0.046, t_rotation : 0.272, entropy : 0.261 - acc jigsaw : 92.19, class : 75.78 [bs:128]
Accuracies on val: jigsaw : 95.96, class : 91.93
--------------------------------------------------------
Accuracies on test: jigsaw : 96.24, class : 88.48
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 9
New epoch - lr: 0.001
0/55 of epoch 10/30 jigsaw : 0.266, class : 0.131, t_rotation : 0.435, entropy : 0.156 - acc jigsaw : 89.06, class : 78.12 [bs:128]
30/55 of epoch 10/30 jigsaw : 0.229, class : 0.104, t_rotation : 0.179, entropy : 0.205 - acc jigsaw : 91.41, class : 74.22 [bs:128]
Accuracies on val: jigsaw : 95.46, class : 91.05
--------------------------------------------------------
Accuracies on test: jigsaw : 95.90, class : 89.11
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 10
New epoch - lr: 0.001
0/55 of epoch 11/30 jigsaw : 0.302, class : 0.128, t_rotation : 0.411, entropy : 0.190 - acc jigsaw : 86.72, class : 75.78 [bs:128]
30/55 of epoch 11/30 jigsaw : 0.260, class : 0.153, t_rotation : 0.217, entropy : 0.213 - acc jigsaw : 90.62, class : 76.56 [bs:128]
Accuracies on val: jigsaw : 95.21, class : 92.18
--------------------------------------------------------
Accuracies on test: jigsaw : 95.02, class : 88.77
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 11
New epoch - lr: 0.001
0/55 of epoch 12/30 jigsaw : 0.336, class : 0.045, t_rotation : 0.263, entropy : 0.130 - acc jigsaw : 88.28, class : 81.25 [bs:128]
30/55 of epoch 12/30 jigsaw : 0.321, class : 0.127, t_rotation : 0.227, entropy : 0.174 - acc jigsaw : 89.06, class : 75.00 [bs:128]
Accuracies on val: jigsaw : 97.10, class : 92.06
--------------------------------------------------------
Accuracies on test: jigsaw : 97.02, class : 89.50
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 12
New epoch - lr: 0.001
0/55 of epoch 13/30 jigsaw : 0.370, class : 0.196, t_rotation : 0.234, entropy : 0.197 - acc jigsaw : 88.28, class : 68.75 [bs:128]
30/55 of epoch 13/30 jigsaw : 0.344, class : 0.139, t_rotation : 0.212, entropy : 0.134 - acc jigsaw : 87.50, class : 74.22 [bs:128]
Accuracies on val: jigsaw : 96.47, class : 91.68
--------------------------------------------------------
Accuracies on test: jigsaw : 96.68, class : 89.36
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 13
New epoch - lr: 0.001
0/55 of epoch 14/30 jigsaw : 0.266, class : 0.095, t_rotation : 0.353, entropy : 0.172 - acc jigsaw : 89.84, class : 78.91 [bs:128]
30/55 of epoch 14/30 jigsaw : 0.181, class : 0.077, t_rotation : 0.185, entropy : 0.131 - acc jigsaw : 92.97, class : 71.88 [bs:128]
Accuracies on val: jigsaw : 95.84, class : 92.18
--------------------------------------------------------
Accuracies on test: jigsaw : 96.48, class : 90.04
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 14
New epoch - lr: 0.001
0/55 of epoch 15/30 jigsaw : 0.297, class : 0.135, t_rotation : 0.372, entropy : 0.167 - acc jigsaw : 88.28, class : 78.12 [bs:128]
30/55 of epoch 15/30 jigsaw : 0.239, class : 0.112, t_rotation : 0.180, entropy : 0.134 - acc jigsaw : 90.62, class : 73.44 [bs:128]
Accuracies on val: jigsaw : 97.35, class : 93.57
--------------------------------------------------------
Accuracies on test: jigsaw : 95.80, class : 89.31
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 15
New epoch - lr: 0.001
0/55 of epoch 16/30 jigsaw : 0.162, class : 0.066, t_rotation : 0.231, entropy : 0.091 - acc jigsaw : 93.75, class : 75.78 [bs:128]
30/55 of epoch 16/30 jigsaw : 0.222, class : 0.107, t_rotation : 0.192, entropy : 0.195 - acc jigsaw : 90.62, class : 76.56 [bs:128]
Accuracies on val: jigsaw : 94.83, class : 92.56
--------------------------------------------------------
Accuracies on test: jigsaw : 96.19, class : 89.21
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 16
New epoch - lr: 0.001
0/55 of epoch 17/30 jigsaw : 0.156, class : 0.073, t_rotation : 0.222, entropy : 0.182 - acc jigsaw : 95.31, class : 75.00 [bs:128]
30/55 of epoch 17/30 jigsaw : 0.383, class : 0.148, t_rotation : 0.119, entropy : 0.161 - acc jigsaw : 88.28, class : 76.56 [bs:128]
Accuracies on val: jigsaw : 95.84, class : 92.31
--------------------------------------------------------
Accuracies on test: jigsaw : 95.51, class : 89.65
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 17
New epoch - lr: 0.001
0/55 of epoch 18/30 jigsaw : 0.155, class : 0.065, t_rotation : 0.241, entropy : 0.112 - acc jigsaw : 96.09, class : 77.34 [bs:128]
30/55 of epoch 18/30 jigsaw : 0.240, class : 0.101, t_rotation : 0.156, entropy : 0.097 - acc jigsaw : 90.62, class : 78.12 [bs:128]
Accuracies on val: jigsaw : 96.34, class : 93.44
--------------------------------------------------------
Accuracies on test: jigsaw : 96.39, class : 89.99
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 18
New epoch - lr: 0.001
0/55 of epoch 19/30 jigsaw : 0.083, class : 0.091, t_rotation : 0.190, entropy : 0.153 - acc jigsaw : 98.44, class : 72.66 [bs:128]
30/55 of epoch 19/30 jigsaw : 0.189, class : 0.058, t_rotation : 0.116, entropy : 0.123 - acc jigsaw : 91.41, class : 81.25 [bs:128]
Accuracies on val: jigsaw : 96.85, class : 92.56
--------------------------------------------------------
Accuracies on test: jigsaw : 97.61, class : 90.14
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 19
New epoch - lr: 0.001
0/55 of epoch 20/30 jigsaw : 0.260, class : 0.025, t_rotation : 0.301, entropy : 0.122 - acc jigsaw : 94.53, class : 69.53 [bs:128]
30/55 of epoch 20/30 jigsaw : 0.323, class : 0.038, t_rotation : 0.135, entropy : 0.130 - acc jigsaw : 89.84, class : 81.25 [bs:128]
Accuracies on val: jigsaw : 95.84, class : 92.06
--------------------------------------------------------
Accuracies on test: jigsaw : 97.46, class : 90.28
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 20
New epoch - lr: 0.001
0/55 of epoch 21/30 jigsaw : 0.180, class : 0.106, t_rotation : 0.299, entropy : 0.065 - acc jigsaw : 95.31, class : 79.69 [bs:128]
30/55 of epoch 21/30 jigsaw : 0.131, class : 0.105, t_rotation : 0.171, entropy : 0.078 - acc jigsaw : 95.31, class : 73.44 [bs:128]
Accuracies on val: jigsaw : 96.60, class : 91.80
--------------------------------------------------------
Accuracies on test: jigsaw : 97.46, class : 90.92
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 21
New epoch - lr: 0.001
0/55 of epoch 22/30 jigsaw : 0.214, class : 0.070, t_rotation : 0.201, entropy : 0.153 - acc jigsaw : 92.19, class : 80.47 [bs:128]
30/55 of epoch 22/30 jigsaw : 0.202, class : 0.089, t_rotation : 0.106, entropy : 0.111 - acc jigsaw : 92.19, class : 79.69 [bs:128]
Accuracies on val: jigsaw : 94.83, class : 90.79
--------------------------------------------------------
Accuracies on test: jigsaw : 96.78, class : 90.19
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 22
New epoch - lr: 0.001
0/55 of epoch 23/30 jigsaw : 0.240, class : 0.015, t_rotation : 0.370, entropy : 0.119 - acc jigsaw : 91.41, class : 77.34 [bs:128]
30/55 of epoch 23/30 jigsaw : 0.121, class : 0.057, t_rotation : 0.127, entropy : 0.093 - acc jigsaw : 97.66, class : 78.12 [bs:128]
Accuracies on val: jigsaw : 96.60, class : 93.32
--------------------------------------------------------
Accuracies on test: jigsaw : 98.34, class : 90.87
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 23
New epoch - lr: 0.0001
0/55 of epoch 24/30 jigsaw : 0.112, class : 0.022, t_rotation : 0.277, entropy : 0.087 - acc jigsaw : 96.88, class : 77.34 [bs:128]
30/55 of epoch 24/30 jigsaw : 0.178, class : 0.085, t_rotation : 0.295, entropy : 0.077 - acc jigsaw : 93.75, class : 77.34 [bs:128]
Accuracies on val: jigsaw : 96.34, class : 92.81
--------------------------------------------------------
Accuracies on test: jigsaw : 98.00, class : 90.92
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 24
New epoch - lr: 0.0001
0/55 of epoch 25/30 jigsaw : 0.176, class : 0.026, t_rotation : 0.114, entropy : 0.098 - acc jigsaw : 92.97, class : 75.00 [bs:128]
30/55 of epoch 25/30 jigsaw : 0.191, class : 0.050, t_rotation : 0.197, entropy : 0.096 - acc jigsaw : 92.97, class : 78.12 [bs:128]
Accuracies on val: jigsaw : 96.85, class : 92.94
--------------------------------------------------------
Accuracies on test: jigsaw : 98.49, class : 91.11
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 25
New epoch - lr: 0.0001
0/55 of epoch 26/30 jigsaw : 0.119, class : 0.046, t_rotation : 0.205, entropy : 0.121 - acc jigsaw : 96.09, class : 74.22 [bs:128]
30/55 of epoch 26/30 jigsaw : 0.165, class : 0.027, t_rotation : 0.167, entropy : 0.076 - acc jigsaw : 92.97, class : 80.47 [bs:128]
Accuracies on val: jigsaw : 96.47, class : 93.06
--------------------------------------------------------
Accuracies on test: jigsaw : 98.24, class : 90.92
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 26
New epoch - lr: 0.0001
0/55 of epoch 27/30 jigsaw : 0.117, class : 0.081, t_rotation : 0.281, entropy : 0.081 - acc jigsaw : 96.88, class : 75.00 [bs:128]
30/55 of epoch 27/30 jigsaw : 0.148, class : 0.019, t_rotation : 0.141, entropy : 0.109 - acc jigsaw : 94.53, class : 78.91 [bs:128]
Accuracies on val: jigsaw : 96.72, class : 93.32
--------------------------------------------------------
Accuracies on test: jigsaw : 98.24, class : 90.87
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 27
New epoch - lr: 0.0001
0/55 of epoch 28/30 jigsaw : 0.182, class : 0.042, t_rotation : 0.149, entropy : 0.100 - acc jigsaw : 96.09, class : 76.56 [bs:128]
30/55 of epoch 28/30 jigsaw : 0.189, class : 0.036, t_rotation : 0.215, entropy : 0.126 - acc jigsaw : 93.75, class : 81.25 [bs:128]
Accuracies on val: jigsaw : 96.47, class : 92.69
--------------------------------------------------------
Accuracies on test: jigsaw : 98.44, class : 90.82
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 28
New epoch - lr: 0.0001
0/55 of epoch 29/30 jigsaw : 0.204, class : 0.010, t_rotation : 0.174, entropy : 0.098 - acc jigsaw : 92.97, class : 81.25 [bs:128]
30/55 of epoch 29/30 jigsaw : 0.175, class : 0.053, t_rotation : 0.196, entropy : 0.103 - acc jigsaw : 93.75, class : 78.91 [bs:128]
Accuracies on val: jigsaw : 96.34, class : 93.06
--------------------------------------------------------
Accuracies on test: jigsaw : 98.44, class : 90.92
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 29
New epoch - lr: 0.0001
0/55 of epoch 30/30 jigsaw : 0.209, class : 0.069, t_rotation : 0.203, entropy : 0.072 - acc jigsaw : 92.97, class : 75.78 [bs:128]
30/55 of epoch 30/30 jigsaw : 0.270, class : 0.054, t_rotation : 0.155, entropy : 0.092 - acc jigsaw : 88.28, class : 76.56 [bs:128]
Accuracies on val: jigsaw : 95.96, class : 92.81
--------------------------------------------------------
Accuracies on test: jigsaw : 97.80, class : 91.02
--------------------------------------------------------
2019-12-16 08:59:18
art_painting
['photo', 'sketch', 'cartoon']
unsupervised_task_weight: 0.8
bias_hole_image: 0.4
target_rotation_weight: 0.8
entropy_weight 0.3
only_classify the ordered image: True
Highest accuracy on validation set appears on epoch  tensor(14)
Highest accuracy on test set appears on epoch  tensor(24)
Accuracy on test set when the accuracy on validation set is highest:0.893
Highest accuracy on test set:0.911
It took 1280.58
--------------------------------------------------------
******************Start training**************************************
--------------------------------------------------------
Dataset size: training 7150, validation 793, testing 2048
--------------------------------------------------------
Namespace(TTA=False, batch_size=128, bias_whole_image=0.4, classify_only_ordered_images_or_not=True, domains_list=['photo', 'sketch', 'cartoon', 'art_painting'], entropy_loss_weight=0.3, epochs=30, folder_name='test', image_size=222, jitter=0.4, learning_rate=0.001, limit_source=None, limit_target=None, max_scale=1.0, min_scale=0.8, n_classes=7, nesterov=False, network='resnet18', ooo_weight=0, parameters_lists=[[0.8, 0.4, 0.8, 0.2], [0.8, 0.4, 0.8, 0.3], [0.8, 0.4, 0.8, 0.4]], random_horiz_flip=0.5, repeat_times=3, source=['photo', 'sketch', 'cartoon'], suffix='', target='art_painting', target_domain_list=['art_painting', 'cartoon', 'sketch', 'photo'], target_domain_unsupervised_task_loss_weight=0.8, tf_logger=True, tile_random_grayscale=0.1, train_all=True, unsupervised_task_weight=0.8, val_size=0.1)
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 0
New epoch - lr: 0.001
0/55 of epoch 1/30 jigsaw : 1.399, class : 2.057, t_rotation : 1.346, entropy : 1.757 - acc jigsaw : 28.12, class : 17.19 [bs:128]
30/55 of epoch 1/30 jigsaw : 1.064, class : 1.214, t_rotation : 0.896, entropy : 1.706 - acc jigsaw : 54.69, class : 59.38 [bs:128]
Accuracies on val: jigsaw : 94.83, class : 76.67
--------------------------------------------------------
Accuracies on test: jigsaw : 92.43, class : 63.82
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 1
New epoch - lr: 0.001
0/55 of epoch 2/30 jigsaw : 0.840, class : 0.776, t_rotation : 0.886, entropy : 1.458 - acc jigsaw : 65.62, class : 70.31 [bs:128]
30/55 of epoch 2/30 jigsaw : 0.749, class : 0.381, t_rotation : 0.725, entropy : 1.115 - acc jigsaw : 67.97, class : 76.56 [bs:128]
Accuracies on val: jigsaw : 95.96, class : 83.73
--------------------------------------------------------
Accuracies on test: jigsaw : 93.90, class : 80.32
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 2
New epoch - lr: 0.001
0/55 of epoch 3/30 jigsaw : 0.627, class : 0.405, t_rotation : 0.772, entropy : 0.846 - acc jigsaw : 76.56, class : 72.66 [bs:128]
30/55 of epoch 3/30 jigsaw : 0.539, class : 0.494, t_rotation : 0.590, entropy : 0.606 - acc jigsaw : 78.91, class : 64.06 [bs:128]
Accuracies on val: jigsaw : 96.34, class : 86.13
--------------------------------------------------------
Accuracies on test: jigsaw : 92.82, class : 84.08
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 3
New epoch - lr: 0.001
0/55 of epoch 4/30 jigsaw : 0.547, class : 0.196, t_rotation : 0.583, entropy : 0.553 - acc jigsaw : 81.25, class : 73.44 [bs:128]
30/55 of epoch 4/30 jigsaw : 0.547, class : 0.346, t_rotation : 0.458, entropy : 0.458 - acc jigsaw : 80.47, class : 69.53 [bs:128]
Accuracies on val: jigsaw : 96.22, class : 85.12
--------------------------------------------------------
Accuracies on test: jigsaw : 93.31, class : 86.91
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 4
New epoch - lr: 0.001
0/55 of epoch 5/30 jigsaw : 0.400, class : 0.160, t_rotation : 0.599, entropy : 0.453 - acc jigsaw : 84.38, class : 76.56 [bs:128]
30/55 of epoch 5/30 jigsaw : 0.476, class : 0.306, t_rotation : 0.515, entropy : 0.398 - acc jigsaw : 78.91, class : 71.88 [bs:128]
Accuracies on val: jigsaw : 96.09, class : 88.65
--------------------------------------------------------
Accuracies on test: jigsaw : 93.95, class : 87.65
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 5
New epoch - lr: 0.001
0/55 of epoch 6/30 jigsaw : 0.510, class : 0.153, t_rotation : 0.602, entropy : 0.400 - acc jigsaw : 78.91, class : 78.12 [bs:128]
30/55 of epoch 6/30 jigsaw : 0.394, class : 0.159, t_rotation : 0.393, entropy : 0.258 - acc jigsaw : 87.50, class : 78.91 [bs:128]
Accuracies on val: jigsaw : 97.48, class : 89.53
--------------------------------------------------------
Accuracies on test: jigsaw : 95.61, class : 88.57
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 6
New epoch - lr: 0.001
0/55 of epoch 7/30 jigsaw : 0.355, class : 0.247, t_rotation : 0.307, entropy : 0.321 - acc jigsaw : 89.06, class : 75.00 [bs:128]
30/55 of epoch 7/30 jigsaw : 0.312, class : 0.174, t_rotation : 0.365, entropy : 0.252 - acc jigsaw : 87.50, class : 66.41 [bs:128]
Accuracies on val: jigsaw : 97.60, class : 90.29
--------------------------------------------------------
Accuracies on test: jigsaw : 95.75, class : 89.06
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 7
New epoch - lr: 0.001
0/55 of epoch 8/30 jigsaw : 0.305, class : 0.228, t_rotation : 0.339, entropy : 0.248 - acc jigsaw : 88.28, class : 71.88 [bs:128]
30/55 of epoch 8/30 jigsaw : 0.348, class : 0.115, t_rotation : 0.348, entropy : 0.217 - acc jigsaw : 89.06, class : 70.31 [bs:128]
Accuracies on val: jigsaw : 95.08, class : 90.29
--------------------------------------------------------
Accuracies on test: jigsaw : 95.26, class : 89.65
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 8
New epoch - lr: 0.001
0/55 of epoch 9/30 jigsaw : 0.252, class : 0.098, t_rotation : 0.378, entropy : 0.163 - acc jigsaw : 91.41, class : 69.53 [bs:128]
30/55 of epoch 9/30 jigsaw : 0.301, class : 0.166, t_rotation : 0.337, entropy : 0.196 - acc jigsaw : 86.72, class : 80.47 [bs:128]
Accuracies on val: jigsaw : 96.85, class : 91.17
--------------------------------------------------------
Accuracies on test: jigsaw : 95.46, class : 89.89
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 9
New epoch - lr: 0.001
0/55 of epoch 10/30 jigsaw : 0.224, class : 0.125, t_rotation : 0.284, entropy : 0.210 - acc jigsaw : 91.41, class : 74.22 [bs:128]
30/55 of epoch 10/30 jigsaw : 0.263, class : 0.091, t_rotation : 0.241, entropy : 0.225 - acc jigsaw : 90.62, class : 74.22 [bs:128]
Accuracies on val: jigsaw : 96.47, class : 92.81
--------------------------------------------------------
Accuracies on test: jigsaw : 95.46, class : 89.94
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 10
New epoch - lr: 0.001
0/55 of epoch 11/30 jigsaw : 0.228, class : 0.128, t_rotation : 0.320, entropy : 0.195 - acc jigsaw : 92.97, class : 78.91 [bs:128]
30/55 of epoch 11/30 jigsaw : 0.261, class : 0.124, t_rotation : 0.263, entropy : 0.148 - acc jigsaw : 89.84, class : 78.12 [bs:128]
Accuracies on val: jigsaw : 96.34, class : 91.80
--------------------------------------------------------
Accuracies on test: jigsaw : 96.39, class : 89.60
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 11
New epoch - lr: 0.001
0/55 of epoch 12/30 jigsaw : 0.220, class : 0.069, t_rotation : 0.313, entropy : 0.163 - acc jigsaw : 90.62, class : 77.34 [bs:128]
30/55 of epoch 12/30 jigsaw : 0.231, class : 0.086, t_rotation : 0.193, entropy : 0.134 - acc jigsaw : 92.19, class : 75.00 [bs:128]
Accuracies on val: jigsaw : 97.73, class : 92.43
--------------------------------------------------------
Accuracies on test: jigsaw : 97.61, class : 90.53
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 12
New epoch - lr: 0.001
0/55 of epoch 13/30 jigsaw : 0.287, class : 0.140, t_rotation : 0.366, entropy : 0.208 - acc jigsaw : 91.41, class : 79.69 [bs:128]
30/55 of epoch 13/30 jigsaw : 0.258, class : 0.116, t_rotation : 0.213, entropy : 0.161 - acc jigsaw : 91.41, class : 76.56 [bs:128]
Accuracies on val: jigsaw : 95.71, class : 93.44
--------------------------------------------------------
Accuracies on test: jigsaw : 96.83, class : 90.43
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 13
New epoch - lr: 0.001
0/55 of epoch 14/30 jigsaw : 0.288, class : 0.052, t_rotation : 0.298, entropy : 0.166 - acc jigsaw : 87.50, class : 67.19 [bs:128]
30/55 of epoch 14/30 jigsaw : 0.285, class : 0.160, t_rotation : 0.204, entropy : 0.133 - acc jigsaw : 89.06, class : 69.53 [bs:128]
Accuracies on val: jigsaw : 96.34, class : 93.06
--------------------------------------------------------
Accuracies on test: jigsaw : 96.83, class : 90.67
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 14
New epoch - lr: 0.001
0/55 of epoch 15/30 jigsaw : 0.379, class : 0.156, t_rotation : 0.212, entropy : 0.138 - acc jigsaw : 86.72, class : 75.00 [bs:128]
30/55 of epoch 15/30 jigsaw : 0.249, class : 0.074, t_rotation : 0.144, entropy : 0.129 - acc jigsaw : 91.41, class : 81.25 [bs:128]
Accuracies on val: jigsaw : 97.23, class : 92.31
--------------------------------------------------------
Accuracies on test: jigsaw : 96.88, class : 90.53
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 15
New epoch - lr: 0.001
0/55 of epoch 16/30 jigsaw : 0.280, class : 0.040, t_rotation : 0.332, entropy : 0.099 - acc jigsaw : 90.62, class : 78.91 [bs:128]
30/55 of epoch 16/30 jigsaw : 0.226, class : 0.165, t_rotation : 0.224, entropy : 0.092 - acc jigsaw : 93.75, class : 72.66 [bs:128]
Accuracies on val: jigsaw : 96.34, class : 92.81
--------------------------------------------------------
Accuracies on test: jigsaw : 95.75, class : 90.77
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 16
New epoch - lr: 0.001
0/55 of epoch 17/30 jigsaw : 0.251, class : 0.109, t_rotation : 0.259, entropy : 0.190 - acc jigsaw : 91.41, class : 71.88 [bs:128]
30/55 of epoch 17/30 jigsaw : 0.186, class : 0.104, t_rotation : 0.142, entropy : 0.134 - acc jigsaw : 94.53, class : 80.47 [bs:128]
Accuracies on val: jigsaw : 95.59, class : 92.69
--------------------------------------------------------
Accuracies on test: jigsaw : 97.51, class : 91.02
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 17
New epoch - lr: 0.001
0/55 of epoch 18/30 jigsaw : 0.164, class : 0.041, t_rotation : 0.207, entropy : 0.076 - acc jigsaw : 95.31, class : 79.69 [bs:128]
30/55 of epoch 18/30 jigsaw : 0.231, class : 0.057, t_rotation : 0.172, entropy : 0.097 - acc jigsaw : 92.19, class : 79.69 [bs:128]
Accuracies on val: jigsaw : 96.22, class : 93.44
--------------------------------------------------------
Accuracies on test: jigsaw : 97.07, class : 90.77
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 18
New epoch - lr: 0.001
0/55 of epoch 19/30 jigsaw : 0.155, class : 0.074, t_rotation : 0.169, entropy : 0.132 - acc jigsaw : 95.31, class : 76.56 [bs:128]
30/55 of epoch 19/30 jigsaw : 0.270, class : 0.050, t_rotation : 0.213, entropy : 0.109 - acc jigsaw : 91.41, class : 78.12 [bs:128]
Accuracies on val: jigsaw : 96.97, class : 94.20
--------------------------------------------------------
Accuracies on test: jigsaw : 96.58, class : 91.16
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 19
New epoch - lr: 0.001
0/55 of epoch 20/30 jigsaw : 0.163, class : 0.112, t_rotation : 0.196, entropy : 0.107 - acc jigsaw : 93.75, class : 71.09 [bs:128]
30/55 of epoch 20/30 jigsaw : 0.246, class : 0.065, t_rotation : 0.160, entropy : 0.075 - acc jigsaw : 90.62, class : 76.56 [bs:128]
Accuracies on val: jigsaw : 96.34, class : 93.82
--------------------------------------------------------
Accuracies on test: jigsaw : 97.61, class : 91.11
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 20
New epoch - lr: 0.001
0/55 of epoch 21/30 jigsaw : 0.069, class : 0.047, t_rotation : 0.134, entropy : 0.155 - acc jigsaw : 98.44, class : 78.12 [bs:128]
30/55 of epoch 21/30 jigsaw : 0.162, class : 0.040, t_rotation : 0.161, entropy : 0.071 - acc jigsaw : 95.31, class : 75.78 [bs:128]
Accuracies on val: jigsaw : 97.10, class : 94.07
--------------------------------------------------------
Accuracies on test: jigsaw : 97.61, class : 91.16
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 21
New epoch - lr: 0.001
0/55 of epoch 22/30 jigsaw : 0.092, class : 0.078, t_rotation : 0.158, entropy : 0.091 - acc jigsaw : 97.66, class : 78.91 [bs:128]
30/55 of epoch 22/30 jigsaw : 0.192, class : 0.033, t_rotation : 0.149, entropy : 0.110 - acc jigsaw : 92.97, class : 76.56 [bs:128]
Accuracies on val: jigsaw : 96.34, class : 94.07
--------------------------------------------------------
Accuracies on test: jigsaw : 98.49, class : 91.11
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 22
New epoch - lr: 0.001
0/55 of epoch 23/30 jigsaw : 0.091, class : 0.079, t_rotation : 0.165, entropy : 0.060 - acc jigsaw : 96.09, class : 79.69 [bs:128]
30/55 of epoch 23/30 jigsaw : 0.146, class : 0.035, t_rotation : 0.143, entropy : 0.144 - acc jigsaw : 94.53, class : 84.38 [bs:128]
Accuracies on val: jigsaw : 96.34, class : 94.20
--------------------------------------------------------
Accuracies on test: jigsaw : 97.71, class : 90.92
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 23
New epoch - lr: 0.0001
0/55 of epoch 24/30 jigsaw : 0.251, class : 0.043, t_rotation : 0.261, entropy : 0.136 - acc jigsaw : 93.75, class : 71.88 [bs:128]
30/55 of epoch 24/30 jigsaw : 0.154, class : 0.046, t_rotation : 0.303, entropy : 0.131 - acc jigsaw : 93.75, class : 74.22 [bs:128]
Accuracies on val: jigsaw : 96.09, class : 94.20
--------------------------------------------------------
Accuracies on test: jigsaw : 98.19, class : 91.16
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 24
New epoch - lr: 0.0001
0/55 of epoch 25/30 jigsaw : 0.173, class : 0.115, t_rotation : 0.164, entropy : 0.088 - acc jigsaw : 90.62, class : 71.88 [bs:128]
30/55 of epoch 25/30 jigsaw : 0.177, class : 0.056, t_rotation : 0.188, entropy : 0.138 - acc jigsaw : 90.62, class : 79.69 [bs:128]
Accuracies on val: jigsaw : 96.47, class : 94.58
--------------------------------------------------------
Accuracies on test: jigsaw : 98.44, class : 91.21
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 25
New epoch - lr: 0.0001
0/55 of epoch 26/30 jigsaw : 0.181, class : 0.024, t_rotation : 0.175, entropy : 0.144 - acc jigsaw : 92.19, class : 80.47 [bs:128]
30/55 of epoch 26/30 jigsaw : 0.119, class : 0.046, t_rotation : 0.162, entropy : 0.064 - acc jigsaw : 97.66, class : 79.69 [bs:128]
Accuracies on val: jigsaw : 96.47, class : 94.33
--------------------------------------------------------
Accuracies on test: jigsaw : 98.10, class : 91.16
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 26
New epoch - lr: 0.0001
0/55 of epoch 27/30 jigsaw : 0.189, class : 0.016, t_rotation : 0.173, entropy : 0.148 - acc jigsaw : 92.19, class : 71.88 [bs:128]
30/55 of epoch 27/30 jigsaw : 0.134, class : 0.029, t_rotation : 0.158, entropy : 0.130 - acc jigsaw : 93.75, class : 80.47 [bs:128]
Accuracies on val: jigsaw : 96.47, class : 94.33
--------------------------------------------------------
Accuracies on test: jigsaw : 98.00, class : 91.21
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 27
New epoch - lr: 0.0001
0/55 of epoch 28/30 jigsaw : 0.198, class : 0.020, t_rotation : 0.137, entropy : 0.082 - acc jigsaw : 94.53, class : 81.25 [bs:128]
30/55 of epoch 28/30 jigsaw : 0.181, class : 0.039, t_rotation : 0.223, entropy : 0.041 - acc jigsaw : 93.75, class : 78.91 [bs:128]
Accuracies on val: jigsaw : 96.60, class : 94.45
--------------------------------------------------------
Accuracies on test: jigsaw : 98.24, class : 91.21
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 28
New epoch - lr: 0.0001
0/55 of epoch 29/30 jigsaw : 0.087, class : 0.082, t_rotation : 0.284, entropy : 0.123 - acc jigsaw : 96.88, class : 73.44 [bs:128]
30/55 of epoch 29/30 jigsaw : 0.154, class : 0.049, t_rotation : 0.253, entropy : 0.127 - acc jigsaw : 94.53, class : 75.78 [bs:128]
Accuracies on val: jigsaw : 96.47, class : 94.20
--------------------------------------------------------
Accuracies on test: jigsaw : 98.10, class : 91.55
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 29
New epoch - lr: 0.0001
0/55 of epoch 30/30 jigsaw : 0.066, class : 0.023, t_rotation : 0.209, entropy : 0.106 - acc jigsaw : 100.00, class : 71.09 [bs:128]
30/55 of epoch 30/30 jigsaw : 0.146, class : 0.013, t_rotation : 0.154, entropy : 0.107 - acc jigsaw : 95.31, class : 76.56 [bs:128]
Accuracies on val: jigsaw : 96.60, class : 94.20
--------------------------------------------------------
Accuracies on test: jigsaw : 98.10, class : 91.85
--------------------------------------------------------
2019-12-16 09:20:40
art_painting
['photo', 'sketch', 'cartoon']
unsupervised_task_weight: 0.8
bias_hole_image: 0.4
target_rotation_weight: 0.8
entropy_weight 0.3
only_classify the ordered image: True
Highest accuracy on validation set appears on epoch  tensor(24)
Highest accuracy on test set appears on epoch  tensor(29)
Accuracy on test set when the accuracy on validation set is highest:0.912
Highest accuracy on test set:0.918
It took 1282.04
--------------------------------------------------------
******************Start training**************************************
--------------------------------------------------------
Dataset size: training 7150, validation 793, testing 2048
--------------------------------------------------------
Namespace(TTA=False, batch_size=128, bias_whole_image=0.4, classify_only_ordered_images_or_not=True, domains_list=['photo', 'sketch', 'cartoon', 'art_painting'], entropy_loss_weight=0.3, epochs=30, folder_name='test', image_size=222, jitter=0.4, learning_rate=0.001, limit_source=None, limit_target=None, max_scale=1.0, min_scale=0.8, n_classes=7, nesterov=False, network='resnet18', ooo_weight=0, parameters_lists=[[0.8, 0.4, 0.8, 0.2], [0.8, 0.4, 0.8, 0.3], [0.8, 0.4, 0.8, 0.4]], random_horiz_flip=0.5, repeat_times=3, source=['photo', 'sketch', 'cartoon'], suffix='', target='art_painting', target_domain_list=['art_painting', 'cartoon', 'sketch', 'photo'], target_domain_unsupervised_task_loss_weight=0.8, tf_logger=True, tile_random_grayscale=0.1, train_all=True, unsupervised_task_weight=0.8, val_size=0.1)
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 0
New epoch - lr: 0.001
0/55 of epoch 1/30 jigsaw : 1.291, class : 2.067, t_rotation : 1.276, entropy : 1.810 - acc jigsaw : 40.62, class : 11.72 [bs:128]
30/55 of epoch 1/30 jigsaw : 0.982, class : 1.196, t_rotation : 0.989, entropy : 1.742 - acc jigsaw : 60.94, class : 52.34 [bs:128]
Accuracies on val: jigsaw : 97.23, class : 67.21
--------------------------------------------------------
Accuracies on test: jigsaw : 93.85, class : 57.76
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 1
New epoch - lr: 0.001
0/55 of epoch 2/30 jigsaw : 0.761, class : 0.731, t_rotation : 0.912, entropy : 1.439 - acc jigsaw : 69.53, class : 67.97 [bs:128]
30/55 of epoch 2/30 jigsaw : 0.718, class : 0.503, t_rotation : 0.699, entropy : 1.123 - acc jigsaw : 76.56, class : 69.53 [bs:128]
Accuracies on val: jigsaw : 96.09, class : 84.11
--------------------------------------------------------
Accuracies on test: jigsaw : 89.79, class : 76.32
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 2
New epoch - lr: 0.001
0/55 of epoch 3/30 jigsaw : 0.701, class : 0.402, t_rotation : 0.685, entropy : 0.905 - acc jigsaw : 71.88, class : 67.19 [bs:128]
30/55 of epoch 3/30 jigsaw : 0.538, class : 0.272, t_rotation : 0.635, entropy : 0.691 - acc jigsaw : 77.34, class : 75.00 [bs:128]
Accuracies on val: jigsaw : 95.96, class : 86.13
--------------------------------------------------------
Accuracies on test: jigsaw : 92.09, class : 80.81
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 3
New epoch - lr: 0.001
0/55 of epoch 4/30 jigsaw : 0.522, class : 0.484, t_rotation : 0.627, entropy : 0.585 - acc jigsaw : 82.03, class : 67.19 [bs:128]
30/55 of epoch 4/30 jigsaw : 0.438, class : 0.352, t_rotation : 0.471, entropy : 0.466 - acc jigsaw : 83.59, class : 71.88 [bs:128]
Accuracies on val: jigsaw : 96.60, class : 84.87
--------------------------------------------------------
Accuracies on test: jigsaw : 93.55, class : 83.74
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 4
New epoch - lr: 0.001
0/55 of epoch 5/30 jigsaw : 0.538, class : 0.168, t_rotation : 0.567, entropy : 0.428 - acc jigsaw : 82.81, class : 74.22 [bs:128]
30/55 of epoch 5/30 jigsaw : 0.376, class : 0.224, t_rotation : 0.426, entropy : 0.322 - acc jigsaw : 85.94, class : 71.09 [bs:128]
Accuracies on val: jigsaw : 96.34, class : 87.26
--------------------------------------------------------
Accuracies on test: jigsaw : 94.97, class : 85.94
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 5
New epoch - lr: 0.001
0/55 of epoch 6/30 jigsaw : 0.417, class : 0.187, t_rotation : 0.507, entropy : 0.401 - acc jigsaw : 83.59, class : 66.41 [bs:128]
30/55 of epoch 6/30 jigsaw : 0.452, class : 0.206, t_rotation : 0.472, entropy : 0.374 - acc jigsaw : 85.16, class : 76.56 [bs:128]
Accuracies on val: jigsaw : 96.85, class : 89.16
--------------------------------------------------------
Accuracies on test: jigsaw : 95.46, class : 88.04
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 6
New epoch - lr: 0.001
0/55 of epoch 7/30 jigsaw : 0.442, class : 0.218, t_rotation : 0.526, entropy : 0.272 - acc jigsaw : 80.47, class : 70.31 [bs:128]
30/55 of epoch 7/30 jigsaw : 0.320, class : 0.171, t_rotation : 0.392, entropy : 0.260 - acc jigsaw : 89.84, class : 75.00 [bs:128]
Accuracies on val: jigsaw : 96.34, class : 89.16
--------------------------------------------------------
Accuracies on test: jigsaw : 95.21, class : 87.01
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 7
New epoch - lr: 0.001
0/55 of epoch 8/30 jigsaw : 0.330, class : 0.176, t_rotation : 0.404, entropy : 0.289 - acc jigsaw : 88.28, class : 67.97 [bs:128]
30/55 of epoch 8/30 jigsaw : 0.293, class : 0.183, t_rotation : 0.333, entropy : 0.242 - acc jigsaw : 90.62, class : 67.19 [bs:128]
Accuracies on val: jigsaw : 97.23, class : 90.16
--------------------------------------------------------
Accuracies on test: jigsaw : 94.24, class : 88.96
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 8
New epoch - lr: 0.001
0/55 of epoch 9/30 jigsaw : 0.279, class : 0.071, t_rotation : 0.415, entropy : 0.271 - acc jigsaw : 89.06, class : 70.31 [bs:128]
30/55 of epoch 9/30 jigsaw : 0.300, class : 0.201, t_rotation : 0.230, entropy : 0.239 - acc jigsaw : 88.28, class : 73.44 [bs:128]
Accuracies on val: jigsaw : 97.10, class : 90.04
--------------------------------------------------------
Accuracies on test: jigsaw : 94.34, class : 89.31
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 9
New epoch - lr: 0.001
0/55 of epoch 10/30 jigsaw : 0.363, class : 0.231, t_rotation : 0.349, entropy : 0.222 - acc jigsaw : 83.59, class : 65.62 [bs:128]
30/55 of epoch 10/30 jigsaw : 0.231, class : 0.064, t_rotation : 0.237, entropy : 0.206 - acc jigsaw : 92.19, class : 82.81 [bs:128]
Accuracies on val: jigsaw : 97.35, class : 92.06
--------------------------------------------------------
Accuracies on test: jigsaw : 96.39, class : 90.19
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 10
New epoch - lr: 0.001
0/55 of epoch 11/30 jigsaw : 0.292, class : 0.059, t_rotation : 0.338, entropy : 0.197 - acc jigsaw : 89.06, class : 74.22 [bs:128]
30/55 of epoch 11/30 jigsaw : 0.271, class : 0.173, t_rotation : 0.356, entropy : 0.155 - acc jigsaw : 92.97, class : 75.00 [bs:128]
Accuracies on val: jigsaw : 97.48, class : 92.56
--------------------------------------------------------
Accuracies on test: jigsaw : 96.44, class : 89.75
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 11
New epoch - lr: 0.001
0/55 of epoch 12/30 jigsaw : 0.286, class : 0.087, t_rotation : 0.323, entropy : 0.178 - acc jigsaw : 89.06, class : 75.78 [bs:128]
30/55 of epoch 12/30 jigsaw : 0.293, class : 0.138, t_rotation : 0.252, entropy : 0.126 - acc jigsaw : 89.06, class : 71.88 [bs:128]
Accuracies on val: jigsaw : 97.23, class : 92.31
--------------------------------------------------------
Accuracies on test: jigsaw : 96.29, class : 90.43
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 12
New epoch - lr: 0.001
0/55 of epoch 13/30 jigsaw : 0.263, class : 0.114, t_rotation : 0.250, entropy : 0.163 - acc jigsaw : 90.62, class : 62.50 [bs:128]
30/55 of epoch 13/30 jigsaw : 0.218, class : 0.084, t_rotation : 0.234, entropy : 0.094 - acc jigsaw : 91.41, class : 71.09 [bs:128]
Accuracies on val: jigsaw : 97.35, class : 93.06
--------------------------------------------------------
Accuracies on test: jigsaw : 96.09, class : 90.48
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 13
New epoch - lr: 0.001
0/55 of epoch 14/30 jigsaw : 0.211, class : 0.044, t_rotation : 0.345, entropy : 0.125 - acc jigsaw : 92.97, class : 72.66 [bs:128]
30/55 of epoch 14/30 jigsaw : 0.226, class : 0.050, t_rotation : 0.160, entropy : 0.157 - acc jigsaw : 92.97, class : 74.22 [bs:128]
Accuracies on val: jigsaw : 98.11, class : 92.69
--------------------------------------------------------
Accuracies on test: jigsaw : 96.92, class : 90.62
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 14
New epoch - lr: 0.001
0/55 of epoch 15/30 jigsaw : 0.198, class : 0.178, t_rotation : 0.322, entropy : 0.134 - acc jigsaw : 92.97, class : 72.66 [bs:128]
30/55 of epoch 15/30 jigsaw : 0.188, class : 0.204, t_rotation : 0.214, entropy : 0.088 - acc jigsaw : 94.53, class : 78.12 [bs:128]
Accuracies on val: jigsaw : 96.85, class : 92.81
--------------------------------------------------------
Accuracies on test: jigsaw : 94.97, class : 89.94
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 15
New epoch - lr: 0.001
0/55 of epoch 16/30 jigsaw : 0.250, class : 0.124, t_rotation : 0.348, entropy : 0.205 - acc jigsaw : 91.41, class : 76.56 [bs:128]
30/55 of epoch 16/30 jigsaw : 0.265, class : 0.088, t_rotation : 0.158, entropy : 0.101 - acc jigsaw : 91.41, class : 75.00 [bs:128]
Accuracies on val: jigsaw : 98.11, class : 93.95
--------------------------------------------------------
Accuracies on test: jigsaw : 96.58, class : 90.43
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 16
New epoch - lr: 0.001
0/55 of epoch 17/30 jigsaw : 0.210, class : 0.088, t_rotation : 0.224, entropy : 0.104 - acc jigsaw : 92.19, class : 78.12 [bs:128]
30/55 of epoch 17/30 jigsaw : 0.196, class : 0.058, t_rotation : 0.194, entropy : 0.111 - acc jigsaw : 91.41, class : 69.53 [bs:128]
Accuracies on val: jigsaw : 97.60, class : 93.32
--------------------------------------------------------
Accuracies on test: jigsaw : 96.24, class : 90.72
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 17
New epoch - lr: 0.001
0/55 of epoch 18/30 jigsaw : 0.208, class : 0.076, t_rotation : 0.218, entropy : 0.170 - acc jigsaw : 92.19, class : 76.56 [bs:128]
30/55 of epoch 18/30 jigsaw : 0.156, class : 0.108, t_rotation : 0.159, entropy : 0.091 - acc jigsaw : 94.53, class : 76.56 [bs:128]
Accuracies on val: jigsaw : 96.22, class : 92.69
--------------------------------------------------------
Accuracies on test: jigsaw : 96.97, class : 90.87
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 18
New epoch - lr: 0.001
0/55 of epoch 19/30 jigsaw : 0.137, class : 0.039, t_rotation : 0.255, entropy : 0.151 - acc jigsaw : 94.53, class : 71.09 [bs:128]
30/55 of epoch 19/30 jigsaw : 0.171, class : 0.027, t_rotation : 0.174, entropy : 0.114 - acc jigsaw : 92.97, class : 80.47 [bs:128]
Accuracies on val: jigsaw : 97.23, class : 94.33
--------------------------------------------------------
Accuracies on test: jigsaw : 96.58, class : 91.11
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 19
New epoch - lr: 0.001
0/55 of epoch 20/30 jigsaw : 0.142, class : 0.061, t_rotation : 0.181, entropy : 0.125 - acc jigsaw : 95.31, class : 71.88 [bs:128]
30/55 of epoch 20/30 jigsaw : 0.131, class : 0.094, t_rotation : 0.140, entropy : 0.094 - acc jigsaw : 96.88, class : 78.12 [bs:128]
Accuracies on val: jigsaw : 97.10, class : 93.82
--------------------------------------------------------
Accuracies on test: jigsaw : 96.73, class : 90.97
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 20
New epoch - lr: 0.001
0/55 of epoch 21/30 jigsaw : 0.207, class : 0.070, t_rotation : 0.251, entropy : 0.096 - acc jigsaw : 92.97, class : 69.53 [bs:128]
30/55 of epoch 21/30 jigsaw : 0.144, class : 0.020, t_rotation : 0.122, entropy : 0.088 - acc jigsaw : 96.09, class : 75.78 [bs:128]
Accuracies on val: jigsaw : 97.60, class : 95.21
--------------------------------------------------------
Accuracies on test: jigsaw : 97.56, class : 90.43
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 21
New epoch - lr: 0.001
0/55 of epoch 22/30 jigsaw : 0.165, class : 0.023, t_rotation : 0.326, entropy : 0.143 - acc jigsaw : 92.97, class : 75.78 [bs:128]
30/55 of epoch 22/30 jigsaw : 0.169, class : 0.021, t_rotation : 0.118, entropy : 0.146 - acc jigsaw : 91.41, class : 79.69 [bs:128]
Accuracies on val: jigsaw : 96.47, class : 94.07
--------------------------------------------------------
Accuracies on test: jigsaw : 96.53, class : 91.06
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 22
New epoch - lr: 0.001
0/55 of epoch 23/30 jigsaw : 0.191, class : 0.055, t_rotation : 0.185, entropy : 0.137 - acc jigsaw : 92.97, class : 78.91 [bs:128]
30/55 of epoch 23/30 jigsaw : 0.140, class : 0.037, t_rotation : 0.085, entropy : 0.069 - acc jigsaw : 96.09, class : 80.47 [bs:128]
Accuracies on val: jigsaw : 97.35, class : 95.33
--------------------------------------------------------
Accuracies on test: jigsaw : 97.71, class : 90.43
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 23
New epoch - lr: 0.0001
0/55 of epoch 24/30 jigsaw : 0.251, class : 0.065, t_rotation : 0.135, entropy : 0.109 - acc jigsaw : 93.75, class : 67.97 [bs:128]
30/55 of epoch 24/30 jigsaw : 0.144, class : 0.031, t_rotation : 0.186, entropy : 0.087 - acc jigsaw : 93.75, class : 78.91 [bs:128]
Accuracies on val: jigsaw : 97.23, class : 95.21
--------------------------------------------------------
Accuracies on test: jigsaw : 98.14, class : 90.67
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 24
New epoch - lr: 0.0001
0/55 of epoch 25/30 jigsaw : 0.202, class : 0.072, t_rotation : 0.159, entropy : 0.133 - acc jigsaw : 94.53, class : 75.78 [bs:128]
30/55 of epoch 25/30 jigsaw : 0.112, class : 0.027, t_rotation : 0.215, entropy : 0.103 - acc jigsaw : 95.31, class : 85.16 [bs:128]
Accuracies on val: jigsaw : 97.73, class : 95.08
--------------------------------------------------------
Accuracies on test: jigsaw : 98.10, class : 90.97
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 25
New epoch - lr: 0.0001
0/55 of epoch 26/30 jigsaw : 0.114, class : 0.059, t_rotation : 0.113, entropy : 0.049 - acc jigsaw : 96.88, class : 76.56 [bs:128]
30/55 of epoch 26/30 jigsaw : 0.159, class : 0.048, t_rotation : 0.191, entropy : 0.132 - acc jigsaw : 94.53, class : 77.34 [bs:128]
Accuracies on val: jigsaw : 98.23, class : 94.83
--------------------------------------------------------
Accuracies on test: jigsaw : 98.44, class : 90.92
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 26
New epoch - lr: 0.0001
0/55 of epoch 27/30 jigsaw : 0.159, class : 0.039, t_rotation : 0.174, entropy : 0.087 - acc jigsaw : 94.53, class : 82.81 [bs:128]
30/55 of epoch 27/30 jigsaw : 0.105, class : 0.034, t_rotation : 0.131, entropy : 0.098 - acc jigsaw : 97.66, class : 75.78 [bs:128]
Accuracies on val: jigsaw : 97.86, class : 94.58
--------------------------------------------------------
Accuracies on test: jigsaw : 98.44, class : 91.11
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 27
New epoch - lr: 0.0001
0/55 of epoch 28/30 jigsaw : 0.123, class : 0.080, t_rotation : 0.219, entropy : 0.107 - acc jigsaw : 95.31, class : 71.88 [bs:128]
30/55 of epoch 28/30 jigsaw : 0.246, class : 0.017, t_rotation : 0.175, entropy : 0.091 - acc jigsaw : 94.53, class : 75.78 [bs:128]
Accuracies on val: jigsaw : 97.48, class : 95.08
--------------------------------------------------------
Accuracies on test: jigsaw : 97.80, class : 91.31
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 28
New epoch - lr: 0.0001
0/55 of epoch 29/30 jigsaw : 0.178, class : 0.064, t_rotation : 0.190, entropy : 0.074 - acc jigsaw : 94.53, class : 74.22 [bs:128]
30/55 of epoch 29/30 jigsaw : 0.107, class : 0.044, t_rotation : 0.155, entropy : 0.069 - acc jigsaw : 96.09, class : 73.44 [bs:128]
Accuracies on val: jigsaw : 98.36, class : 94.83
--------------------------------------------------------
Accuracies on test: jigsaw : 98.24, class : 91.31
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 29
New epoch - lr: 0.0001
0/55 of epoch 30/30 jigsaw : 0.154, class : 0.063, t_rotation : 0.117, entropy : 0.085 - acc jigsaw : 92.97, class : 79.69 [bs:128]
30/55 of epoch 30/30 jigsaw : 0.204, class : 0.042, t_rotation : 0.187, entropy : 0.062 - acc jigsaw : 92.97, class : 79.69 [bs:128]
Accuracies on val: jigsaw : 97.73, class : 94.83
--------------------------------------------------------
Accuracies on test: jigsaw : 97.95, class : 90.97
--------------------------------------------------------
2019-12-16 09:42:02
art_painting
['photo', 'sketch', 'cartoon']
unsupervised_task_weight: 0.8
bias_hole_image: 0.4
target_rotation_weight: 0.8
entropy_weight 0.3
only_classify the ordered image: True
Highest accuracy on validation set appears on epoch  tensor(22)
Highest accuracy on test set appears on epoch  tensor(28)
Accuracy on test set when the accuracy on validation set is highest:0.904
Highest accuracy on test set:0.913
It took 1280.97
--------------------------------------------------------
******************Start training**************************************
--------------------------------------------------------
Dataset size: training 6884, validation 763, testing 2344
--------------------------------------------------------
Namespace(TTA=False, batch_size=128, bias_whole_image=0.4, classify_only_ordered_images_or_not=True, domains_list=['photo', 'sketch', 'cartoon', 'art_painting'], entropy_loss_weight=0.3, epochs=30, folder_name='test', image_size=222, jitter=0.4, learning_rate=0.001, limit_source=None, limit_target=None, max_scale=1.0, min_scale=0.8, n_classes=7, nesterov=False, network='resnet18', ooo_weight=0, parameters_lists=[[0.8, 0.4, 0.8, 0.2], [0.8, 0.4, 0.8, 0.3], [0.8, 0.4, 0.8, 0.4]], random_horiz_flip=0.5, repeat_times=3, source=['photo', 'sketch', 'art_painting'], suffix='', target='cartoon', target_domain_list=['art_painting', 'cartoon', 'sketch', 'photo'], target_domain_unsupervised_task_loss_weight=0.8, tf_logger=True, tile_random_grayscale=0.1, train_all=True, unsupervised_task_weight=0.8, val_size=0.1)
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 0
New epoch - lr: 0.001
0/53 of epoch 1/30 jigsaw : 1.509, class : 2.264, t_rotation : 1.448, entropy : 1.636 - acc jigsaw : 26.56, class : 10.16 [bs:128]
30/53 of epoch 1/30 jigsaw : 0.880, class : 1.145, t_rotation : 0.909, entropy : 1.685 - acc jigsaw : 70.31, class : 56.25 [bs:128]
Accuracies on val: jigsaw : 94.50, class : 74.44
--------------------------------------------------------
Accuracies on test: jigsaw : 96.33, class : 56.57
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 1
New epoch - lr: 0.001
0/53 of epoch 2/30 jigsaw : 0.743, class : 0.741, t_rotation : 0.868, entropy : 1.440 - acc jigsaw : 71.09, class : 64.84 [bs:128]
30/53 of epoch 2/30 jigsaw : 0.737, class : 0.463, t_rotation : 0.611, entropy : 0.976 - acc jigsaw : 70.31, class : 64.84 [bs:128]
Accuracies on val: jigsaw : 93.45, class : 85.85
--------------------------------------------------------
Accuracies on test: jigsaw : 95.90, class : 64.08
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 2
New epoch - lr: 0.001
0/53 of epoch 3/30 jigsaw : 0.635, class : 0.409, t_rotation : 0.650, entropy : 0.792 - acc jigsaw : 70.31, class : 65.62 [bs:128]
30/53 of epoch 3/30 jigsaw : 0.543, class : 0.433, t_rotation : 0.474, entropy : 0.763 - acc jigsaw : 78.91, class : 70.31 [bs:128]
Accuracies on val: jigsaw : 92.79, class : 87.94
--------------------------------------------------------
Accuracies on test: jigsaw : 96.80, class : 71.76
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 3
New epoch - lr: 0.001
0/53 of epoch 4/30 jigsaw : 0.544, class : 0.336, t_rotation : 0.527, entropy : 0.511 - acc jigsaw : 78.12, class : 66.41 [bs:128]
30/53 of epoch 4/30 jigsaw : 0.513, class : 0.234, t_rotation : 0.388, entropy : 0.515 - acc jigsaw : 78.12, class : 71.88 [bs:128]
Accuracies on val: jigsaw : 92.01, class : 88.07
--------------------------------------------------------
Accuracies on test: jigsaw : 97.23, class : 76.07
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 4
New epoch - lr: 0.001
0/53 of epoch 5/30 jigsaw : 0.455, class : 0.316, t_rotation : 0.485, entropy : 0.553 - acc jigsaw : 82.03, class : 75.78 [bs:128]
30/53 of epoch 5/30 jigsaw : 0.440, class : 0.147, t_rotation : 0.338, entropy : 0.349 - acc jigsaw : 82.81, class : 73.44 [bs:128]
Accuracies on val: jigsaw : 93.71, class : 90.56
--------------------------------------------------------
Accuracies on test: jigsaw : 97.91, class : 74.27
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 5
New epoch - lr: 0.001
0/53 of epoch 6/30 jigsaw : 0.447, class : 0.216, t_rotation : 0.443, entropy : 0.373 - acc jigsaw : 84.38, class : 67.97 [bs:128]
30/53 of epoch 6/30 jigsaw : 0.365, class : 0.238, t_rotation : 0.365, entropy : 0.367 - acc jigsaw : 88.28, class : 71.09 [bs:128]
Accuracies on val: jigsaw : 92.92, class : 90.56
--------------------------------------------------------
Accuracies on test: jigsaw : 97.78, class : 75.43
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 6
New epoch - lr: 0.001
0/53 of epoch 7/30 jigsaw : 0.327, class : 0.173, t_rotation : 0.344, entropy : 0.348 - acc jigsaw : 89.06, class : 71.09 [bs:128]
30/53 of epoch 7/30 jigsaw : 0.354, class : 0.310, t_rotation : 0.288, entropy : 0.249 - acc jigsaw : 86.72, class : 72.66 [bs:128]
Accuracies on val: jigsaw : 93.58, class : 91.22
--------------------------------------------------------
Accuracies on test: jigsaw : 97.53, class : 75.73
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 7
New epoch - lr: 0.001
0/53 of epoch 8/30 jigsaw : 0.397, class : 0.222, t_rotation : 0.323, entropy : 0.309 - acc jigsaw : 83.59, class : 69.53 [bs:128]
30/53 of epoch 8/30 jigsaw : 0.314, class : 0.086, t_rotation : 0.172, entropy : 0.262 - acc jigsaw : 87.50, class : 74.22 [bs:128]
Accuracies on val: jigsaw : 92.66, class : 90.83
--------------------------------------------------------
Accuracies on test: jigsaw : 97.48, class : 77.43
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 8
New epoch - lr: 0.001
0/53 of epoch 9/30 jigsaw : 0.256, class : 0.044, t_rotation : 0.276, entropy : 0.243 - acc jigsaw : 90.62, class : 72.66 [bs:128]
30/53 of epoch 9/30 jigsaw : 0.349, class : 0.120, t_rotation : 0.324, entropy : 0.189 - acc jigsaw : 87.50, class : 72.66 [bs:128]
Accuracies on val: jigsaw : 92.79, class : 91.61
--------------------------------------------------------
Accuracies on test: jigsaw : 97.57, class : 78.41
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 9
New epoch - lr: 0.001
0/53 of epoch 10/30 jigsaw : 0.358, class : 0.075, t_rotation : 0.194, entropy : 0.228 - acc jigsaw : 86.72, class : 69.53 [bs:128]
30/53 of epoch 10/30 jigsaw : 0.309, class : 0.097, t_rotation : 0.155, entropy : 0.208 - acc jigsaw : 89.84, class : 78.91 [bs:128]
Accuracies on val: jigsaw : 94.10, class : 91.48
--------------------------------------------------------
Accuracies on test: jigsaw : 97.87, class : 78.84
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 10
New epoch - lr: 0.001
0/53 of epoch 11/30 jigsaw : 0.281, class : 0.216, t_rotation : 0.174, entropy : 0.177 - acc jigsaw : 90.62, class : 69.53 [bs:128]
30/53 of epoch 11/30 jigsaw : 0.195, class : 0.144, t_rotation : 0.127, entropy : 0.173 - acc jigsaw : 95.31, class : 79.69 [bs:128]
Accuracies on val: jigsaw : 94.63, class : 92.14
--------------------------------------------------------
Accuracies on test: jigsaw : 98.34, class : 77.99
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 11
New epoch - lr: 0.001
0/53 of epoch 12/30 jigsaw : 0.324, class : 0.131, t_rotation : 0.171, entropy : 0.244 - acc jigsaw : 89.84, class : 78.12 [bs:128]
30/53 of epoch 12/30 jigsaw : 0.260, class : 0.142, t_rotation : 0.120, entropy : 0.165 - acc jigsaw : 90.62, class : 71.09 [bs:128]
Accuracies on val: jigsaw : 93.18, class : 92.66
--------------------------------------------------------
Accuracies on test: jigsaw : 98.12, class : 77.52
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 12
New epoch - lr: 0.001
0/53 of epoch 13/30 jigsaw : 0.320, class : 0.073, t_rotation : 0.157, entropy : 0.203 - acc jigsaw : 90.62, class : 74.22 [bs:128]
30/53 of epoch 13/30 jigsaw : 0.157, class : 0.092, t_rotation : 0.186, entropy : 0.159 - acc jigsaw : 92.97, class : 68.75 [bs:128]
Accuracies on val: jigsaw : 93.18, class : 92.01
--------------------------------------------------------
Accuracies on test: jigsaw : 97.74, class : 78.28
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 13
New epoch - lr: 0.001
0/53 of epoch 14/30 jigsaw : 0.276, class : 0.109, t_rotation : 0.218, entropy : 0.166 - acc jigsaw : 89.06, class : 73.44 [bs:128]
30/53 of epoch 14/30 jigsaw : 0.241, class : 0.087, t_rotation : 0.140, entropy : 0.169 - acc jigsaw : 92.97, class : 75.78 [bs:128]
Accuracies on val: jigsaw : 94.23, class : 92.01
--------------------------------------------------------
Accuracies on test: jigsaw : 98.68, class : 79.14
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 14
New epoch - lr: 0.001
0/53 of epoch 15/30 jigsaw : 0.301, class : 0.151, t_rotation : 0.190, entropy : 0.162 - acc jigsaw : 91.41, class : 70.31 [bs:128]
30/53 of epoch 15/30 jigsaw : 0.267, class : 0.037, t_rotation : 0.155, entropy : 0.176 - acc jigsaw : 91.41, class : 72.66 [bs:128]
Accuracies on val: jigsaw : 94.76, class : 91.35
--------------------------------------------------------
Accuracies on test: jigsaw : 98.68, class : 80.20
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 15
New epoch - lr: 0.001
0/53 of epoch 16/30 jigsaw : 0.349, class : 0.025, t_rotation : 0.163, entropy : 0.153 - acc jigsaw : 85.94, class : 69.53 [bs:128]
30/53 of epoch 16/30 jigsaw : 0.373, class : 0.132, t_rotation : 0.089, entropy : 0.124 - acc jigsaw : 89.06, class : 71.88 [bs:128]
Accuracies on val: jigsaw : 93.97, class : 92.92
--------------------------------------------------------
Accuracies on test: jigsaw : 98.51, class : 78.07
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 16
New epoch - lr: 0.001
0/53 of epoch 17/30 jigsaw : 0.268, class : 0.067, t_rotation : 0.129, entropy : 0.132 - acc jigsaw : 92.97, class : 71.88 [bs:128]
30/53 of epoch 17/30 jigsaw : 0.203, class : 0.038, t_rotation : 0.114, entropy : 0.161 - acc jigsaw : 90.62, class : 75.78 [bs:128]
Accuracies on val: jigsaw : 93.58, class : 92.27
--------------------------------------------------------
Accuracies on test: jigsaw : 98.17, class : 79.14
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 17
New epoch - lr: 0.001
0/53 of epoch 18/30 jigsaw : 0.242, class : 0.147, t_rotation : 0.152, entropy : 0.145 - acc jigsaw : 92.19, class : 75.78 [bs:128]
30/53 of epoch 18/30 jigsaw : 0.156, class : 0.027, t_rotation : 0.056, entropy : 0.099 - acc jigsaw : 95.31, class : 77.34 [bs:128]
Accuracies on val: jigsaw : 94.36, class : 91.74
--------------------------------------------------------
Accuracies on test: jigsaw : 98.76, class : 78.20
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 18
New epoch - lr: 0.001
0/53 of epoch 19/30 jigsaw : 0.241, class : 0.075, t_rotation : 0.122, entropy : 0.123 - acc jigsaw : 94.53, class : 69.53 [bs:128]
30/53 of epoch 19/30 jigsaw : 0.227, class : 0.164, t_rotation : 0.107, entropy : 0.135 - acc jigsaw : 91.41, class : 71.09 [bs:128]
Accuracies on val: jigsaw : 94.50, class : 91.87
--------------------------------------------------------
Accuracies on test: jigsaw : 98.72, class : 77.82
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 19
New epoch - lr: 0.001
0/53 of epoch 20/30 jigsaw : 0.265, class : 0.086, t_rotation : 0.138, entropy : 0.132 - acc jigsaw : 89.84, class : 74.22 [bs:128]
30/53 of epoch 20/30 jigsaw : 0.227, class : 0.095, t_rotation : 0.095, entropy : 0.113 - acc jigsaw : 92.19, class : 69.53 [bs:128]
Accuracies on val: jigsaw : 94.89, class : 92.14
--------------------------------------------------------
Accuracies on test: jigsaw : 99.06, class : 79.22
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 20
New epoch - lr: 0.001
0/53 of epoch 21/30 jigsaw : 0.173, class : 0.056, t_rotation : 0.112, entropy : 0.177 - acc jigsaw : 90.62, class : 71.09 [bs:128]
30/53 of epoch 21/30 jigsaw : 0.271, class : 0.016, t_rotation : 0.107, entropy : 0.130 - acc jigsaw : 92.19, class : 79.69 [bs:128]
Accuracies on val: jigsaw : 94.89, class : 92.66
--------------------------------------------------------
Accuracies on test: jigsaw : 99.27, class : 78.88
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 21
New epoch - lr: 0.001
0/53 of epoch 22/30 jigsaw : 0.190, class : 0.054, t_rotation : 0.155, entropy : 0.131 - acc jigsaw : 92.19, class : 79.69 [bs:128]
30/53 of epoch 22/30 jigsaw : 0.184, class : 0.019, t_rotation : 0.091, entropy : 0.095 - acc jigsaw : 92.97, class : 75.78 [bs:128]
Accuracies on val: jigsaw : 95.15, class : 92.27
--------------------------------------------------------
Accuracies on test: jigsaw : 99.27, class : 79.44
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 22
New epoch - lr: 0.001
0/53 of epoch 23/30 jigsaw : 0.285, class : 0.008, t_rotation : 0.116, entropy : 0.118 - acc jigsaw : 92.97, class : 77.34 [bs:128]
30/53 of epoch 23/30 jigsaw : 0.162, class : 0.052, t_rotation : 0.094, entropy : 0.079 - acc jigsaw : 93.75, class : 67.97 [bs:128]
Accuracies on val: jigsaw : 96.07, class : 91.61
--------------------------------------------------------
Accuracies on test: jigsaw : 99.53, class : 79.74
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 23
New epoch - lr: 0.0001
0/53 of epoch 24/30 jigsaw : 0.231, class : 0.019, t_rotation : 0.181, entropy : 0.114 - acc jigsaw : 93.75, class : 67.19 [bs:128]
30/53 of epoch 24/30 jigsaw : 0.179, class : 0.052, t_rotation : 0.153, entropy : 0.162 - acc jigsaw : 94.53, class : 78.12 [bs:128]
Accuracies on val: jigsaw : 96.20, class : 92.01
--------------------------------------------------------
Accuracies on test: jigsaw : 99.49, class : 79.95
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 24
New epoch - lr: 0.0001
0/53 of epoch 25/30 jigsaw : 0.179, class : 0.026, t_rotation : 0.170, entropy : 0.149 - acc jigsaw : 92.97, class : 78.12 [bs:128]
30/53 of epoch 25/30 jigsaw : 0.197, class : 0.068, t_rotation : 0.127, entropy : 0.117 - acc jigsaw : 94.53, class : 68.75 [bs:128]
Accuracies on val: jigsaw : 95.28, class : 92.27
--------------------------------------------------------
Accuracies on test: jigsaw : 99.45, class : 79.44
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 25
New epoch - lr: 0.0001
0/53 of epoch 26/30 jigsaw : 0.179, class : 0.024, t_rotation : 0.118, entropy : 0.123 - acc jigsaw : 94.53, class : 75.00 [bs:128]
30/53 of epoch 26/30 jigsaw : 0.167, class : 0.102, t_rotation : 0.134, entropy : 0.063 - acc jigsaw : 92.97, class : 75.00 [bs:128]
Accuracies on val: jigsaw : 95.15, class : 92.40
--------------------------------------------------------
Accuracies on test: jigsaw : 99.32, class : 79.18
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 26
New epoch - lr: 0.0001
0/53 of epoch 27/30 jigsaw : 0.166, class : 0.035, t_rotation : 0.151, entropy : 0.107 - acc jigsaw : 92.19, class : 74.22 [bs:128]
30/53 of epoch 27/30 jigsaw : 0.152, class : 0.031, t_rotation : 0.141, entropy : 0.115 - acc jigsaw : 95.31, class : 76.56 [bs:128]
Accuracies on val: jigsaw : 95.28, class : 92.40
--------------------------------------------------------
Accuracies on test: jigsaw : 99.49, class : 79.10
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 27
New epoch - lr: 0.0001
0/53 of epoch 28/30 jigsaw : 0.181, class : 0.059, t_rotation : 0.038, entropy : 0.111 - acc jigsaw : 93.75, class : 74.22 [bs:128]
30/53 of epoch 28/30 jigsaw : 0.276, class : 0.053, t_rotation : 0.140, entropy : 0.122 - acc jigsaw : 91.41, class : 74.22 [bs:128]
Accuracies on val: jigsaw : 95.54, class : 92.40
--------------------------------------------------------
Accuracies on test: jigsaw : 99.57, class : 79.61
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 28
New epoch - lr: 0.0001
0/53 of epoch 29/30 jigsaw : 0.202, class : 0.051, t_rotation : 0.084, entropy : 0.089 - acc jigsaw : 92.19, class : 73.44 [bs:128]
30/53 of epoch 29/30 jigsaw : 0.235, class : 0.022, t_rotation : 0.115, entropy : 0.109 - acc jigsaw : 92.19, class : 79.69 [bs:128]
Accuracies on val: jigsaw : 95.41, class : 92.79
--------------------------------------------------------
Accuracies on test: jigsaw : 99.53, class : 79.35
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 29
New epoch - lr: 0.0001
0/53 of epoch 30/30 jigsaw : 0.160, class : 0.042, t_rotation : 0.109, entropy : 0.117 - acc jigsaw : 92.97, class : 72.66 [bs:128]
30/53 of epoch 30/30 jigsaw : 0.212, class : 0.046, t_rotation : 0.086, entropy : 0.078 - acc jigsaw : 93.75, class : 75.00 [bs:128]
Accuracies on val: jigsaw : 95.02, class : 92.53
--------------------------------------------------------
Accuracies on test: jigsaw : 99.45, class : 79.74
--------------------------------------------------------
2019-12-16 10:03:06
cartoon
['photo', 'sketch', 'art_painting']
unsupervised_task_weight: 0.8
bias_hole_image: 0.4
target_rotation_weight: 0.8
entropy_weight 0.3
only_classify the ordered image: True
Highest accuracy on validation set appears on epoch  tensor(15)
Highest accuracy on test set appears on epoch  tensor(14)
Accuracy on test set when the accuracy on validation set is highest:0.781
Highest accuracy on test set:0.802
It took 1264.25
--------------------------------------------------------
******************Start training**************************************
--------------------------------------------------------
Dataset size: training 6884, validation 763, testing 2344
--------------------------------------------------------
Namespace(TTA=False, batch_size=128, bias_whole_image=0.4, classify_only_ordered_images_or_not=True, domains_list=['photo', 'sketch', 'cartoon', 'art_painting'], entropy_loss_weight=0.3, epochs=30, folder_name='test', image_size=222, jitter=0.4, learning_rate=0.001, limit_source=None, limit_target=None, max_scale=1.0, min_scale=0.8, n_classes=7, nesterov=False, network='resnet18', ooo_weight=0, parameters_lists=[[0.8, 0.4, 0.8, 0.2], [0.8, 0.4, 0.8, 0.3], [0.8, 0.4, 0.8, 0.4]], random_horiz_flip=0.5, repeat_times=3, source=['photo', 'sketch', 'art_painting'], suffix='', target='cartoon', target_domain_list=['art_painting', 'cartoon', 'sketch', 'photo'], target_domain_unsupervised_task_loss_weight=0.8, tf_logger=True, tile_random_grayscale=0.1, train_all=True, unsupervised_task_weight=0.8, val_size=0.1)
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 0
New epoch - lr: 0.001
0/53 of epoch 1/30 jigsaw : 1.578, class : 2.180, t_rotation : 1.502, entropy : 1.718 - acc jigsaw : 21.88, class : 11.72 [bs:128]
30/53 of epoch 1/30 jigsaw : 0.944, class : 1.206, t_rotation : 1.001, entropy : 1.675 - acc jigsaw : 64.06, class : 53.12 [bs:128]
Accuracies on val: jigsaw : 97.25, class : 74.18
--------------------------------------------------------
Accuracies on test: jigsaw : 97.57, class : 60.07
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 1
New epoch - lr: 0.001
0/53 of epoch 2/30 jigsaw : 0.794, class : 0.784, t_rotation : 0.876, entropy : 1.339 - acc jigsaw : 66.41, class : 66.41 [bs:128]
30/53 of epoch 2/30 jigsaw : 0.561, class : 0.660, t_rotation : 0.649, entropy : 0.905 - acc jigsaw : 77.34, class : 67.97 [bs:128]
Accuracies on val: jigsaw : 93.97, class : 83.88
--------------------------------------------------------
Accuracies on test: jigsaw : 94.50, class : 71.03
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 2
New epoch - lr: 0.001
0/53 of epoch 3/30 jigsaw : 0.574, class : 0.402, t_rotation : 0.685, entropy : 0.806 - acc jigsaw : 82.03, class : 67.19 [bs:128]
30/53 of epoch 3/30 jigsaw : 0.530, class : 0.376, t_rotation : 0.467, entropy : 0.567 - acc jigsaw : 78.91, class : 70.31 [bs:128]
Accuracies on val: jigsaw : 95.41, class : 87.68
--------------------------------------------------------
Accuracies on test: jigsaw : 97.10, class : 74.83
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 3
New epoch - lr: 0.001
0/53 of epoch 4/30 jigsaw : 0.531, class : 0.351, t_rotation : 0.511, entropy : 0.562 - acc jigsaw : 79.69, class : 61.72 [bs:128]
30/53 of epoch 4/30 jigsaw : 0.648, class : 0.215, t_rotation : 0.444, entropy : 0.501 - acc jigsaw : 73.44, class : 69.53 [bs:128]
Accuracies on val: jigsaw : 94.63, class : 88.20
--------------------------------------------------------
Accuracies on test: jigsaw : 97.23, class : 73.55
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 4
New epoch - lr: 0.001
0/53 of epoch 5/30 jigsaw : 0.496, class : 0.228, t_rotation : 0.371, entropy : 0.335 - acc jigsaw : 79.69, class : 67.19 [bs:128]
30/53 of epoch 5/30 jigsaw : 0.473, class : 0.360, t_rotation : 0.397, entropy : 0.294 - acc jigsaw : 85.16, class : 69.53 [bs:128]
Accuracies on val: jigsaw : 94.10, class : 89.91
--------------------------------------------------------
Accuracies on test: jigsaw : 96.63, class : 76.62
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 5
New epoch - lr: 0.001
0/53 of epoch 6/30 jigsaw : 0.510, class : 0.160, t_rotation : 0.354, entropy : 0.381 - acc jigsaw : 83.59, class : 67.19 [bs:128]
30/53 of epoch 6/30 jigsaw : 0.439, class : 0.251, t_rotation : 0.362, entropy : 0.297 - acc jigsaw : 85.16, class : 66.41 [bs:128]
Accuracies on val: jigsaw : 94.89, class : 88.47
--------------------------------------------------------
Accuracies on test: jigsaw : 97.87, class : 77.86
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 6
New epoch - lr: 0.001
0/53 of epoch 7/30 jigsaw : 0.424, class : 0.155, t_rotation : 0.288, entropy : 0.275 - acc jigsaw : 85.94, class : 70.31 [bs:128]
30/53 of epoch 7/30 jigsaw : 0.350, class : 0.246, t_rotation : 0.211, entropy : 0.309 - acc jigsaw : 89.06, class : 71.88 [bs:128]
Accuracies on val: jigsaw : 94.63, class : 90.04
--------------------------------------------------------
Accuracies on test: jigsaw : 97.99, class : 77.22
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 7
New epoch - lr: 0.001
0/53 of epoch 8/30 jigsaw : 0.341, class : 0.126, t_rotation : 0.330, entropy : 0.263 - acc jigsaw : 85.16, class : 71.88 [bs:128]
30/53 of epoch 8/30 jigsaw : 0.291, class : 0.167, t_rotation : 0.228, entropy : 0.137 - acc jigsaw : 89.06, class : 75.78 [bs:128]
Accuracies on val: jigsaw : 95.02, class : 90.04
--------------------------------------------------------
Accuracies on test: jigsaw : 97.91, class : 78.41
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 8
New epoch - lr: 0.001
0/53 of epoch 9/30 jigsaw : 0.348, class : 0.175, t_rotation : 0.253, entropy : 0.162 - acc jigsaw : 90.62, class : 65.62 [bs:128]
30/53 of epoch 9/30 jigsaw : 0.326, class : 0.173, t_rotation : 0.204, entropy : 0.208 - acc jigsaw : 87.50, class : 71.88 [bs:128]
Accuracies on val: jigsaw : 94.63, class : 90.96
--------------------------------------------------------
Accuracies on test: jigsaw : 97.99, class : 77.39
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 9
New epoch - lr: 0.001
0/53 of epoch 10/30 jigsaw : 0.434, class : 0.253, t_rotation : 0.187, entropy : 0.219 - acc jigsaw : 85.16, class : 73.44 [bs:128]
30/53 of epoch 10/30 jigsaw : 0.271, class : 0.123, t_rotation : 0.192, entropy : 0.177 - acc jigsaw : 92.19, class : 74.22 [bs:128]
Accuracies on val: jigsaw : 94.50, class : 91.61
--------------------------------------------------------
Accuracies on test: jigsaw : 98.76, class : 77.52
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 10
New epoch - lr: 0.001
0/53 of epoch 11/30 jigsaw : 0.298, class : 0.101, t_rotation : 0.184, entropy : 0.213 - acc jigsaw : 86.72, class : 75.00 [bs:128]
30/53 of epoch 11/30 jigsaw : 0.292, class : 0.109, t_rotation : 0.104, entropy : 0.177 - acc jigsaw : 89.06, class : 72.66 [bs:128]
Accuracies on val: jigsaw : 95.94, class : 90.83
--------------------------------------------------------
Accuracies on test: jigsaw : 99.10, class : 77.77
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 11
New epoch - lr: 0.001
0/53 of epoch 12/30 jigsaw : 0.187, class : 0.176, t_rotation : 0.165, entropy : 0.189 - acc jigsaw : 93.75, class : 69.53 [bs:128]
30/53 of epoch 12/30 jigsaw : 0.333, class : 0.093, t_rotation : 0.117, entropy : 0.209 - acc jigsaw : 88.28, class : 77.34 [bs:128]
Accuracies on val: jigsaw : 93.97, class : 91.74
--------------------------------------------------------
Accuracies on test: jigsaw : 98.81, class : 77.99
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 12
New epoch - lr: 0.001
0/53 of epoch 13/30 jigsaw : 0.205, class : 0.205, t_rotation : 0.132, entropy : 0.241 - acc jigsaw : 91.41, class : 76.56 [bs:128]
30/53 of epoch 13/30 jigsaw : 0.251, class : 0.053, t_rotation : 0.125, entropy : 0.156 - acc jigsaw : 91.41, class : 78.12 [bs:128]
Accuracies on val: jigsaw : 94.63, class : 92.40
--------------------------------------------------------
Accuracies on test: jigsaw : 98.42, class : 77.43
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 13
New epoch - lr: 0.001
0/53 of epoch 14/30 jigsaw : 0.298, class : 0.033, t_rotation : 0.189, entropy : 0.182 - acc jigsaw : 88.28, class : 78.91 [bs:128]
30/53 of epoch 14/30 jigsaw : 0.339, class : 0.116, t_rotation : 0.088, entropy : 0.142 - acc jigsaw : 89.06, class : 71.88 [bs:128]
Accuracies on val: jigsaw : 95.15, class : 92.66
--------------------------------------------------------
Accuracies on test: jigsaw : 99.10, class : 78.24
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 14
New epoch - lr: 0.001
0/53 of epoch 15/30 jigsaw : 0.258, class : 0.153, t_rotation : 0.222, entropy : 0.146 - acc jigsaw : 88.28, class : 71.09 [bs:128]
30/53 of epoch 15/30 jigsaw : 0.335, class : 0.097, t_rotation : 0.107, entropy : 0.099 - acc jigsaw : 88.28, class : 75.00 [bs:128]
Accuracies on val: jigsaw : 95.28, class : 92.14
--------------------------------------------------------
Accuracies on test: jigsaw : 98.76, class : 77.43
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 15
New epoch - lr: 0.001
0/53 of epoch 16/30 jigsaw : 0.225, class : 0.084, t_rotation : 0.156, entropy : 0.159 - acc jigsaw : 91.41, class : 68.75 [bs:128]
30/53 of epoch 16/30 jigsaw : 0.231, class : 0.107, t_rotation : 0.139, entropy : 0.202 - acc jigsaw : 92.19, class : 66.41 [bs:128]
Accuracies on val: jigsaw : 95.41, class : 91.61
--------------------------------------------------------
Accuracies on test: jigsaw : 99.27, class : 77.56
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 16
New epoch - lr: 0.001
0/53 of epoch 17/30 jigsaw : 0.317, class : 0.099, t_rotation : 0.114, entropy : 0.140 - acc jigsaw : 88.28, class : 79.69 [bs:128]
30/53 of epoch 17/30 jigsaw : 0.324, class : 0.051, t_rotation : 0.066, entropy : 0.174 - acc jigsaw : 89.84, class : 75.78 [bs:128]
Accuracies on val: jigsaw : 94.10, class : 92.01
--------------------------------------------------------
Accuracies on test: jigsaw : 98.29, class : 77.22
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 17
New epoch - lr: 0.001
0/53 of epoch 18/30 jigsaw : 0.289, class : 0.030, t_rotation : 0.122, entropy : 0.150 - acc jigsaw : 89.84, class : 76.56 [bs:128]
30/53 of epoch 18/30 jigsaw : 0.307, class : 0.012, t_rotation : 0.090, entropy : 0.139 - acc jigsaw : 90.62, class : 75.00 [bs:128]
Accuracies on val: jigsaw : 95.54, class : 92.27
--------------------------------------------------------
Accuracies on test: jigsaw : 99.19, class : 77.86
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 18
New epoch - lr: 0.001
0/53 of epoch 19/30 jigsaw : 0.317, class : 0.046, t_rotation : 0.133, entropy : 0.095 - acc jigsaw : 89.84, class : 75.00 [bs:128]
30/53 of epoch 19/30 jigsaw : 0.227, class : 0.031, t_rotation : 0.086, entropy : 0.113 - acc jigsaw : 91.41, class : 74.22 [bs:128]
Accuracies on val: jigsaw : 95.15, class : 92.53
--------------------------------------------------------
Accuracies on test: jigsaw : 99.10, class : 77.30
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 19
New epoch - lr: 0.001
0/53 of epoch 20/30 jigsaw : 0.147, class : 0.020, t_rotation : 0.181, entropy : 0.109 - acc jigsaw : 93.75, class : 73.44 [bs:128]
30/53 of epoch 20/30 jigsaw : 0.198, class : 0.029, t_rotation : 0.117, entropy : 0.131 - acc jigsaw : 92.19, class : 80.47 [bs:128]
Accuracies on val: jigsaw : 94.50, class : 90.96
--------------------------------------------------------
Accuracies on test: jigsaw : 99.27, class : 78.67
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 20
New epoch - lr: 0.001
0/53 of epoch 21/30 jigsaw : 0.312, class : 0.065, t_rotation : 0.108, entropy : 0.085 - acc jigsaw : 89.06, class : 82.81 [bs:128]
30/53 of epoch 21/30 jigsaw : 0.263, class : 0.085, t_rotation : 0.093, entropy : 0.126 - acc jigsaw : 90.62, class : 71.88 [bs:128]
Accuracies on val: jigsaw : 96.07, class : 90.69
--------------------------------------------------------
Accuracies on test: jigsaw : 99.49, class : 78.07
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 21
New epoch - lr: 0.001
0/53 of epoch 22/30 jigsaw : 0.137, class : 0.063, t_rotation : 0.095, entropy : 0.081 - acc jigsaw : 94.53, class : 68.75 [bs:128]
30/53 of epoch 22/30 jigsaw : 0.180, class : 0.057, t_rotation : 0.104, entropy : 0.095 - acc jigsaw : 92.97, class : 75.78 [bs:128]
Accuracies on val: jigsaw : 95.15, class : 91.09
--------------------------------------------------------
Accuracies on test: jigsaw : 99.45, class : 77.90
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 22
New epoch - lr: 0.001
0/53 of epoch 23/30 jigsaw : 0.233, class : 0.099, t_rotation : 0.200, entropy : 0.121 - acc jigsaw : 91.41, class : 70.31 [bs:128]
30/53 of epoch 23/30 jigsaw : 0.291, class : 0.068, t_rotation : 0.075, entropy : 0.083 - acc jigsaw : 89.84, class : 72.66 [bs:128]
Accuracies on val: jigsaw : 95.02, class : 92.53
--------------------------------------------------------
Accuracies on test: jigsaw : 99.45, class : 77.99
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 23
New epoch - lr: 0.0001
0/53 of epoch 24/30 jigsaw : 0.231, class : 0.023, t_rotation : 0.196, entropy : 0.098 - acc jigsaw : 92.19, class : 80.47 [bs:128]
30/53 of epoch 24/30 jigsaw : 0.225, class : 0.019, t_rotation : 0.159, entropy : 0.132 - acc jigsaw : 90.62, class : 77.34 [bs:128]
Accuracies on val: jigsaw : 94.63, class : 93.05
--------------------------------------------------------
Accuracies on test: jigsaw : 99.45, class : 77.86
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 24
New epoch - lr: 0.0001
0/53 of epoch 25/30 jigsaw : 0.166, class : 0.020, t_rotation : 0.148, entropy : 0.134 - acc jigsaw : 93.75, class : 70.31 [bs:128]
30/53 of epoch 25/30 jigsaw : 0.188, class : 0.038, t_rotation : 0.103, entropy : 0.109 - acc jigsaw : 94.53, class : 80.47 [bs:128]
Accuracies on val: jigsaw : 94.36, class : 93.18
--------------------------------------------------------
Accuracies on test: jigsaw : 99.32, class : 77.77
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 25
New epoch - lr: 0.0001
0/53 of epoch 26/30 jigsaw : 0.278, class : 0.009, t_rotation : 0.130, entropy : 0.146 - acc jigsaw : 89.06, class : 82.81 [bs:128]
30/53 of epoch 26/30 jigsaw : 0.220, class : 0.009, t_rotation : 0.078, entropy : 0.098 - acc jigsaw : 92.19, class : 77.34 [bs:128]
Accuracies on val: jigsaw : 94.89, class : 93.05
--------------------------------------------------------
Accuracies on test: jigsaw : 99.49, class : 77.73
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 26
New epoch - lr: 0.0001
0/53 of epoch 27/30 jigsaw : 0.233, class : 0.023, t_rotation : 0.152, entropy : 0.109 - acc jigsaw : 90.62, class : 71.09 [bs:128]
30/53 of epoch 27/30 jigsaw : 0.183, class : 0.027, t_rotation : 0.095, entropy : 0.102 - acc jigsaw : 93.75, class : 75.00 [bs:128]
Accuracies on val: jigsaw : 94.50, class : 92.53
--------------------------------------------------------
Accuracies on test: jigsaw : 99.32, class : 77.77
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 27
New epoch - lr: 0.0001
0/53 of epoch 28/30 jigsaw : 0.163, class : 0.049, t_rotation : 0.121, entropy : 0.115 - acc jigsaw : 93.75, class : 75.78 [bs:128]
30/53 of epoch 28/30 jigsaw : 0.151, class : 0.079, t_rotation : 0.111, entropy : 0.098 - acc jigsaw : 95.31, class : 78.91 [bs:128]
Accuracies on val: jigsaw : 95.02, class : 92.40
--------------------------------------------------------
Accuracies on test: jigsaw : 99.40, class : 77.82
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 28
New epoch - lr: 0.0001
0/53 of epoch 29/30 jigsaw : 0.314, class : 0.056, t_rotation : 0.130, entropy : 0.122 - acc jigsaw : 87.50, class : 76.56 [bs:128]
30/53 of epoch 29/30 jigsaw : 0.208, class : 0.063, t_rotation : 0.144, entropy : 0.091 - acc jigsaw : 93.75, class : 74.22 [bs:128]
Accuracies on val: jigsaw : 94.63, class : 92.66
--------------------------------------------------------
Accuracies on test: jigsaw : 99.49, class : 77.60
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 29
New epoch - lr: 0.0001
0/53 of epoch 30/30 jigsaw : 0.174, class : 0.077, t_rotation : 0.085, entropy : 0.101 - acc jigsaw : 92.19, class : 69.53 [bs:128]
30/53 of epoch 30/30 jigsaw : 0.129, class : 0.026, t_rotation : 0.109, entropy : 0.099 - acc jigsaw : 95.31, class : 70.31 [bs:128]
Accuracies on val: jigsaw : 94.36, class : 92.27
--------------------------------------------------------
Accuracies on test: jigsaw : 99.49, class : 77.73
--------------------------------------------------------
2019-12-16 10:23:55
cartoon
['photo', 'sketch', 'art_painting']
unsupervised_task_weight: 0.8
bias_hole_image: 0.4
target_rotation_weight: 0.8
entropy_weight 0.3
only_classify the ordered image: True
Highest accuracy on validation set appears on epoch  tensor(24)
Highest accuracy on test set appears on epoch  tensor(19)
Accuracy on test set when the accuracy on validation set is highest:0.778
Highest accuracy on test set:0.787
It took 1248.87
--------------------------------------------------------
******************Start training**************************************
--------------------------------------------------------
Dataset size: training 6884, validation 763, testing 2344
--------------------------------------------------------
Namespace(TTA=False, batch_size=128, bias_whole_image=0.4, classify_only_ordered_images_or_not=True, domains_list=['photo', 'sketch', 'cartoon', 'art_painting'], entropy_loss_weight=0.3, epochs=30, folder_name='test', image_size=222, jitter=0.4, learning_rate=0.001, limit_source=None, limit_target=None, max_scale=1.0, min_scale=0.8, n_classes=7, nesterov=False, network='resnet18', ooo_weight=0, parameters_lists=[[0.8, 0.4, 0.8, 0.2], [0.8, 0.4, 0.8, 0.3], [0.8, 0.4, 0.8, 0.4]], random_horiz_flip=0.5, repeat_times=3, source=['photo', 'sketch', 'art_painting'], suffix='', target='cartoon', target_domain_list=['art_painting', 'cartoon', 'sketch', 'photo'], target_domain_unsupervised_task_loss_weight=0.8, tf_logger=True, tile_random_grayscale=0.1, train_all=True, unsupervised_task_weight=0.8, val_size=0.1)
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 0
New epoch - lr: 0.001
0/53 of epoch 1/30 jigsaw : 1.786, class : 2.086, t_rotation : 1.745, entropy : 1.843 - acc jigsaw : 11.72, class : 8.59 [bs:128]
30/53 of epoch 1/30 jigsaw : 0.954, class : 1.249, t_rotation : 1.002, entropy : 1.688 - acc jigsaw : 59.38, class : 50.78 [bs:128]
Accuracies on val: jigsaw : 93.45, class : 71.82
--------------------------------------------------------
Accuracies on test: jigsaw : 97.01, class : 50.85
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 1
New epoch - lr: 0.001
0/53 of epoch 2/30 jigsaw : 0.807, class : 0.728, t_rotation : 0.809, entropy : 1.365 - acc jigsaw : 64.06, class : 60.94 [bs:128]
30/53 of epoch 2/30 jigsaw : 0.658, class : 0.570, t_rotation : 0.640, entropy : 1.004 - acc jigsaw : 77.34, class : 66.41 [bs:128]
Accuracies on val: jigsaw : 92.79, class : 84.53
--------------------------------------------------------
Accuracies on test: jigsaw : 96.20, class : 63.44
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 2
New epoch - lr: 0.001
0/53 of epoch 3/30 jigsaw : 0.694, class : 0.522, t_rotation : 0.646, entropy : 0.690 - acc jigsaw : 73.44, class : 56.25 [bs:128]
30/53 of epoch 3/30 jigsaw : 0.473, class : 0.292, t_rotation : 0.594, entropy : 0.525 - acc jigsaw : 83.59, class : 72.66 [bs:128]
Accuracies on val: jigsaw : 93.84, class : 88.47
--------------------------------------------------------
Accuracies on test: jigsaw : 97.78, class : 73.46
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 3
New epoch - lr: 0.001
0/53 of epoch 4/30 jigsaw : 0.699, class : 0.423, t_rotation : 0.536, entropy : 0.599 - acc jigsaw : 71.88, class : 76.56 [bs:128]
30/53 of epoch 4/30 jigsaw : 0.421, class : 0.198, t_rotation : 0.526, entropy : 0.449 - acc jigsaw : 85.94, class : 71.88 [bs:128]
Accuracies on val: jigsaw : 94.50, class : 88.47
--------------------------------------------------------
Accuracies on test: jigsaw : 97.06, class : 75.90
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 4
New epoch - lr: 0.001
0/53 of epoch 5/30 jigsaw : 0.470, class : 0.258, t_rotation : 0.470, entropy : 0.585 - acc jigsaw : 87.50, class : 73.44 [bs:128]
30/53 of epoch 5/30 jigsaw : 0.441, class : 0.171, t_rotation : 0.386, entropy : 0.367 - acc jigsaw : 82.81, class : 71.09 [bs:128]
Accuracies on val: jigsaw : 94.76, class : 90.56
--------------------------------------------------------
Accuracies on test: jigsaw : 97.35, class : 75.43
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 5
New epoch - lr: 0.001
0/53 of epoch 6/30 jigsaw : 0.394, class : 0.193, t_rotation : 0.340, entropy : 0.318 - acc jigsaw : 85.16, class : 73.44 [bs:128]
30/53 of epoch 6/30 jigsaw : 0.515, class : 0.140, t_rotation : 0.238, entropy : 0.315 - acc jigsaw : 80.47, class : 73.44 [bs:128]
Accuracies on val: jigsaw : 93.71, class : 91.09
--------------------------------------------------------
Accuracies on test: jigsaw : 97.01, class : 75.51
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 6
New epoch - lr: 0.001
0/53 of epoch 7/30 jigsaw : 0.382, class : 0.180, t_rotation : 0.391, entropy : 0.309 - acc jigsaw : 87.50, class : 74.22 [bs:128]
30/53 of epoch 7/30 jigsaw : 0.303, class : 0.174, t_rotation : 0.301, entropy : 0.287 - acc jigsaw : 89.84, class : 71.88 [bs:128]
Accuracies on val: jigsaw : 94.10, class : 91.48
--------------------------------------------------------
Accuracies on test: jigsaw : 96.89, class : 77.73
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 7
New epoch - lr: 0.001
0/53 of epoch 8/30 jigsaw : 0.349, class : 0.103, t_rotation : 0.333, entropy : 0.308 - acc jigsaw : 91.41, class : 77.34 [bs:128]
30/53 of epoch 8/30 jigsaw : 0.278, class : 0.064, t_rotation : 0.199, entropy : 0.208 - acc jigsaw : 87.50, class : 78.12 [bs:128]
Accuracies on val: jigsaw : 95.28, class : 92.40
--------------------------------------------------------
Accuracies on test: jigsaw : 98.81, class : 78.20
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 8
New epoch - lr: 0.001
0/53 of epoch 9/30 jigsaw : 0.333, class : 0.145, t_rotation : 0.341, entropy : 0.395 - acc jigsaw : 87.50, class : 78.91 [bs:128]
30/53 of epoch 9/30 jigsaw : 0.219, class : 0.158, t_rotation : 0.155, entropy : 0.270 - acc jigsaw : 93.75, class : 71.09 [bs:128]
Accuracies on val: jigsaw : 93.84, class : 93.45
--------------------------------------------------------
Accuracies on test: jigsaw : 97.91, class : 77.09
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 9
New epoch - lr: 0.001
0/53 of epoch 10/30 jigsaw : 0.257, class : 0.134, t_rotation : 0.224, entropy : 0.261 - acc jigsaw : 92.19, class : 67.19 [bs:128]
30/53 of epoch 10/30 jigsaw : 0.246, class : 0.132, t_rotation : 0.131, entropy : 0.179 - acc jigsaw : 90.62, class : 72.66 [bs:128]
Accuracies on val: jigsaw : 95.02, class : 93.58
--------------------------------------------------------
Accuracies on test: jigsaw : 98.72, class : 76.54
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 10
New epoch - lr: 0.001
0/53 of epoch 11/30 jigsaw : 0.313, class : 0.099, t_rotation : 0.200, entropy : 0.195 - acc jigsaw : 88.28, class : 69.53 [bs:128]
30/53 of epoch 11/30 jigsaw : 0.299, class : 0.214, t_rotation : 0.200, entropy : 0.185 - acc jigsaw : 85.94, class : 71.88 [bs:128]
Accuracies on val: jigsaw : 95.28, class : 93.32
--------------------------------------------------------
Accuracies on test: jigsaw : 99.02, class : 77.69
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 11
New epoch - lr: 0.001
0/53 of epoch 12/30 jigsaw : 0.240, class : 0.089, t_rotation : 0.210, entropy : 0.186 - acc jigsaw : 91.41, class : 76.56 [bs:128]
30/53 of epoch 12/30 jigsaw : 0.309, class : 0.073, t_rotation : 0.124, entropy : 0.152 - acc jigsaw : 88.28, class : 82.81 [bs:128]
Accuracies on val: jigsaw : 95.81, class : 93.71
--------------------------------------------------------
Accuracies on test: jigsaw : 98.68, class : 78.80
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 12
New epoch - lr: 0.001
0/53 of epoch 13/30 jigsaw : 0.189, class : 0.134, t_rotation : 0.170, entropy : 0.149 - acc jigsaw : 92.19, class : 74.22 [bs:128]
30/53 of epoch 13/30 jigsaw : 0.253, class : 0.214, t_rotation : 0.144, entropy : 0.163 - acc jigsaw : 91.41, class : 79.69 [bs:128]
Accuracies on val: jigsaw : 94.10, class : 93.58
--------------------------------------------------------
Accuracies on test: jigsaw : 98.51, class : 79.82
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 13
New epoch - lr: 0.001
0/53 of epoch 14/30 jigsaw : 0.291, class : 0.086, t_rotation : 0.210, entropy : 0.119 - acc jigsaw : 86.72, class : 71.88 [bs:128]
30/53 of epoch 14/30 jigsaw : 0.272, class : 0.077, t_rotation : 0.167, entropy : 0.176 - acc jigsaw : 89.84, class : 75.78 [bs:128]
Accuracies on val: jigsaw : 94.76, class : 94.50
--------------------------------------------------------
Accuracies on test: jigsaw : 98.72, class : 78.63
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 14
New epoch - lr: 0.001
0/53 of epoch 15/30 jigsaw : 0.206, class : 0.037, t_rotation : 0.149, entropy : 0.161 - acc jigsaw : 91.41, class : 70.31 [bs:128]
30/53 of epoch 15/30 jigsaw : 0.367, class : 0.087, t_rotation : 0.099, entropy : 0.129 - acc jigsaw : 85.94, class : 73.44 [bs:128]
Accuracies on val: jigsaw : 95.02, class : 94.10
--------------------------------------------------------
Accuracies on test: jigsaw : 99.27, class : 79.44
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 15
New epoch - lr: 0.001
0/53 of epoch 16/30 jigsaw : 0.241, class : 0.072, t_rotation : 0.129, entropy : 0.156 - acc jigsaw : 89.84, class : 74.22 [bs:128]
30/53 of epoch 16/30 jigsaw : 0.208, class : 0.140, t_rotation : 0.087, entropy : 0.102 - acc jigsaw : 92.19, class : 70.31 [bs:128]
Accuracies on val: jigsaw : 93.84, class : 94.36
--------------------------------------------------------
Accuracies on test: jigsaw : 98.38, class : 78.92
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 16
New epoch - lr: 0.001
0/53 of epoch 17/30 jigsaw : 0.190, class : 0.117, t_rotation : 0.139, entropy : 0.107 - acc jigsaw : 92.19, class : 76.56 [bs:128]
30/53 of epoch 17/30 jigsaw : 0.208, class : 0.183, t_rotation : 0.102, entropy : 0.149 - acc jigsaw : 93.75, class : 73.44 [bs:128]
Accuracies on val: jigsaw : 94.76, class : 94.36
--------------------------------------------------------
Accuracies on test: jigsaw : 99.15, class : 78.28
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 17
New epoch - lr: 0.001
0/53 of epoch 18/30 jigsaw : 0.225, class : 0.067, t_rotation : 0.126, entropy : 0.166 - acc jigsaw : 92.19, class : 74.22 [bs:128]
30/53 of epoch 18/30 jigsaw : 0.225, class : 0.126, t_rotation : 0.088, entropy : 0.130 - acc jigsaw : 92.19, class : 79.69 [bs:128]
Accuracies on val: jigsaw : 93.18, class : 95.15
--------------------------------------------------------
Accuracies on test: jigsaw : 98.85, class : 78.20
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 18
New epoch - lr: 0.001
0/53 of epoch 19/30 jigsaw : 0.206, class : 0.045, t_rotation : 0.142, entropy : 0.127 - acc jigsaw : 91.41, class : 76.56 [bs:128]
30/53 of epoch 19/30 jigsaw : 0.389, class : 0.120, t_rotation : 0.128, entropy : 0.095 - acc jigsaw : 87.50, class : 72.66 [bs:128]
Accuracies on val: jigsaw : 93.32, class : 94.36
--------------------------------------------------------
Accuracies on test: jigsaw : 99.10, class : 79.91
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 19
New epoch - lr: 0.001
0/53 of epoch 20/30 jigsaw : 0.229, class : 0.041, t_rotation : 0.116, entropy : 0.090 - acc jigsaw : 89.84, class : 73.44 [bs:128]
30/53 of epoch 20/30 jigsaw : 0.220, class : 0.045, t_rotation : 0.067, entropy : 0.092 - acc jigsaw : 91.41, class : 79.69 [bs:128]
Accuracies on val: jigsaw : 93.71, class : 95.54
--------------------------------------------------------
Accuracies on test: jigsaw : 99.23, class : 77.47
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 20
New epoch - lr: 0.001
0/53 of epoch 21/30 jigsaw : 0.182, class : 0.028, t_rotation : 0.205, entropy : 0.076 - acc jigsaw : 96.09, class : 76.56 [bs:128]
30/53 of epoch 21/30 jigsaw : 0.186, class : 0.064, t_rotation : 0.089, entropy : 0.123 - acc jigsaw : 92.19, class : 71.09 [bs:128]
Accuracies on val: jigsaw : 95.02, class : 94.76
--------------------------------------------------------
Accuracies on test: jigsaw : 99.49, class : 79.74
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 21
New epoch - lr: 0.001
0/53 of epoch 22/30 jigsaw : 0.178, class : 0.152, t_rotation : 0.149, entropy : 0.107 - acc jigsaw : 91.41, class : 71.88 [bs:128]
30/53 of epoch 22/30 jigsaw : 0.174, class : 0.023, t_rotation : 0.090, entropy : 0.072 - acc jigsaw : 92.97, class : 78.12 [bs:128]
Accuracies on val: jigsaw : 95.15, class : 95.54
--------------------------------------------------------
Accuracies on test: jigsaw : 99.49, class : 79.27
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 22
New epoch - lr: 0.001
0/53 of epoch 23/30 jigsaw : 0.215, class : 0.116, t_rotation : 0.136, entropy : 0.119 - acc jigsaw : 94.53, class : 78.91 [bs:128]
30/53 of epoch 23/30 jigsaw : 0.243, class : 0.098, t_rotation : 0.086, entropy : 0.126 - acc jigsaw : 90.62, class : 78.91 [bs:128]
Accuracies on val: jigsaw : 95.15, class : 95.02
--------------------------------------------------------
Accuracies on test: jigsaw : 99.45, class : 79.39
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 23
New epoch - lr: 0.0001
0/53 of epoch 24/30 jigsaw : 0.214, class : 0.121, t_rotation : 0.095, entropy : 0.090 - acc jigsaw : 92.97, class : 71.88 [bs:128]
30/53 of epoch 24/30 jigsaw : 0.191, class : 0.028, t_rotation : 0.075, entropy : 0.091 - acc jigsaw : 94.53, class : 74.22 [bs:128]
Accuracies on val: jigsaw : 94.89, class : 95.28
--------------------------------------------------------
Accuracies on test: jigsaw : 99.57, class : 79.18
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 24
New epoch - lr: 0.0001
0/53 of epoch 25/30 jigsaw : 0.172, class : 0.032, t_rotation : 0.085, entropy : 0.151 - acc jigsaw : 93.75, class : 75.78 [bs:128]
30/53 of epoch 25/30 jigsaw : 0.223, class : 0.060, t_rotation : 0.111, entropy : 0.115 - acc jigsaw : 92.97, class : 72.66 [bs:128]
Accuracies on val: jigsaw : 95.54, class : 95.15
--------------------------------------------------------
Accuracies on test: jigsaw : 99.66, class : 79.35
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 25
New epoch - lr: 0.0001
0/53 of epoch 26/30 jigsaw : 0.125, class : 0.078, t_rotation : 0.123, entropy : 0.106 - acc jigsaw : 96.88, class : 68.75 [bs:128]
30/53 of epoch 26/30 jigsaw : 0.295, class : 0.058, t_rotation : 0.155, entropy : 0.150 - acc jigsaw : 89.06, class : 72.66 [bs:128]
Accuracies on val: jigsaw : 95.02, class : 95.41
--------------------------------------------------------
Accuracies on test: jigsaw : 99.57, class : 79.05
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 26
New epoch - lr: 0.0001
0/53 of epoch 27/30 jigsaw : 0.209, class : 0.025, t_rotation : 0.120, entropy : 0.111 - acc jigsaw : 92.19, class : 69.53 [bs:128]
30/53 of epoch 27/30 jigsaw : 0.240, class : 0.021, t_rotation : 0.113, entropy : 0.114 - acc jigsaw : 92.19, class : 82.81 [bs:128]
Accuracies on val: jigsaw : 95.94, class : 95.28
--------------------------------------------------------
Accuracies on test: jigsaw : 99.70, class : 79.39
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 27
New epoch - lr: 0.0001
0/53 of epoch 28/30 jigsaw : 0.179, class : 0.018, t_rotation : 0.097, entropy : 0.070 - acc jigsaw : 93.75, class : 73.44 [bs:128]
30/53 of epoch 28/30 jigsaw : 0.296, class : 0.065, t_rotation : 0.055, entropy : 0.092 - acc jigsaw : 90.62, class : 73.44 [bs:128]
Accuracies on val: jigsaw : 95.28, class : 95.28
--------------------------------------------------------
Accuracies on test: jigsaw : 99.62, class : 79.31
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 28
New epoch - lr: 0.0001
0/53 of epoch 29/30 jigsaw : 0.285, class : 0.010, t_rotation : 0.109, entropy : 0.093 - acc jigsaw : 92.19, class : 75.78 [bs:128]
30/53 of epoch 29/30 jigsaw : 0.338, class : 0.082, t_rotation : 0.106, entropy : 0.111 - acc jigsaw : 88.28, class : 76.56 [bs:128]
Accuracies on val: jigsaw : 95.54, class : 95.28
--------------------------------------------------------
Accuracies on test: jigsaw : 99.57, class : 79.05
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 29
New epoch - lr: 0.0001
0/53 of epoch 30/30 jigsaw : 0.168, class : 0.055, t_rotation : 0.086, entropy : 0.120 - acc jigsaw : 92.97, class : 82.03 [bs:128]
30/53 of epoch 30/30 jigsaw : 0.185, class : 0.031, t_rotation : 0.155, entropy : 0.168 - acc jigsaw : 93.75, class : 71.09 [bs:128]
Accuracies on val: jigsaw : 95.28, class : 95.15
--------------------------------------------------------
Accuracies on test: jigsaw : 99.70, class : 78.97
--------------------------------------------------------
2019-12-16 10:44:45
cartoon
['photo', 'sketch', 'art_painting']
unsupervised_task_weight: 0.8
bias_hole_image: 0.4
target_rotation_weight: 0.8
entropy_weight 0.3
only_classify the ordered image: True
Highest accuracy on validation set appears on epoch  tensor(21)
Highest accuracy on test set appears on epoch  tensor(18)
Accuracy on test set when the accuracy on validation set is highest:0.793
Highest accuracy on test set:0.799
It took 1249.72
--------------------------------------------------------
******************Start training**************************************
--------------------------------------------------------
Dataset size: training 5457, validation 605, testing 3929
--------------------------------------------------------
Namespace(TTA=False, batch_size=128, bias_whole_image=0.4, classify_only_ordered_images_or_not=True, domains_list=['photo', 'sketch', 'cartoon', 'art_painting'], entropy_loss_weight=0.3, epochs=30, folder_name='test', image_size=222, jitter=0.4, learning_rate=0.001, limit_source=None, limit_target=None, max_scale=1.0, min_scale=0.8, n_classes=7, nesterov=False, network='resnet18', ooo_weight=0, parameters_lists=[[0.8, 0.4, 0.8, 0.2], [0.8, 0.4, 0.8, 0.3], [0.8, 0.4, 0.8, 0.4]], random_horiz_flip=0.5, repeat_times=3, source=['photo', 'cartoon', 'art_painting'], suffix='', target='sketch', target_domain_list=['art_painting', 'cartoon', 'sketch', 'photo'], target_domain_unsupervised_task_loss_weight=0.8, tf_logger=True, tile_random_grayscale=0.1, train_all=True, unsupervised_task_weight=0.8, val_size=0.1)
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 0
New epoch - lr: 0.001
0/42 of epoch 1/30 jigsaw : 1.409, class : 2.044, t_rotation : 1.400, entropy : 1.814 - acc jigsaw : 31.25, class : 18.75 [bs:128]
30/42 of epoch 1/30 jigsaw : 1.039, class : 1.140, t_rotation : 0.850, entropy : 1.733 - acc jigsaw : 62.50, class : 53.91 [bs:128]
Accuracies on val: jigsaw : 98.02, class : 69.59
--------------------------------------------------------
Accuracies on test: jigsaw : 93.26, class : 34.33
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 1
New epoch - lr: 0.001
0/42 of epoch 2/30 jigsaw : 0.961, class : 1.046, t_rotation : 0.687, entropy : 1.619 - acc jigsaw : 63.28, class : 66.41 [bs:128]
30/42 of epoch 2/30 jigsaw : 0.906, class : 0.578, t_rotation : 0.484, entropy : 1.201 - acc jigsaw : 61.72, class : 75.78 [bs:128]
Accuracies on val: jigsaw : 97.52, class : 81.82
--------------------------------------------------------
Accuracies on test: jigsaw : 93.99, class : 58.36
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 2
New epoch - lr: 0.001
0/42 of epoch 3/30 jigsaw : 0.797, class : 0.346, t_rotation : 0.564, entropy : 0.962 - acc jigsaw : 67.97, class : 78.12 [bs:128]
30/42 of epoch 3/30 jigsaw : 0.664, class : 0.363, t_rotation : 0.478, entropy : 0.667 - acc jigsaw : 71.88, class : 71.09 [bs:128]
Accuracies on val: jigsaw : 92.23, class : 84.79
--------------------------------------------------------
Accuracies on test: jigsaw : 93.26, class : 65.39
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 3
New epoch - lr: 0.001
0/42 of epoch 4/30 jigsaw : 0.723, class : 0.337, t_rotation : 0.418, entropy : 0.634 - acc jigsaw : 72.66, class : 75.78 [bs:128]
30/42 of epoch 4/30 jigsaw : 0.572, class : 0.320, t_rotation : 0.330, entropy : 0.479 - acc jigsaw : 78.12, class : 84.38 [bs:128]
Accuracies on val: jigsaw : 90.91, class : 89.42
--------------------------------------------------------
Accuracies on test: jigsaw : 92.49, class : 66.73
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 4
New epoch - lr: 0.001
0/42 of epoch 5/30 jigsaw : 0.634, class : 0.328, t_rotation : 0.412, entropy : 0.517 - acc jigsaw : 74.22, class : 71.09 [bs:128]
30/42 of epoch 5/30 jigsaw : 0.560, class : 0.251, t_rotation : 0.341, entropy : 0.413 - acc jigsaw : 77.34, class : 78.12 [bs:128]
Accuracies on val: jigsaw : 91.24, class : 89.09
--------------------------------------------------------
Accuracies on test: jigsaw : 93.89, class : 66.12
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 5
New epoch - lr: 0.001
0/42 of epoch 6/30 jigsaw : 0.758, class : 0.233, t_rotation : 0.434, entropy : 0.429 - acc jigsaw : 66.41, class : 77.34 [bs:128]
30/42 of epoch 6/30 jigsaw : 0.474, class : 0.255, t_rotation : 0.350, entropy : 0.379 - acc jigsaw : 88.28, class : 78.12 [bs:128]
Accuracies on val: jigsaw : 93.06, class : 88.93
--------------------------------------------------------
Accuracies on test: jigsaw : 95.39, class : 67.65
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 6
New epoch - lr: 0.001
0/42 of epoch 7/30 jigsaw : 0.503, class : 0.159, t_rotation : 0.424, entropy : 0.412 - acc jigsaw : 82.03, class : 78.12 [bs:128]
30/42 of epoch 7/30 jigsaw : 0.509, class : 0.174, t_rotation : 0.346, entropy : 0.336 - acc jigsaw : 82.81, class : 77.34 [bs:128]
Accuracies on val: jigsaw : 92.56, class : 90.25
--------------------------------------------------------
Accuracies on test: jigsaw : 96.49, class : 64.21
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 7
New epoch - lr: 0.001
0/42 of epoch 8/30 jigsaw : 0.487, class : 0.114, t_rotation : 0.266, entropy : 0.248 - acc jigsaw : 81.25, class : 78.12 [bs:128]
30/42 of epoch 8/30 jigsaw : 0.468, class : 0.256, t_rotation : 0.226, entropy : 0.244 - acc jigsaw : 83.59, class : 76.56 [bs:128]
Accuracies on val: jigsaw : 92.73, class : 89.26
--------------------------------------------------------
Accuracies on test: jigsaw : 96.72, class : 71.01
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 8
New epoch - lr: 0.001
0/42 of epoch 9/30 jigsaw : 0.468, class : 0.147, t_rotation : 0.261, entropy : 0.297 - acc jigsaw : 82.03, class : 77.34 [bs:128]
30/42 of epoch 9/30 jigsaw : 0.376, class : 0.204, t_rotation : 0.211, entropy : 0.228 - acc jigsaw : 84.38, class : 78.12 [bs:128]
Accuracies on val: jigsaw : 91.40, class : 92.40
--------------------------------------------------------
Accuracies on test: jigsaw : 95.27, class : 69.92
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 9
New epoch - lr: 0.001
0/42 of epoch 10/30 jigsaw : 0.380, class : 0.141, t_rotation : 0.263, entropy : 0.332 - acc jigsaw : 88.28, class : 74.22 [bs:128]
30/42 of epoch 10/30 jigsaw : 0.469, class : 0.213, t_rotation : 0.227, entropy : 0.311 - acc jigsaw : 83.59, class : 77.34 [bs:128]
Accuracies on val: jigsaw : 92.89, class : 90.25
--------------------------------------------------------
Accuracies on test: jigsaw : 95.65, class : 67.35
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 10
New epoch - lr: 0.001
0/42 of epoch 11/30 jigsaw : 0.401, class : 0.253, t_rotation : 0.229, entropy : 0.269 - acc jigsaw : 85.94, class : 79.69 [bs:128]
30/42 of epoch 11/30 jigsaw : 0.285, class : 0.109, t_rotation : 0.167, entropy : 0.246 - acc jigsaw : 89.84, class : 83.59 [bs:128]
Accuracies on val: jigsaw : 93.06, class : 92.23
--------------------------------------------------------
Accuracies on test: jigsaw : 96.84, class : 69.53
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 11
New epoch - lr: 0.001
0/42 of epoch 12/30 jigsaw : 0.364, class : 0.123, t_rotation : 0.216, entropy : 0.264 - acc jigsaw : 86.72, class : 69.53 [bs:128]
30/42 of epoch 12/30 jigsaw : 0.337, class : 0.155, t_rotation : 0.162, entropy : 0.225 - acc jigsaw : 85.94, class : 78.12 [bs:128]
Accuracies on val: jigsaw : 94.21, class : 92.23
--------------------------------------------------------
Accuracies on test: jigsaw : 97.68, class : 73.25
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 12
New epoch - lr: 0.001
0/42 of epoch 13/30 jigsaw : 0.400, class : 0.130, t_rotation : 0.286, entropy : 0.193 - acc jigsaw : 85.16, class : 75.78 [bs:128]
30/42 of epoch 13/30 jigsaw : 0.233, class : 0.059, t_rotation : 0.233, entropy : 0.189 - acc jigsaw : 93.75, class : 80.47 [bs:128]
Accuracies on val: jigsaw : 93.72, class : 93.39
--------------------------------------------------------
Accuracies on test: jigsaw : 97.45, class : 67.88
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 13
New epoch - lr: 0.001
0/42 of epoch 14/30 jigsaw : 0.367, class : 0.056, t_rotation : 0.142, entropy : 0.190 - acc jigsaw : 86.72, class : 78.12 [bs:128]
30/42 of epoch 14/30 jigsaw : 0.260, class : 0.094, t_rotation : 0.113, entropy : 0.161 - acc jigsaw : 91.41, class : 81.25 [bs:128]
Accuracies on val: jigsaw : 92.89, class : 92.40
--------------------------------------------------------
Accuracies on test: jigsaw : 97.17, class : 67.98
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 14
New epoch - lr: 0.001
0/42 of epoch 15/30 jigsaw : 0.251, class : 0.088, t_rotation : 0.222, entropy : 0.128 - acc jigsaw : 92.97, class : 75.78 [bs:128]
30/42 of epoch 15/30 jigsaw : 0.222, class : 0.116, t_rotation : 0.164, entropy : 0.118 - acc jigsaw : 94.53, class : 82.03 [bs:128]
Accuracies on val: jigsaw : 95.04, class : 92.40
--------------------------------------------------------
Accuracies on test: jigsaw : 97.63, class : 70.20
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 15
New epoch - lr: 0.001
0/42 of epoch 16/30 jigsaw : 0.350, class : 0.100, t_rotation : 0.147, entropy : 0.161 - acc jigsaw : 85.16, class : 75.78 [bs:128]
30/42 of epoch 16/30 jigsaw : 0.272, class : 0.126, t_rotation : 0.128, entropy : 0.125 - acc jigsaw : 90.62, class : 78.12 [bs:128]
Accuracies on val: jigsaw : 93.22, class : 93.55
--------------------------------------------------------
Accuracies on test: jigsaw : 96.72, class : 71.72
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 16
New epoch - lr: 0.001
0/42 of epoch 17/30 jigsaw : 0.294, class : 0.117, t_rotation : 0.226, entropy : 0.151 - acc jigsaw : 92.19, class : 76.56 [bs:128]
30/42 of epoch 17/30 jigsaw : 0.321, class : 0.053, t_rotation : 0.188, entropy : 0.142 - acc jigsaw : 88.28, class : 83.59 [bs:128]
Accuracies on val: jigsaw : 95.70, class : 93.88
--------------------------------------------------------
Accuracies on test: jigsaw : 98.37, class : 69.81
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 17
New epoch - lr: 0.001
0/42 of epoch 18/30 jigsaw : 0.284, class : 0.023, t_rotation : 0.140, entropy : 0.184 - acc jigsaw : 87.50, class : 76.56 [bs:128]
30/42 of epoch 18/30 jigsaw : 0.310, class : 0.050, t_rotation : 0.106, entropy : 0.156 - acc jigsaw : 88.28, class : 80.47 [bs:128]
Accuracies on val: jigsaw : 94.55, class : 93.22
--------------------------------------------------------
Accuracies on test: jigsaw : 98.73, class : 73.02
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 18
New epoch - lr: 0.001
0/42 of epoch 19/30 jigsaw : 0.315, class : 0.213, t_rotation : 0.173, entropy : 0.212 - acc jigsaw : 91.41, class : 69.53 [bs:128]
30/42 of epoch 19/30 jigsaw : 0.209, class : 0.096, t_rotation : 0.133, entropy : 0.189 - acc jigsaw : 92.97, class : 78.91 [bs:128]
Accuracies on val: jigsaw : 93.72, class : 93.06
--------------------------------------------------------
Accuracies on test: jigsaw : 98.19, class : 70.07
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 19
New epoch - lr: 0.001
0/42 of epoch 20/30 jigsaw : 0.301, class : 0.154, t_rotation : 0.170, entropy : 0.098 - acc jigsaw : 87.50, class : 75.78 [bs:128]
30/42 of epoch 20/30 jigsaw : 0.270, class : 0.024, t_rotation : 0.149, entropy : 0.063 - acc jigsaw : 91.41, class : 79.69 [bs:128]
Accuracies on val: jigsaw : 94.71, class : 93.72
--------------------------------------------------------
Accuracies on test: jigsaw : 98.22, class : 67.70
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 20
New epoch - lr: 0.001
0/42 of epoch 21/30 jigsaw : 0.279, class : 0.063, t_rotation : 0.127, entropy : 0.159 - acc jigsaw : 88.28, class : 77.34 [bs:128]
30/42 of epoch 21/30 jigsaw : 0.255, class : 0.067, t_rotation : 0.109, entropy : 0.152 - acc jigsaw : 89.84, class : 83.59 [bs:128]
Accuracies on val: jigsaw : 95.21, class : 93.55
--------------------------------------------------------
Accuracies on test: jigsaw : 98.96, class : 68.82
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 21
New epoch - lr: 0.001
0/42 of epoch 22/30 jigsaw : 0.280, class : 0.067, t_rotation : 0.113, entropy : 0.128 - acc jigsaw : 90.62, class : 78.91 [bs:128]
30/42 of epoch 22/30 jigsaw : 0.263, class : 0.145, t_rotation : 0.078, entropy : 0.109 - acc jigsaw : 91.41, class : 74.22 [bs:128]
Accuracies on val: jigsaw : 95.21, class : 93.39
--------------------------------------------------------
Accuracies on test: jigsaw : 97.51, class : 64.09
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 22
New epoch - lr: 0.001
0/42 of epoch 23/30 jigsaw : 0.278, class : 0.055, t_rotation : 0.148, entropy : 0.075 - acc jigsaw : 90.62, class : 76.56 [bs:128]
30/42 of epoch 23/30 jigsaw : 0.228, class : 0.114, t_rotation : 0.085, entropy : 0.060 - acc jigsaw : 92.97, class : 80.47 [bs:128]
Accuracies on val: jigsaw : 95.87, class : 93.22
--------------------------------------------------------
Accuracies on test: jigsaw : 99.01, class : 65.26
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 23
New epoch - lr: 0.0001
0/42 of epoch 24/30 jigsaw : 0.230, class : 0.023, t_rotation : 0.220, entropy : 0.090 - acc jigsaw : 91.41, class : 75.00 [bs:128]
30/42 of epoch 24/30 jigsaw : 0.180, class : 0.027, t_rotation : 0.208, entropy : 0.087 - acc jigsaw : 94.53, class : 82.81 [bs:128]
Accuracies on val: jigsaw : 95.37, class : 93.06
--------------------------------------------------------
Accuracies on test: jigsaw : 98.47, class : 64.90
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 24
New epoch - lr: 0.0001
0/42 of epoch 25/30 jigsaw : 0.237, class : 0.039, t_rotation : 0.175, entropy : 0.155 - acc jigsaw : 93.75, class : 73.44 [bs:128]
30/42 of epoch 25/30 jigsaw : 0.193, class : 0.117, t_rotation : 0.165, entropy : 0.151 - acc jigsaw : 92.97, class : 77.34 [bs:128]
Accuracies on val: jigsaw : 95.54, class : 92.89
--------------------------------------------------------
Accuracies on test: jigsaw : 98.55, class : 64.90
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 25
New epoch - lr: 0.0001
0/42 of epoch 26/30 jigsaw : 0.202, class : 0.098, t_rotation : 0.144, entropy : 0.143 - acc jigsaw : 90.62, class : 81.25 [bs:128]
30/42 of epoch 26/30 jigsaw : 0.260, class : 0.062, t_rotation : 0.137, entropy : 0.142 - acc jigsaw : 92.19, class : 78.91 [bs:128]
Accuracies on val: jigsaw : 95.04, class : 92.89
--------------------------------------------------------
Accuracies on test: jigsaw : 98.57, class : 64.88
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 26
New epoch - lr: 0.0001
0/42 of epoch 27/30 jigsaw : 0.295, class : 0.049, t_rotation : 0.088, entropy : 0.103 - acc jigsaw : 87.50, class : 81.25 [bs:128]
30/42 of epoch 27/30 jigsaw : 0.270, class : 0.070, t_rotation : 0.084, entropy : 0.100 - acc jigsaw : 89.84, class : 79.69 [bs:128]
Accuracies on val: jigsaw : 95.04, class : 93.06
--------------------------------------------------------
Accuracies on test: jigsaw : 98.37, class : 64.42
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 27
New epoch - lr: 0.0001
0/42 of epoch 28/30 jigsaw : 0.239, class : 0.068, t_rotation : 0.128, entropy : 0.122 - acc jigsaw : 93.75, class : 79.69 [bs:128]
30/42 of epoch 28/30 jigsaw : 0.170, class : 0.046, t_rotation : 0.124, entropy : 0.119 - acc jigsaw : 93.75, class : 81.25 [bs:128]
Accuracies on val: jigsaw : 95.37, class : 93.06
--------------------------------------------------------
Accuracies on test: jigsaw : 98.57, class : 64.62
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 28
New epoch - lr: 0.0001
0/42 of epoch 29/30 jigsaw : 0.217, class : 0.021, t_rotation : 0.147, entropy : 0.067 - acc jigsaw : 90.62, class : 75.78 [bs:128]
30/42 of epoch 29/30 jigsaw : 0.268, class : 0.054, t_rotation : 0.140, entropy : 0.065 - acc jigsaw : 87.50, class : 81.25 [bs:128]
Accuracies on val: jigsaw : 95.04, class : 93.22
--------------------------------------------------------
Accuracies on test: jigsaw : 98.63, class : 65.41
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 29
New epoch - lr: 0.0001
0/42 of epoch 30/30 jigsaw : 0.180, class : 0.036, t_rotation : 0.170, entropy : 0.133 - acc jigsaw : 92.19, class : 86.72 [bs:128]
30/42 of epoch 30/30 jigsaw : 0.349, class : 0.064, t_rotation : 0.157, entropy : 0.129 - acc jigsaw : 86.72, class : 80.47 [bs:128]
Accuracies on val: jigsaw : 94.38, class : 93.22
--------------------------------------------------------
Accuracies on test: jigsaw : 97.91, class : 65.92
--------------------------------------------------------
2019-12-16 11:02:25
sketch
['photo', 'cartoon', 'art_painting']
unsupervised_task_weight: 0.8
bias_hole_image: 0.4
target_rotation_weight: 0.8
entropy_weight 0.3
only_classify the ordered image: True
Highest accuracy on validation set appears on epoch  tensor(16)
Highest accuracy on test set appears on epoch  tensor(11)
Accuracy on test set when the accuracy on validation set is highest:0.698
Highest accuracy on test set:0.733
It took 1059.65
--------------------------------------------------------
******************Start training**************************************
--------------------------------------------------------
Dataset size: training 5457, validation 605, testing 3929
--------------------------------------------------------
Namespace(TTA=False, batch_size=128, bias_whole_image=0.4, classify_only_ordered_images_or_not=True, domains_list=['photo', 'sketch', 'cartoon', 'art_painting'], entropy_loss_weight=0.3, epochs=30, folder_name='test', image_size=222, jitter=0.4, learning_rate=0.001, limit_source=None, limit_target=None, max_scale=1.0, min_scale=0.8, n_classes=7, nesterov=False, network='resnet18', ooo_weight=0, parameters_lists=[[0.8, 0.4, 0.8, 0.2], [0.8, 0.4, 0.8, 0.3], [0.8, 0.4, 0.8, 0.4]], random_horiz_flip=0.5, repeat_times=3, source=['photo', 'cartoon', 'art_painting'], suffix='', target='sketch', target_domain_list=['art_painting', 'cartoon', 'sketch', 'photo'], target_domain_unsupervised_task_loss_weight=0.8, tf_logger=True, tile_random_grayscale=0.1, train_all=True, unsupervised_task_weight=0.8, val_size=0.1)
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 0
New epoch - lr: 0.001
0/42 of epoch 1/30 jigsaw : 1.448, class : 2.152, t_rotation : 1.448, entropy : 1.714 - acc jigsaw : 34.38, class : 17.19 [bs:128]
30/42 of epoch 1/30 jigsaw : 1.037, class : 1.141, t_rotation : 0.920, entropy : 1.738 - acc jigsaw : 58.59, class : 56.25 [bs:128]
Accuracies on val: jigsaw : 93.22, class : 72.73
--------------------------------------------------------
Accuracies on test: jigsaw : 85.95, class : 53.37
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 1
New epoch - lr: 0.001
0/42 of epoch 2/30 jigsaw : 0.943, class : 0.947, t_rotation : 0.788, entropy : 1.552 - acc jigsaw : 62.50, class : 59.38 [bs:128]
30/42 of epoch 2/30 jigsaw : 0.751, class : 0.674, t_rotation : 0.592, entropy : 1.125 - acc jigsaw : 71.09, class : 67.19 [bs:128]
Accuracies on val: jigsaw : 95.70, class : 86.12
--------------------------------------------------------
Accuracies on test: jigsaw : 93.59, class : 65.61
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 2
New epoch - lr: 0.001
0/42 of epoch 3/30 jigsaw : 0.941, class : 0.428, t_rotation : 0.558, entropy : 1.008 - acc jigsaw : 55.47, class : 80.47 [bs:128]
30/42 of epoch 3/30 jigsaw : 0.574, class : 0.390, t_rotation : 0.454, entropy : 0.758 - acc jigsaw : 78.91, class : 71.88 [bs:128]
Accuracies on val: jigsaw : 95.21, class : 87.77
--------------------------------------------------------
Accuracies on test: jigsaw : 95.60, class : 72.77
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 3
New epoch - lr: 0.001
0/42 of epoch 4/30 jigsaw : 0.695, class : 0.223, t_rotation : 0.431, entropy : 0.714 - acc jigsaw : 68.75, class : 78.12 [bs:128]
30/42 of epoch 4/30 jigsaw : 0.568, class : 0.187, t_rotation : 0.338, entropy : 0.574 - acc jigsaw : 78.91, class : 78.91 [bs:128]
Accuracies on val: jigsaw : 93.55, class : 89.42
--------------------------------------------------------
Accuracies on test: jigsaw : 94.76, class : 74.01
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 4
New epoch - lr: 0.001
0/42 of epoch 5/30 jigsaw : 0.604, class : 0.286, t_rotation : 0.362, entropy : 0.480 - acc jigsaw : 76.56, class : 71.09 [bs:128]
30/42 of epoch 5/30 jigsaw : 0.521, class : 0.263, t_rotation : 0.299, entropy : 0.395 - acc jigsaw : 78.91, class : 78.12 [bs:128]
Accuracies on val: jigsaw : 93.88, class : 91.40
--------------------------------------------------------
Accuracies on test: jigsaw : 96.08, class : 74.55
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 5
New epoch - lr: 0.001
0/42 of epoch 6/30 jigsaw : 0.571, class : 0.234, t_rotation : 0.329, entropy : 0.412 - acc jigsaw : 75.78, class : 79.69 [bs:128]
30/42 of epoch 6/30 jigsaw : 0.547, class : 0.181, t_rotation : 0.262, entropy : 0.348 - acc jigsaw : 77.34, class : 76.56 [bs:128]
Accuracies on val: jigsaw : 93.39, class : 91.57
--------------------------------------------------------
Accuracies on test: jigsaw : 96.16, class : 75.31
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 6
New epoch - lr: 0.001
0/42 of epoch 7/30 jigsaw : 0.467, class : 0.190, t_rotation : 0.265, entropy : 0.303 - acc jigsaw : 79.69, class : 72.66 [bs:128]
30/42 of epoch 7/30 jigsaw : 0.483, class : 0.326, t_rotation : 0.235, entropy : 0.237 - acc jigsaw : 83.59, class : 72.66 [bs:128]
Accuracies on val: jigsaw : 93.72, class : 91.24
--------------------------------------------------------
Accuracies on test: jigsaw : 96.23, class : 77.63
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 7
New epoch - lr: 0.001
0/42 of epoch 8/30 jigsaw : 0.385, class : 0.155, t_rotation : 0.412, entropy : 0.192 - acc jigsaw : 87.50, class : 78.12 [bs:128]
30/42 of epoch 8/30 jigsaw : 0.395, class : 0.274, t_rotation : 0.342, entropy : 0.171 - acc jigsaw : 85.94, class : 77.34 [bs:128]
Accuracies on val: jigsaw : 94.55, class : 92.56
--------------------------------------------------------
Accuracies on test: jigsaw : 97.84, class : 78.06
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 8
New epoch - lr: 0.001
0/42 of epoch 9/30 jigsaw : 0.423, class : 0.147, t_rotation : 0.226, entropy : 0.333 - acc jigsaw : 86.72, class : 78.91 [bs:128]
30/42 of epoch 9/30 jigsaw : 0.283, class : 0.238, t_rotation : 0.179, entropy : 0.284 - acc jigsaw : 89.84, class : 78.91 [bs:128]
Accuracies on val: jigsaw : 93.72, class : 93.22
--------------------------------------------------------
Accuracies on test: jigsaw : 96.61, class : 78.54
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 9
New epoch - lr: 0.001
0/42 of epoch 10/30 jigsaw : 0.336, class : 0.166, t_rotation : 0.242, entropy : 0.247 - acc jigsaw : 89.06, class : 78.12 [bs:128]
30/42 of epoch 10/30 jigsaw : 0.339, class : 0.142, t_rotation : 0.177, entropy : 0.242 - acc jigsaw : 85.94, class : 75.00 [bs:128]
Accuracies on val: jigsaw : 95.54, class : 92.89
--------------------------------------------------------
Accuracies on test: jigsaw : 97.96, class : 79.03
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 10
New epoch - lr: 0.001
0/42 of epoch 11/30 jigsaw : 0.445, class : 0.157, t_rotation : 0.256, entropy : 0.193 - acc jigsaw : 83.59, class : 73.44 [bs:128]
30/42 of epoch 11/30 jigsaw : 0.418, class : 0.138, t_rotation : 0.202, entropy : 0.158 - acc jigsaw : 85.94, class : 78.12 [bs:128]
Accuracies on val: jigsaw : 95.21, class : 93.72
--------------------------------------------------------
Accuracies on test: jigsaw : 97.28, class : 79.79
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 11
New epoch - lr: 0.001
0/42 of epoch 12/30 jigsaw : 0.356, class : 0.189, t_rotation : 0.166, entropy : 0.200 - acc jigsaw : 83.59, class : 82.81 [bs:128]
30/42 of epoch 12/30 jigsaw : 0.308, class : 0.106, t_rotation : 0.142, entropy : 0.175 - acc jigsaw : 90.62, class : 81.25 [bs:128]
Accuracies on val: jigsaw : 94.55, class : 94.05
--------------------------------------------------------
Accuracies on test: jigsaw : 96.82, class : 78.95
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 12
New epoch - lr: 0.001
0/42 of epoch 13/30 jigsaw : 0.304, class : 0.086, t_rotation : 0.166, entropy : 0.142 - acc jigsaw : 86.72, class : 72.66 [bs:128]
30/42 of epoch 13/30 jigsaw : 0.333, class : 0.183, t_rotation : 0.142, entropy : 0.133 - acc jigsaw : 85.16, class : 71.88 [bs:128]
Accuracies on val: jigsaw : 94.21, class : 93.55
--------------------------------------------------------
Accuracies on test: jigsaw : 95.60, class : 80.73
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 13
New epoch - lr: 0.001
0/42 of epoch 14/30 jigsaw : 0.256, class : 0.095, t_rotation : 0.196, entropy : 0.235 - acc jigsaw : 92.97, class : 78.91 [bs:128]
30/42 of epoch 14/30 jigsaw : 0.251, class : 0.058, t_rotation : 0.175, entropy : 0.222 - acc jigsaw : 91.41, class : 74.22 [bs:128]
Accuracies on val: jigsaw : 95.54, class : 93.06
--------------------------------------------------------
Accuracies on test: jigsaw : 95.78, class : 80.12
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 14
New epoch - lr: 0.001
0/42 of epoch 15/30 jigsaw : 0.504, class : 0.065, t_rotation : 0.233, entropy : 0.199 - acc jigsaw : 82.03, class : 81.25 [bs:128]
30/42 of epoch 15/30 jigsaw : 0.310, class : 0.151, t_rotation : 0.194, entropy : 0.159 - acc jigsaw : 87.50, class : 75.00 [bs:128]
Accuracies on val: jigsaw : 94.05, class : 94.21
--------------------------------------------------------
Accuracies on test: jigsaw : 96.77, class : 79.36
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 15
New epoch - lr: 0.001
0/42 of epoch 16/30 jigsaw : 0.321, class : 0.116, t_rotation : 0.195, entropy : 0.138 - acc jigsaw : 89.06, class : 76.56 [bs:128]
30/42 of epoch 16/30 jigsaw : 0.220, class : 0.120, t_rotation : 0.145, entropy : 0.134 - acc jigsaw : 92.97, class : 76.56 [bs:128]
Accuracies on val: jigsaw : 95.70, class : 94.38
--------------------------------------------------------
Accuracies on test: jigsaw : 98.14, class : 80.22
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 16
New epoch - lr: 0.001
0/42 of epoch 17/30 jigsaw : 0.357, class : 0.126, t_rotation : 0.146, entropy : 0.145 - acc jigsaw : 85.16, class : 70.31 [bs:128]
30/42 of epoch 17/30 jigsaw : 0.330, class : 0.141, t_rotation : 0.121, entropy : 0.133 - acc jigsaw : 85.94, class : 82.81 [bs:128]
Accuracies on val: jigsaw : 95.54, class : 94.21
--------------------------------------------------------
Accuracies on test: jigsaw : 97.23, class : 79.89
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 17
New epoch - lr: 0.001
0/42 of epoch 18/30 jigsaw : 0.288, class : 0.152, t_rotation : 0.172, entropy : 0.137 - acc jigsaw : 90.62, class : 81.25 [bs:128]
30/42 of epoch 18/30 jigsaw : 0.258, class : 0.097, t_rotation : 0.136, entropy : 0.121 - acc jigsaw : 92.19, class : 75.78 [bs:128]
Accuracies on val: jigsaw : 96.36, class : 94.21
--------------------------------------------------------
Accuracies on test: jigsaw : 98.42, class : 79.94
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 18
New epoch - lr: 0.001
0/42 of epoch 19/30 jigsaw : 0.363, class : 0.107, t_rotation : 0.094, entropy : 0.126 - acc jigsaw : 85.94, class : 80.47 [bs:128]
30/42 of epoch 19/30 jigsaw : 0.197, class : 0.046, t_rotation : 0.082, entropy : 0.105 - acc jigsaw : 94.53, class : 81.25 [bs:128]
Accuracies on val: jigsaw : 96.53, class : 93.72
--------------------------------------------------------
Accuracies on test: jigsaw : 98.07, class : 80.02
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 19
New epoch - lr: 0.001
0/42 of epoch 20/30 jigsaw : 0.201, class : 0.076, t_rotation : 0.204, entropy : 0.115 - acc jigsaw : 91.41, class : 78.91 [bs:128]
30/42 of epoch 20/30 jigsaw : 0.243, class : 0.079, t_rotation : 0.163, entropy : 0.103 - acc jigsaw : 90.62, class : 76.56 [bs:128]
Accuracies on val: jigsaw : 95.70, class : 94.05
--------------------------------------------------------
Accuracies on test: jigsaw : 98.22, class : 80.63
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 20
New epoch - lr: 0.001
0/42 of epoch 21/30 jigsaw : 0.179, class : 0.042, t_rotation : 0.089, entropy : 0.093 - acc jigsaw : 93.75, class : 73.44 [bs:128]
30/42 of epoch 21/30 jigsaw : 0.255, class : 0.078, t_rotation : 0.065, entropy : 0.087 - acc jigsaw : 90.62, class : 85.94 [bs:128]
Accuracies on val: jigsaw : 95.21, class : 94.71
--------------------------------------------------------
Accuracies on test: jigsaw : 98.01, class : 80.22
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 21
New epoch - lr: 0.001
0/42 of epoch 22/30 jigsaw : 0.227, class : 0.039, t_rotation : 0.105, entropy : 0.114 - acc jigsaw : 92.97, class : 78.91 [bs:128]
30/42 of epoch 22/30 jigsaw : 0.254, class : 0.058, t_rotation : 0.073, entropy : 0.093 - acc jigsaw : 89.84, class : 76.56 [bs:128]
Accuracies on val: jigsaw : 96.03, class : 93.39
--------------------------------------------------------
Accuracies on test: jigsaw : 97.73, class : 80.81
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 22
New epoch - lr: 0.001
0/42 of epoch 23/30 jigsaw : 0.140, class : 0.044, t_rotation : 0.151, entropy : 0.092 - acc jigsaw : 96.88, class : 75.00 [bs:128]
30/42 of epoch 23/30 jigsaw : 0.248, class : 0.036, t_rotation : 0.111, entropy : 0.075 - acc jigsaw : 92.19, class : 82.03 [bs:128]
Accuracies on val: jigsaw : 96.03, class : 94.55
--------------------------------------------------------
Accuracies on test: jigsaw : 98.42, class : 81.85
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 23
New epoch - lr: 0.0001
0/42 of epoch 24/30 jigsaw : 0.382, class : 0.080, t_rotation : 0.126, entropy : 0.125 - acc jigsaw : 86.72, class : 75.00 [bs:128]
30/42 of epoch 24/30 jigsaw : 0.272, class : 0.035, t_rotation : 0.116, entropy : 0.123 - acc jigsaw : 92.19, class : 78.12 [bs:128]
Accuracies on val: jigsaw : 96.03, class : 94.38
--------------------------------------------------------
Accuracies on test: jigsaw : 98.47, class : 81.80
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 24
New epoch - lr: 0.0001
0/42 of epoch 25/30 jigsaw : 0.220, class : 0.043, t_rotation : 0.086, entropy : 0.112 - acc jigsaw : 92.19, class : 78.91 [bs:128]
30/42 of epoch 25/30 jigsaw : 0.203, class : 0.098, t_rotation : 0.083, entropy : 0.110 - acc jigsaw : 92.19, class : 78.12 [bs:128]
Accuracies on val: jigsaw : 96.69, class : 94.38
--------------------------------------------------------
Accuracies on test: jigsaw : 98.68, class : 81.62
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 25
New epoch - lr: 0.0001
0/42 of epoch 26/30 jigsaw : 0.237, class : 0.038, t_rotation : 0.251, entropy : 0.089 - acc jigsaw : 92.97, class : 78.12 [bs:128]
30/42 of epoch 26/30 jigsaw : 0.295, class : 0.073, t_rotation : 0.242, entropy : 0.087 - acc jigsaw : 88.28, class : 82.03 [bs:128]
Accuracies on val: jigsaw : 96.36, class : 94.55
--------------------------------------------------------
Accuracies on test: jigsaw : 98.50, class : 81.27
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 26
New epoch - lr: 0.0001
0/42 of epoch 27/30 jigsaw : 0.262, class : 0.128, t_rotation : 0.136, entropy : 0.082 - acc jigsaw : 91.41, class : 69.53 [bs:128]
30/42 of epoch 27/30 jigsaw : 0.358, class : 0.037, t_rotation : 0.133, entropy : 0.080 - acc jigsaw : 86.72, class : 83.59 [bs:128]
Accuracies on val: jigsaw : 96.53, class : 94.38
--------------------------------------------------------
Accuracies on test: jigsaw : 98.65, class : 80.73
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 27
New epoch - lr: 0.0001
0/42 of epoch 28/30 jigsaw : 0.300, class : 0.053, t_rotation : 0.062, entropy : 0.101 - acc jigsaw : 92.19, class : 78.91 [bs:128]
30/42 of epoch 28/30 jigsaw : 0.270, class : 0.155, t_rotation : 0.061, entropy : 0.098 - acc jigsaw : 92.97, class : 79.69 [bs:128]
Accuracies on val: jigsaw : 96.03, class : 94.05
--------------------------------------------------------
Accuracies on test: jigsaw : 98.52, class : 81.57
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 28
New epoch - lr: 0.0001
0/42 of epoch 29/30 jigsaw : 0.258, class : 0.075, t_rotation : 0.086, entropy : 0.125 - acc jigsaw : 89.84, class : 76.56 [bs:128]
30/42 of epoch 29/30 jigsaw : 0.205, class : 0.032, t_rotation : 0.083, entropy : 0.121 - acc jigsaw : 93.75, class : 82.81 [bs:128]
Accuracies on val: jigsaw : 96.36, class : 94.55
--------------------------------------------------------
Accuracies on test: jigsaw : 98.55, class : 81.06
--------------------------------------------------------
--------------------------------------------------------
current epoch:%d 29
New epoch - lr: 0.0001
0/42 of epoch 30/30 jigsaw : 0.252, class : 0.023, t_rotation : 0.104, entropy : 0.148 - acc jigsaw : 88.28, class : 71.09 [bs:128]
